<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NeoMutt: send/send.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><a href="https://neomutt.org"><img alt="Logo" src="neomutt-64.png"/></a></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <a style="color: black; text-decoration: none;" href="https://neomutt.org">
   <div id="projectname">NeoMutt
   &#160;<span id="projectnumber">2021-02-05-584-gb5c7a7</span>
   </div>
   <div id="projectbrief">Teaching an old dog new tricks</div>
   </a>
   <a href="https://github.com/neomutt/neomutt" class="github-corner" aria-label="View source on Github"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#000000; color:#fff; position: fixed; top: 0; border: 0; right: 0; z-index: 9999;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
  </td>
   <td><a style="text-decoration: none; position: absolute; right: 0; top: 25px; margin-right: 100px; color: #66d866; font-size: 400%;" href="http://www.doxygen.org/index.html">DOXYGEN</a></td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('send_8c_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">send.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="send_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;config.h&quot;</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &lt;errno.h&gt;</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &lt;locale.h&gt;</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &lt;stdbool.h&gt;</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &lt;stdio.h&gt;</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &lt;string.h&gt;</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &lt;sys/stat.h&gt;</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &lt;time.h&gt;</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &lt;unistd.h&gt;</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="mutt_2lib_8h.html">mutt/lib.h</a>&quot;</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="address_2lib_8h.html">address/lib.h</a>&quot;</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="config_2lib_8h.html">config/lib.h</a>&quot;</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="email_2lib_8h.html">email/lib.h</a>&quot;</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="core_2lib_8h.html">core/lib.h</a>&quot;</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="alias_2lib_8h.html">alias/lib.h</a>&quot;</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="gui_2lib_8h.html">gui/lib.h</a>&quot;</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="mutt_8h.html">mutt.h</a>&quot;</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="send_8h.html">send.h</a>&quot;</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="address_2lib_8h.html">lib.h</a>&quot;</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="compose_2lib_8h.html">compose/lib.h</a>&quot;</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ncrypt_2lib_8h.html">ncrypt/lib.h</a>&quot;</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="pattern_2lib_8h.html">pattern/lib.h</a>&quot;</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="question_2lib_8h.html">question/lib.h</a>&quot;</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="attachments_8h.html">attachments.h</a>&quot;</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="browser_8h.html">browser.h</a>&quot;</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="context_8h.html">context.h</a>&quot;</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="copy_8h.html">copy.h</a>&quot;</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="format__flags_8h.html">format_flags.h</a>&quot;</span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="handler_8h.html">handler.h</a>&quot;</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="hdrline_8h.html">hdrline.h</a>&quot;</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="hook_8h.html">hook.h</a>&quot;</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="maillist_8h.html">maillist.h</a>&quot;</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="mutt__attach_8h.html">mutt_attach.h</a>&quot;</span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="mutt__body_8h.html">mutt_body.h</a>&quot;</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="mutt__globals_8h.html">mutt_globals.h</a>&quot;</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="mutt__header_8h.html">mutt_header.h</a>&quot;</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="mutt__logging_8h.html">mutt_logging.h</a>&quot;</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="muttlib_8h.html">muttlib.h</a>&quot;</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="options_8h.html">options.h</a>&quot;</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="protos_8h.html">protos.h</a>&quot;</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="recvattach_8h.html">recvattach.h</a>&quot;</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="rfc3676_8h.html">rfc3676.h</a>&quot;</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="sort_8h.html">sort.h</a>&quot;</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="preprocessor">#ifdef USE_NNTP</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="mx_8h.html">mx.h</a>&quot;</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="nntp_2mdata_8h.html">nntp/mdata.h</a>&quot;</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="preprocessor">#ifdef MIXMASTER</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="remailer_8h.html">remailer.h</a>&quot;</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="preprocessor">#ifdef USE_NOTMUCH</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="notmuch_2lib_8h.html">notmuch/lib.h</a>&quot;</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="preprocessor">#ifdef USE_IMAP</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="imap_2lib_8h.html">imap/lib.h</a>&quot;</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="preprocessor">#ifdef USE_AUTOCRYPT</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="autocrypt_2lib_8h.html">autocrypt/lib.h</a>&quot;</span></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div><div class="line"><a name="l00093"></a><span class="lineno"><a class="line" href="structGreetingInfo.html">   93</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structGreetingInfo.html">GreetingInfo</a></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;{</div><div class="line"><a name="l00095"></a><span class="lineno"><a class="line" href="structGreetingInfo.html#a287c96c716ab398fb5f062bd504b9a08">   95</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="structMailbox.html">Mailbox</a> *<a class="code" href="structGreetingInfo.html#a287c96c716ab398fb5f062bd504b9a08">mailbox</a>;</div><div class="line"><a name="l00096"></a><span class="lineno"><a class="line" href="structGreetingInfo.html#a8d8954bea1b907441e59e537bc41f4ce">   96</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="structEmail.html">Email</a> *<a class="code" href="structGreetingInfo.html#a8d8954bea1b907441e59e537bc41f4ce">email</a>;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;};</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div><div class="line"><a name="l00104"></a><span class="lineno"><a class="line" href="send_8c.html#afa5258518aabbe76c14e64e105515acf">  104</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="send_8c.html#afa5258518aabbe76c14e64e105515acf">append_signature</a>(FILE *fp, <span class="keyword">struct</span> <a class="code" href="structConfigSubset.html">ConfigSubset</a> *sub)</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;{</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keyword">const</span> c_signature = <a class="code" href="helpers_8c.html#acadf9e29fd733422508496a70a080c09">cs_subset_path</a>(sub, <span class="stringliteral">&quot;signature&quot;</span>);</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  <span class="keywordflow">if</span> (!c_signature)</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  <span class="comment">// If the user hasn&#39;t set $signature, don&#39;t warn them if it doesn&#39;t exist</span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  <span class="keyword">struct </span><a class="code" href="structBuffer.html">Buffer</a> *def_sig = <a class="code" href="pool_8c.html#a2129d5ea0085753afdd37cf62161845d">mutt_buffer_pool_get</a>();</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  <a class="code" href="set_8c.html#a1bc435f8e505a9274333899fa70250ce">cs_str_initial_get</a>(sub-&gt;<a class="code" href="structConfigSubset.html#a910a9162ee6326d796e785a03dc8b47a">cs</a>, <span class="stringliteral">&quot;signature&quot;</span>, def_sig);</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <a class="code" href="mutt_2path_8c.html#aa0bcac4d1513357fbd5fea73f25b63a5">mutt_path_canon</a>(def_sig-&gt;<a class="code" href="structBuffer.html#aeec1fd4af0ddf6765b0187466d4361b8">data</a>, def_sig-&gt;<a class="code" href="structBuffer.html#a1d9ee60bcf94de702b15ec2b5d811995">dsize</a>, <a class="code" href="config_2path_8c.html#a6f7b1cf93328b961c3e3a64f300d75b0">HomeDir</a>, <span class="keyword">false</span>);</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <span class="keywordtype">bool</span> notify_missing = !<a class="code" href="mutt_2string_8c.html#a6b6a50296dd2a31863a43379ef4a343d">mutt_str_equal</a>(c_signature, <a class="code" href="buffer_8h.html#a4aca040fb75bc1dfc086cbfbf14ac8cd">mutt_buffer_string</a>(def_sig));</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  <a class="code" href="pool_8c.html#a08b48e2ac8849341888ee7429cc5093c">mutt_buffer_pool_release</a>(&amp;def_sig);</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  pid_t pid = 0;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  FILE *fp_tmp = <a class="code" href="muttlib_8c.html#a99ddb819be19b4db97884f1d2b9984d8">mutt_open_read</a>(c_signature, &amp;pid);</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  <span class="keywordflow">if</span> (!fp_tmp)</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  {</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="keywordflow">if</span> (notify_missing)</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;      <a class="code" href="logging_8h.html#afaa521ab22db877ccf1b87e679e1b43e">mutt_perror</a>(c_signature);</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  }</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> c_sig_dashes = <a class="code" href="helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(sub, <span class="stringliteral">&quot;sig_dashes&quot;</span>);</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  <span class="keywordflow">if</span> (c_sig_dashes)</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    fputs(<span class="stringliteral">&quot;\n-- \n&quot;</span>, fp);</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  <a class="code" href="file_8c.html#a0a6ff09a685fb6fa1120a582a5a6ef4a">mutt_file_copy_stream</a>(fp_tmp, fp);</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  <a class="code" href="file_8c.html#a31f49795ff5b9558db5476e5777e63b6">mutt_file_fclose</a>(&amp;fp_tmp);</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  <span class="keywordflow">if</span> (pid != -1)</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <a class="code" href="filter_8c.html#a22c6912b837b1114c3276c990e73dca3">filter_wait</a>(pid);</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;}</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;</div><div class="line"><a name="l00141"></a><span class="lineno"><a class="line" href="send_8c.html#a6671477ec99e59665fcbac17986d6e93">  141</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="send_8c.html#a6671477ec99e59665fcbac17986d6e93">remove_user</a>(<span class="keyword">struct</span> AddressList *al, <span class="keywordtype">bool</span> leave_only)</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;{</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  <span class="keyword">struct </span><a class="code" href="structAddress.html">Address</a> *a = NULL, *tmp = NULL;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  <a class="code" href="queue_8h.html#a2a85f19896399eecd0ebf91cb8176166">TAILQ_FOREACH_SAFE</a>(a, al, entries, tmp)</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  {</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="alias_8c.html#a9d6f6b4ea9d79c9c33ddd7c6b6ef764b">mutt_addr_is_user</a>(a) &amp;&amp; (!leave_only || <a class="code" href="queue_8h.html#abd57fe9bdea6007a602f8c7d61bd5265">TAILQ_NEXT</a>(a, entries)))</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    {</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;      <a class="code" href="queue_8h.html#aaae87ca18c28066e1a96221e762d1209">TAILQ_REMOVE</a>(al, a, entries);</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;      <a class="code" href="address_2address_8c.html#a40eda06e6e64ff9d9f1e7d3b69e7c846">mutt_addr_free</a>(&amp;a);</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    }</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  }</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;}</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;</div><div class="line"><a name="l00160"></a><span class="lineno"><a class="line" href="send_8c.html#a7513f0a7dea1ccf4de7506399771a4c2">  160</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="send_8c.html#a7513f0a7dea1ccf4de7506399771a4c2">add_mailing_lists</a>(<span class="keyword">struct</span> AddressList *out, <span class="keyword">const</span> <span class="keyword">struct</span> AddressList *t,</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;                              <span class="keyword">const</span> <span class="keyword">struct</span> AddressList *c)</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;{</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  <span class="keyword">const</span> <span class="keyword">struct </span>AddressList *<span class="keyword">const</span> als[] = { t, c };</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code" href="memory_8h.html#afe62718c7d5ad088c3ea1dc4c28ccea3">mutt_array_size</a>(als); ++i)</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  {</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="keyword">const</span> <span class="keyword">struct </span>AddressList *al = als[i];</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="keyword">struct </span><a class="code" href="structAddress.html">Address</a> *a = NULL;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <a class="code" href="queue_8h.html#a16e5fc168e7f3494d4b1df54447d871e">TAILQ_FOREACH</a>(a, al, entries)</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    {</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;      <span class="keywordflow">if</span> (!a-&gt;<a class="code" href="structAddress.html#a12bd44ccc016e50c674ec3a902ba1c28">group</a> &amp;&amp; <a class="code" href="maillist_8c.html#a546aac24675f5681df8fe2ccd17aece8">mutt_is_mail_list</a>(a))</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;      {</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        <a class="code" href="address_2address_8c.html#a68385b174baad74a9aecf3dec61432a0">mutt_addrlist_append</a>(out, <a class="code" href="address_2address_8c.html#a16a97a499073187e58d4022ad6de29d1">mutt_addr_copy</a>(a));</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;      }</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    }</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  }</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;}</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;</div><div class="line"><a name="l00187"></a><span class="lineno"><a class="line" href="send_8h.html#a3a50e112e7c0ddd1270a550e63fdd80f">  187</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="send_8c.html#a3a50e112e7c0ddd1270a550e63fdd80f">mutt_edit_address</a>(<span class="keyword">struct</span> AddressList *al, <span class="keyword">const</span> <span class="keywordtype">char</span> *field, <span class="keywordtype">bool</span> expand_aliases)</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;{</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  <span class="keywordtype">char</span> buf[8192];</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  <span class="keywordtype">char</span> *err = NULL;</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  <span class="keywordtype">int</span> idna_ok = 0;</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  <span class="keywordflow">do</span></div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  {</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    buf[0] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <a class="code" href="address_2address_8c.html#a7b1224fc8c5dde7114228cfc8ffbbc23">mutt_addrlist_to_local</a>(al);</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <a class="code" href="address_2address_8c.html#a69d612ac8c7f2fc7e471561216bd1c41">mutt_addrlist_write</a>(al, buf, <span class="keyword">sizeof</span>(buf), <span class="keyword">false</span>);</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="curs__lib_8c.html#ab5fab29957531e6df60881531c22e907">mutt_get_field</a>(field, buf, <span class="keyword">sizeof</span>(buf), <a class="code" href="mutt_8h.html#aa576482dcb86d7d547476221029b176a">MUTT_ALIAS</a>, <span class="keyword">false</span>, NULL, NULL) != 0)</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <a class="code" href="address_2address_8c.html#a396bcf6adfff6663096fa6ae99c31c9a">mutt_addrlist_clear</a>(al);</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <a class="code" href="address_2address_8c.html#a8ac391285f1af69a114544e6575b597a">mutt_addrlist_parse2</a>(al, buf);</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="keywordflow">if</span> (expand_aliases)</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;      <a class="code" href="alias_8c.html#a7c57d5376e9a1cf5e1f504a452996b86">mutt_expand_aliases</a>(al);</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    idna_ok = <a class="code" href="address_2address_8c.html#abe8afdaeb5bdca19a1867823d73a1ec4">mutt_addrlist_to_intl</a>(al, &amp;err);</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="keywordflow">if</span> (idna_ok != 0)</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    {</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;      <a class="code" href="logging_8h.html#acc1fd6d7ab1603e80e11e84e90d061e4">mutt_error</a>(<a class="code" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Bad IDN: &#39;%s&#39;&quot;</span>), err);</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;      <a class="code" href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;err);</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    }</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  } <span class="keywordflow">while</span> (idna_ok != 0);</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;}</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;</div><div class="line"><a name="l00222"></a><span class="lineno"><a class="line" href="send_8c.html#a9fb4ee964889bd118582f0938027a659">  222</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="send_8c.html#a9fb4ee964889bd118582f0938027a659">edit_envelope</a>(<span class="keyword">struct</span> <a class="code" href="structEnvelope.html">Envelope</a> *en, <a class="code" href="send_8h.html#af731a62ddd44f1d907196beef8f8f19f">SendFlags</a> flags, <span class="keyword">struct</span> <a class="code" href="structConfigSubset.html">ConfigSubset</a> *sub)</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;{</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  <span class="keywordtype">char</span> buf[8192];</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="preprocessor">#ifdef USE_NNTP</span></div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="options_8h.html#affdfc25e31602911d236c7d283865f1c">OptNewsSend</a>)</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  {</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <span class="keywordflow">if</span> (en-&gt;<a class="code" href="structEnvelope.html#a5f680f60f1713477a879877dcbd21a5c">newsgroups</a>)</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;      <a class="code" href="mutt_2string_8c.html#ad20e00309de897a1e882fc7400335b83">mutt_str_copy</a>(buf, en-&gt;<a class="code" href="structEnvelope.html#a5f680f60f1713477a879877dcbd21a5c">newsgroups</a>, <span class="keyword">sizeof</span>(buf));</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;      buf[0] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="curs__lib_8c.html#ab5fab29957531e6df60881531c22e907">mutt_get_field</a>(<span class="stringliteral">&quot;Newsgroups: &quot;</span>, buf, <span class="keyword">sizeof</span>(buf), <a class="code" href="mutt_8h.html#ab0d3fda521b45dec654ff46bac59c8c2">MUTT_COMP_NO_FLAGS</a>,</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;                       <span class="keyword">false</span>, NULL, NULL) != 0)</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    {</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    }</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <a class="code" href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;en-&gt;<a class="code" href="structEnvelope.html#a5f680f60f1713477a879877dcbd21a5c">newsgroups</a>);</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    en-&gt;<a class="code" href="structEnvelope.html#a5f680f60f1713477a879877dcbd21a5c">newsgroups</a> = <a class="code" href="mutt_2string_8c.html#a4c2560f787bd1226b977992c16860c98">mutt_str_dup</a>(buf);</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <span class="keywordflow">if</span> (en-&gt;<a class="code" href="structEnvelope.html#a46a9e33786aa5394ad768cbcc2357d65">followup_to</a>)</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;      <a class="code" href="mutt_2string_8c.html#ad20e00309de897a1e882fc7400335b83">mutt_str_copy</a>(buf, en-&gt;<a class="code" href="structEnvelope.html#a46a9e33786aa5394ad768cbcc2357d65">followup_to</a>, <span class="keyword">sizeof</span>(buf));</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;      buf[0] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> c_ask_follow_up = <a class="code" href="helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(sub, <span class="stringliteral">&quot;ask_follow_up&quot;</span>);</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="keywordflow">if</span> (c_ask_follow_up &amp;&amp; (<a class="code" href="curs__lib_8c.html#ab5fab29957531e6df60881531c22e907">mutt_get_field</a>(<span class="stringliteral">&quot;Followup-To: &quot;</span>, buf, <span class="keyword">sizeof</span>(buf),</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                                           <a class="code" href="mutt_8h.html#ab0d3fda521b45dec654ff46bac59c8c2">MUTT_COMP_NO_FLAGS</a>, <span class="keyword">false</span>, NULL, NULL) != 0))</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    {</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    }</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <a class="code" href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;en-&gt;<a class="code" href="structEnvelope.html#a46a9e33786aa5394ad768cbcc2357d65">followup_to</a>);</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    en-&gt;<a class="code" href="structEnvelope.html#a46a9e33786aa5394ad768cbcc2357d65">followup_to</a> = <a class="code" href="mutt_2string_8c.html#a4c2560f787bd1226b977992c16860c98">mutt_str_dup</a>(buf);</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="keywordflow">if</span> (en-&gt;<a class="code" href="structEnvelope.html#a52153c6e4fdb551233e26d4fdb48fb78">x_comment_to</a>)</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;      <a class="code" href="mutt_2string_8c.html#ad20e00309de897a1e882fc7400335b83">mutt_str_copy</a>(buf, en-&gt;<a class="code" href="structEnvelope.html#a52153c6e4fdb551233e26d4fdb48fb78">x_comment_to</a>, <span class="keyword">sizeof</span>(buf));</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;      buf[0] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> c_x_comment_to = <a class="code" href="helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(sub, <span class="stringliteral">&quot;x_comment_to&quot;</span>);</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> c_ask_x_comment_to = <a class="code" href="helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(sub, <span class="stringliteral">&quot;ask_x_comment_to&quot;</span>);</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="keywordflow">if</span> (c_x_comment_to &amp;&amp; c_ask_x_comment_to &amp;&amp;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        (<a class="code" href="curs__lib_8c.html#ab5fab29957531e6df60881531c22e907">mutt_get_field</a>(<span class="stringliteral">&quot;X-Comment-To: &quot;</span>, buf, <span class="keyword">sizeof</span>(buf), <a class="code" href="mutt_8h.html#ab0d3fda521b45dec654ff46bac59c8c2">MUTT_COMP_NO_FLAGS</a>,</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                        <span class="keyword">false</span>, NULL, NULL) != 0))</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    {</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    }</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <a class="code" href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;en-&gt;<a class="code" href="structEnvelope.html#a52153c6e4fdb551233e26d4fdb48fb78">x_comment_to</a>);</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    en-&gt;<a class="code" href="structEnvelope.html#a52153c6e4fdb551233e26d4fdb48fb78">x_comment_to</a> = <a class="code" href="mutt_2string_8c.html#a4c2560f787bd1226b977992c16860c98">mutt_str_dup</a>(buf);</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  }</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  {</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="send_8c.html#a3a50e112e7c0ddd1270a550e63fdd80f">mutt_edit_address</a>(&amp;en-&gt;<a class="code" href="structEnvelope.html#a2d927371b3b80e025d6f7522b7361fe7">to</a>, <a class="code" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;To: &quot;</span>), <span class="keyword">true</span>) == -1) || <a class="code" href="queue_8h.html#ac3c9da7ac712eacbbad5cc54d7a3477e">TAILQ_EMPTY</a>(&amp;en-&gt;<a class="code" href="structEnvelope.html#a2d927371b3b80e025d6f7522b7361fe7">to</a>))</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> c_ask_cc = <a class="code" href="helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(sub, <span class="stringliteral">&quot;ask_cc&quot;</span>);</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="keywordflow">if</span> (c_ask_cc &amp;&amp; (<a class="code" href="send_8c.html#a3a50e112e7c0ddd1270a550e63fdd80f">mutt_edit_address</a>(&amp;en-&gt;<a class="code" href="structEnvelope.html#a6b00837b3cb4b41898b42307135be8b6">cc</a>, <a class="code" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Cc: &quot;</span>), <span class="keyword">true</span>) == -1))</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> c_ask_bcc = <a class="code" href="helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(sub, <span class="stringliteral">&quot;ask_bcc&quot;</span>);</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <span class="keywordflow">if</span> (c_ask_bcc &amp;&amp; (<a class="code" href="send_8c.html#a3a50e112e7c0ddd1270a550e63fdd80f">mutt_edit_address</a>(&amp;en-&gt;<a class="code" href="structEnvelope.html#aad427832f4ae422f1b16d0896c1d3af6">bcc</a>, <a class="code" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Bcc: &quot;</span>), <span class="keyword">true</span>) == -1))</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> c_reply_with_xorig = <a class="code" href="helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(sub, <span class="stringliteral">&quot;reply_with_xorig&quot;</span>);</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <span class="keywordflow">if</span> (c_reply_with_xorig &amp;&amp; (flags &amp; (<a class="code" href="send_8h.html#ac23e1891bcbc52cc25b5824acfb42d3c">SEND_REPLY</a> | <a class="code" href="send_8h.html#a54e225c19799cf682ef8228825dbb3d8">SEND_LIST_REPLY</a> | <a class="code" href="send_8h.html#a47e90c63dbdc4426d0630139c04cc8f3">SEND_GROUP_REPLY</a>)) &amp;&amp;</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        (<a class="code" href="send_8c.html#a3a50e112e7c0ddd1270a550e63fdd80f">mutt_edit_address</a>(&amp;en-&gt;<a class="code" href="structEnvelope.html#af1aa00aed4b8767cf98f08e45a432ad8">from</a>, <span class="stringliteral">&quot;From: &quot;</span>, <span class="keyword">true</span>) == -1))</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    {</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    }</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  }</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  <span class="keywordflow">if</span> (en-&gt;<a class="code" href="structEnvelope.html#aa3d22c82ed26a0727508d26363e98ea7">subject</a>)</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;  {</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> c_fast_reply = <a class="code" href="helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(sub, <span class="stringliteral">&quot;fast_reply&quot;</span>);</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <span class="keywordflow">if</span> (c_fast_reply)</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <a class="code" href="mutt_2string_8c.html#ad20e00309de897a1e882fc7400335b83">mutt_str_copy</a>(buf, en-&gt;<a class="code" href="structEnvelope.html#aa3d22c82ed26a0727508d26363e98ea7">subject</a>, <span class="keyword">sizeof</span>(buf));</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  }</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  {</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *p = NULL;</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    buf[0] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <span class="keyword">struct </span><a class="code" href="structListNode.html">ListNode</a> *uh = NULL;</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <a class="code" href="queue_8h.html#a77999ebdf5aaf7af8b8ea22bf208c432">STAILQ_FOREACH</a>(uh, &amp;UserHeader, entries)</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    {</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;      <span class="keywordtype">size_t</span> <a class="code" href="pgppacket_8c.html#af86b82f9e1d828f6609218d3787e6ea1">plen</a> = <a class="code" href="mutt_2string_8c.html#aebd2a8a3f8a30062c31fa1474d87cc41">mutt_istr_startswith</a>(uh-&gt;<a class="code" href="structListNode.html#aafe688d670318196766392d8235d00a7">data</a>, <span class="stringliteral">&quot;subject:&quot;</span>);</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;      <span class="keywordflow">if</span> (plen)</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;      {</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        p = <a class="code" href="mutt_2string_8c.html#aa5fb929533630a48c6d2e893267ce208">mutt_str_skip_email_wsp</a>(uh-&gt;<a class="code" href="structListNode.html#aafe688d670318196766392d8235d00a7">data</a> + plen);</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;        <a class="code" href="mutt_2string_8c.html#ad20e00309de897a1e882fc7400335b83">mutt_str_copy</a>(buf, p, <span class="keyword">sizeof</span>(buf));</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;      }</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    }</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  }</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  <span class="keyword">const</span> <span class="keyword">enum</span> <a class="code" href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35db">QuadOption</a> c_abort_nosubject =</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;      <a class="code" href="helpers_8c.html#a9154ba713ce99b0937f475eec7c61af9">cs_subset_quad</a>(sub, <span class="stringliteral">&quot;abort_nosubject&quot;</span>);</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  <span class="keywordflow">if</span> ((<a class="code" href="curs__lib_8c.html#ab5fab29957531e6df60881531c22e907">mutt_get_field</a>(<a class="code" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Subject: &quot;</span>), buf, <span class="keyword">sizeof</span>(buf), <a class="code" href="mutt_8h.html#ab0d3fda521b45dec654ff46bac59c8c2">MUTT_COMP_NO_FLAGS</a>,</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;                      <span class="keyword">false</span>, NULL, NULL) != 0) ||</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;      ((buf[0] == <span class="charliteral">&#39;\0&#39;</span>) &amp;&amp;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;       (<a class="code" href="question_2lib_8h.html#ab02047769214ff014b9a8a1782babadc">query_quadoption</a>(c_abort_nosubject, <a class="code" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;No subject, abort?&quot;</span>)) != <a class="code" href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35dbabe3800cc419f25384aaf1892fc3c812b">MUTT_NO</a>)))</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  {</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <a class="code" href="logging_8h.html#ae108f891125caafa9250cf0959c40c04">mutt_message</a>(<a class="code" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;No subject, aborting&quot;</span>));</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;  }</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;  <a class="code" href="mutt_2string_8c.html#ae9b6bbaa52b6ce51f2a384fe500e028e">mutt_str_replace</a>(&amp;en-&gt;<a class="code" href="structEnvelope.html#aa3d22c82ed26a0727508d26363e98ea7">subject</a>, buf);</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;}</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="preprocessor">#ifdef USE_NNTP</span></div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;</div><div class="line"><a name="l00340"></a><span class="lineno"><a class="line" href="send_8c.html#a1f444e7c2a2266af7e16fade94f07841">  340</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">char</span> *<a class="code" href="send_8c.html#a1f444e7c2a2266af7e16fade94f07841">nntp_get_header</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *s)</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;{</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;  <a class="code" href="string2_8h.html#aebd4477213a7b706515efaffdec64181">SKIPWS</a>(s);</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="mutt_2string_8c.html#a4c2560f787bd1226b977992c16860c98">mutt_str_dup</a>(s);</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;}</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;</div><div class="line"><a name="l00351"></a><span class="lineno"><a class="line" href="send_8c.html#a93b53146e2fbfb6657f83297e722fdac">  351</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="send_8c.html#a93b53146e2fbfb6657f83297e722fdac">process_user_recips</a>(<span class="keyword">struct</span> <a class="code" href="structEnvelope.html">Envelope</a> *env)</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;{</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  <span class="keyword">struct </span><a class="code" href="structListNode.html">ListNode</a> *uh = NULL;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;  <a class="code" href="queue_8h.html#a77999ebdf5aaf7af8b8ea22bf208c432">STAILQ_FOREACH</a>(uh, &amp;UserHeader, entries)</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  {</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="pgppacket_8c.html#af86b82f9e1d828f6609218d3787e6ea1">plen</a>;</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <span class="keywordflow">if</span> ((plen = <a class="code" href="mutt_2string_8c.html#aebd2a8a3f8a30062c31fa1474d87cc41">mutt_istr_startswith</a>(uh-&gt;<a class="code" href="structListNode.html#aafe688d670318196766392d8235d00a7">data</a>, <span class="stringliteral">&quot;to:&quot;</span>)))</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;      <a class="code" href="address_2address_8c.html#a9bb4abe92405bac67f03e36936a29b6e">mutt_addrlist_parse</a>(&amp;env-&gt;<a class="code" href="structEnvelope.html#a2d927371b3b80e025d6f7522b7361fe7">to</a>, uh-&gt;<a class="code" href="structListNode.html#aafe688d670318196766392d8235d00a7">data</a> + plen);</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((plen = <a class="code" href="mutt_2string_8c.html#aebd2a8a3f8a30062c31fa1474d87cc41">mutt_istr_startswith</a>(uh-&gt;<a class="code" href="structListNode.html#aafe688d670318196766392d8235d00a7">data</a>, <span class="stringliteral">&quot;cc:&quot;</span>)))</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;      <a class="code" href="address_2address_8c.html#a9bb4abe92405bac67f03e36936a29b6e">mutt_addrlist_parse</a>(&amp;env-&gt;<a class="code" href="structEnvelope.html#a6b00837b3cb4b41898b42307135be8b6">cc</a>, uh-&gt;<a class="code" href="structListNode.html#aafe688d670318196766392d8235d00a7">data</a> + plen);</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((plen = <a class="code" href="mutt_2string_8c.html#aebd2a8a3f8a30062c31fa1474d87cc41">mutt_istr_startswith</a>(uh-&gt;<a class="code" href="structListNode.html#aafe688d670318196766392d8235d00a7">data</a>, <span class="stringliteral">&quot;bcc:&quot;</span>)))</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;      <a class="code" href="address_2address_8c.html#a9bb4abe92405bac67f03e36936a29b6e">mutt_addrlist_parse</a>(&amp;env-&gt;<a class="code" href="structEnvelope.html#aad427832f4ae422f1b16d0896c1d3af6">bcc</a>, uh-&gt;<a class="code" href="structListNode.html#aafe688d670318196766392d8235d00a7">data</a> + plen);</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="preprocessor">#ifdef USE_NNTP</span></div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((plen = <a class="code" href="mutt_2string_8c.html#aebd2a8a3f8a30062c31fa1474d87cc41">mutt_istr_startswith</a>(uh-&gt;<a class="code" href="structListNode.html#aafe688d670318196766392d8235d00a7">data</a>, <span class="stringliteral">&quot;newsgroups:&quot;</span>)))</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;      env-&gt;<a class="code" href="structEnvelope.html#a5f680f60f1713477a879877dcbd21a5c">newsgroups</a> = <a class="code" href="send_8c.html#a1f444e7c2a2266af7e16fade94f07841">nntp_get_header</a>(uh-&gt;<a class="code" href="structListNode.html#aafe688d670318196766392d8235d00a7">data</a> + plen);</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((plen = <a class="code" href="mutt_2string_8c.html#aebd2a8a3f8a30062c31fa1474d87cc41">mutt_istr_startswith</a>(uh-&gt;<a class="code" href="structListNode.html#aafe688d670318196766392d8235d00a7">data</a>, <span class="stringliteral">&quot;followup-to:&quot;</span>)))</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;      env-&gt;<a class="code" href="structEnvelope.html#a46a9e33786aa5394ad768cbcc2357d65">followup_to</a> = <a class="code" href="send_8c.html#a1f444e7c2a2266af7e16fade94f07841">nntp_get_header</a>(uh-&gt;<a class="code" href="structListNode.html#aafe688d670318196766392d8235d00a7">data</a> + plen);</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((plen = <a class="code" href="mutt_2string_8c.html#aebd2a8a3f8a30062c31fa1474d87cc41">mutt_istr_startswith</a>(uh-&gt;<a class="code" href="structListNode.html#aafe688d670318196766392d8235d00a7">data</a>, <span class="stringliteral">&quot;x-comment-to:&quot;</span>)))</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;      env-&gt;<a class="code" href="structEnvelope.html#a52153c6e4fdb551233e26d4fdb48fb78">x_comment_to</a> = <a class="code" href="send_8c.html#a1f444e7c2a2266af7e16fade94f07841">nntp_get_header</a>(uh-&gt;<a class="code" href="structListNode.html#aafe688d670318196766392d8235d00a7">data</a> + plen);</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;  }</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;}</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;</div><div class="line"><a name="l00378"></a><span class="lineno"><a class="line" href="send_8c.html#a9bca5c9f44a7908485389d16dcf20f96">  378</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="send_8c.html#a9bca5c9f44a7908485389d16dcf20f96">process_user_header</a>(<span class="keyword">struct</span> <a class="code" href="structEnvelope.html">Envelope</a> *env)</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;{</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;  <span class="keyword">struct </span><a class="code" href="structListNode.html">ListNode</a> *uh = NULL;</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;  <a class="code" href="queue_8h.html#a77999ebdf5aaf7af8b8ea22bf208c432">STAILQ_FOREACH</a>(uh, &amp;UserHeader, entries)</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;  {</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="pgppacket_8c.html#af86b82f9e1d828f6609218d3787e6ea1">plen</a>;</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <span class="keywordflow">if</span> ((plen = <a class="code" href="mutt_2string_8c.html#aebd2a8a3f8a30062c31fa1474d87cc41">mutt_istr_startswith</a>(uh-&gt;<a class="code" href="structListNode.html#aafe688d670318196766392d8235d00a7">data</a>, <span class="stringliteral">&quot;from:&quot;</span>)))</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    {</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;      <span class="comment">/* User has specified a default From: address.  Remove default address */</span></div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;      <a class="code" href="address_2address_8c.html#a396bcf6adfff6663096fa6ae99c31c9a">mutt_addrlist_clear</a>(&amp;env-&gt;<a class="code" href="structEnvelope.html#af1aa00aed4b8767cf98f08e45a432ad8">from</a>);</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;      <a class="code" href="address_2address_8c.html#a9bb4abe92405bac67f03e36936a29b6e">mutt_addrlist_parse</a>(&amp;env-&gt;<a class="code" href="structEnvelope.html#af1aa00aed4b8767cf98f08e45a432ad8">from</a>, uh-&gt;<a class="code" href="structListNode.html#aafe688d670318196766392d8235d00a7">data</a> + plen);</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    }</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((plen = <a class="code" href="mutt_2string_8c.html#aebd2a8a3f8a30062c31fa1474d87cc41">mutt_istr_startswith</a>(uh-&gt;<a class="code" href="structListNode.html#aafe688d670318196766392d8235d00a7">data</a>, <span class="stringliteral">&quot;reply-to:&quot;</span>)))</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    {</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;      <a class="code" href="address_2address_8c.html#a396bcf6adfff6663096fa6ae99c31c9a">mutt_addrlist_clear</a>(&amp;env-&gt;<a class="code" href="structEnvelope.html#a4b75ab1853f95878dec079371bb0d799">reply_to</a>);</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;      <a class="code" href="address_2address_8c.html#a9bb4abe92405bac67f03e36936a29b6e">mutt_addrlist_parse</a>(&amp;env-&gt;<a class="code" href="structEnvelope.html#a4b75ab1853f95878dec079371bb0d799">reply_to</a>, uh-&gt;<a class="code" href="structListNode.html#aafe688d670318196766392d8235d00a7">data</a> + plen);</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    }</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((plen = <a class="code" href="mutt_2string_8c.html#aebd2a8a3f8a30062c31fa1474d87cc41">mutt_istr_startswith</a>(uh-&gt;<a class="code" href="structListNode.html#aafe688d670318196766392d8235d00a7">data</a>, <span class="stringliteral">&quot;message-id:&quot;</span>)))</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    {</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;      <span class="keywordtype">char</span> *tmp = <a class="code" href="parse_8c.html#a383628b0d4778ad83677498fab4132dd">mutt_extract_message_id</a>(uh-&gt;<a class="code" href="structListNode.html#aafe688d670318196766392d8235d00a7">data</a> + plen, NULL);</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="address_2address_8c.html#a434492a707aadd897d74bdf7b493bbc2">mutt_addr_valid_msgid</a>(tmp))</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;      {</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;        <a class="code" href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;env-&gt;<a class="code" href="structEnvelope.html#a50418c13a849bf27b22922bd5867e5e1">message_id</a>);</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;        env-&gt;<a class="code" href="structEnvelope.html#a50418c13a849bf27b22922bd5867e5e1">message_id</a> = tmp;</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;      }</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;        <a class="code" href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;tmp);</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    }</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code" href="mutt_2string_8c.html#aebd2a8a3f8a30062c31fa1474d87cc41">mutt_istr_startswith</a>(uh-&gt;<a class="code" href="structListNode.html#aafe688d670318196766392d8235d00a7">data</a>, <span class="stringliteral">&quot;to:&quot;</span>) &amp;&amp;</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;             !<a class="code" href="mutt_2string_8c.html#aebd2a8a3f8a30062c31fa1474d87cc41">mutt_istr_startswith</a>(uh-&gt;<a class="code" href="structListNode.html#aafe688d670318196766392d8235d00a7">data</a>, <span class="stringliteral">&quot;cc:&quot;</span>) &amp;&amp;</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;             !<a class="code" href="mutt_2string_8c.html#aebd2a8a3f8a30062c31fa1474d87cc41">mutt_istr_startswith</a>(uh-&gt;<a class="code" href="structListNode.html#aafe688d670318196766392d8235d00a7">data</a>, <span class="stringliteral">&quot;bcc:&quot;</span>) &amp;&amp;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;#ifdef USE_NNTP</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;             !<a class="code" href="mutt_2string_8c.html#aebd2a8a3f8a30062c31fa1474d87cc41">mutt_istr_startswith</a>(uh-&gt;<a class="code" href="structListNode.html#aafe688d670318196766392d8235d00a7">data</a>, <span class="stringliteral">&quot;newsgroups:&quot;</span>) &amp;&amp;</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;             !<a class="code" href="mutt_2string_8c.html#aebd2a8a3f8a30062c31fa1474d87cc41">mutt_istr_startswith</a>(uh-&gt;<a class="code" href="structListNode.html#aafe688d670318196766392d8235d00a7">data</a>, <span class="stringliteral">&quot;followup-to:&quot;</span>) &amp;&amp;</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;             !<a class="code" href="mutt_2string_8c.html#aebd2a8a3f8a30062c31fa1474d87cc41">mutt_istr_startswith</a>(uh-&gt;<a class="code" href="structListNode.html#aafe688d670318196766392d8235d00a7">data</a>, <span class="stringliteral">&quot;x-comment-to:&quot;</span>) &amp;&amp;</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;#endif</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;             !<a class="code" href="mutt_2string_8c.html#aebd2a8a3f8a30062c31fa1474d87cc41">mutt_istr_startswith</a>(uh-&gt;<a class="code" href="structListNode.html#aafe688d670318196766392d8235d00a7">data</a>, <span class="stringliteral">&quot;supersedes:&quot;</span>) &amp;&amp;</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;             !<a class="code" href="mutt_2string_8c.html#aebd2a8a3f8a30062c31fa1474d87cc41">mutt_istr_startswith</a>(uh-&gt;<a class="code" href="structListNode.html#aafe688d670318196766392d8235d00a7">data</a>, <span class="stringliteral">&quot;subject:&quot;</span>) &amp;&amp;</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;             !<a class="code" href="mutt_2string_8c.html#aebd2a8a3f8a30062c31fa1474d87cc41">mutt_istr_startswith</a>(uh-&gt;<a class="code" href="structListNode.html#aafe688d670318196766392d8235d00a7">data</a>, <span class="stringliteral">&quot;return-path:&quot;</span>))</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    {</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;      <a class="code" href="list_8c.html#ace47a64c8bec9d1b24be6524f650293d">mutt_list_insert_tail</a>(&amp;env-&gt;<a class="code" href="structEnvelope.html#a005f4bd665ae1ae362add27948753fe1">userhdrs</a>, <a class="code" href="mutt_2string_8c.html#a4c2560f787bd1226b977992c16860c98">mutt_str_dup</a>(uh-&gt;<a class="code" href="structListNode.html#aafe688d670318196766392d8235d00a7">data</a>));</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    }</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;  }</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;}</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;</div><div class="line"><a name="l00429"></a><span class="lineno"><a class="line" href="send_8h.html#a40683be6f58e2cdf321c3e30a494fbde">  429</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="send_8c.html#a40683be6f58e2cdf321c3e30a494fbde">mutt_forward_intro</a>(<span class="keyword">struct</span> <a class="code" href="structEmail.html">Email</a> *e, FILE *fp, <span class="keyword">struct</span> <a class="code" href="structConfigSubset.html">ConfigSubset</a> *sub)</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;{</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keyword">const</span> c_forward_attribution_intro =</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;      <a class="code" href="helpers_8c.html#ac477c591155aa4ae0452bbabc0affffe">cs_subset_string</a>(sub, <span class="stringliteral">&quot;forward_attribution_intro&quot;</span>);</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;  <span class="keywordflow">if</span> (!c_forward_attribution_intro || !fp)</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keyword">const</span> c_attribution_locale =</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;      <a class="code" href="helpers_8c.html#ac477c591155aa4ae0452bbabc0affffe">cs_subset_string</a>(sub, <span class="stringliteral">&quot;attribution_locale&quot;</span>);</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;  <span class="keywordtype">char</span> buf[1024];</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;  setlocale(LC_TIME, <a class="code" href="string2_8h.html#a7e0481bed27661ea2679f256b24e0283">NONULL</a>(c_attribution_locale));</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;  <a class="code" href="hdrline_8c.html#a5ff2b7d1b1e2dbd345801cdda1e3af14">mutt_make_string</a>(buf, <span class="keyword">sizeof</span>(buf), 0, c_forward_attribution_intro, NULL, -1,</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;                   e, <a class="code" href="format__flags_8h.html#a5167e8b2777abe5e02be90e0d2a816de">MUTT_FORMAT_NO_FLAGS</a>, NULL);</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;  setlocale(LC_TIME, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;  fputs(buf, fp);</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;  fputs(<span class="stringliteral">&quot;\n\n&quot;</span>, fp);</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;}</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;</div><div class="line"><a name="l00454"></a><span class="lineno"><a class="line" href="send_8h.html#ad951cc16f636045622b313f89278627a">  454</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="send_8c.html#ad951cc16f636045622b313f89278627a">mutt_forward_trailer</a>(<span class="keyword">struct</span> <a class="code" href="structEmail.html">Email</a> *e, FILE *fp, <span class="keyword">struct</span> <a class="code" href="structConfigSubset.html">ConfigSubset</a> *sub)</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;{</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keyword">const</span> c_forward_attribution_trailer =</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;      <a class="code" href="helpers_8c.html#ac477c591155aa4ae0452bbabc0affffe">cs_subset_string</a>(sub, <span class="stringliteral">&quot;forward_attribution_trailer&quot;</span>);</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;  <span class="keywordflow">if</span> (!c_forward_attribution_trailer || !fp)</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keyword">const</span> c_attribution_locale =</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;      <a class="code" href="helpers_8c.html#ac477c591155aa4ae0452bbabc0affffe">cs_subset_string</a>(sub, <span class="stringliteral">&quot;attribution_locale&quot;</span>);</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;  <span class="keywordtype">char</span> buf[1024];</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;  setlocale(LC_TIME, <a class="code" href="string2_8h.html#a7e0481bed27661ea2679f256b24e0283">NONULL</a>(c_attribution_locale));</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;  <a class="code" href="hdrline_8c.html#a5ff2b7d1b1e2dbd345801cdda1e3af14">mutt_make_string</a>(buf, <span class="keyword">sizeof</span>(buf), 0, c_forward_attribution_trailer, NULL, -1,</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;                   e, <a class="code" href="format__flags_8h.html#a5167e8b2777abe5e02be90e0d2a816de">MUTT_FORMAT_NO_FLAGS</a>, NULL);</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;  setlocale(LC_TIME, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;  fputc(<span class="charliteral">&#39;\n&#39;</span>, fp);</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;  fputs(buf, fp);</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;  fputc(<span class="charliteral">&#39;\n&#39;</span>, fp);</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;}</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;</div><div class="line"><a name="l00483"></a><span class="lineno"><a class="line" href="send_8c.html#a5e533b7adb511ebbadbd637e3264fb05">  483</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="send_8c.html#a5e533b7adb511ebbadbd637e3264fb05">include_forward</a>(<span class="keyword">struct</span> <a class="code" href="structMailbox.html">Mailbox</a> *m, <span class="keyword">struct</span> <a class="code" href="structEmail.html">Email</a> *e, FILE *fp_out,</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;                           <span class="keyword">struct</span> <a class="code" href="structConfigSubset.html">ConfigSubset</a> *sub)</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;{</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;  <a class="code" href="copy_8h.html#a88a40e8f238a8478b885c90d1ce53e9c">CopyHeaderFlags</a> chflags = <a class="code" href="copy_8h.html#a05de77c5d16eb6266cfb34b7b322a807">CH_DECODE</a>;</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;  <a class="code" href="copy_8h.html#adc738493d51f47c7dd372f3ebd53223a">CopyMessageFlags</a> cmflags = <a class="code" href="copy_8h.html#ac778c083de78e4fb27889f345f242d13">MUTT_CM_NO_FLAGS</a>;</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;  <span class="keyword">struct </span><a class="code" href="structMessage.html">Message</a> *msg = <a class="code" href="mx_8c.html#a7df2f9d4d83ce9fca2cf48e08f8a4bc0">mx_msg_open</a>(m, e-&gt;<a class="code" href="structEmail.html#abd3d551204f4ea232a304c1c4c4c149d">msgno</a>);</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;  <span class="keywordflow">if</span> (!msg)</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;  {</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;  }</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;  <a class="code" href="attachments_8c.html#a9fb5dd768a13b9f083ca3a5e2e713db6">mutt_parse_mime_message</a>(m, e, msg-&gt;<a class="code" href="structMessage.html#a11d53ee4319e8735c1677d8780a7b517">fp</a>);</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;  <a class="code" href="hook_8c.html#af487ca5e3f7da21c86e3ad61fdb55faa">mutt_message_hook</a>(m, e, <a class="code" href="hook_8h.html#ac4fada4e7df870f12ec6387389bba8c4">MUTT_MESSAGE_HOOK</a>);</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> c_forward_decode = <a class="code" href="helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(sub, <span class="stringliteral">&quot;forward_decode&quot;</span>);</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;  <span class="keywordflow">if</span> ((<a class="code" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> != 0) &amp;&amp; (e-&gt;<a class="code" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> &amp; <a class="code" href="ncrypt_2lib_8h.html#aacaa4abd4c0696e260b7a0f1d466360a">SEC_ENCRYPT</a>) &amp;&amp; c_forward_decode)</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;  {</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    <span class="comment">/* make sure we have the user&#39;s passphrase before proceeding... */</span></div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="crypt_8c.html#a4ee7f1419a7e39b0e9f1f9d550f4de43">crypt_valid_passphrase</a>(e-&gt;<a class="code" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a>))</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    {</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;      <a class="code" href="mx_8c.html#a2172d90c08b5a2b293d22ed13ee0e7a8">mx_msg_close</a>(m, &amp;msg);</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    }</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;  }</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;  <a class="code" href="send_8c.html#a40683be6f58e2cdf321c3e30a494fbde">mutt_forward_intro</a>(e, fp_out, sub);</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;  <span class="keywordflow">if</span> (c_forward_decode)</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;  {</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    cmflags |= <a class="code" href="copy_8h.html#a4898a6c2c88fdba8ce7decdb6c125a96">MUTT_CM_DECODE</a> | <a class="code" href="copy_8h.html#a648ee091378fa6c0f6f129f64fc7f22b">MUTT_CM_CHARCONV</a>;</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> c_weed = <a class="code" href="helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(sub, <span class="stringliteral">&quot;weed&quot;</span>);</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    <span class="keywordflow">if</span> (c_weed)</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    {</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;      chflags |= <a class="code" href="copy_8h.html#a5e818fe5d60277b658d3f98ee7e0e675">CH_WEED</a> | <a class="code" href="copy_8h.html#a606b533a9896e294b1341e648f0b8ba2">CH_REORDER</a>;</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;      cmflags |= <a class="code" href="copy_8h.html#a2184765637d3fe603457f28a20eccb41">MUTT_CM_WEED</a>;</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    }</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;  }</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> c_forward_quote = <a class="code" href="helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(sub, <span class="stringliteral">&quot;forward_quote&quot;</span>);</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;  <span class="keywordflow">if</span> (c_forward_quote)</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    cmflags |= <a class="code" href="copy_8h.html#a23b8aa8125d370213675b3c0b1c5e6fe">MUTT_CM_PREFIX</a>;</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;  <a class="code" href="copy_8c.html#aa0dd608f4ed300454d97ac83ade160ac">mutt_copy_message</a>(fp_out, m, e, msg, cmflags, chflags, 0);</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;  <a class="code" href="mx_8c.html#a2172d90c08b5a2b293d22ed13ee0e7a8">mx_msg_close</a>(m, &amp;msg);</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;  <a class="code" href="send_8c.html#ad951cc16f636045622b313f89278627a">mutt_forward_trailer</a>(e, fp_out, sub);</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;}</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;</div><div class="line"><a name="l00542"></a><span class="lineno"><a class="line" href="send_8c.html#ae0accb8ca6f488f8a6d77cd9fac7672b">  542</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="send_8c.html#ae0accb8ca6f488f8a6d77cd9fac7672b">inline_forward_attachments</a>(<span class="keyword">struct</span> <a class="code" href="structMailbox.html">Mailbox</a> *m, <span class="keyword">struct</span> <a class="code" href="structEmail.html">Email</a> *e,</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;                                      <span class="keyword">struct</span> <a class="code" href="structBody.html">Body</a> ***plast, <span class="keyword">enum</span> <a class="code" href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35db">QuadOption</a> *forwardq,</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;                                      <span class="keyword">struct</span> <a class="code" href="structConfigSubset.html">ConfigSubset</a> *sub)</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;{</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;  <span class="keyword">struct </span><a class="code" href="structBody.html">Body</a> **last = *plast;</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;  <span class="keyword">struct </span><a class="code" href="structBody.html">Body</a> *body = NULL;</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;  <span class="keyword">struct </span><a class="code" href="structAttachCtx.html">AttachCtx</a> *actx = NULL;</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;  <span class="keywordtype">int</span> rc = 0, i;</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;  <span class="keyword">struct </span><a class="code" href="structMessage.html">Message</a> *msg = <a class="code" href="mx_8c.html#a7df2f9d4d83ce9fca2cf48e08f8a4bc0">mx_msg_open</a>(m, e-&gt;<a class="code" href="structEmail.html#abd3d551204f4ea232a304c1c4c4c149d">msgno</a>);</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;  <span class="keywordflow">if</span> (!msg)</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;  {</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;  }</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;  <a class="code" href="attachments_8c.html#a9fb5dd768a13b9f083ca3a5e2e713db6">mutt_parse_mime_message</a>(m, e, msg-&gt;<a class="code" href="structMessage.html#a11d53ee4319e8735c1677d8780a7b517">fp</a>);</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;  <a class="code" href="hook_8c.html#af487ca5e3f7da21c86e3ad61fdb55faa">mutt_message_hook</a>(m, e, <a class="code" href="hook_8h.html#ac4fada4e7df870f12ec6387389bba8c4">MUTT_MESSAGE_HOOK</a>);</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;  actx = <a class="code" href="memory_8c.html#a4c1612d209c7825d55e6a014df352f03">mutt_mem_calloc</a>(1, <span class="keyword">sizeof</span>(*actx));</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;  actx-&gt;<a class="code" href="structAttachCtx.html#a8753a1c1a51b26d4a628861dfd56294f">email</a> = e;</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;  actx-&gt;<a class="code" href="structAttachCtx.html#a6bd678fc233b795a978f78f786f89f1c">fp_root</a> = msg-&gt;<a class="code" href="structMessage.html#a11d53ee4319e8735c1677d8780a7b517">fp</a>;</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;  <a class="code" href="recvattach_8c.html#a7688e395101baa5931494c883909d1da">mutt_generate_recvattach_list</a>(actx, actx-&gt;<a class="code" href="structAttachCtx.html#a8753a1c1a51b26d4a628861dfd56294f">email</a>, actx-&gt;<a class="code" href="structAttachCtx.html#a8753a1c1a51b26d4a628861dfd56294f">email</a>-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>,</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;                                actx-&gt;<a class="code" href="structAttachCtx.html#a6bd678fc233b795a978f78f786f89f1c">fp_root</a>, -1, 0, 0);</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;  <span class="keywordflow">for</span> (i = 0; i &lt; actx-&gt;<a class="code" href="structAttachCtx.html#af02af835a67d8b3467f3a52ede4897f0">idxlen</a>; i++)</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;  {</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    body = actx-&gt;<a class="code" href="structAttachCtx.html#a8954cda6f07f33628b3addf8bc2621fd">idx</a>[i]-&gt;<a class="code" href="structAttachPtr.html#a0546c0753a6155ae9555c290b80d0356">body</a>;</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    <span class="keywordflow">if</span> ((body-&gt;<a class="code" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a> != <a class="code" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79a877e24e62c85f20ff0e0f09ab983031e">TYPE_MULTIPART</a>) &amp;&amp; !<a class="code" href="handler_8c.html#ad8ffd2d9dd15e18644b821ec35c7ce52">mutt_can_decode</a>(body) &amp;&amp;</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;        !((body-&gt;<a class="code" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a> == <a class="code" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79ac5074066199e3f540550ca0b1a38978e">TYPE_APPLICATION</a>) &amp;&amp;</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;          (<a class="code" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(body-&gt;<a class="code" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>, <span class="stringliteral">&quot;pgp-signature&quot;</span>) ||</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;           <a class="code" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(body-&gt;<a class="code" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>, <span class="stringliteral">&quot;x-pkcs7-signature&quot;</span>) ||</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;           <a class="code" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(body-&gt;<a class="code" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>, <span class="stringliteral">&quot;pkcs7-signature&quot;</span>))))</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    {</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;      <span class="comment">/* Ask the quadoption only once */</span></div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;      <span class="keywordflow">if</span> (*forwardq == <a class="code" href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35dbaaa75b5db14c0aed1fde665034f113339">MUTT_ABORT</a>)</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;      {</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;        <span class="keyword">const</span> <span class="keyword">enum</span> <a class="code" href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35db">QuadOption</a> c_forward_attachments =</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;            <a class="code" href="helpers_8c.html#a9154ba713ce99b0937f475eec7c61af9">cs_subset_quad</a>(sub, <span class="stringliteral">&quot;forward_attachments&quot;</span>);</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;        *forwardq = <a class="code" href="question_2lib_8h.html#ab02047769214ff014b9a8a1782babadc">query_quadoption</a>(c_forward_attachments,</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;                                     <span class="comment">/* L10N: This is the prompt for $forward_attachments.</span></div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="comment">                                        When inline forwarding ($mime_forward answered &quot;no&quot;), this prompts</span></div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;<span class="comment">                                        whether to add non-decodable attachments from the original email.</span></div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;<span class="comment">                                        Text/plain parts and the like will already be included in the</span></div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;<span class="comment">                                        message contents, but other attachment, such as PDF files, will also</span></div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;<span class="comment">                                        be added as attachments to the new mail, if this is answered yes.  */</span></div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;                                     <a class="code" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Forward attachments?&quot;</span>));</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;        <span class="keywordflow">if</span> (*forwardq != <a class="code" href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35dbafee7088606c4724651c799a6a0b182b7">MUTT_YES</a>)</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;        {</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;          <span class="keywordflow">if</span> (*forwardq == -1)</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;            rc = -1;</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;          <span class="keywordflow">goto</span> cleanup;</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;        }</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;      }</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="mutt__body_8c.html#a34765b4c275e55006a2203472caa0294">mutt_body_copy</a>(actx-&gt;<a class="code" href="structAttachCtx.html#a8954cda6f07f33628b3addf8bc2621fd">idx</a>[i]-&gt;<a class="code" href="structAttachPtr.html#a776ea6f490cedf7dc47accba055d964c">fp</a>, last, body) == -1)</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;      {</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;        rc = -1;</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;        <span class="keywordflow">goto</span> cleanup;</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;      }</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;      last = &amp;((*last)-&gt;next);</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    }</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;  }</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;cleanup:</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;  *plast = last;</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;  <a class="code" href="mx_8c.html#a2172d90c08b5a2b293d22ed13ee0e7a8">mx_msg_close</a>(m, &amp;msg);</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;  <a class="code" href="email_2attach_8c.html#ac215772ab5cc4d60e0a64fd5c84513e1">mutt_actx_free</a>(&amp;actx);</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;  <span class="keywordflow">return</span> rc;</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;}</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;</div><div class="line"><a name="l00618"></a><span class="lineno"><a class="line" href="send_8h.html#a8119a731eeae7c3e754315e585169c33">  618</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="send_8c.html#a8119a731eeae7c3e754315e585169c33">mutt_make_attribution</a>(<span class="keyword">struct</span> <a class="code" href="structEmail.html">Email</a> *e, FILE *fp_out, <span class="keyword">struct</span> <a class="code" href="structConfigSubset.html">ConfigSubset</a> *sub)</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;{</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keyword">const</span> c_attribution = <a class="code" href="helpers_8c.html#ac477c591155aa4ae0452bbabc0affffe">cs_subset_string</a>(sub, <span class="stringliteral">&quot;attribution&quot;</span>);</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;  <span class="keywordflow">if</span> (!c_attribution || !fp_out)</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keyword">const</span> c_attribution_locale =</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;      <a class="code" href="helpers_8c.html#ac477c591155aa4ae0452bbabc0affffe">cs_subset_string</a>(sub, <span class="stringliteral">&quot;attribution_locale&quot;</span>);</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;  <span class="keywordtype">char</span> buf[1024];</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;  setlocale(LC_TIME, <a class="code" href="string2_8h.html#a7e0481bed27661ea2679f256b24e0283">NONULL</a>(c_attribution_locale));</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;  <a class="code" href="hdrline_8c.html#a5ff2b7d1b1e2dbd345801cdda1e3af14">mutt_make_string</a>(buf, <span class="keyword">sizeof</span>(buf), 0, c_attribution, NULL, -1, e,</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;                   <a class="code" href="format__flags_8h.html#a5167e8b2777abe5e02be90e0d2a816de">MUTT_FORMAT_NO_FLAGS</a>, NULL);</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;  setlocale(LC_TIME, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;  fputs(buf, fp_out);</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;  fputc(<span class="charliteral">&#39;\n&#39;</span>, fp_out);</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;}</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;</div><div class="line"><a name="l00645"></a><span class="lineno"><a class="line" href="send_8c.html#a43b8e36cf2d3908ed8484cceeab3de63">  645</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="send_8c.html#a43b8e36cf2d3908ed8484cceeab3de63">greeting_string</a>(<span class="keywordtype">char</span> *buf, <span class="keywordtype">size_t</span> buflen, <span class="keywordtype">size_t</span> col, <span class="keywordtype">int</span> cols,</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;                                   <span class="keywordtype">char</span> op, <span class="keyword">const</span> <span class="keywordtype">char</span> *src, <span class="keyword">const</span> <span class="keywordtype">char</span> *prec,</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;                                   <span class="keyword">const</span> <span class="keywordtype">char</span> *if_str, <span class="keyword">const</span> <span class="keywordtype">char</span> *else_str,</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;                                   intptr_t data, <a class="code" href="format__flags_8h.html#ad2734d319d795141616e1b5f241be1b2">MuttFormatFlags</a> <a class="code" href="structMessage.html#aa0bd3611d117ed56d5c42380c05e429d">flags</a>)</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;{</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;  <span class="keyword">struct </span><a class="code" href="structGreetingInfo.html">GreetingInfo</a> *gi = (<span class="keyword">struct </span><a class="code" href="structGreetingInfo.html">GreetingInfo</a> *) data;</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;  <span class="keywordtype">char</span> *p = NULL;</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;  <span class="keywordtype">char</span> buf2[256];</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;  <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structAddress.html">Address</a> *to = <a class="code" href="queue_8h.html#a7d6894360bd1c41e0e6f6d84998c1362">TAILQ_FIRST</a>(&amp;gi-&gt;<a class="code" href="structGreetingInfo.html#a8d8954bea1b907441e59e537bc41f4ce">email</a>-&gt;<a class="code" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code" href="structEnvelope.html#a2d927371b3b80e025d6f7522b7361fe7">to</a>);</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;  <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structAddress.html">Address</a> *cc = <a class="code" href="queue_8h.html#a7d6894360bd1c41e0e6f6d84998c1362">TAILQ_FIRST</a>(&amp;gi-&gt;<a class="code" href="structGreetingInfo.html#a8d8954bea1b907441e59e537bc41f4ce">email</a>-&gt;<a class="code" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code" href="structEnvelope.html#a6b00837b3cb4b41898b42307135be8b6">cc</a>);</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;  buf[0] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;  <span class="keywordflow">switch</span> (op)</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;  {</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    <span class="keywordflow">case</span> <span class="charliteral">&#39;n&#39;</span>:</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;      <a class="code" href="curs__lib_8c.html#af100ad8efff5639c6e0ed7d3e37030eb">mutt_format_s</a>(buf, buflen, prec, <a class="code" href="sort_8c.html#a9a230efa9217e987ca1d1adb14b7e235">mutt_get_name</a>(to));</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    <span class="keywordflow">case</span> <span class="charliteral">&#39;u&#39;</span>:</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;      <span class="keywordflow">if</span> (to)</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;      {</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;        <a class="code" href="mutt_2string_8c.html#ad20e00309de897a1e882fc7400335b83">mutt_str_copy</a>(buf2, <a class="code" href="address_2address_8c.html#a64951ec4d595356746ef4d26dd7533c6">mutt_addr_for_display</a>(to), <span class="keyword">sizeof</span>(buf2));</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;        <span class="keywordflow">if</span> ((p = strpbrk(buf2, <span class="stringliteral">&quot;%@&quot;</span>)))</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;          *p = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;      }</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;        buf2[0] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;      <a class="code" href="curs__lib_8c.html#af100ad8efff5639c6e0ed7d3e37030eb">mutt_format_s</a>(buf, buflen, prec, buf2);</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    <span class="keywordflow">case</span> <span class="charliteral">&#39;v&#39;</span>:</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;      <span class="keywordflow">if</span> (to)</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;        <a class="code" href="curs__lib_8c.html#af100ad8efff5639c6e0ed7d3e37030eb">mutt_format_s</a>(buf2, <span class="keyword">sizeof</span>(buf2), prec, <a class="code" href="sort_8c.html#a9a230efa9217e987ca1d1adb14b7e235">mutt_get_name</a>(to));</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (cc)</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;        <a class="code" href="curs__lib_8c.html#af100ad8efff5639c6e0ed7d3e37030eb">mutt_format_s</a>(buf2, <span class="keyword">sizeof</span>(buf2), prec, <a class="code" href="sort_8c.html#a9a230efa9217e987ca1d1adb14b7e235">mutt_get_name</a>(cc));</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;        *buf2 = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;      <span class="keywordflow">if</span> ((p = strpbrk(buf2, <span class="stringliteral">&quot; %@&quot;</span>)))</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;        *p = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;      <a class="code" href="curs__lib_8c.html#af100ad8efff5639c6e0ed7d3e37030eb">mutt_format_s</a>(buf, buflen, prec, buf2);</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    <span class="keywordflow">default</span>:</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;      snprintf(buf, buflen, <span class="stringliteral">&quot;%%%s%c&quot;</span>, prec, op);</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;  }</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;  <span class="keywordflow">if</span> (flags &amp; <a class="code" href="format__flags_8h.html#a74b6a43a2681d01209a8caa889779938">MUTT_FORMAT_OPTIONAL</a>)</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;    <a class="code" href="muttlib_8c.html#a8972094c1e995739c8b072c8be3ce453">mutt_expando_format</a>(buf, buflen, col, cols, else_str, <a class="code" href="send_8c.html#a43b8e36cf2d3908ed8484cceeab3de63">greeting_string</a>, data, flags);</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;  <span class="keywordflow">return</span> src;</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;}</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;</div><div class="line"><a name="l00706"></a><span class="lineno"><a class="line" href="send_8c.html#a08f60d273517436bc186ba194c086108">  706</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="send_8c.html#a08f60d273517436bc186ba194c086108">mutt_make_greeting</a>(<span class="keyword">struct</span> <a class="code" href="structMailbox.html">Mailbox</a> *m, <span class="keyword">struct</span> <a class="code" href="structEmail.html">Email</a> *e, FILE *fp_out,</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;                               <span class="keyword">struct</span> <a class="code" href="structConfigSubset.html">ConfigSubset</a> *sub)</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;{</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keyword">const</span> c_greeting = <a class="code" href="helpers_8c.html#ac477c591155aa4ae0452bbabc0affffe">cs_subset_string</a>(sub, <span class="stringliteral">&quot;greeting&quot;</span>);</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;  <span class="keywordflow">if</span> (!c_greeting || !fp_out)</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;  <span class="keywordtype">char</span> buf[1024];</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;  <span class="keyword">struct </span><a class="code" href="structGreetingInfo.html">GreetingInfo</a> gi = { m, e };</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;  <a class="code" href="muttlib_8c.html#a8972094c1e995739c8b072c8be3ce453">mutt_expando_format</a>(buf, <span class="keyword">sizeof</span>(buf), 0, 0, c_greeting, <a class="code" href="send_8c.html#a43b8e36cf2d3908ed8484cceeab3de63">greeting_string</a>,</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;                      (intptr_t) &amp;gi, <a class="code" href="mutt_8h.html#a9e6a54c16b89088342e5ed4054d35a83">MUTT_TOKEN_NO_FLAGS</a>);</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;  fputs(buf, fp_out);</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;  fputc(<span class="charliteral">&#39;\n&#39;</span>, fp_out);</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;}</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;</div><div class="line"><a name="l00729"></a><span class="lineno"><a class="line" href="send_8h.html#a089f8240c097d82940d94b4cf094fc81">  729</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="send_8c.html#a089f8240c097d82940d94b4cf094fc81">mutt_make_post_indent</a>(<span class="keyword">struct</span> <a class="code" href="structEmail.html">Email</a> *e, FILE *fp_out, <span class="keyword">struct</span> <a class="code" href="structConfigSubset.html">ConfigSubset</a> *sub)</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;{</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keyword">const</span> c_post_indent_string =</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;      <a class="code" href="helpers_8c.html#ac477c591155aa4ae0452bbabc0affffe">cs_subset_string</a>(sub, <span class="stringliteral">&quot;post_indent_string&quot;</span>);</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;  <span class="keywordflow">if</span> (!c_post_indent_string || !fp_out)</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;  <span class="keywordtype">char</span> buf[256];</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;  <a class="code" href="hdrline_8c.html#a5ff2b7d1b1e2dbd345801cdda1e3af14">mutt_make_string</a>(buf, <span class="keyword">sizeof</span>(buf), 0, c_post_indent_string, NULL, -1, e,</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;                   <a class="code" href="format__flags_8h.html#a5167e8b2777abe5e02be90e0d2a816de">MUTT_FORMAT_NO_FLAGS</a>, NULL);</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;  fputs(buf, fp_out);</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;  fputc(<span class="charliteral">&#39;\n&#39;</span>, fp_out);</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;}</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;</div><div class="line"><a name="l00752"></a><span class="lineno"><a class="line" href="send_8c.html#a133621f63fdff19b66d2b833f29a7c0f">  752</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="send_8c.html#a133621f63fdff19b66d2b833f29a7c0f">include_reply</a>(<span class="keyword">struct</span> <a class="code" href="structMailbox.html">Mailbox</a> *m, <span class="keyword">struct</span> <a class="code" href="structEmail.html">Email</a> *e, FILE *fp_out,</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;                         <span class="keyword">struct</span> <a class="code" href="structConfigSubset.html">ConfigSubset</a> *sub)</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;{</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;  <a class="code" href="copy_8h.html#adc738493d51f47c7dd372f3ebd53223a">CopyMessageFlags</a> cmflags =</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;      <a class="code" href="copy_8h.html#a23b8aa8125d370213675b3c0b1c5e6fe">MUTT_CM_PREFIX</a> | <a class="code" href="copy_8h.html#a4898a6c2c88fdba8ce7decdb6c125a96">MUTT_CM_DECODE</a> | <a class="code" href="copy_8h.html#a648ee091378fa6c0f6f129f64fc7f22b">MUTT_CM_CHARCONV</a> | <a class="code" href="copy_8h.html#a21e9ee6d7c3e70ffe4775aa9a90ac8c6">MUTT_CM_REPLYING</a>;</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;  <a class="code" href="copy_8h.html#a88a40e8f238a8478b885c90d1ce53e9c">CopyHeaderFlags</a> chflags = <a class="code" href="copy_8h.html#a05de77c5d16eb6266cfb34b7b322a807">CH_DECODE</a>;</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;  <span class="keywordflow">if</span> ((<a class="code" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> != 0) &amp;&amp; (e-&gt;<a class="code" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> &amp; <a class="code" href="ncrypt_2lib_8h.html#aacaa4abd4c0696e260b7a0f1d466360a">SEC_ENCRYPT</a>))</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;  {</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    <span class="comment">/* make sure we have the user&#39;s passphrase before proceeding... */</span></div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="crypt_8c.html#a4ee7f1419a7e39b0e9f1f9d550f4de43">crypt_valid_passphrase</a>(e-&gt;<a class="code" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a>))</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;  }</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;  <span class="keyword">struct </span><a class="code" href="structMessage.html">Message</a> *msg = <a class="code" href="mx_8c.html#a7df2f9d4d83ce9fca2cf48e08f8a4bc0">mx_msg_open</a>(m, e-&gt;<a class="code" href="structEmail.html#abd3d551204f4ea232a304c1c4c4c149d">msgno</a>);</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;  <span class="keywordflow">if</span> (!msg)</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;  {</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;  }</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;  <a class="code" href="attachments_8c.html#a9fb5dd768a13b9f083ca3a5e2e713db6">mutt_parse_mime_message</a>(m, e, msg-&gt;<a class="code" href="structMessage.html#a11d53ee4319e8735c1677d8780a7b517">fp</a>);</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;  <a class="code" href="hook_8c.html#af487ca5e3f7da21c86e3ad61fdb55faa">mutt_message_hook</a>(m, e, <a class="code" href="hook_8h.html#ac4fada4e7df870f12ec6387389bba8c4">MUTT_MESSAGE_HOOK</a>);</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;  <a class="code" href="send_8c.html#a8119a731eeae7c3e754315e585169c33">mutt_make_attribution</a>(e, fp_out, sub);</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> c_header = <a class="code" href="helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(sub, <span class="stringliteral">&quot;header&quot;</span>);</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;  <span class="keywordflow">if</span> (!c_header)</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;    cmflags |= <a class="code" href="copy_8h.html#ad0d836342af33c74966ba719fd33c475">MUTT_CM_NOHEADER</a>;</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> c_weed = <a class="code" href="helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(sub, <span class="stringliteral">&quot;weed&quot;</span>);</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;  <span class="keywordflow">if</span> (c_weed)</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;  {</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;    chflags |= <a class="code" href="copy_8h.html#a5e818fe5d60277b658d3f98ee7e0e675">CH_WEED</a> | <a class="code" href="copy_8h.html#a606b533a9896e294b1341e648f0b8ba2">CH_REORDER</a>;</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;    cmflags |= <a class="code" href="copy_8h.html#a2184765637d3fe603457f28a20eccb41">MUTT_CM_WEED</a>;</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;  }</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;  <a class="code" href="copy_8c.html#aa0dd608f4ed300454d97ac83ade160ac">mutt_copy_message</a>(fp_out, m, e, msg, cmflags, chflags, 0);</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;  <a class="code" href="mx_8c.html#a2172d90c08b5a2b293d22ed13ee0e7a8">mx_msg_close</a>(m, &amp;msg);</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;  <a class="code" href="send_8c.html#a089f8240c097d82940d94b4cf094fc81">mutt_make_post_indent</a>(e, fp_out, sub);</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;}</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;</div><div class="line"><a name="l00802"></a><span class="lineno"><a class="line" href="send_8c.html#a69f63db0bf88ead16cba146fc3ef26ae">  802</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">struct </span>AddressList *<a class="code" href="send_8c.html#a69f63db0bf88ead16cba146fc3ef26ae">choose_default_to</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structAddress.html">Address</a> *from,</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;                                                   <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structEnvelope.html">Envelope</a> *env,</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;                                                   <span class="keyword">struct</span> <a class="code" href="structConfigSubset.html">ConfigSubset</a> *sub)</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;{</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> c_reply_self = <a class="code" href="helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(sub, <span class="stringliteral">&quot;reply_self&quot;</span>);</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;  <span class="keywordflow">if</span> (!c_reply_self &amp;&amp; <a class="code" href="alias_8c.html#a9d6f6b4ea9d79c9c33ddd7c6b6ef764b">mutt_addr_is_user</a>(from))</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;  {</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;    <span class="comment">/* mail is from the user, assume replying to recipients */</span></div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;    <span class="keywordflow">return</span> &amp;env-&gt;<a class="code" href="structEnvelope.html#a2d927371b3b80e025d6f7522b7361fe7">to</a>;</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;  }</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;  {</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    <span class="keywordflow">return</span> &amp;env-&gt;<a class="code" href="structEnvelope.html#af1aa00aed4b8767cf98f08e45a432ad8">from</a>;</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;  }</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;}</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;</div><div class="line"><a name="l00828"></a><span class="lineno"><a class="line" href="send_8c.html#ab5edea027c9fa45beef0a68fb707789d">  828</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="send_8c.html#ab5edea027c9fa45beef0a68fb707789d">default_to</a>(<span class="keyword">struct</span> AddressList *to, <span class="keyword">struct</span> <a class="code" href="structEnvelope.html">Envelope</a> *env,</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;                      <a class="code" href="send_8h.html#af731a62ddd44f1d907196beef8f8f19f">SendFlags</a> flags, <span class="keywordtype">int</span> hmfupto, <span class="keyword">struct</span> <a class="code" href="structConfigSubset.html">ConfigSubset</a> *sub)</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;{</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;  <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structAddress.html">Address</a> *from = <a class="code" href="queue_8h.html#a7d6894360bd1c41e0e6f6d84998c1362">TAILQ_FIRST</a>(&amp;env-&gt;<a class="code" href="structEnvelope.html#af1aa00aed4b8767cf98f08e45a432ad8">from</a>);</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;  <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structAddress.html">Address</a> *reply_to = <a class="code" href="queue_8h.html#a7d6894360bd1c41e0e6f6d84998c1362">TAILQ_FIRST</a>(&amp;env-&gt;<a class="code" href="structEnvelope.html#a4b75ab1853f95878dec079371bb0d799">reply_to</a>);</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;  <span class="keywordflow">if</span> (flags &amp;&amp; !<a class="code" href="queue_8h.html#ac3c9da7ac712eacbbad5cc54d7a3477e">TAILQ_EMPTY</a>(&amp;env-&gt;<a class="code" href="structEnvelope.html#a6044b60220b8029a6a505e5b61f1cadc">mail_followup_to</a>) &amp;&amp; (hmfupto == <a class="code" href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35dbafee7088606c4724651c799a6a0b182b7">MUTT_YES</a>))</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;  {</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;    <a class="code" href="address_2address_8c.html#a16764dc80c9b3f6ad2897c8b7e59bd10">mutt_addrlist_copy</a>(to, &amp;env-&gt;<a class="code" href="structEnvelope.html#a6044b60220b8029a6a505e5b61f1cadc">mail_followup_to</a>, <span class="keyword">true</span>);</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;  }</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;  <span class="comment">/* Exit now if we&#39;re setting up the default Cc list for list-reply</span></div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;<span class="comment">   * (only set if Mail-Followup-To is present and honoured).  */</span></div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;  <span class="keywordflow">if</span> (flags &amp; <a class="code" href="send_8h.html#a54e225c19799cf682ef8228825dbb3d8">SEND_LIST_REPLY</a>)</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;  <span class="keyword">const</span> <span class="keyword">struct </span>AddressList *<a class="code" href="send_8c.html#ab5edea027c9fa45beef0a68fb707789d">default_to</a> = <a class="code" href="send_8c.html#a69f63db0bf88ead16cba146fc3ef26ae">choose_default_to</a>(from, env, sub);</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;  <span class="keywordflow">if</span> (reply_to)</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;  {</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> from_is_reply_to = <a class="code" href="address_2address_8c.html#a60b3ced56e9f5be39c391250d951bf72">mutt_addr_cmp</a>(from, reply_to);</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> multiple_reply_to =</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;        reply_to &amp;&amp; <a class="code" href="queue_8h.html#abd57fe9bdea6007a602f8c7d61bd5265">TAILQ_NEXT</a>(<a class="code" href="queue_8h.html#a7d6894360bd1c41e0e6f6d84998c1362">TAILQ_FIRST</a>(&amp;env-&gt;<a class="code" href="structEnvelope.html#a4b75ab1853f95878dec079371bb0d799">reply_to</a>), entries);</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> c_ignore_list_reply_to =</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;        <a class="code" href="helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(sub, <span class="stringliteral">&quot;ignore_list_reply_to&quot;</span>);</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;    <span class="keyword">const</span> <span class="keyword">enum</span> <a class="code" href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35db">QuadOption</a> c_reply_to = <a class="code" href="helpers_8c.html#a9154ba713ce99b0937f475eec7c61af9">cs_subset_quad</a>(sub, <span class="stringliteral">&quot;reply_to&quot;</span>);</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;    <span class="keywordflow">if</span> ((from_is_reply_to &amp;&amp; !multiple_reply_to &amp;&amp; !reply_to-&gt;<a class="code" href="structAddress.html#af4ac89f0f41e7872b4faeaedfcb709b4">personal</a>) ||</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;        (c_ignore_list_reply_to &amp;&amp; <a class="code" href="maillist_8c.html#a546aac24675f5681df8fe2ccd17aece8">mutt_is_mail_list</a>(reply_to) &amp;&amp;</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;         (<a class="code" href="address_2address_8c.html#ad602a3cf6ff5c7fb79d21627553a586d">mutt_addrlist_search</a>(&amp;env-&gt;<a class="code" href="structEnvelope.html#a2d927371b3b80e025d6f7522b7361fe7">to</a>, reply_to) || <a class="code" href="address_2address_8c.html#ad602a3cf6ff5c7fb79d21627553a586d">mutt_addrlist_search</a>(&amp;env-&gt;<a class="code" href="structEnvelope.html#a6b00837b3cb4b41898b42307135be8b6">cc</a>, reply_to))))</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;    {</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;      <span class="comment">/* If the Reply-To: address is a mailing list, assume that it was</span></div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;<span class="comment">       * put there by the mailing list, and use the From: address</span></div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;<span class="comment">       *</span></div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;<span class="comment">       * We also take the from header if our correspondent has a reply-to</span></div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;<span class="comment">       * header which is identical to the electronic mail address given</span></div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;<span class="comment">       * in his From header, and the reply-to has no display-name.  */</span></div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;      <a class="code" href="address_2address_8c.html#a16764dc80c9b3f6ad2897c8b7e59bd10">mutt_addrlist_copy</a>(to, &amp;env-&gt;<a class="code" href="structEnvelope.html#af1aa00aed4b8767cf98f08e45a432ad8">from</a>, <span class="keyword">false</span>);</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    }</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!(from_is_reply_to &amp;&amp; !multiple_reply_to) &amp;&amp; (c_reply_to != <a class="code" href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35dbafee7088606c4724651c799a6a0b182b7">MUTT_YES</a>))</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;    {</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;      <span class="keywordtype">char</span> prompt[256];</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;      <span class="comment">/* There are quite a few mailing lists which set the Reply-To:</span></div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;<span class="comment">       * header field to the list address, which makes it quite impossible</span></div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;<span class="comment">       * to send a message to only the sender of the message.  This</span></div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;<span class="comment">       * provides a way to do that.  */</span></div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;      <span class="comment">/* L10N: Asks whether the user respects the reply-to header.</span></div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;<span class="comment">         If she says no, neomutt will reply to the from header&#39;s address instead. */</span></div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;      snprintf(prompt, <span class="keyword">sizeof</span>(prompt), <a class="code" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Reply to %s%s?&quot;</span>), reply_to-&gt;<a class="code" href="structAddress.html#a8ea3ae93a2550c76c392a9001dbbaefd">mailbox</a>,</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;               multiple_reply_to ? <span class="stringliteral">&quot;,...&quot;</span> : <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;      <span class="keywordflow">switch</span> (<a class="code" href="question_2lib_8h.html#ab02047769214ff014b9a8a1782babadc">query_quadoption</a>(c_reply_to, prompt))</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;      {</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35dbafee7088606c4724651c799a6a0b182b7">MUTT_YES</a>:</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;          <a class="code" href="address_2address_8c.html#a16764dc80c9b3f6ad2897c8b7e59bd10">mutt_addrlist_copy</a>(to, &amp;env-&gt;<a class="code" href="structEnvelope.html#a4b75ab1853f95878dec079371bb0d799">reply_to</a>, <span class="keyword">false</span>);</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;          <span class="keywordflow">break</span>;</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35dbabe3800cc419f25384aaf1892fc3c812b">MUTT_NO</a>:</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;          <a class="code" href="address_2address_8c.html#a16764dc80c9b3f6ad2897c8b7e59bd10">mutt_addrlist_copy</a>(to, default_to, <span class="keyword">false</span>);</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;          <span class="keywordflow">break</span>;</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;        <span class="keywordflow">default</span>:</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;          <span class="keywordflow">return</span> -1; <span class="comment">/* abort */</span></div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;      }</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;    }</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;    {</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;      <a class="code" href="address_2address_8c.html#a16764dc80c9b3f6ad2897c8b7e59bd10">mutt_addrlist_copy</a>(to, &amp;env-&gt;<a class="code" href="structEnvelope.html#a4b75ab1853f95878dec079371bb0d799">reply_to</a>, <span class="keyword">false</span>);</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;    }</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;  }</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;  {</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;    <a class="code" href="address_2address_8c.html#a16764dc80c9b3f6ad2897c8b7e59bd10">mutt_addrlist_copy</a>(to, default_to, <span class="keyword">false</span>);</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;  }</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;}</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;</div><div class="line"><a name="l00915"></a><span class="lineno"><a class="line" href="send_8h.html#a78de7631e05a4bde3c61e5f5d2c34921">  915</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="send_8c.html#a78de7631e05a4bde3c61e5f5d2c34921">mutt_fetch_recips</a>(<span class="keyword">struct</span> <a class="code" href="structEnvelope.html">Envelope</a> *out, <span class="keyword">struct</span> <a class="code" href="structEnvelope.html">Envelope</a> *in,</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;                      <a class="code" href="send_8h.html#af731a62ddd44f1d907196beef8f8f19f">SendFlags</a> flags, <span class="keyword">struct</span> <a class="code" href="structConfigSubset.html">ConfigSubset</a> *sub)</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;{</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;  <span class="keyword">enum</span> <a class="code" href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35db">QuadOption</a> hmfupto = <a class="code" href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35dbaaa75b5db14c0aed1fde665034f113339">MUTT_ABORT</a>;</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;  <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structAddress.html">Address</a> *followup_to = <a class="code" href="queue_8h.html#a7d6894360bd1c41e0e6f6d84998c1362">TAILQ_FIRST</a>(&amp;in-&gt;<a class="code" href="structEnvelope.html#a6044b60220b8029a6a505e5b61f1cadc">mail_followup_to</a>);</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;  <span class="keywordflow">if</span> ((flags &amp; (<a class="code" href="send_8h.html#a54e225c19799cf682ef8228825dbb3d8">SEND_LIST_REPLY</a> | <a class="code" href="send_8h.html#a47e90c63dbdc4426d0630139c04cc8f3">SEND_GROUP_REPLY</a> | <a class="code" href="send_8h.html#a0e11db957196a8cc43bbe955178f3686">SEND_GROUP_CHAT_REPLY</a>)) &amp;&amp; followup_to)</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;  {</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;    <span class="keywordtype">char</span> prompt[256];</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;    snprintf(prompt, <span class="keyword">sizeof</span>(prompt), <a class="code" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Follow-up to %s%s?&quot;</span>), followup_to-&gt;<a class="code" href="structAddress.html#a8ea3ae93a2550c76c392a9001dbbaefd">mailbox</a>,</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;             <a class="code" href="queue_8h.html#abd57fe9bdea6007a602f8c7d61bd5265">TAILQ_NEXT</a>(<a class="code" href="queue_8h.html#a7d6894360bd1c41e0e6f6d84998c1362">TAILQ_FIRST</a>(&amp;in-&gt;<a class="code" href="structEnvelope.html#a6044b60220b8029a6a505e5b61f1cadc">mail_followup_to</a>), entries) ? <span class="stringliteral">&quot;,...&quot;</span> : <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;    <span class="keyword">const</span> <span class="keyword">enum</span> <a class="code" href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35db">QuadOption</a> c_honor_followup_to =</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;        <a class="code" href="helpers_8c.html#a9154ba713ce99b0937f475eec7c61af9">cs_subset_quad</a>(sub, <span class="stringliteral">&quot;honor_followup_to&quot;</span>);</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;    hmfupto = <a class="code" href="question_2lib_8h.html#ab02047769214ff014b9a8a1782babadc">query_quadoption</a>(c_honor_followup_to, prompt);</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;    <span class="keywordflow">if</span> (hmfupto == <a class="code" href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35dbaaa75b5db14c0aed1fde665034f113339">MUTT_ABORT</a>)</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;  }</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;  <span class="keywordflow">if</span> (flags &amp; <a class="code" href="send_8h.html#a54e225c19799cf682ef8228825dbb3d8">SEND_LIST_REPLY</a>)</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;  {</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;    <a class="code" href="send_8c.html#a7513f0a7dea1ccf4de7506399771a4c2">add_mailing_lists</a>(&amp;out-&gt;<a class="code" href="structEnvelope.html#a2d927371b3b80e025d6f7522b7361fe7">to</a>, &amp;in-&gt;<a class="code" href="structEnvelope.html#a2d927371b3b80e025d6f7522b7361fe7">to</a>, &amp;in-&gt;<a class="code" href="structEnvelope.html#a6b00837b3cb4b41898b42307135be8b6">cc</a>);</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;    <span class="keywordflow">if</span> (followup_to &amp;&amp; (hmfupto == <a class="code" href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35dbafee7088606c4724651c799a6a0b182b7">MUTT_YES</a>) &amp;&amp;</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;        (<a class="code" href="send_8c.html#ab5edea027c9fa45beef0a68fb707789d">default_to</a>(&amp;out-&gt;<a class="code" href="structEnvelope.html#a6b00837b3cb4b41898b42307135be8b6">cc</a>, in, flags &amp; SEND_LIST_REPLY, (hmfupto == <a class="code" href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35dbafee7088606c4724651c799a6a0b182b7">MUTT_YES</a>), sub) == <a class="code" href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35dbaaa75b5db14c0aed1fde665034f113339">MUTT_ABORT</a>))</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;    {</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;      <span class="keywordflow">return</span> -1; <span class="comment">/* abort */</span></div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;    }</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;  }</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (flags &amp; <a class="code" href="send_8h.html#aa0a201a6d90a4760c1e0ece8be43c1cb">SEND_TO_SENDER</a>)</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;  {</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;    <a class="code" href="address_2address_8c.html#a16764dc80c9b3f6ad2897c8b7e59bd10">mutt_addrlist_copy</a>(&amp;out-&gt;<a class="code" href="structEnvelope.html#a2d927371b3b80e025d6f7522b7361fe7">to</a>, &amp;in-&gt;<a class="code" href="structEnvelope.html#af1aa00aed4b8767cf98f08e45a432ad8">from</a>, <span class="keyword">false</span>);</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;  }</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;  {</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="send_8c.html#ab5edea027c9fa45beef0a68fb707789d">default_to</a>(&amp;out-&gt;<a class="code" href="structEnvelope.html#a2d927371b3b80e025d6f7522b7361fe7">to</a>, in, flags &amp; (<a class="code" href="send_8h.html#a47e90c63dbdc4426d0630139c04cc8f3">SEND_GROUP_REPLY</a> | <a class="code" href="send_8h.html#a0e11db957196a8cc43bbe955178f3686">SEND_GROUP_CHAT_REPLY</a>),</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;                   (hmfupto == <a class="code" href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35dbafee7088606c4724651c799a6a0b182b7">MUTT_YES</a>), sub) == -1)</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;    {</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;      <span class="keywordflow">return</span> -1; <span class="comment">/* abort */</span></div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;    }</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;    <span class="keywordflow">if</span> ((flags &amp; (<a class="code" href="send_8h.html#a47e90c63dbdc4426d0630139c04cc8f3">SEND_GROUP_REPLY</a> | <a class="code" href="send_8h.html#a0e11db957196a8cc43bbe955178f3686">SEND_GROUP_CHAT_REPLY</a>)) &amp;&amp;</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;        (!followup_to || (hmfupto != <a class="code" href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35dbafee7088606c4724651c799a6a0b182b7">MUTT_YES</a>)))</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;    {</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;      <span class="comment">/* if(!mutt_addr_is_user(in-&gt;to)) */</span></div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;      <span class="keywordflow">if</span> (flags &amp; <a class="code" href="send_8h.html#a47e90c63dbdc4426d0630139c04cc8f3">SEND_GROUP_REPLY</a>)</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;        <a class="code" href="address_2address_8c.html#a16764dc80c9b3f6ad2897c8b7e59bd10">mutt_addrlist_copy</a>(&amp;out-&gt;<a class="code" href="structEnvelope.html#a6b00837b3cb4b41898b42307135be8b6">cc</a>, &amp;in-&gt;<a class="code" href="structEnvelope.html#a2d927371b3b80e025d6f7522b7361fe7">to</a>, <span class="keyword">true</span>);</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;        <a class="code" href="address_2address_8c.html#a16764dc80c9b3f6ad2897c8b7e59bd10">mutt_addrlist_copy</a>(&amp;out-&gt;<a class="code" href="structEnvelope.html#a2d927371b3b80e025d6f7522b7361fe7">to</a>, &amp;in-&gt;<a class="code" href="structEnvelope.html#a2d927371b3b80e025d6f7522b7361fe7">to</a>, <span class="keyword">true</span>);</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;      <a class="code" href="address_2address_8c.html#a16764dc80c9b3f6ad2897c8b7e59bd10">mutt_addrlist_copy</a>(&amp;out-&gt;<a class="code" href="structEnvelope.html#a6b00837b3cb4b41898b42307135be8b6">cc</a>, &amp;in-&gt;<a class="code" href="structEnvelope.html#a6b00837b3cb4b41898b42307135be8b6">cc</a>, <span class="keyword">true</span>);</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;    }</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;  }</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;}</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;</div><div class="line"><a name="l00975"></a><span class="lineno"><a class="line" href="send_8c.html#af14544f55d0b62fcba84643fadec4890">  975</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="send_8c.html#af14544f55d0b62fcba84643fadec4890">add_references</a>(<span class="keyword">struct</span> ListHead *head, <span class="keyword">struct</span> <a class="code" href="structEnvelope.html">Envelope</a> *env)</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;{</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;  <span class="keyword">struct </span><a class="code" href="structListNode.html">ListNode</a> *np = NULL;</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;  <span class="keyword">struct </span>ListHead *src = <a class="code" href="queue_8h.html#a8427c8f43d09d73062cf6b37f303aff5">STAILQ_EMPTY</a>(&amp;env-&gt;<a class="code" href="structEnvelope.html#a832eec73356a806761e26f0bc40d9083">references</a>) ? &amp;env-&gt;<a class="code" href="structEnvelope.html#a9ae6d450b2f012c37d3350f4305fbb90">in_reply_to</a> : &amp;env-&gt;<a class="code" href="structEnvelope.html#a832eec73356a806761e26f0bc40d9083">references</a>;</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;  <a class="code" href="queue_8h.html#a77999ebdf5aaf7af8b8ea22bf208c432">STAILQ_FOREACH</a>(np, src, entries)</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;  {</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;    <a class="code" href="list_8c.html#ace47a64c8bec9d1b24be6524f650293d">mutt_list_insert_tail</a>(head, <a class="code" href="mutt_2string_8c.html#a4c2560f787bd1226b977992c16860c98">mutt_str_dup</a>(np-&gt;<a class="code" href="structListNode.html#aafe688d670318196766392d8235d00a7">data</a>));</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;  }</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;}</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;</div><div class="line"><a name="l00991"></a><span class="lineno"><a class="line" href="send_8c.html#a6c0f91c0d2e3bb30c0dc096c2d5d5361">  991</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="send_8c.html#a6c0f91c0d2e3bb30c0dc096c2d5d5361">add_message_id</a>(<span class="keyword">struct</span> ListHead *head, <span class="keyword">struct</span> <a class="code" href="structEnvelope.html">Envelope</a> *env)</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;{</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;  <span class="keywordflow">if</span> (env-&gt;<a class="code" href="structEnvelope.html#a50418c13a849bf27b22922bd5867e5e1">message_id</a>)</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;  {</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;    <a class="code" href="list_8c.html#a53adfccd4c8b3409a1fa09aa5daf405b">mutt_list_insert_head</a>(head, <a class="code" href="mutt_2string_8c.html#a4c2560f787bd1226b977992c16860c98">mutt_str_dup</a>(env-&gt;<a class="code" href="structEnvelope.html#a50418c13a849bf27b22922bd5867e5e1">message_id</a>));</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;  }</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;}</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;</div><div class="line"><a name="l01004"></a><span class="lineno"><a class="line" href="send_8h.html#a527f182325365ed083dad7be735bab25"> 1004</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="send_8c.html#a527f182325365ed083dad7be735bab25">mutt_fix_reply_recipients</a>(<span class="keyword">struct</span> <a class="code" href="structEnvelope.html">Envelope</a> *env, <span class="keyword">struct</span> <a class="code" href="structConfigSubset.html">ConfigSubset</a> *sub)</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;{</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> c_me_too = <a class="code" href="helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(sub, <span class="stringliteral">&quot;me_too&quot;</span>);</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;  <span class="keywordflow">if</span> (!c_me_too)</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;  {</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> c_reply_self = <a class="code" href="helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(sub, <span class="stringliteral">&quot;reply_self&quot;</span>);</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;    <span class="comment">/* the order is important here.  do the CC: first so that if the</span></div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;<span class="comment">     * the user is the only recipient, it ends up on the TO: field */</span></div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;    <a class="code" href="send_8c.html#a6671477ec99e59665fcbac17986d6e93">remove_user</a>(&amp;env-&gt;<a class="code" href="structEnvelope.html#a6b00837b3cb4b41898b42307135be8b6">cc</a>, <a class="code" href="queue_8h.html#ac3c9da7ac712eacbbad5cc54d7a3477e">TAILQ_EMPTY</a>(&amp;env-&gt;<a class="code" href="structEnvelope.html#a2d927371b3b80e025d6f7522b7361fe7">to</a>));</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;    <a class="code" href="send_8c.html#a6671477ec99e59665fcbac17986d6e93">remove_user</a>(&amp;env-&gt;<a class="code" href="structEnvelope.html#a2d927371b3b80e025d6f7522b7361fe7">to</a>, <a class="code" href="queue_8h.html#ac3c9da7ac712eacbbad5cc54d7a3477e">TAILQ_EMPTY</a>(&amp;env-&gt;<a class="code" href="structEnvelope.html#a6b00837b3cb4b41898b42307135be8b6">cc</a>) || c_reply_self);</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;  }</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;  <span class="comment">/* the CC field can get cluttered, especially with lists */</span></div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;  <a class="code" href="address_2address_8c.html#aee5d40d84136d3a7adba727e2908ad66">mutt_addrlist_dedupe</a>(&amp;env-&gt;<a class="code" href="structEnvelope.html#a2d927371b3b80e025d6f7522b7361fe7">to</a>);</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;  <a class="code" href="address_2address_8c.html#aee5d40d84136d3a7adba727e2908ad66">mutt_addrlist_dedupe</a>(&amp;env-&gt;<a class="code" href="structEnvelope.html#a6b00837b3cb4b41898b42307135be8b6">cc</a>);</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;  <a class="code" href="address_2address_8c.html#a968e9f56e7408d5e0fa1d1135bdee017">mutt_addrlist_remove_xrefs</a>(&amp;env-&gt;<a class="code" href="structEnvelope.html#a2d927371b3b80e025d6f7522b7361fe7">to</a>, &amp;env-&gt;<a class="code" href="structEnvelope.html#a6b00837b3cb4b41898b42307135be8b6">cc</a>);</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="queue_8h.html#ac3c9da7ac712eacbbad5cc54d7a3477e">TAILQ_EMPTY</a>(&amp;env-&gt;<a class="code" href="structEnvelope.html#a6b00837b3cb4b41898b42307135be8b6">cc</a>) &amp;&amp; <a class="code" href="queue_8h.html#ac3c9da7ac712eacbbad5cc54d7a3477e">TAILQ_EMPTY</a>(&amp;env-&gt;<a class="code" href="structEnvelope.html#a2d927371b3b80e025d6f7522b7361fe7">to</a>))</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;  {</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;    <a class="code" href="queue_8h.html#aa4cf483c7dcddd1d89a00886b5466bac">TAILQ_SWAP</a>(&amp;env-&gt;<a class="code" href="structEnvelope.html#a2d927371b3b80e025d6f7522b7361fe7">to</a>, &amp;env-&gt;<a class="code" href="structEnvelope.html#a6b00837b3cb4b41898b42307135be8b6">cc</a>, <a class="code" href="structAddress.html">Address</a>, entries);</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;  }</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;}</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;</div><div class="line"><a name="l01034"></a><span class="lineno"><a class="line" href="send_8h.html#a441dbd4f179147fa14692a98acbd8f26"> 1034</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="send_8c.html#a441dbd4f179147fa14692a98acbd8f26">mutt_make_forward_subject</a>(<span class="keyword">struct</span> <a class="code" href="structEnvelope.html">Envelope</a> *env, <span class="keyword">struct</span> <a class="code" href="structEmail.html">Email</a> *e, <span class="keyword">struct</span> <a class="code" href="structConfigSubset.html">ConfigSubset</a> *sub)</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;{</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;  <span class="keywordflow">if</span> (!env)</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keyword">const</span> c_forward_format = <a class="code" href="helpers_8c.html#ac477c591155aa4ae0452bbabc0affffe">cs_subset_string</a>(sub, <span class="stringliteral">&quot;forward_format&quot;</span>);</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;  <span class="keywordtype">char</span> buf[256];</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;  <span class="comment">/* set the default subject for the message. */</span></div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;  <a class="code" href="hdrline_8c.html#a5ff2b7d1b1e2dbd345801cdda1e3af14">mutt_make_string</a>(buf, <span class="keyword">sizeof</span>(buf), 0, <a class="code" href="string2_8h.html#a7e0481bed27661ea2679f256b24e0283">NONULL</a>(c_forward_format), NULL, -1, e,</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;                   <a class="code" href="format__flags_8h.html#a5167e8b2777abe5e02be90e0d2a816de">MUTT_FORMAT_NO_FLAGS</a>, NULL);</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;  <a class="code" href="mutt_2string_8c.html#ae9b6bbaa52b6ce51f2a384fe500e028e">mutt_str_replace</a>(&amp;env-&gt;<a class="code" href="structEnvelope.html#aa3d22c82ed26a0727508d26363e98ea7">subject</a>, buf);</div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;}</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;</div><div class="line"><a name="l01054"></a><span class="lineno"><a class="line" href="send_8h.html#a247e6a821f797b77785f3a724baa44c3"> 1054</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="send_8c.html#a247e6a821f797b77785f3a724baa44c3">mutt_make_misc_reply_headers</a>(<span class="keyword">struct</span> <a class="code" href="structEnvelope.html">Envelope</a> *env, <span class="keyword">struct</span> <a class="code" href="structEnvelope.html">Envelope</a> *curenv,</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;                                  <span class="keyword">struct</span> <a class="code" href="structConfigSubset.html">ConfigSubset</a> *sub)</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;{</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;  <span class="keywordflow">if</span> (!env || !curenv)</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;  <span class="comment">/* This takes precedence over a subject that might have</span></div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;<span class="comment">   * been taken from a List-Post header.  Is that correct?  */</span></div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;  <span class="keywordflow">if</span> (curenv-&gt;<a class="code" href="structEnvelope.html#adea069c71a9e00c79e1233f0fb51f824">real_subj</a>)</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;  {</div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;    <a class="code" href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;env-&gt;<a class="code" href="structEnvelope.html#aa3d22c82ed26a0727508d26363e98ea7">subject</a>);</div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;    env-&gt;<a class="code" href="structEnvelope.html#aa3d22c82ed26a0727508d26363e98ea7">subject</a> = <a class="code" href="memory_8c.html#a264da4dc58e6dc8983285bd1f538f24d">mutt_mem_malloc</a>(<a class="code" href="mutt_2string_8c.html#acca6786b903b22a5924219f9db96e10d">mutt_str_len</a>(curenv-&gt;<a class="code" href="structEnvelope.html#adea069c71a9e00c79e1233f0fb51f824">real_subj</a>) + 5);</div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;    sprintf(env-&gt;<a class="code" href="structEnvelope.html#aa3d22c82ed26a0727508d26363e98ea7">subject</a>, <span class="stringliteral">&quot;Re: %s&quot;</span>, curenv-&gt;<a class="code" href="structEnvelope.html#adea069c71a9e00c79e1233f0fb51f824">real_subj</a>);</div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;  }</div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!env-&gt;<a class="code" href="structEnvelope.html#aa3d22c82ed26a0727508d26363e98ea7">subject</a>)</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;  {</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keyword">const</span> c_empty_subject = <a class="code" href="helpers_8c.html#ac477c591155aa4ae0452bbabc0affffe">cs_subset_string</a>(sub, <span class="stringliteral">&quot;empty_subject&quot;</span>);</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;    env-&gt;<a class="code" href="structEnvelope.html#aa3d22c82ed26a0727508d26363e98ea7">subject</a> = <a class="code" href="mutt_2string_8c.html#a4c2560f787bd1226b977992c16860c98">mutt_str_dup</a>(c_empty_subject);</div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;  }</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;}</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;</div><div class="line"><a name="l01081"></a><span class="lineno"><a class="line" href="send_8h.html#a4ac367179189d865ae41a5366bc6bec7"> 1081</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="send_8c.html#a4ac367179189d865ae41a5366bc6bec7">mutt_add_to_reference_headers</a>(<span class="keyword">struct</span> <a class="code" href="structEnvelope.html">Envelope</a> *env, <span class="keyword">struct</span> <a class="code" href="structEnvelope.html">Envelope</a> *curenv,</div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;                                   <span class="keyword">struct</span> <a class="code" href="structConfigSubset.html">ConfigSubset</a> *sub)</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;{</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;  <a class="code" href="send_8c.html#af14544f55d0b62fcba84643fadec4890">add_references</a>(&amp;env-&gt;<a class="code" href="structEnvelope.html#a832eec73356a806761e26f0bc40d9083">references</a>, curenv);</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;  <a class="code" href="send_8c.html#a6c0f91c0d2e3bb30c0dc096c2d5d5361">add_message_id</a>(&amp;env-&gt;<a class="code" href="structEnvelope.html#a832eec73356a806761e26f0bc40d9083">references</a>, curenv);</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;  <a class="code" href="send_8c.html#a6c0f91c0d2e3bb30c0dc096c2d5d5361">add_message_id</a>(&amp;env-&gt;<a class="code" href="structEnvelope.html#a9ae6d450b2f012c37d3350f4305fbb90">in_reply_to</a>, curenv);</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;<span class="preprocessor">#ifdef USE_NNTP</span></div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> c_x_comment_to = <a class="code" href="helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(sub, <span class="stringliteral">&quot;x_comment_to&quot;</span>);</div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="options_8h.html#affdfc25e31602911d236c7d283865f1c">OptNewsSend</a> &amp;&amp; c_x_comment_to &amp;&amp; !<a class="code" href="queue_8h.html#ac3c9da7ac712eacbbad5cc54d7a3477e">TAILQ_EMPTY</a>(&amp;curenv-&gt;<a class="code" href="structEnvelope.html#af1aa00aed4b8767cf98f08e45a432ad8">from</a>))</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;    env-&gt;<a class="code" href="structEnvelope.html#a52153c6e4fdb551233e26d4fdb48fb78">x_comment_to</a> = <a class="code" href="mutt_2string_8c.html#a4c2560f787bd1226b977992c16860c98">mutt_str_dup</a>(<a class="code" href="sort_8c.html#a9a230efa9217e987ca1d1adb14b7e235">mutt_get_name</a>(<a class="code" href="queue_8h.html#a7d6894360bd1c41e0e6f6d84998c1362">TAILQ_FIRST</a>(&amp;curenv-&gt;<a class="code" href="structEnvelope.html#af1aa00aed4b8767cf98f08e45a432ad8">from</a>)));</div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;}</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;</div><div class="line"><a name="l01101"></a><span class="lineno"><a class="line" href="send_8c.html#ac4e76f02be95b09bccb7806659fa0ea6"> 1101</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="send_8c.html#ac4e76f02be95b09bccb7806659fa0ea6">make_reference_headers</a>(<span class="keyword">struct</span> EmailList *el, <span class="keyword">struct</span> <a class="code" href="structEnvelope.html">Envelope</a> *env,</div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;                                   <span class="keyword">struct</span> <a class="code" href="structConfigSubset.html">ConfigSubset</a> *sub)</div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;{</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;  <span class="keywordflow">if</span> (!el || !env || <a class="code" href="queue_8h.html#a8427c8f43d09d73062cf6b37f303aff5">STAILQ_EMPTY</a>(el))</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;  <span class="keyword">struct </span><a class="code" href="structEmailNode.html">EmailNode</a> *en = <a class="code" href="queue_8h.html#a3e2eb7535019a2829399b24744dd1a66">STAILQ_FIRST</a>(el);</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;  <span class="keywordtype">bool</span> single = !<a class="code" href="queue_8h.html#ad89ac472696d006112dface9c2d75e47">STAILQ_NEXT</a>(en, entries);</div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;  <span class="keywordflow">if</span> (!single)</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;  {</div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;    <a class="code" href="queue_8h.html#a77999ebdf5aaf7af8b8ea22bf208c432">STAILQ_FOREACH</a>(en, el, entries)</div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;    {</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;      <a class="code" href="send_8c.html#a4ac367179189d865ae41a5366bc6bec7">mutt_add_to_reference_headers</a>(env, en-&gt;<a class="code" href="structEmailNode.html#a812e5a33b27b12a78daacbe246089abb">email</a>-&gt;<a class="code" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>, sub);</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;    }</div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;  }</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;    <a class="code" href="send_8c.html#a4ac367179189d865ae41a5366bc6bec7">mutt_add_to_reference_headers</a>(env, en-&gt;<a class="code" href="structEmailNode.html#a812e5a33b27b12a78daacbe246089abb">email</a>-&gt;<a class="code" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>, sub);</div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;  <span class="comment">/* if there&#39;s more than entry in In-Reply-To (i.e. message has multiple</span></div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;<span class="comment">   * parents), don&#39;t generate a References: header as it&#39;s discouraged by</span></div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;<span class="comment">   * RFC2822, sect. 3.6.4 */</span></div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;  <span class="keywordflow">if</span> (!single &amp;&amp; !<a class="code" href="queue_8h.html#a8427c8f43d09d73062cf6b37f303aff5">STAILQ_EMPTY</a>(&amp;env-&gt;<a class="code" href="structEnvelope.html#a9ae6d450b2f012c37d3350f4305fbb90">in_reply_to</a>) &amp;&amp;</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;      <a class="code" href="queue_8h.html#ad89ac472696d006112dface9c2d75e47">STAILQ_NEXT</a>(<a class="code" href="queue_8h.html#a3e2eb7535019a2829399b24744dd1a66">STAILQ_FIRST</a>(&amp;env-&gt;<a class="code" href="structEnvelope.html#a9ae6d450b2f012c37d3350f4305fbb90">in_reply_to</a>), entries))</div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;  {</div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;    <a class="code" href="list_8c.html#ab5c53ce94cc2aafa4299dbc81a37f4a4">mutt_list_free</a>(&amp;env-&gt;<a class="code" href="structEnvelope.html#a832eec73356a806761e26f0bc40d9083">references</a>);</div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;  }</div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;}</div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;</div><div class="line"><a name="l01140"></a><span class="lineno"><a class="line" href="send_8c.html#a8491c02ca19dcad55ccdd2edb3bbcf24"> 1140</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="send_8c.html#a8491c02ca19dcad55ccdd2edb3bbcf24">envelope_defaults</a>(<span class="keyword">struct</span> <a class="code" href="structEnvelope.html">Envelope</a> *env, <span class="keyword">struct</span> <a class="code" href="structMailbox.html">Mailbox</a> *m, <span class="keyword">struct</span> EmailList *el,</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;                             <a class="code" href="send_8h.html#af731a62ddd44f1d907196beef8f8f19f">SendFlags</a> flags, <span class="keyword">struct</span> <a class="code" href="structConfigSubset.html">ConfigSubset</a> *sub)</div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;{</div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;  <span class="keywordflow">if</span> (!el || <a class="code" href="queue_8h.html#a8427c8f43d09d73062cf6b37f303aff5">STAILQ_EMPTY</a>(el))</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;</div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;  <span class="keyword">struct </span><a class="code" href="structEmailNode.html">EmailNode</a> *en = <a class="code" href="queue_8h.html#a3e2eb7535019a2829399b24744dd1a66">STAILQ_FIRST</a>(el);</div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;  <span class="keywordtype">bool</span> single = !<a class="code" href="queue_8h.html#ad89ac472696d006112dface9c2d75e47">STAILQ_NEXT</a>(en, entries);</div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;  <span class="keyword">struct </span><a class="code" href="structEnvelope.html">Envelope</a> *curenv = en-&gt;<a class="code" href="structEmailNode.html#a812e5a33b27b12a78daacbe246089abb">email</a>-&gt;<a class="code" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>;</div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;  <span class="keywordflow">if</span> (!curenv)</div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;</div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;  <span class="keywordflow">if</span> (flags &amp; (<a class="code" href="send_8h.html#ac23e1891bcbc52cc25b5824acfb42d3c">SEND_REPLY</a> | <a class="code" href="send_8h.html#aa0a201a6d90a4760c1e0ece8be43c1cb">SEND_TO_SENDER</a>))</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;  {</div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;<span class="preprocessor">#ifdef USE_NNTP</span></div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;    <span class="keywordflow">if</span> ((flags &amp; <a class="code" href="send_8h.html#ae31498a0e61355a0b4ece8f0c89daf49">SEND_NEWS</a>))</div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;    {</div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;      <span class="comment">/* in case followup set Newsgroups: with Followup-To: if it present */</span></div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;      <span class="keywordflow">if</span> (!env-&gt;<a class="code" href="structEnvelope.html#a5f680f60f1713477a879877dcbd21a5c">newsgroups</a> &amp;&amp; !<a class="code" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(curenv-&gt;<a class="code" href="structEnvelope.html#a46a9e33786aa5394ad768cbcc2357d65">followup_to</a>, <span class="stringliteral">&quot;poster&quot;</span>))</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;      {</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;        env-&gt;<a class="code" href="structEnvelope.html#a5f680f60f1713477a879877dcbd21a5c">newsgroups</a> = <a class="code" href="mutt_2string_8c.html#a4c2560f787bd1226b977992c16860c98">mutt_str_dup</a>(curenv-&gt;<a class="code" href="structEnvelope.html#a46a9e33786aa5394ad768cbcc2357d65">followup_to</a>);</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;      }</div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;    }</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;        <span class="keywordflow">if</span> (!single)</div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;    {</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;      <a class="code" href="queue_8h.html#a77999ebdf5aaf7af8b8ea22bf208c432">STAILQ_FOREACH</a>(en, el, entries)</div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;      {</div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="send_8c.html#a78de7631e05a4bde3c61e5f5d2c34921">mutt_fetch_recips</a>(env, en-&gt;<a class="code" href="structEmailNode.html#a812e5a33b27b12a78daacbe246089abb">email</a>-&gt;<a class="code" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>, flags, sub) == -1)</div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;          <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;      }</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;    }</div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="send_8c.html#a78de7631e05a4bde3c61e5f5d2c34921">mutt_fetch_recips</a>(env, curenv, flags, sub) == -1)</div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;    <span class="keywordflow">if</span> ((flags &amp; <a class="code" href="send_8h.html#a54e225c19799cf682ef8228825dbb3d8">SEND_LIST_REPLY</a>) &amp;&amp; <a class="code" href="queue_8h.html#ac3c9da7ac712eacbbad5cc54d7a3477e">TAILQ_EMPTY</a>(&amp;env-&gt;<a class="code" href="structEnvelope.html#a2d927371b3b80e025d6f7522b7361fe7">to</a>))</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;    {</div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;      <a class="code" href="logging_8h.html#acc1fd6d7ab1603e80e11e84e90d061e4">mutt_error</a>(<a class="code" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;No mailing lists found&quot;</span>));</div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;    }</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;    <span class="keywordflow">if</span> (flags &amp; <a class="code" href="send_8h.html#ac23e1891bcbc52cc25b5824acfb42d3c">SEND_REPLY</a>)</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;    {</div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;      <a class="code" href="send_8c.html#a247e6a821f797b77785f3a724baa44c3">mutt_make_misc_reply_headers</a>(env, curenv, sub);</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;      <a class="code" href="send_8c.html#ac4e76f02be95b09bccb7806659fa0ea6">make_reference_headers</a>(el, env, sub);</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;    }</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;  }</div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (flags &amp; <a class="code" href="send_8h.html#af72e00ab3817e49360034f4d9593bb62">SEND_FORWARD</a>)</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;  {</div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;    <a class="code" href="send_8c.html#a441dbd4f179147fa14692a98acbd8f26">mutt_make_forward_subject</a>(env, en-&gt;<a class="code" href="structEmailNode.html#a812e5a33b27b12a78daacbe246089abb">email</a>, sub);</div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;</div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> c_forward_references = <a class="code" href="helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(sub, <span class="stringliteral">&quot;forward_references&quot;</span>);</div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;    <span class="keywordflow">if</span> (c_forward_references)</div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;      <a class="code" href="send_8c.html#ac4e76f02be95b09bccb7806659fa0ea6">make_reference_headers</a>(el, env, sub);</div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;  }</div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;</div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;}</div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;</div><div class="line"><a name="l01212"></a><span class="lineno"><a class="line" href="send_8c.html#a0d247d6120598b06384009ea2bdb36af"> 1212</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="send_8c.html#a0d247d6120598b06384009ea2bdb36af">generate_body</a>(FILE *fp_tmp, <span class="keyword">struct</span> <a class="code" href="structEmail.html">Email</a> *e, <a class="code" href="send_8h.html#af731a62ddd44f1d907196beef8f8f19f">SendFlags</a> flags,</div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;                         <span class="keyword">struct</span> <a class="code" href="structMailbox.html">Mailbox</a> *m, <span class="keyword">struct</span> EmailList *el, <span class="keyword">struct</span> <a class="code" href="structConfigSubset.html">ConfigSubset</a> *sub)</div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;{</div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;  <span class="comment">/* An EmailList is required for replying and forwarding */</span></div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;  <span class="keywordflow">if</span> (!el &amp;&amp; (flags &amp; (<a class="code" href="send_8h.html#ac23e1891bcbc52cc25b5824acfb42d3c">SEND_REPLY</a> | <a class="code" href="send_8h.html#af72e00ab3817e49360034f4d9593bb62">SEND_FORWARD</a>)))</div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;</div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;  <span class="keywordflow">if</span> (flags &amp; <a class="code" href="send_8h.html#ac23e1891bcbc52cc25b5824acfb42d3c">SEND_REPLY</a>)</div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;  {</div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;    <span class="keyword">const</span> <span class="keyword">enum</span> <a class="code" href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35db">QuadOption</a> c_include = <a class="code" href="helpers_8c.html#a9154ba713ce99b0937f475eec7c61af9">cs_subset_quad</a>(sub, <span class="stringliteral">&quot;include&quot;</span>);</div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;    <span class="keyword">enum</span> <a class="code" href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35db">QuadOption</a> ans =</div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;        <a class="code" href="question_2lib_8h.html#ab02047769214ff014b9a8a1782babadc">query_quadoption</a>(c_include, <a class="code" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Include message in reply?&quot;</span>));</div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;    <span class="keywordflow">if</span> (ans == <a class="code" href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35dbaaa75b5db14c0aed1fde665034f113339">MUTT_ABORT</a>)</div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;</div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;    <span class="keywordflow">if</span> (ans == <a class="code" href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35dbafee7088606c4724651c799a6a0b182b7">MUTT_YES</a>)</div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;    {</div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;      <a class="code" href="logging_8h.html#ae108f891125caafa9250cf0959c40c04">mutt_message</a>(<a class="code" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Including quoted message...&quot;</span>));</div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;      <span class="keyword">struct </span><a class="code" href="structEmailNode.html">EmailNode</a> *en = NULL;</div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;      <a class="code" href="queue_8h.html#a77999ebdf5aaf7af8b8ea22bf208c432">STAILQ_FOREACH</a>(en, el, entries)</div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;      {</div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="send_8c.html#a133621f63fdff19b66d2b833f29a7c0f">include_reply</a>(m, en-&gt;<a class="code" href="structEmailNode.html#a812e5a33b27b12a78daacbe246089abb">email</a>, fp_tmp, sub) == -1)</div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;        {</div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;          <a class="code" href="logging_8h.html#acc1fd6d7ab1603e80e11e84e90d061e4">mutt_error</a>(<a class="code" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Could not include all requested messages&quot;</span>));</div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;          <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;        }</div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="queue_8h.html#ad89ac472696d006112dface9c2d75e47">STAILQ_NEXT</a>(en, entries) != NULL)</div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;        {</div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;          fputc(<span class="charliteral">&#39;\n&#39;</span>, fp_tmp);</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;        }</div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;      }</div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;    }</div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;  }</div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (flags &amp; <a class="code" href="send_8h.html#af72e00ab3817e49360034f4d9593bb62">SEND_FORWARD</a>)</div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;  {</div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;    <span class="keyword">const</span> <span class="keyword">enum</span> <a class="code" href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35db">QuadOption</a> c_mime_forward = <a class="code" href="helpers_8c.html#a9154ba713ce99b0937f475eec7c61af9">cs_subset_quad</a>(sub, <span class="stringliteral">&quot;mime_forward&quot;</span>);</div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;    <span class="keyword">enum</span> <a class="code" href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35db">QuadOption</a> ans =</div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;        <a class="code" href="question_2lib_8h.html#ab02047769214ff014b9a8a1782babadc">query_quadoption</a>(c_mime_forward, <a class="code" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Forward as attachment?&quot;</span>));</div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;    <span class="keywordflow">if</span> (ans == <a class="code" href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35dbafee7088606c4724651c799a6a0b182b7">MUTT_YES</a>)</div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;    {</div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;      <span class="keyword">struct </span><a class="code" href="structBody.html">Body</a> *last = e-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>;</div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;</div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;      <a class="code" href="logging_8h.html#ae108f891125caafa9250cf0959c40c04">mutt_message</a>(<a class="code" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Preparing forwarded message...&quot;</span>));</div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;</div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;      <span class="keywordflow">while</span> (last &amp;&amp; last-&gt;<a class="code" href="structBody.html#ac55cdfce46eed13151dcfe9b329d254c">next</a>)</div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;        last = last-&gt;<a class="code" href="structBody.html#ac55cdfce46eed13151dcfe9b329d254c">next</a>;</div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;</div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;      <span class="keyword">struct </span><a class="code" href="structEmailNode.html">EmailNode</a> *en = NULL;</div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;      <a class="code" href="queue_8h.html#a77999ebdf5aaf7af8b8ea22bf208c432">STAILQ_FOREACH</a>(en, el, entries)</div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;      {</div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;        <span class="keyword">struct </span><a class="code" href="structBody.html">Body</a> *tmp = <a class="code" href="sendlib_8c.html#ac8ddd58faaec9226b8af76db09d4155c">mutt_make_message_attach</a>(m, en-&gt;<a class="code" href="structEmailNode.html#a812e5a33b27b12a78daacbe246089abb">email</a>, <span class="keyword">false</span>, sub);</div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;        <span class="keywordflow">if</span> (last)</div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;        {</div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;          last-&gt;<a class="code" href="structBody.html#ac55cdfce46eed13151dcfe9b329d254c">next</a> = tmp;</div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;          last = tmp;</div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;        }</div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;        {</div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;          last = tmp;</div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;          e-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a> = tmp;</div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;        }</div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;      }</div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;    }</div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ans != <a class="code" href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35dbaaa75b5db14c0aed1fde665034f113339">MUTT_ABORT</a>)</div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;    {</div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;      <span class="keyword">enum</span> <a class="code" href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35db">QuadOption</a> forwardq = <a class="code" href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35dbaaa75b5db14c0aed1fde665034f113339">MUTT_ABORT</a>;</div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;      <span class="keyword">struct </span><a class="code" href="structBody.html">Body</a> **last = NULL;</div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;      <span class="keyword">struct </span><a class="code" href="structEmailNode.html">EmailNode</a> *en = NULL;</div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;</div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">bool</span> c_forward_decode = <a class="code" href="helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(sub, <span class="stringliteral">&quot;forward_decode&quot;</span>);</div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;      <span class="keyword">const</span> <span class="keyword">enum</span> <a class="code" href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35db">QuadOption</a> c_forward_attachments =</div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;          <a class="code" href="helpers_8c.html#a9154ba713ce99b0937f475eec7c61af9">cs_subset_quad</a>(sub, <span class="stringliteral">&quot;forward_attachments&quot;</span>);</div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;      <span class="keywordflow">if</span> (c_forward_decode &amp;&amp; (c_forward_attachments != <a class="code" href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35dbabe3800cc419f25384aaf1892fc3c812b">MUTT_NO</a>))</div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;      {</div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;        last = &amp;e-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>;</div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;        <span class="keywordflow">while</span> (*last)</div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;          last = &amp;((*last)-&gt;next);</div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;      }</div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;</div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;      <a class="code" href="queue_8h.html#a77999ebdf5aaf7af8b8ea22bf208c432">STAILQ_FOREACH</a>(en, el, entries)</div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;      {</div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;        <span class="keyword">struct </span><a class="code" href="structEmail.html">Email</a> *e_cur = en-&gt;<a class="code" href="structEmailNode.html#a812e5a33b27b12a78daacbe246089abb">email</a>;</div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;        <a class="code" href="send_8c.html#a5e533b7adb511ebbadbd637e3264fb05">include_forward</a>(m, e_cur, fp_tmp, sub);</div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;        <span class="keywordflow">if</span> (c_forward_decode &amp;&amp; (c_forward_attachments != <a class="code" href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35dbabe3800cc419f25384aaf1892fc3c812b">MUTT_NO</a>))</div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;        {</div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="send_8c.html#ae0accb8ca6f488f8a6d77cd9fac7672b">inline_forward_attachments</a>(m, e_cur, &amp;last, &amp;forwardq, sub) != 0)</div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;            <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;        }</div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;      }</div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;    }</div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;  }</div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;  <span class="comment">/* if (WithCrypto &amp;&amp; (flags &amp; SEND_KEY)) */</span></div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (((<a class="code" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a>) != 0) &amp;&amp; (flags &amp; <a class="code" href="send_8h.html#a623f46e1bab1e562893dbd01bbbd92dd">SEND_KEY</a>))</div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;  {</div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;    <span class="keyword">struct </span><a class="code" href="structBody.html">Body</a> *b = NULL;</div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;</div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;    <span class="keywordflow">if</span> (((<a class="code" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; APPLICATION_PGP) != 0) &amp;&amp; !(b = <a class="code" href="cryptglue_8c.html#ac671b1b0cd5df34d49ea749d29df8d3f">crypt_pgp_make_key_attachment</a>()))</div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;    {</div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;    }</div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;</div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;    b-&gt;<a class="code" href="structBody.html#ac55cdfce46eed13151dcfe9b329d254c">next</a> = e-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>;</div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;    e-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a> = b;</div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;  }</div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;</div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;  <a class="code" href="mutt__logging_8c.html#af068b3f524a31fad293b2fb61dfc4534">mutt_clear_error</a>();</div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;</div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;}</div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;</div><div class="line"><a name="l01329"></a><span class="lineno"><a class="line" href="send_8h.html#afa20b4cc93fe3d7cbc02675afeddcad4"> 1329</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="send_8c.html#afa20b4cc93fe3d7cbc02675afeddcad4">mutt_set_followup_to</a>(<span class="keyword">struct</span> <a class="code" href="structEnvelope.html">Envelope</a> *env, <span class="keyword">struct</span> <a class="code" href="structConfigSubset.html">ConfigSubset</a> *sub)</div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;{</div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;  <span class="comment">/* Only generate the Mail-Followup-To if the user has requested it, and</span></div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;<span class="comment">   * it hasn&#39;t already been set */</span></div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;</div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> c_followup_to = <a class="code" href="helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(sub, <span class="stringliteral">&quot;followup_to&quot;</span>);</div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;  <span class="keywordflow">if</span> (!c_followup_to)</div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;<span class="preprocessor">#ifdef USE_NNTP</span></div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="options_8h.html#affdfc25e31602911d236c7d283865f1c">OptNewsSend</a>)</div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;  {</div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;    <span class="keywordflow">if</span> (!env-&gt;<a class="code" href="structEnvelope.html#a46a9e33786aa5394ad768cbcc2357d65">followup_to</a> &amp;&amp; env-&gt;<a class="code" href="structEnvelope.html#a5f680f60f1713477a879877dcbd21a5c">newsgroups</a> &amp;&amp; (strrchr(env-&gt;<a class="code" href="structEnvelope.html#a5f680f60f1713477a879877dcbd21a5c">newsgroups</a>, <span class="charliteral">&#39;,&#39;</span>)))</div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;      env-&gt;<a class="code" href="structEnvelope.html#a46a9e33786aa5394ad768cbcc2357d65">followup_to</a> = <a class="code" href="mutt_2string_8c.html#a4c2560f787bd1226b977992c16860c98">mutt_str_dup</a>(env-&gt;<a class="code" href="structEnvelope.html#a5f680f60f1713477a879877dcbd21a5c">newsgroups</a>);</div><div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;  }</div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;</div><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="queue_8h.html#ac3c9da7ac712eacbbad5cc54d7a3477e">TAILQ_EMPTY</a>(&amp;env-&gt;<a class="code" href="structEnvelope.html#a6044b60220b8029a6a505e5b61f1cadc">mail_followup_to</a>))</div><div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;  {</div><div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="exec_8c.html#aa406114bea99ec4cdb561d61b3813c6d">mutt_is_list_recipient</a>(<span class="keyword">false</span>, env))</div><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;    {</div><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;      <span class="comment">/* this message goes to known mailing lists, so create a proper</span></div><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;<span class="comment">       * mail-followup-to header */</span></div><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;</div><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;      <a class="code" href="address_2address_8c.html#a16764dc80c9b3f6ad2897c8b7e59bd10">mutt_addrlist_copy</a>(&amp;env-&gt;<a class="code" href="structEnvelope.html#a6044b60220b8029a6a505e5b61f1cadc">mail_followup_to</a>, &amp;env-&gt;<a class="code" href="structEnvelope.html#a2d927371b3b80e025d6f7522b7361fe7">to</a>, <span class="keyword">false</span>);</div><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;      <a class="code" href="address_2address_8c.html#a16764dc80c9b3f6ad2897c8b7e59bd10">mutt_addrlist_copy</a>(&amp;env-&gt;<a class="code" href="structEnvelope.html#a6044b60220b8029a6a505e5b61f1cadc">mail_followup_to</a>, &amp;env-&gt;<a class="code" href="structEnvelope.html#a6b00837b3cb4b41898b42307135be8b6">cc</a>, <span class="keyword">true</span>);</div><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;    }</div><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;</div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;    <span class="comment">/* remove ourselves from the mail-followup-to header */</span></div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;    <a class="code" href="send_8c.html#a6671477ec99e59665fcbac17986d6e93">remove_user</a>(&amp;env-&gt;<a class="code" href="structEnvelope.html#a6044b60220b8029a6a505e5b61f1cadc">mail_followup_to</a>, <span class="keyword">false</span>);</div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;</div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;    <span class="comment">/* If we are not subscribed to any of the lists in question, re-add</span></div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;<span class="comment">     * ourselves to the mail-followup-to header.  The mail-followup-to header</span></div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;<span class="comment">     * generated is a no-op with group-reply, but makes sure list-reply has the</span></div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;<span class="comment">     * desired effect.  */</span></div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;</div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="queue_8h.html#ac3c9da7ac712eacbbad5cc54d7a3477e">TAILQ_EMPTY</a>(&amp;env-&gt;<a class="code" href="structEnvelope.html#a6044b60220b8029a6a505e5b61f1cadc">mail_followup_to</a>) &amp;&amp;</div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;        !<a class="code" href="exec_8c.html#a668a02e9879868145b1da7edbc8c4508">mutt_is_subscribed_list_recipient</a>(<span class="keyword">false</span>, env))</div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;    {</div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;      <span class="keyword">struct </span>AddressList *al = NULL;</div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="queue_8h.html#ac3c9da7ac712eacbbad5cc54d7a3477e">TAILQ_EMPTY</a>(&amp;env-&gt;<a class="code" href="structEnvelope.html#a4b75ab1853f95878dec079371bb0d799">reply_to</a>))</div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;        al = &amp;env-&gt;<a class="code" href="structEnvelope.html#a4b75ab1853f95878dec079371bb0d799">reply_to</a>;</div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code" href="queue_8h.html#ac3c9da7ac712eacbbad5cc54d7a3477e">TAILQ_EMPTY</a>(&amp;env-&gt;<a class="code" href="structEnvelope.html#af1aa00aed4b8767cf98f08e45a432ad8">from</a>))</div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;        al = &amp;env-&gt;<a class="code" href="structEnvelope.html#af1aa00aed4b8767cf98f08e45a432ad8">from</a>;</div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;</div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;      <span class="keywordflow">if</span> (al)</div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;      {</div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;        <span class="keyword">struct </span><a class="code" href="structAddress.html">Address</a> *a = NULL;</div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;        <a class="code" href="queue_8h.html#aa7f65c910cd4616fcfa9723c5763b1a5">TAILQ_FOREACH_REVERSE</a>(a, al, AddressList, entries)</div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;        {</div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;          <a class="code" href="address_2address_8c.html#aa68a29c1feb5938596aa589cf2d6a1af">mutt_addrlist_prepend</a>(&amp;env-&gt;<a class="code" href="structEnvelope.html#a6044b60220b8029a6a505e5b61f1cadc">mail_followup_to</a>, <a class="code" href="address_2address_8c.html#a16a97a499073187e58d4022ad6de29d1">mutt_addr_copy</a>(a));</div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;        }</div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;      }</div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;      {</div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;        <a class="code" href="address_2address_8c.html#aa68a29c1feb5938596aa589cf2d6a1af">mutt_addrlist_prepend</a>(&amp;env-&gt;<a class="code" href="structEnvelope.html#a6044b60220b8029a6a505e5b61f1cadc">mail_followup_to</a>, <a class="code" href="send_8c.html#aa93b7a6bc9e26176ebf17bf37c7d2a87">mutt_default_from</a>(sub));</div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;      }</div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;    }</div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;</div><div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;    <a class="code" href="address_2address_8c.html#aee5d40d84136d3a7adba727e2908ad66">mutt_addrlist_dedupe</a>(&amp;env-&gt;<a class="code" href="structEnvelope.html#a6044b60220b8029a6a505e5b61f1cadc">mail_followup_to</a>);</div><div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;  }</div><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;}</div><div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;</div><div class="line"><a name="l01402"></a><span class="lineno"><a class="line" href="send_8c.html#ac5be3d670b1d7e5cddb605652e9aa859"> 1402</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="send_8c.html#ac5be3d670b1d7e5cddb605652e9aa859">set_reverse_name</a>(<span class="keyword">struct</span> AddressList *al, <span class="keyword">struct</span> <a class="code" href="structEnvelope.html">Envelope</a> *env,</div><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;                             <span class="keyword">struct</span> <a class="code" href="structConfigSubset.html">ConfigSubset</a> *sub)</div><div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;{</div><div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;  <span class="keyword">struct </span><a class="code" href="structAddress.html">Address</a> *a = NULL;</div><div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="queue_8h.html#ac3c9da7ac712eacbbad5cc54d7a3477e">TAILQ_EMPTY</a>(al))</div><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;  {</div><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;    <a class="code" href="queue_8h.html#a16e5fc168e7f3494d4b1df54447d871e">TAILQ_FOREACH</a>(a, &amp;env-&gt;<a class="code" href="structEnvelope.html#a2d927371b3b80e025d6f7522b7361fe7">to</a>, entries)</div><div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;    {</div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="alias_8c.html#a9d6f6b4ea9d79c9c33ddd7c6b6ef764b">mutt_addr_is_user</a>(a))</div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;      {</div><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;        <a class="code" href="address_2address_8c.html#a68385b174baad74a9aecf3dec61432a0">mutt_addrlist_append</a>(al, <a class="code" href="address_2address_8c.html#a16a97a499073187e58d4022ad6de29d1">mutt_addr_copy</a>(a));</div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;      }</div><div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;    }</div><div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;  }</div><div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;</div><div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="queue_8h.html#ac3c9da7ac712eacbbad5cc54d7a3477e">TAILQ_EMPTY</a>(al))</div><div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;  {</div><div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;    <a class="code" href="queue_8h.html#a16e5fc168e7f3494d4b1df54447d871e">TAILQ_FOREACH</a>(a, &amp;env-&gt;<a class="code" href="structEnvelope.html#a6b00837b3cb4b41898b42307135be8b6">cc</a>, entries)</div><div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;    {</div><div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="alias_8c.html#a9d6f6b4ea9d79c9c33ddd7c6b6ef764b">mutt_addr_is_user</a>(a))</div><div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;      {</div><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;        <a class="code" href="address_2address_8c.html#a68385b174baad74a9aecf3dec61432a0">mutt_addrlist_append</a>(al, <a class="code" href="address_2address_8c.html#a16a97a499073187e58d4022ad6de29d1">mutt_addr_copy</a>(a));</div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;      }</div><div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;    }</div><div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;  }</div><div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;</div><div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="queue_8h.html#ac3c9da7ac712eacbbad5cc54d7a3477e">TAILQ_EMPTY</a>(al))</div><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;  {</div><div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;    <span class="keyword">struct </span><a class="code" href="structAddress.html">Address</a> *from = <a class="code" href="queue_8h.html#a7d6894360bd1c41e0e6f6d84998c1362">TAILQ_FIRST</a>(&amp;env-&gt;<a class="code" href="structEnvelope.html#af1aa00aed4b8767cf98f08e45a432ad8">from</a>);</div><div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;    <span class="keywordflow">if</span> (from &amp;&amp; <a class="code" href="alias_8c.html#a9d6f6b4ea9d79c9c33ddd7c6b6ef764b">mutt_addr_is_user</a>(from))</div><div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;    {</div><div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;      <a class="code" href="address_2address_8c.html#a68385b174baad74a9aecf3dec61432a0">mutt_addrlist_append</a>(al, <a class="code" href="address_2address_8c.html#a16a97a499073187e58d4022ad6de29d1">mutt_addr_copy</a>(from));</div><div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;    }</div><div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;  }</div><div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;</div><div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="queue_8h.html#ac3c9da7ac712eacbbad5cc54d7a3477e">TAILQ_EMPTY</a>(al))</div><div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;  {</div><div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;    <span class="comment">/* when $reverse_real_name is not set, clear the personal name so that it</span></div><div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;<span class="comment">     * may be set via a reply- or send-hook.  */</span></div><div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;</div><div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> c_reverse_real_name = <a class="code" href="helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(sub, <span class="stringliteral">&quot;reverse_real_name&quot;</span>);</div><div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;    <span class="keywordflow">if</span> (!c_reverse_real_name)</div><div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;      <a class="code" href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;<a class="code" href="queue_8h.html#a7d6894360bd1c41e0e6f6d84998c1362">TAILQ_FIRST</a>(al)-&gt;<a class="code" href="structAddress.html#af4ac89f0f41e7872b4faeaedfcb709b4">personal</a>);</div><div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;  }</div><div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;}</div><div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;</div><div class="line"><a name="l01454"></a><span class="lineno"><a class="line" href="send_8h.html#aa93b7a6bc9e26176ebf17bf37c7d2a87"> 1454</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structAddress.html">Address</a> *<a class="code" href="send_8c.html#aa93b7a6bc9e26176ebf17bf37c7d2a87">mutt_default_from</a>(<span class="keyword">struct</span> <a class="code" href="structConfigSubset.html">ConfigSubset</a> *sub)</div><div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;{</div><div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;  <span class="comment">/* Note: We let $from override $real_name here.</span></div><div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;<span class="comment">   *       Is this the right thing to do?</span></div><div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;</div><div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;  <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structAddress.html">Address</a> *c_from = <a class="code" href="helpers_8c.html#a1118361831f5c60ec14ce80ae37267d9">cs_subset_address</a>(sub, <span class="stringliteral">&quot;from&quot;</span>);</div><div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> c_use_domain = <a class="code" href="helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(sub, <span class="stringliteral">&quot;use_domain&quot;</span>);</div><div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;  <span class="keywordflow">if</span> (c_from)</div><div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;  {</div><div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="address_2address_8c.html#a16a97a499073187e58d4022ad6de29d1">mutt_addr_copy</a>(c_from);</div><div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;  }</div><div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (c_use_domain)</div><div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;  {</div><div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;    <span class="keyword">struct </span><a class="code" href="structAddress.html">Address</a> *addr = <a class="code" href="address_2address_8c.html#ac9b323dadeb2a55ce6e9cd4763b9d832">mutt_addr_new</a>();</div><div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;    <a class="code" href="mutt_2string_8c.html#a4388c16988fac9a7596dee4d4af89595">mutt_str_asprintf</a>(&amp;addr-&gt;<a class="code" href="structAddress.html#a8ea3ae93a2550c76c392a9001dbbaefd">mailbox</a>, <span class="stringliteral">&quot;%s@%s&quot;</span>, <a class="code" href="string2_8h.html#a7e0481bed27661ea2679f256b24e0283">NONULL</a>(<a class="code" href="mutt__globals_8h.html#a441e341e914ef8b06dbb797713a1e83b">Username</a>),</div><div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;                      <a class="code" href="string2_8h.html#a7e0481bed27661ea2679f256b24e0283">NONULL</a>(<a class="code" href="sendlib_8c.html#a3214a4d6985ca1a64f72d21f6f8c252f">mutt_fqdn</a>(<span class="keyword">true</span>, sub)));</div><div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;    <span class="keywordflow">return</span> addr;</div><div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;  }</div><div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;  {</div><div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="address_2address_8c.html#a4b1281c02f8b158f174c0b7c57af3d83">mutt_addr_create</a>(NULL, <a class="code" href="mutt__globals_8h.html#a441e341e914ef8b06dbb797713a1e83b">Username</a>);</div><div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;  }</div><div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;}</div><div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;</div><div class="line"><a name="l01487"></a><span class="lineno"><a class="line" href="send_8c.html#a859ddbab5f9384328fd06bf9c18c02f2"> 1487</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="send_8c.html#a859ddbab5f9384328fd06bf9c18c02f2">invoke_mta</a>(<span class="keyword">struct</span> <a class="code" href="structMailbox.html">Mailbox</a> *m, <span class="keyword">struct</span> <a class="code" href="structEmail.html">Email</a> *e, <span class="keyword">struct</span> <a class="code" href="structConfigSubset.html">ConfigSubset</a> *sub)</div><div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;{</div><div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;  <span class="keyword">struct </span><a class="code" href="structBuffer.html">Buffer</a> *tempfile = NULL;</div><div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;  <span class="keywordtype">int</span> rc = -1;</div><div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;</div><div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;  <span class="comment">/* Write out the message in MIME form. */</span></div><div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;  tempfile = <a class="code" href="pool_8c.html#a2129d5ea0085753afdd37cf62161845d">mutt_buffer_pool_get</a>();</div><div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;  <a class="code" href="muttlib_8h.html#a7f1db9db6f710a84cace77248096e2ac">mutt_buffer_mktemp</a>(tempfile);</div><div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;  FILE *fp_tmp = <a class="code" href="file_8c.html#ae1c0c19fec03274220b3ca065ad1e2e5">mutt_file_fopen</a>(<a class="code" href="buffer_8h.html#a4aca040fb75bc1dfc086cbfbf14ac8cd">mutt_buffer_string</a>(tempfile), <span class="stringliteral">&quot;w&quot;</span>);</div><div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;  <span class="keywordflow">if</span> (!fp_tmp)</div><div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;    <span class="keywordflow">goto</span> cleanup;</div><div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;</div><div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;<span class="preprocessor">#ifdef USE_SMTP</span></div><div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> c_write_bcc = <a class="code" href="helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(sub, <span class="stringliteral">&quot;write_bcc&quot;</span>);</div><div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keyword">const</span> c_smtp_url = <a class="code" href="helpers_8c.html#ac477c591155aa4ae0452bbabc0affffe">cs_subset_string</a>(sub, <span class="stringliteral">&quot;smtp_url&quot;</span>);</div><div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;  <span class="keywordflow">if</span> (c_smtp_url)</div><div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;    <a class="code" href="subset_8c.html#a6ee598a96defed645b11cad6e6cb6512">cs_subset_str_native_set</a>(sub, <span class="stringliteral">&quot;write_bcc&quot;</span>, <span class="keyword">false</span>, NULL);</div><div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;<span class="preprocessor">#ifdef MIXMASTER</span></div><div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;  <a class="code" href="header_8c.html#a400e83b7e5612f974ef543ff3cd237d8">mutt_rfc822_write_header</a>(fp_tmp, e-&gt;<a class="code" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>, e-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>, <a class="code" href="header_8h.html#a610db600447893b501a944c8e5dbb9f7ab8ca5468a3e97884fe52cfc76ff40fa8">MUTT_WRITE_HEADER_NORMAL</a>,</div><div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;                           !<a class="code" href="queue_8h.html#a8427c8f43d09d73062cf6b37f303aff5">STAILQ_EMPTY</a>(&amp;e-&gt;<a class="code" href="structEmail.html#a9a3c73dc042313773159d921a711c830">chain</a>),</div><div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;                           <a class="code" href="crypt_8c.html#a52c65477f5b80ad3dc8028663653771d">mutt_should_hide_protected_subject</a>(e), sub);</div><div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;<span class="preprocessor">#ifndef MIXMASTER</span></div><div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;  <a class="code" href="header_8c.html#a400e83b7e5612f974ef543ff3cd237d8">mutt_rfc822_write_header</a>(fp_tmp, e-&gt;<a class="code" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>, e-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>, <a class="code" href="header_8h.html#a610db600447893b501a944c8e5dbb9f7ab8ca5468a3e97884fe52cfc76ff40fa8">MUTT_WRITE_HEADER_NORMAL</a>,</div><div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;                           <span class="keyword">false</span>, <a class="code" href="crypt_8c.html#a52c65477f5b80ad3dc8028663653771d">mutt_should_hide_protected_subject</a>(e), sub);</div><div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;<span class="preprocessor">#ifdef USE_SMTP</span></div><div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;  <a class="code" href="subset_8c.html#a6ee598a96defed645b11cad6e6cb6512">cs_subset_str_native_set</a>(sub, <span class="stringliteral">&quot;write_bcc&quot;</span>, c_write_bcc, NULL);</div><div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;</div><div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;  fputc(<span class="charliteral">&#39;\n&#39;</span>, fp_tmp); <span class="comment">/* tie off the header. */</span></div><div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;</div><div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;  <span class="keywordflow">if</span> ((<a class="code" href="send_2body_8c.html#a7ed09e9904a3693633204577be91f413">mutt_write_mime_body</a>(e-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>, fp_tmp, sub) == -1))</div><div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;    <span class="keywordflow">goto</span> cleanup;</div><div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;</div><div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="file_8c.html#a31f49795ff5b9558db5476e5777e63b6">mutt_file_fclose</a>(&amp;fp_tmp) != 0)</div><div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;  {</div><div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;    <a class="code" href="logging_8h.html#afaa521ab22db877ccf1b87e679e1b43e">mutt_perror</a>(<a class="code" href="buffer_8h.html#a4aca040fb75bc1dfc086cbfbf14ac8cd">mutt_buffer_string</a>(tempfile));</div><div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;    unlink(<a class="code" href="buffer_8h.html#a4aca040fb75bc1dfc086cbfbf14ac8cd">mutt_buffer_string</a>(tempfile));</div><div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;    <span class="keywordflow">goto</span> cleanup;</div><div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;  }</div><div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;</div><div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;<span class="preprocessor">#ifdef MIXMASTER</span></div><div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="queue_8h.html#a8427c8f43d09d73062cf6b37f303aff5">STAILQ_EMPTY</a>(&amp;e-&gt;<a class="code" href="structEmail.html#a9a3c73dc042313773159d921a711c830">chain</a>))</div><div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;  {</div><div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;    rc = <a class="code" href="remailer_8c.html#a0b48fa9d9df7079340bb349c86635738">mix_send_message</a>(&amp;e-&gt;<a class="code" href="structEmail.html#a9a3c73dc042313773159d921a711c830">chain</a>, <a class="code" href="buffer_8h.html#a4aca040fb75bc1dfc086cbfbf14ac8cd">mutt_buffer_string</a>(tempfile));</div><div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;    <span class="keywordflow">goto</span> cleanup;</div><div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;  }</div><div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;</div><div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;<span class="preprocessor">#ifdef USE_NNTP</span></div><div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="options_8h.html#affdfc25e31602911d236c7d283865f1c">OptNewsSend</a>)</div><div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;    <span class="keywordflow">goto</span> sendmail;</div><div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;</div><div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;<span class="preprocessor">#ifdef USE_SMTP</span></div><div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;  <span class="keywordflow">if</span> (c_smtp_url)</div><div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;  {</div><div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;    rc = <a class="code" href="smtp_8c.html#ae59289bca751588d49e12337981f375d">mutt_smtp_send</a>(&amp;e-&gt;<a class="code" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code" href="structEnvelope.html#af1aa00aed4b8767cf98f08e45a432ad8">from</a>, &amp;e-&gt;<a class="code" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code" href="structEnvelope.html#a2d927371b3b80e025d6f7522b7361fe7">to</a>, &amp;e-&gt;<a class="code" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code" href="structEnvelope.html#a6b00837b3cb4b41898b42307135be8b6">cc</a>, &amp;e-&gt;<a class="code" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code" href="structEnvelope.html#aad427832f4ae422f1b16d0896c1d3af6">bcc</a>,</div><div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;                        <a class="code" href="buffer_8h.html#a4aca040fb75bc1dfc086cbfbf14ac8cd">mutt_buffer_string</a>(tempfile),</div><div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;                        (e-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>-&gt;<a class="code" href="structBody.html#ad2f05b8ff24813de41988e63de5d6a31">encoding</a> == <a class="code" href="mime_8h.html#a1757cddbe4d3d273bf8fbffde3489a61a7c05065f79f9ed33904677a211ec3466">ENC_8BIT</a>), sub);</div><div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;    <span class="keywordflow">goto</span> cleanup;</div><div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;  }</div><div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;</div><div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;sendmail:</div><div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;  rc = <a class="code" href="sendmail_8c.html#a5562a863571c41379b43fd780735776c">mutt_invoke_sendmail</a>(m, &amp;e-&gt;<a class="code" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code" href="structEnvelope.html#af1aa00aed4b8767cf98f08e45a432ad8">from</a>, &amp;e-&gt;<a class="code" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code" href="structEnvelope.html#a2d927371b3b80e025d6f7522b7361fe7">to</a>, &amp;e-&gt;<a class="code" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code" href="structEnvelope.html#a6b00837b3cb4b41898b42307135be8b6">cc</a>,</div><div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;                            &amp;e-&gt;<a class="code" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code" href="structEnvelope.html#aad427832f4ae422f1b16d0896c1d3af6">bcc</a>, <a class="code" href="buffer_8h.html#a4aca040fb75bc1dfc086cbfbf14ac8cd">mutt_buffer_string</a>(tempfile),</div><div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;                            (e-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>-&gt;<a class="code" href="structBody.html#ad2f05b8ff24813de41988e63de5d6a31">encoding</a> == <a class="code" href="mime_8h.html#a1757cddbe4d3d273bf8fbffde3489a61a7c05065f79f9ed33904677a211ec3466">ENC_8BIT</a>), sub);</div><div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;cleanup:</div><div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;  <span class="keywordflow">if</span> (fp_tmp)</div><div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;  {</div><div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;    <a class="code" href="file_8c.html#a31f49795ff5b9558db5476e5777e63b6">mutt_file_fclose</a>(&amp;fp_tmp);</div><div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;    unlink(<a class="code" href="buffer_8h.html#a4aca040fb75bc1dfc086cbfbf14ac8cd">mutt_buffer_string</a>(tempfile));</div><div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;  }</div><div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;  <a class="code" href="pool_8c.html#a08b48e2ac8849341888ee7429cc5093c">mutt_buffer_pool_release</a>(&amp;tempfile);</div><div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;  <span class="keywordflow">return</span> rc;</div><div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;}</div><div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;</div><div class="line"><a name="l01573"></a><span class="lineno"><a class="line" href="send_8h.html#a1ba9ce78a67261e872a264bc956ef857"> 1573</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="send_8c.html#a1ba9ce78a67261e872a264bc956ef857">mutt_encode_descriptions</a>(<span class="keyword">struct</span> <a class="code" href="structBody.html">Body</a> *b, <span class="keywordtype">bool</span> recurse, <span class="keyword">struct</span> <a class="code" href="structConfigSubset.html">ConfigSubset</a> *sub)</div><div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;{</div><div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">struct</span> <a class="code" href="structBody.html">Body</a> *t = b; t; t = t-&gt;<a class="code" href="structBody.html#ac55cdfce46eed13151dcfe9b329d254c">next</a>)</div><div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;  {</div><div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;    <span class="keywordflow">if</span> (t-&gt;description)</div><div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;    {</div><div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keyword">const</span> c_send_charset = <a class="code" href="helpers_8c.html#ac477c591155aa4ae0452bbabc0affffe">cs_subset_string</a>(sub, <span class="stringliteral">&quot;send_charset&quot;</span>);</div><div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;      <a class="code" href="rfc2047_8c.html#a3cc43939d840544876d40c8da1f99b7d">rfc2047_encode</a>(&amp;t-&gt;description, NULL, <span class="keyword">sizeof</span>(<span class="stringliteral">&quot;Content-Description:&quot;</span>), c_send_charset);</div><div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;    }</div><div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;    <span class="keywordflow">if</span> (recurse &amp;&amp; t-&gt;parts)</div><div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;      <a class="code" href="send_8c.html#a1ba9ce78a67261e872a264bc956ef857">mutt_encode_descriptions</a>(t-&gt;parts, recurse, sub);</div><div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;  }</div><div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;}</div><div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;</div><div class="line"><a name="l01591"></a><span class="lineno"><a class="line" href="send_8c.html#af1b54154700865964598299ed1cf9a6a"> 1591</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="send_8c.html#af1b54154700865964598299ed1cf9a6a">decode_descriptions</a>(<span class="keyword">struct</span> <a class="code" href="structBody.html">Body</a> *b)</div><div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;{</div><div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">struct</span> <a class="code" href="structBody.html">Body</a> *t = b; t; t = t-&gt;<a class="code" href="structBody.html#ac55cdfce46eed13151dcfe9b329d254c">next</a>)</div><div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;  {</div><div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;    <span class="keywordflow">if</span> (t-&gt;description)</div><div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;    {</div><div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;      <a class="code" href="rfc2047_8c.html#a89c57c82465740567f73641c9397d760">rfc2047_decode</a>(&amp;t-&gt;description);</div><div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;    }</div><div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;    <span class="keywordflow">if</span> (t-&gt;parts)</div><div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;      <a class="code" href="send_8c.html#af1b54154700865964598299ed1cf9a6a">decode_descriptions</a>(t-&gt;parts);</div><div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;  }</div><div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;}</div><div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;</div><div class="line"><a name="l01608"></a><span class="lineno"><a class="line" href="send_8c.html#ad5e73f6a253107a7f55ee7388fbbf92f"> 1608</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="send_8c.html#ad5e73f6a253107a7f55ee7388fbbf92f">fix_end_of_file</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="structBuffer.html#aeec1fd4af0ddf6765b0187466d4361b8">data</a>)</div><div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;{</div><div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;  FILE *fp = <a class="code" href="file_8c.html#ae1c0c19fec03274220b3ca065ad1e2e5">mutt_file_fopen</a>(data, <span class="stringliteral">&quot;a+&quot;</span>);</div><div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;  <span class="keywordflow">if</span> (!fp)</div><div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;  <span class="keywordflow">if</span> (fseek(fp, -1, SEEK_END) &gt;= 0)</div><div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;  {</div><div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;    <span class="keywordtype">int</span> c = fgetc(fp);</div><div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;    <span class="keywordflow">if</span> (c != <span class="charliteral">&#39;\n&#39;</span>)</div><div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;      fputc(<span class="charliteral">&#39;\n&#39;</span>, fp);</div><div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;  }</div><div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;  <a class="code" href="file_8c.html#a31f49795ff5b9558db5476e5777e63b6">mutt_file_fclose</a>(&amp;fp);</div><div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;}</div><div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;</div><div class="line"><a name="l01632"></a><span class="lineno"><a class="line" href="send_8h.html#a58823b3164da72a6429664e1091d12a8"> 1632</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="send_8c.html#a58823b3164da72a6429664e1091d12a8">mutt_resend_message</a>(FILE *fp, <span class="keyword">struct</span> <a class="code" href="structMailbox.html">Mailbox</a> *m, <span class="keyword">struct</span> <a class="code" href="structEmail.html">Email</a> *e_cur,</div><div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;                        <span class="keyword">struct</span> <a class="code" href="structConfigSubset.html">ConfigSubset</a> *sub)</div><div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;{</div><div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;  <span class="keyword">struct </span><a class="code" href="structEmail.html">Email</a> *e_new = <a class="code" href="email_2email_8c.html#a77c9ecff4b23001b81177ffe398bad44">email_new</a>();</div><div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;</div><div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="postpone_8c.html#aad14aaca518d6c005ec318f14114d5ec">mutt_prepare_template</a>(fp, m, e_new, e_cur, <span class="keyword">true</span>) &lt; 0)</div><div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;  {</div><div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;    <a class="code" href="email_2email_8c.html#ae9f719d3fc31d00b92bcf9f77d56ee67">email_free</a>(&amp;e_new);</div><div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;  }</div><div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;</div><div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a>)</div><div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;  {</div><div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;    <span class="comment">/* mutt_prepare_template doesn&#39;t always flip on an application bit.</span></div><div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;<span class="comment">     * so fix that here */</span></div><div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;    <span class="keywordflow">if</span> (!(e_new-&gt;<a class="code" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> &amp; (<a class="code" href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a> | <a class="code" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a>)))</div><div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;    {</div><div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">bool</span> c_smime_is_default = <a class="code" href="helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(sub, <span class="stringliteral">&quot;smime_is_default&quot;</span>);</div><div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;      <span class="keywordflow">if</span> (((<a class="code" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code" href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a>) != 0) &amp;&amp; c_smime_is_default)</div><div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;        e_new-&gt;<a class="code" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> |= <a class="code" href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a>;</div><div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a>)</div><div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;        e_new-&gt;<a class="code" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> |= <a class="code" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a>;</div><div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;        e_new-&gt;<a class="code" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> |= <a class="code" href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a>;</div><div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;    }</div><div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;</div><div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> c_crypt_opportunistic_encrypt =</div><div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;        <a class="code" href="helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(sub, <span class="stringliteral">&quot;crypt_opportunistic_encrypt&quot;</span>);</div><div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;    <span class="keywordflow">if</span> (c_crypt_opportunistic_encrypt)</div><div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;    {</div><div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;      e_new-&gt;<a class="code" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> |= <a class="code" href="ncrypt_2lib_8h.html#a2fb0b0aa796d8d79a746001d09c2a2c7">SEC_OPPENCRYPT</a>;</div><div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;      <a class="code" href="crypt_8c.html#a8ebc13a33b0dd650151d5b1b37cb99e4">crypt_opportunistic_encrypt</a>(m, e_new);</div><div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;    }</div><div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;  }</div><div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;</div><div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;  <span class="keyword">struct </span>EmailList el = <a class="code" href="queue_8h.html#a3d41ce2c3f1dd21c0d4051d13204c321">STAILQ_HEAD_INITIALIZER</a>(el);</div><div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;  <a class="code" href="email_2email_8c.html#a0c1d7a53b53fccd8f52dc45f69282318">emaillist_add_email</a>(&amp;el, e_cur);</div><div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;  <span class="keywordtype">int</span> rc = <a class="code" href="send_8c.html#a886452bec277bd3e4169d0863b7768ae">mutt_send_message</a>(<a class="code" href="send_8h.html#abeb38906954f30b89ad58ebbf95ac2b0">SEND_RESEND</a>, e_new, NULL, m, &amp;el, sub);</div><div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;  <a class="code" href="email_2email_8c.html#af751cd283c12c90ca470959861930feb">emaillist_clear</a>(&amp;el);</div><div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;</div><div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;  <span class="keywordflow">return</span> rc;</div><div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;}</div><div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;</div><div class="line"><a name="l01682"></a><span class="lineno"><a class="line" href="send_8c.html#a19cc8b134c97bc3752c778d8b4977e8c"> 1682</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="send_8c.html#a19cc8b134c97bc3752c778d8b4977e8c">is_reply</a>(<span class="keyword">struct</span> <a class="code" href="structEmail.html">Email</a> *reply, <span class="keyword">struct</span> <a class="code" href="structEmail.html">Email</a> *orig)</div><div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;{</div><div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;  <span class="keywordflow">if</span> (!reply || !reply-&gt;<a class="code" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a> || !orig || !orig-&gt;<a class="code" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>)</div><div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="list_8c.html#a4a88586627792b16d55bd2e164a59e0a">mutt_list_find</a>(&amp;orig-&gt;<a class="code" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code" href="structEnvelope.html#a832eec73356a806761e26f0bc40d9083">references</a>, reply-&gt;<a class="code" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code" href="structEnvelope.html#a50418c13a849bf27b22922bd5867e5e1">message_id</a>) ||</div><div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;         <a class="code" href="list_8c.html#a4a88586627792b16d55bd2e164a59e0a">mutt_list_find</a>(&amp;orig-&gt;<a class="code" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code" href="structEnvelope.html#a9ae6d450b2f012c37d3350f4305fbb90">in_reply_to</a>, reply-&gt;<a class="code" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code" href="structEnvelope.html#a50418c13a849bf27b22922bd5867e5e1">message_id</a>);</div><div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;}</div><div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;</div><div class="line"><a name="l01701"></a><span class="lineno"><a class="line" href="send_8c.html#ad829e8c88d7630a8a6ed719378dd4570"> 1701</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="send_8c.html#ad829e8c88d7630a8a6ed719378dd4570">search_attach_keyword</a>(<span class="keywordtype">char</span> *filename, <span class="keyword">struct</span> <a class="code" href="structConfigSubset.html">ConfigSubset</a> *sub)</div><div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;{</div><div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;  <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structRegex.html">Regex</a> *c_abort_noattach_regex =</div><div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;      <a class="code" href="helpers_8c.html#ae5ccc8068dd017455c38dd01982f7908">cs_subset_regex</a>(sub, <span class="stringliteral">&quot;abort_noattach_regex&quot;</span>);</div><div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;  <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structRegex.html">Regex</a> *c_quote_regex = <a class="code" href="helpers_8c.html#ae5ccc8068dd017455c38dd01982f7908">cs_subset_regex</a>(sub, <span class="stringliteral">&quot;quote_regex&quot;</span>);</div><div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;</div><div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;  <span class="comment">/* Search for the regex in `$abort_noattach_regex` within a file */</span></div><div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;  <span class="keywordflow">if</span> (!c_abort_noattach_regex || !c_abort_noattach_regex-&gt;<a class="code" href="structRegex.html#af9ccc25da6324c9055e53966abe9a7b3">regex</a> ||</div><div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;      !c_quote_regex || !c_quote_regex-&gt;<a class="code" href="structRegex.html#af9ccc25da6324c9055e53966abe9a7b3">regex</a>)</div><div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;  {</div><div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;  }</div><div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;</div><div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;  FILE *fp_att = <a class="code" href="file_8c.html#ae1c0c19fec03274220b3ca065ad1e2e5">mutt_file_fopen</a>(filename, <span class="stringliteral">&quot;r&quot;</span>);</div><div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;  <span class="keywordflow">if</span> (!fp_att)</div><div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;</div><div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;  <span class="keywordtype">char</span> *inputline = <a class="code" href="memory_8c.html#a264da4dc58e6dc8983285bd1f538f24d">mutt_mem_malloc</a>(1024);</div><div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;  <span class="keywordtype">bool</span> found = <span class="keyword">false</span>;</div><div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;  <span class="keywordflow">while</span> (!feof(fp_att))</div><div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;  {</div><div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;    fgets(inputline, 1024, fp_att);</div><div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="dlg__pager_8c.html#a1f9daa6945087758fdee1bdf76e62354">mutt_is_quote_line</a>(inputline, NULL) &amp;&amp;</div><div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;        <a class="code" href="mutt_2regex_8c.html#ad25947e610db74945537b99edf428982">mutt_regex_match</a>(c_abort_noattach_regex, inputline))</div><div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;    {</div><div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;      found = <span class="keyword">true</span>;</div><div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;    }</div><div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;  }</div><div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;  <a class="code" href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;inputline);</div><div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;  <a class="code" href="file_8c.html#a31f49795ff5b9558db5476e5777e63b6">mutt_file_fclose</a>(&amp;fp_att);</div><div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;  <span class="keywordflow">return</span> found;</div><div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;}</div><div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;</div><div class="line"><a name="l01748"></a><span class="lineno"><a class="line" href="send_8c.html#a255efc8a4a366c3de07d48da23d03a32"> 1748</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="send_8c.html#a255efc8a4a366c3de07d48da23d03a32">save_fcc</a>(<span class="keyword">struct</span> <a class="code" href="structMailbox.html">Mailbox</a> *m, <span class="keyword">struct</span> <a class="code" href="structEmail.html">Email</a> *e, <span class="keyword">struct</span> <a class="code" href="structBuffer.html">Buffer</a> *fcc,</div><div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;                    <span class="keyword">struct</span> <a class="code" href="structBody.html">Body</a> *clear_content, <span class="keywordtype">char</span> *pgpkeylist,</div><div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;                    <a class="code" href="send_8h.html#af731a62ddd44f1d907196beef8f8f19f">SendFlags</a> flags, <span class="keywordtype">char</span> **finalpath, <span class="keyword">struct</span> <a class="code" href="structConfigSubset.html">ConfigSubset</a> *sub)</div><div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;{</div><div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;  <span class="keywordtype">int</span> rc = 0;</div><div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;  <span class="keyword">struct </span><a class="code" href="structBody.html">Body</a> *save_content = NULL;</div><div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;</div><div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;  <a class="code" href="muttlib_8c.html#a21df22e3d202586bf463caf3c9e718cc">mutt_buffer_expand_path</a>(fcc);</div><div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;</div><div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;  <span class="comment">/* Don&#39;t save a copy when we are in batch-mode, and the FCC</span></div><div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;<span class="comment">   * folder is on an IMAP server: This would involve possibly lots</span></div><div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;<span class="comment">   * of user interaction, which is not available in batch mode.</span></div><div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;<span class="comment">   *</span></div><div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;<span class="comment">   * Note: A patch to fix the problems with the use of IMAP servers</span></div><div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;<span class="comment">   * from non-curses mode is available from Brendan Cully.  However,</span></div><div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;<span class="comment">   * I&#39;d like to think a bit more about this before including it.  */</span></div><div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;</div><div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;<span class="preprocessor">#ifdef USE_IMAP</span></div><div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;  <span class="keywordflow">if</span> ((flags &amp; <a class="code" href="send_8h.html#a05caaa1cac7622dce2a0e32d75619b48">SEND_BATCH</a>) &amp;&amp; !<a class="code" href="buffer_8c.html#a2d7c4a32422377609be66b0f620c4971">mutt_buffer_is_empty</a>(fcc) &amp;&amp;</div><div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;      (<a class="code" href="imap_8c.html#ab4f27af8eb857a20834f445be3f498de">imap_path_probe</a>(<a class="code" href="buffer_8h.html#a4aca040fb75bc1dfc086cbfbf14ac8cd">mutt_buffer_string</a>(fcc), NULL) == <a class="code" href="mailbox_8h.html#af65addf714c28dd5d483cb426100921da7f541a03089370b1a260e344f8d1809b">MUTT_IMAP</a>))</div><div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;  {</div><div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;    <a class="code" href="logging_8h.html#acc1fd6d7ab1603e80e11e84e90d061e4">mutt_error</a>(</div><div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;        <a class="code" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Warning: Fcc to an IMAP mailbox is not supported in batch mode&quot;</span>));</div><div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;    <span class="comment">/* L10N: Printed after the &quot;Fcc to an IMAP mailbox is not supported&quot; message.</span></div><div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;<span class="comment">       To make it clearer that the message doesn&#39;t mean NeoMutt is aborting</span></div><div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;<span class="comment">       sending the mail too.</span></div><div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;<span class="comment">       %s is the full mailbox URL, including imap(s)://</span></div><div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;    <a class="code" href="logging_8h.html#acc1fd6d7ab1603e80e11e84e90d061e4">mutt_error</a>(<a class="code" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Skipping Fcc to %s&quot;</span>), <a class="code" href="buffer_8h.html#a4aca040fb75bc1dfc086cbfbf14ac8cd">mutt_buffer_string</a>(fcc));</div><div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;    <a class="code" href="buffer_8c.html#adb26acff5f6b9bb7c322669bcb7c48e3">mutt_buffer_reset</a>(fcc);</div><div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;    <span class="keywordflow">return</span> rc;</div><div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;  }</div><div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;</div><div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="buffer_8c.html#a2d7c4a32422377609be66b0f620c4971">mutt_buffer_is_empty</a>(fcc) || <a class="code" href="mutt_2string_8c.html#a6b6a50296dd2a31863a43379ef4a343d">mutt_str_equal</a>(<span class="stringliteral">&quot;/dev/null&quot;</span>, <a class="code" href="buffer_8h.html#a4aca040fb75bc1dfc086cbfbf14ac8cd">mutt_buffer_string</a>(fcc)))</div><div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;    <span class="keywordflow">return</span> rc;</div><div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;</div><div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;  <span class="keyword">struct </span><a class="code" href="structBody.html">Body</a> *tmpbody = e-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>;</div><div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;  <span class="keyword">struct </span><a class="code" href="structBody.html">Body</a> *save_sig = NULL;</div><div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;  <span class="keyword">struct </span><a class="code" href="structBody.html">Body</a> *save_parts = NULL;</div><div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;</div><div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> c_fcc_before_send = <a class="code" href="helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(sub, <span class="stringliteral">&quot;fcc_before_send&quot;</span>);</div><div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;  <span class="comment">/* Before sending, we don&#39;t allow message manipulation because it</span></div><div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;<span class="comment">   * will break message signatures.  This is especially complicated by</span></div><div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;<span class="comment">   * Protected Headers. */</span></div><div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;  <span class="keywordflow">if</span> (!c_fcc_before_send)</div><div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;  {</div><div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> c_fcc_clear = <a class="code" href="helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(sub, <span class="stringliteral">&quot;fcc_clear&quot;</span>);</div><div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> != 0) &amp;&amp;</div><div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;        (e-&gt;<a class="code" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> &amp; (<a class="code" href="ncrypt_2lib_8h.html#aacaa4abd4c0696e260b7a0f1d466360a">SEC_ENCRYPT</a> | <a class="code" href="ncrypt_2lib_8h.html#ae12c003463c99d28f65f1d6b8b053b2c">SEC_SIGN</a> | <a class="code" href="ncrypt_2lib_8h.html#a0b36be5c32ca90d8f2caef9ea9d627fc">SEC_AUTOCRYPT</a>)) &amp;&amp; c_fcc_clear)</div><div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;    {</div><div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;      e-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a> = clear_content;</div><div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;      e-&gt;<a class="code" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> &amp;= ~(<a class="code" href="ncrypt_2lib_8h.html#aacaa4abd4c0696e260b7a0f1d466360a">SEC_ENCRYPT</a> | <a class="code" href="ncrypt_2lib_8h.html#ae12c003463c99d28f65f1d6b8b053b2c">SEC_SIGN</a> | <a class="code" href="ncrypt_2lib_8h.html#a0b36be5c32ca90d8f2caef9ea9d627fc">SEC_AUTOCRYPT</a>);</div><div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;      <a class="code" href="email_2envelope_8c.html#a244dacf9b1001c9ce1dbd473e001381f">mutt_env_free</a>(&amp;e-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>-&gt;<a class="code" href="structBody.html#a62f6c9b4245ed3b6b9296adb45aa4010">mime_headers</a>);</div><div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;    }</div><div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;</div><div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;    <span class="keyword">const</span> <span class="keyword">enum</span> <a class="code" href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35db">QuadOption</a> c_fcc_attach = <a class="code" href="helpers_8c.html#a9154ba713ce99b0937f475eec7c61af9">cs_subset_quad</a>(sub, <span class="stringliteral">&quot;fcc_attach&quot;</span>);</div><div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;</div><div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;    <span class="comment">/* check to see if the user wants copies of all attachments */</span></div><div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;    <span class="keywordtype">bool</span> save_atts = <span class="keyword">true</span>;</div><div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;    <span class="keywordflow">if</span> (e-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>-&gt;<a class="code" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a> == <a class="code" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79a877e24e62c85f20ff0e0f09ab983031e">TYPE_MULTIPART</a>)</div><div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;    {</div><div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;      <span class="comment">/* In batch mode, save attachments if the quadoption is yes or ask-yes */</span></div><div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;      <span class="keywordflow">if</span> (flags &amp; SEND_BATCH)</div><div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;      {</div><div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;        <span class="keywordflow">if</span> ((c_fcc_attach == <a class="code" href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35dbabe3800cc419f25384aaf1892fc3c812b">MUTT_NO</a>) || (c_fcc_attach == <a class="code" href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35dbaaf90604c0e1430d5002944c93ac46952">MUTT_ASKNO</a>))</div><div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;          save_atts = <span class="keyword">false</span>;</div><div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;      }</div><div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="question_2lib_8h.html#ab02047769214ff014b9a8a1782babadc">query_quadoption</a>(c_fcc_attach, <a class="code" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Save attachments in Fcc?&quot;</span>)) != <a class="code" href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35dbafee7088606c4724651c799a6a0b182b7">MUTT_YES</a>)</div><div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;        save_atts = <span class="keyword">false</span>;</div><div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;    }</div><div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;    <span class="keywordflow">if</span> (!save_atts)</div><div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;    {</div><div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;      <span class="keywordflow">if</span> ((<a class="code" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> != 0) &amp;&amp; (e-&gt;<a class="code" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> &amp; (<a class="code" href="ncrypt_2lib_8h.html#aacaa4abd4c0696e260b7a0f1d466360a">SEC_ENCRYPT</a> | <a class="code" href="ncrypt_2lib_8h.html#ae12c003463c99d28f65f1d6b8b053b2c">SEC_SIGN</a> | <a class="code" href="ncrypt_2lib_8h.html#a0b36be5c32ca90d8f2caef9ea9d627fc">SEC_AUTOCRYPT</a>)) &amp;&amp;</div><div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;          (<a class="code" href="mutt_2string_8c.html#a6b6a50296dd2a31863a43379ef4a343d">mutt_str_equal</a>(e-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>-&gt;<a class="code" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>, <span class="stringliteral">&quot;encrypted&quot;</span>) ||</div><div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;           <a class="code" href="mutt_2string_8c.html#a6b6a50296dd2a31863a43379ef4a343d">mutt_str_equal</a>(e-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>-&gt;<a class="code" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>, <span class="stringliteral">&quot;signed&quot;</span>)))</div><div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;      {</div><div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;        <span class="keywordflow">if</span> ((clear_content-&gt;<a class="code" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a> == <a class="code" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79a877e24e62c85f20ff0e0f09ab983031e">TYPE_MULTIPART</a>) &amp;&amp;</div><div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;            (<a class="code" href="question_2lib_8h.html#ab02047769214ff014b9a8a1782babadc">query_quadoption</a>(c_fcc_attach, <a class="code" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Save attachments in Fcc?&quot;</span>)) == <a class="code" href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35dbabe3800cc419f25384aaf1892fc3c812b">MUTT_NO</a>))</div><div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;        {</div><div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;          <span class="keywordflow">if</span> (!(e-&gt;<a class="code" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> &amp; <a class="code" href="ncrypt_2lib_8h.html#aacaa4abd4c0696e260b7a0f1d466360a">SEC_ENCRYPT</a>) &amp;&amp; (e-&gt;<a class="code" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> &amp; <a class="code" href="ncrypt_2lib_8h.html#ae12c003463c99d28f65f1d6b8b053b2c">SEC_SIGN</a>))</div><div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;          {</div><div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;            <span class="comment">/* save initial signature and attachments */</span></div><div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;            save_sig = e-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>-&gt;<a class="code" href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">parts</a>-&gt;<a class="code" href="structBody.html#ac55cdfce46eed13151dcfe9b329d254c">next</a>;</div><div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;            save_parts = clear_content-&gt;<a class="code" href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">parts</a>-&gt;<a class="code" href="structBody.html#ac55cdfce46eed13151dcfe9b329d254c">next</a>;</div><div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;          }</div><div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;</div><div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;          <span class="comment">/* this means writing only the main part */</span></div><div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;          e-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a> = clear_content-&gt;<a class="code" href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">parts</a>;</div><div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;</div><div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="crypt_8c.html#afb7fbdc0157b9f7fd68b378232d554fc">mutt_protect</a>(m, e, pgpkeylist, <span class="keyword">false</span>) == -1)</div><div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;          {</div><div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;            <span class="comment">/* we can&#39;t do much about it at this point, so</span></div><div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;<span class="comment">           * fallback to saving the whole thing to fcc */</span></div><div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;            e-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a> = tmpbody;</div><div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;            save_sig = NULL;</div><div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;            <span class="keywordflow">goto</span> full_fcc;</div><div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;          }</div><div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;</div><div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;          save_content = e-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>;</div><div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;        }</div><div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;      }</div><div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;      {</div><div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="question_2lib_8h.html#ab02047769214ff014b9a8a1782babadc">query_quadoption</a>(c_fcc_attach, <a class="code" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Save attachments in Fcc?&quot;</span>)) == <a class="code" href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35dbabe3800cc419f25384aaf1892fc3c812b">MUTT_NO</a>)</div><div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;          e-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a> = e-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>-&gt;<a class="code" href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">parts</a>;</div><div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;      }</div><div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;    }</div><div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;  }</div><div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;</div><div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;full_fcc:</div><div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;  <span class="keywordflow">if</span> (e-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>)</div><div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;  {</div><div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;    <span class="comment">/* update received time so that when storing to a mbox-style folder</span></div><div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;<span class="comment">     * the From_ line contains the current time instead of when the</span></div><div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;<span class="comment">     * message was first postponed.  */</span></div><div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;    e-&gt;<a class="code" href="structEmail.html#af64bcf33ccd8b0ba248fc8d427c21264">received</a> = <a class="code" href="date_8c.html#a97bacb1574ec0b1c69b6236fbacceccf">mutt_date_epoch</a>();</div><div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;    rc = <a class="code" href="sendlib_8c.html#a8957ce367f6683e839e4ddb7245d466c">mutt_write_multiple_fcc</a>(<a class="code" href="buffer_8h.html#a4aca040fb75bc1dfc086cbfbf14ac8cd">mutt_buffer_string</a>(fcc), e, NULL, <span class="keyword">false</span>, NULL,</div><div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;                                 finalpath, sub);</div><div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;    <span class="keywordflow">while</span> (rc &amp;&amp; !(flags &amp; SEND_BATCH))</div><div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;    {</div><div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;      <a class="code" href="mutt__logging_8c.html#af068b3f524a31fad293b2fb61dfc4534">mutt_clear_error</a>();</div><div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;      <span class="keywordtype">int</span> choice = <a class="code" href="question_2lib_8h.html#a95d1cd189641185a743df0397ea072c8">mutt_multi_choice</a>(</div><div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;          <span class="comment">/* L10N: Called when saving to $record or Fcc failed after sending.</span></div><div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;<span class="comment">             (r)etry tries the same mailbox again.</span></div><div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;<span class="comment">             alternate (m)ailbox prompts for a different mailbox to try.</span></div><div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;<span class="comment">             (s)kip aborts saving.  */</span></div><div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;          <a class="code" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Fcc failed. (r)etry, alternate (m)ailbox, or (s)kip?&quot;</span>),</div><div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;          <span class="comment">/* L10N: These correspond to the &quot;Fcc failed&quot; multi-choice prompt</span></div><div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;<span class="comment">             (r)etry, alternate (m)ailbox, or (s)kip.</span></div><div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;<span class="comment">             Any similarity to famous leaders of the FSF is coincidental.  */</span></div><div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;          <a class="code" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;rms&quot;</span>));</div><div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;      <span class="keywordflow">switch</span> (choice)</div><div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;      {</div><div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;        <span class="keywordflow">case</span> 2: <span class="comment">/* alternate (m)ailbox */</span></div><div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;          <span class="comment">/* L10N: This is the prompt to enter an &quot;alternate (m)ailbox&quot; when the</span></div><div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;<span class="comment">             initial Fcc fails.  */</span></div><div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;          rc = <a class="code" href="curs__lib_8c.html#a8323a2c35930da81a8f0c63545537839">mutt_buffer_enter_fname</a>(<a class="code" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Fcc mailbox&quot;</span>), fcc, <span class="keyword">true</span>, m, <span class="keyword">false</span>,</div><div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;                                       NULL, NULL, <a class="code" href="browser_8h.html#aef17206dea5302001a39f3c633e731d3">MUTT_SEL_NO_FLAGS</a>);</div><div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;          <span class="keywordflow">if</span> ((rc == -1) || <a class="code" href="buffer_8c.html#a2d7c4a32422377609be66b0f620c4971">mutt_buffer_is_empty</a>(fcc))</div><div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;          {</div><div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;            rc = 0;</div><div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;          }</div><div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;          <span class="comment">/* fall through */</span></div><div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;</div><div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;        <span class="keywordflow">case</span> 1: <span class="comment">/* (r)etry */</span></div><div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;          rc = <a class="code" href="sendlib_8c.html#a8957ce367f6683e839e4ddb7245d466c">mutt_write_multiple_fcc</a>(<a class="code" href="buffer_8h.html#a4aca040fb75bc1dfc086cbfbf14ac8cd">mutt_buffer_string</a>(fcc), e, NULL, <span class="keyword">false</span>,</div><div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;                                       NULL, finalpath, sub);</div><div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;          <span class="keywordflow">break</span>;</div><div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;</div><div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;        <span class="keywordflow">case</span> -1: <span class="comment">/* abort */</span></div><div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;        <span class="keywordflow">case</span> 3:  <span class="comment">/* (s)kip */</span></div><div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;          rc = 0;</div><div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;          <span class="keywordflow">break</span>;</div><div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;      }</div><div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;    }</div><div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;  }</div><div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;</div><div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;  <span class="keywordflow">if</span> (!c_fcc_before_send)</div><div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;  {</div><div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;    e-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a> = tmpbody;</div><div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;</div><div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> != 0) &amp;&amp; save_sig)</div><div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;    {</div><div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;      <span class="comment">/* cleanup the second signature structures */</span></div><div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;      <span class="keywordflow">if</span> (save_content-&gt;<a class="code" href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">parts</a>)</div><div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;      {</div><div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;        <a class="code" href="email_2body_8c.html#a129af1c316fcbc26b55fb48957bab2cb">mutt_body_free</a>(&amp;save_content-&gt;<a class="code" href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">parts</a>-&gt;<a class="code" href="structBody.html#ac55cdfce46eed13151dcfe9b329d254c">next</a>);</div><div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;        save_content-&gt;<a class="code" href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">parts</a> = NULL;</div><div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;      }</div><div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;      <a class="code" href="email_2body_8c.html#a129af1c316fcbc26b55fb48957bab2cb">mutt_body_free</a>(&amp;save_content);</div><div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;</div><div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;      <span class="comment">/* restore old signature and attachments */</span></div><div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;      e-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>-&gt;<a class="code" href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">parts</a>-&gt;<a class="code" href="structBody.html#ac55cdfce46eed13151dcfe9b329d254c">next</a> = save_sig;</div><div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;      e-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>-&gt;<a class="code" href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">parts</a>-&gt;<a class="code" href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">parts</a>-&gt;<a class="code" href="structBody.html#ac55cdfce46eed13151dcfe9b329d254c">next</a> = save_parts;</div><div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;    }</div><div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((<a class="code" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> != 0) &amp;&amp; save_content)</div><div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;    {</div><div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;      <span class="comment">/* destroy the new encrypted body. */</span></div><div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;      <a class="code" href="email_2body_8c.html#a129af1c316fcbc26b55fb48957bab2cb">mutt_body_free</a>(&amp;save_content);</div><div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;    }</div><div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;  }</div><div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;</div><div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;}</div><div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;</div><div class="line"><a name="l01945"></a><span class="lineno"><a class="line" href="send_8c.html#a08794ff2edb022ef0c0f59086da9675f"> 1945</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="send_8c.html#a08794ff2edb022ef0c0f59086da9675f">postpone_message</a>(<span class="keyword">struct</span> <a class="code" href="structEmail.html">Email</a> *e_post, <span class="keyword">struct</span> <a class="code" href="structEmail.html">Email</a> *e_cur,</div><div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;                            <span class="keyword">const</span> <span class="keywordtype">char</span> *fcc, <a class="code" href="send_8h.html#af731a62ddd44f1d907196beef8f8f19f">SendFlags</a> flags, <span class="keyword">struct</span> <a class="code" href="structConfigSubset.html">ConfigSubset</a> *sub)</div><div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;{</div><div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;  <span class="keywordtype">char</span> *pgpkeylist = NULL;</div><div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *encrypt_as = NULL;</div><div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;  <span class="keyword">struct </span><a class="code" href="structBody.html">Body</a> *clear_content = NULL;</div><div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;  <span class="keyword">struct </span><a class="code" href="structMailbox.html">Mailbox</a> *m = <a class="code" href="context_8c.html#a3d99ae9e3203ce327227f9ab3f711427">ctx_mailbox</a>(<a class="code" href="structContext.html">Context</a>);</div><div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;</div><div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keyword">const</span> c_postponed = <a class="code" href="helpers_8c.html#ac477c591155aa4ae0452bbabc0affffe">cs_subset_string</a>(sub, <span class="stringliteral">&quot;postponed&quot;</span>);</div><div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;  <span class="keywordflow">if</span> (!c_postponed)</div><div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;  {</div><div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;    <a class="code" href="logging_8h.html#acc1fd6d7ab1603e80e11e84e90d061e4">mutt_error</a>(<a class="code" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Can&#39;t postpone.  $postponed is unset&quot;</span>));</div><div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;  }</div><div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;</div><div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;  <span class="keywordflow">if</span> (e_post-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>-&gt;<a class="code" href="structBody.html#ac55cdfce46eed13151dcfe9b329d254c">next</a>)</div><div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;    e_post-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a> = <a class="code" href="multipart_8c.html#a336393521f79b3158f5da26385f20103">mutt_make_multipart</a>(e_post-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>);</div><div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;</div><div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;  <a class="code" href="send_8c.html#a1ba9ce78a67261e872a264bc956ef857">mutt_encode_descriptions</a>(e_post-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>, <span class="keyword">true</span>, sub);</div><div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;</div><div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> c_postpone_encrypt = <a class="code" href="helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(sub, <span class="stringliteral">&quot;postpone_encrypt&quot;</span>);</div><div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;  <span class="keywordflow">if</span> ((<a class="code" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> != 0) &amp;&amp; c_postpone_encrypt &amp;&amp;</div><div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;      (e_post-&gt;<a class="code" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> &amp; (<a class="code" href="ncrypt_2lib_8h.html#aacaa4abd4c0696e260b7a0f1d466360a">SEC_ENCRYPT</a> | <a class="code" href="ncrypt_2lib_8h.html#a0b36be5c32ca90d8f2caef9ea9d627fc">SEC_AUTOCRYPT</a>)))</div><div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;  {</div><div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;    <span class="keywordflow">if</span> (((<a class="code" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a>) != 0) &amp;&amp; (e_post-&gt;<a class="code" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> &amp; APPLICATION_PGP))</div><div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;    {</div><div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keyword">const</span> c_pgp_default_key =</div><div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;          <a class="code" href="helpers_8c.html#ac477c591155aa4ae0452bbabc0affffe">cs_subset_string</a>(sub, <span class="stringliteral">&quot;pgp_default_key&quot;</span>);</div><div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;      encrypt_as = c_pgp_default_key;</div><div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;    }</div><div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (((<a class="code" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code" href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a>) != 0) &amp;&amp; (e_post-&gt;<a class="code" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> &amp; APPLICATION_SMIME))</div><div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;    {</div><div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keyword">const</span> c_smime_default_key =</div><div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;          <a class="code" href="helpers_8c.html#ac477c591155aa4ae0452bbabc0affffe">cs_subset_string</a>(sub, <span class="stringliteral">&quot;smime_default_key&quot;</span>);</div><div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;      encrypt_as = c_smime_default_key;</div><div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;    }</div><div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;    <span class="keywordflow">if</span> (!encrypt_as)</div><div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;    {</div><div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keyword">const</span> c_postpone_encrypt_as =</div><div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;          <a class="code" href="helpers_8c.html#ac477c591155aa4ae0452bbabc0affffe">cs_subset_string</a>(sub, <span class="stringliteral">&quot;postpone_encrypt_as&quot;</span>);</div><div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;      encrypt_as = c_postpone_encrypt_as;</div><div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;    }</div><div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;</div><div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;<span class="preprocessor">#ifdef USE_AUTOCRYPT</span></div><div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;    <span class="keywordflow">if</span> (e_post-&gt;<a class="code" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> &amp; <a class="code" href="ncrypt_2lib_8h.html#a0b36be5c32ca90d8f2caef9ea9d627fc">SEC_AUTOCRYPT</a>)</div><div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;    {</div><div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="autocrypt_8c.html#a23ccdf8d23c4c9ec7f9517e5d2942429">mutt_autocrypt_set_sign_as_default_key</a>(m, e_post))</div><div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;      {</div><div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;        e_post-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a> = <a class="code" href="multipart_8c.html#a71d5ccd20fbbbe2fa56e6d1f577e34ae">mutt_remove_multipart</a>(e_post-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>);</div><div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;        <a class="code" href="send_8c.html#af1b54154700865964598299ed1cf9a6a">decode_descriptions</a>(e_post-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>);</div><div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;        <a class="code" href="logging_8h.html#acc1fd6d7ab1603e80e11e84e90d061e4">mutt_error</a>(<a class="code" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Error encrypting message. Check your crypt settings.&quot;</span>));</div><div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;        <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;      }</div><div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;      encrypt_as = <a class="code" href="autocrypt_2config_8c.html#a933b5108398b46e2aadfe51b4ce466a7">AutocryptDefaultKey</a>;</div><div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;    }</div><div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;</div><div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;    <span class="keywordflow">if</span> (encrypt_as)</div><div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;    {</div><div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;      pgpkeylist = <a class="code" href="mutt_2string_8c.html#a4c2560f787bd1226b977992c16860c98">mutt_str_dup</a>(encrypt_as);</div><div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;      clear_content = e_post-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>;</div><div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="crypt_8c.html#afb7fbdc0157b9f7fd68b378232d554fc">mutt_protect</a>(m, e_post, pgpkeylist, <span class="keyword">true</span>) == -1)</div><div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;      {</div><div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;        <a class="code" href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;pgpkeylist);</div><div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;        e_post-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a> = <a class="code" href="multipart_8c.html#a71d5ccd20fbbbe2fa56e6d1f577e34ae">mutt_remove_multipart</a>(e_post-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>);</div><div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;        <a class="code" href="send_8c.html#af1b54154700865964598299ed1cf9a6a">decode_descriptions</a>(e_post-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>);</div><div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;        <a class="code" href="logging_8h.html#acc1fd6d7ab1603e80e11e84e90d061e4">mutt_error</a>(<a class="code" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Error encrypting message. Check your crypt settings.&quot;</span>));</div><div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;        <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;      }</div><div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;</div><div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;      <a class="code" href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;pgpkeylist);</div><div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;</div><div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;      <a class="code" href="send_8c.html#a1ba9ce78a67261e872a264bc956ef857">mutt_encode_descriptions</a>(e_post-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>, <span class="keyword">false</span>, sub);</div><div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;    }</div><div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;  }</div><div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;</div><div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;  <span class="comment">/* make sure the message is written to the right part of a maildir</span></div><div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;<span class="comment">   * postponed folder.  */</span></div><div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;  e_post-&gt;<a class="code" href="structEmail.html#a0bd79550be901d44e50953fb43614e10">read</a> = <span class="keyword">false</span>;</div><div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;  e_post-&gt;<a class="code" href="structEmail.html#a6d9062408a8c89b19cf25584dd2ffb57">old</a> = <span class="keyword">false</span>;</div><div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;</div><div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;  <a class="code" href="sendlib_8c.html#ac35da3d19eb0d95d4f6260adab57b4c9">mutt_prepare_envelope</a>(e_post-&gt;<a class="code" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>, <span class="keyword">false</span>, sub);</div><div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;  <a class="code" href="email_2envelope_8c.html#a0108f989ca58622df272cf31b610395e">mutt_env_to_intl</a>(e_post-&gt;<a class="code" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>, NULL, NULL); <span class="comment">/* Handle bad IDNAs the next time. */</span></div><div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;</div><div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="sendlib_8c.html#acd4f22db21ca81a6a845ffe6888d141f">mutt_write_fcc</a>(<a class="code" href="string2_8h.html#a7e0481bed27661ea2679f256b24e0283">NONULL</a>(c_postponed), e_post,</div><div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;                     (e_cur &amp;&amp; (flags &amp; <a class="code" href="send_8h.html#ac23e1891bcbc52cc25b5824acfb42d3c">SEND_REPLY</a>)) ? e_cur-&gt;<a class="code" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code" href="structEnvelope.html#a50418c13a849bf27b22922bd5867e5e1">message_id</a> : NULL,</div><div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;                     <span class="keyword">true</span>, fcc, NULL, sub) &lt; 0)</div><div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;  {</div><div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;    <span class="keywordflow">if</span> (clear_content)</div><div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;    {</div><div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;      <a class="code" href="email_2body_8c.html#a129af1c316fcbc26b55fb48957bab2cb">mutt_body_free</a>(&amp;e_post-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>);</div><div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;      e_post-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a> = clear_content;</div><div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;    }</div><div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;    <a class="code" href="email_2envelope_8c.html#a244dacf9b1001c9ce1dbd473e001381f">mutt_env_free</a>(&amp;e_post-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>-&gt;<a class="code" href="structBody.html#a62f6c9b4245ed3b6b9296adb45aa4010">mime_headers</a>); <span class="comment">/* protected headers */</span></div><div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;    e_post-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a> = <a class="code" href="multipart_8c.html#a71d5ccd20fbbbe2fa56e6d1f577e34ae">mutt_remove_multipart</a>(e_post-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>);</div><div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;    <a class="code" href="send_8c.html#af1b54154700865964598299ed1cf9a6a">decode_descriptions</a>(e_post-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>);</div><div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;    <a class="code" href="sendlib_8c.html#a99b5cff5076c9e25bce367f0bae45f4c">mutt_unprepare_envelope</a>(e_post-&gt;<a class="code" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>);</div><div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;  }</div><div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;</div><div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;  <a class="code" href="postpone_8c.html#a6d6fb2f03b78be714443316f335c90ae">mutt_update_num_postponed</a>();</div><div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;</div><div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;  <span class="keywordflow">if</span> (clear_content)</div><div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;    <a class="code" href="email_2body_8c.html#a129af1c316fcbc26b55fb48957bab2cb">mutt_body_free</a>(&amp;clear_content);</div><div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;</div><div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;}</div><div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;</div><div class="line"><a name="l02059"></a><span class="lineno"><a class="line" href="send_8c.html#adaad7f2e93eb41299f638d224d90f82b"> 2059</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="send_8c.html#adaad7f2e93eb41299f638d224d90f82b">is_text_plain</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structBody.html">Body</a> *b)</div><div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;{</div><div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;  <span class="keywordflow">return</span> (b-&gt;<a class="code" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a> == <a class="code" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79ad88e88afaec507209421bba20aeeb167">TYPE_TEXT</a>) &amp;&amp; <a class="code" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(b-&gt;<a class="code" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>, <span class="stringliteral">&quot;plain&quot;</span>);</div><div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;}</div><div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;</div><div class="line"><a name="l02070"></a><span class="lineno"><a class="line" href="send_8c.html#aad5805f2620506ae4bc2d7f6474cb849"> 2070</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="send_8c.html#aad5805f2620506ae4bc2d7f6474cb849">abort_for_missing_attachments</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structBody.html">Body</a> *b, <span class="keyword">struct</span> <a class="code" href="structConfigSubset.html">ConfigSubset</a> *<a class="code" href="structMailbox.html#afbd00b44dedabb87c3b86042287a812a">sub</a>)</div><div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;{</div><div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;  <span class="keyword">const</span> <span class="keyword">enum</span> <a class="code" href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35db">QuadOption</a> c_abort_noattach =</div><div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;      <a class="code" href="helpers_8c.html#a9154ba713ce99b0937f475eec7c61af9">cs_subset_quad</a>(sub, <span class="stringliteral">&quot;abort_noattach&quot;</span>);</div><div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;</div><div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;  <span class="keywordflow">if</span> (c_abort_noattach == <a class="code" href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35dbabe3800cc419f25384aaf1892fc3c812b">MUTT_NO</a>)</div><div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;</div><div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;  <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structBody.html#ac55cdfce46eed13151dcfe9b329d254c">next</a>)</div><div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;</div><div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;  <span class="keywordtype">bool</span> has_keyword = <span class="keyword">false</span>;</div><div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;</div><div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;  <span class="comment">/* search text/plain parts, whether they are main or alternative parts */</span></div><div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="send_8c.html#adaad7f2e93eb41299f638d224d90f82b">is_text_plain</a>(b))</div><div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;  {</div><div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;    has_keyword |= <a class="code" href="send_8c.html#ad829e8c88d7630a8a6ed719378dd4570">search_attach_keyword</a>(b-&gt;<a class="code" href="structBody.html#afe3cd2c4b1070e3d0edbf1fed939ac5a">filename</a>, sub);</div><div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;  }</div><div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;  {</div><div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;    <span class="keywordflow">for</span> (b = b-&gt;<a class="code" href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">parts</a>; b; b = b-&gt;<a class="code" href="structBody.html#ac55cdfce46eed13151dcfe9b329d254c">next</a>)</div><div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;    {</div><div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="send_8c.html#adaad7f2e93eb41299f638d224d90f82b">is_text_plain</a>(b))</div><div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;      {</div><div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;        has_keyword |= <a class="code" href="send_8c.html#ad829e8c88d7630a8a6ed719378dd4570">search_attach_keyword</a>(b-&gt;<a class="code" href="structBody.html#afe3cd2c4b1070e3d0edbf1fed939ac5a">filename</a>, sub);</div><div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;      }</div><div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;    }</div><div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;  }</div><div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;</div><div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;  <span class="keywordflow">if</span> (!has_keyword)</div><div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;</div><div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;  <span class="keywordflow">if</span> (c_abort_noattach == <a class="code" href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35dbafee7088606c4724651c799a6a0b182b7">MUTT_YES</a>)</div><div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;  {</div><div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;    <a class="code" href="logging_8h.html#acc1fd6d7ab1603e80e11e84e90d061e4">mutt_error</a>(<a class="code" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Message contains text matching \&quot;$abort_noattach_regex\&quot;. &quot;</span></div><div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;                 <span class="stringliteral">&quot;Not sending.&quot;</span>));</div><div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;  }</div><div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;</div><div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="question_2lib_8h.html#ab02047769214ff014b9a8a1782babadc">query_quadoption</a>(c_abort_noattach,</div><div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;                          <a class="code" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;No attachments, cancel sending?&quot;</span>)) != <a class="code" href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35dbabe3800cc419f25384aaf1892fc3c812b">MUTT_NO</a>;</div><div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;}</div><div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;</div><div class="line"><a name="l02125"></a><span class="lineno"><a class="line" href="send_8h.html#a886452bec277bd3e4169d0863b7768ae"> 2125</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="send_8c.html#a886452bec277bd3e4169d0863b7768ae">mutt_send_message</a>(<a class="code" href="send_8h.html#af731a62ddd44f1d907196beef8f8f19f">SendFlags</a> <a class="code" href="structMailbox.html#af35ab91f4bcebac7a06a1b0aae9dc4e7">flags</a>, <span class="keyword">struct</span> <a class="code" href="structEmail.html">Email</a> *e_templ, <span class="keyword">const</span> <span class="keywordtype">char</span> *tempfile,</div><div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;                      <span class="keyword">struct</span> <a class="code" href="structMailbox.html">Mailbox</a> *m, <span class="keyword">struct</span> EmailList *el, <span class="keyword">struct</span> <a class="code" href="structConfigSubset.html">ConfigSubset</a> *<a class="code" href="structMailbox.html#afbd00b44dedabb87c3b86042287a812a">sub</a>)</div><div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;{</div><div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;  <span class="keywordtype">char</span> buf[1024];</div><div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;  <span class="keyword">struct </span><a class="code" href="structBuffer.html">Buffer</a> fcc = <a class="code" href="buffer_8c.html#a0242aaa9a400d0722a99828776c0403b">mutt_buffer_make</a>(0); <span class="comment">/* where to copy this message */</span></div><div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;  FILE *fp_tmp = NULL;</div><div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;  <span class="keyword">struct </span><a class="code" href="structBody.html">Body</a> *pbody = NULL;</div><div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;  <span class="keywordtype">int</span> i;</div><div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;  <span class="keywordtype">bool</span> free_clear_content = <span class="keyword">false</span>;</div><div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;</div><div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;  <span class="keyword">struct </span><a class="code" href="structBody.html">Body</a> *clear_content = NULL;</div><div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;  <span class="keywordtype">char</span> *pgpkeylist = NULL;</div><div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;  <span class="comment">/* save current value of &quot;pgp_sign_as&quot;  and &quot;smime_default_key&quot; */</span></div><div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;  <span class="keywordtype">char</span> *pgp_sign_as = NULL;</div><div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;  <span class="keywordtype">char</span> *smime_sign_as = NULL;</div><div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *tag = NULL;</div><div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;  <span class="keywordtype">char</span> *err = NULL;</div><div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;  <span class="keywordtype">char</span> *ctype = NULL;</div><div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;  <span class="keywordtype">char</span> *finalpath = NULL;</div><div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;  <span class="keyword">struct </span><a class="code" href="structEmailNode.html">EmailNode</a> *en = NULL;</div><div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;  <span class="keyword">struct </span><a class="code" href="structEmail.html">Email</a> *e_cur = NULL;</div><div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;</div><div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;  <span class="keywordflow">if</span> (el)</div><div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;    en = <a class="code" href="queue_8h.html#a3e2eb7535019a2829399b24744dd1a66">STAILQ_FIRST</a>(el);</div><div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;  <span class="keywordflow">if</span> (en)</div><div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;    e_cur = <a class="code" href="queue_8h.html#ad89ac472696d006112dface9c2d75e47">STAILQ_NEXT</a>(en, entries) ? NULL : en-&gt;<a class="code" href="structEmailNode.html#a812e5a33b27b12a78daacbe246089abb">email</a>;</div><div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;</div><div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;  <span class="keywordtype">int</span> rc = -1;</div><div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;</div><div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;<span class="preprocessor">#ifdef USE_NNTP</span></div><div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;  <span class="keywordflow">if</span> (flags &amp; <a class="code" href="send_8h.html#ae31498a0e61355a0b4ece8f0c89daf49">SEND_NEWS</a>)</div><div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;    <a class="code" href="options_8h.html#affdfc25e31602911d236c7d283865f1c">OptNewsSend</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;    <a class="code" href="options_8h.html#affdfc25e31602911d236c7d283865f1c">OptNewsSend</a> = <span class="keyword">false</span>;</div><div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;</div><div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;  <span class="keyword">const</span> <span class="keyword">enum</span> <a class="code" href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35db">QuadOption</a> c_recall = <a class="code" href="helpers_8c.html#a9154ba713ce99b0937f475eec7c61af9">cs_subset_quad</a>(sub, <span class="stringliteral">&quot;recall&quot;</span>);</div><div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;</div><div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;  <span class="keywordflow">if</span> (!flags &amp;&amp; !e_templ &amp;&amp; (c_recall != <a class="code" href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35dbabe3800cc419f25384aaf1892fc3c812b">MUTT_NO</a>) &amp;&amp; <a class="code" href="postpone_8c.html#a42853d2d4da10271644dc7083ae1c453">mutt_num_postponed</a>(m, <span class="keyword">true</span>))</div><div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;  {</div><div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;    <span class="comment">/* If the user is composing a new message, check to see if there</span></div><div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;<span class="comment">     * are any postponed messages first.  */</span></div><div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;    <span class="keyword">enum</span> <a class="code" href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35db">QuadOption</a> ans =</div><div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;        <a class="code" href="question_2lib_8h.html#ab02047769214ff014b9a8a1782babadc">query_quadoption</a>(c_recall, <a class="code" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Recall postponed message?&quot;</span>));</div><div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;    <span class="keywordflow">if</span> (ans == <a class="code" href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35dbaaa75b5db14c0aed1fde665034f113339">MUTT_ABORT</a>)</div><div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;      <span class="keywordflow">return</span> rc;</div><div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;</div><div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;    <span class="keywordflow">if</span> (ans == <a class="code" href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35dbafee7088606c4724651c799a6a0b182b7">MUTT_YES</a>)</div><div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;      flags |= <a class="code" href="send_8h.html#a819cb72f23fd5b12401baf2963bc694f">SEND_POSTPONED</a>;</div><div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;  }</div><div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;</div><div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;  <span class="comment">/* Allocate the buffer due to the long lifetime, but</span></div><div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;<span class="comment">   * pre-resize it to ensure there are no NULL data field issues */</span></div><div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;  <a class="code" href="buffer_8c.html#a2837f43a0e59e6cf2f83f23c81e53498">mutt_buffer_alloc</a>(&amp;fcc, 1024);</div><div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;</div><div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;  <span class="keywordflow">if</span> (flags &amp; <a class="code" href="send_8h.html#a819cb72f23fd5b12401baf2963bc694f">SEND_POSTPONED</a>)</div><div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;  {</div><div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a>)</div><div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;    {</div><div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keyword">const</span> c_pgp_sign_as = <a class="code" href="helpers_8c.html#ac477c591155aa4ae0452bbabc0affffe">cs_subset_string</a>(sub, <span class="stringliteral">&quot;pgp_sign_as&quot;</span>);</div><div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;      pgp_sign_as = <a class="code" href="mutt_2string_8c.html#a4c2560f787bd1226b977992c16860c98">mutt_str_dup</a>(c_pgp_sign_as);</div><div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;    }</div><div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code" href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a>)</div><div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;    {</div><div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keyword">const</span> c_smime_sign_as =</div><div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;          <a class="code" href="helpers_8c.html#ac477c591155aa4ae0452bbabc0affffe">cs_subset_string</a>(sub, <span class="stringliteral">&quot;smime_sign_as&quot;</span>);</div><div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;      smime_sign_as = <a class="code" href="mutt_2string_8c.html#a4c2560f787bd1226b977992c16860c98">mutt_str_dup</a>(c_smime_sign_as);</div><div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;    }</div><div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;  }</div><div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;</div><div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;  <span class="comment">/* Delay expansion of aliases until absolutely necessary--shouldn&#39;t</span></div><div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;<span class="comment">   * be necessary unless we are prompting the user or about to execute a</span></div><div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;<span class="comment">   * send-hook.  */</span></div><div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;</div><div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;  <span class="keywordflow">if</span> (!e_templ)</div><div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;  {</div><div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;    e_templ = <a class="code" href="email_2email_8c.html#a77c9ecff4b23001b81177ffe398bad44">email_new</a>();</div><div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;</div><div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;    <span class="keywordflow">if</span> (flags == SEND_POSTPONED)</div><div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;    {</div><div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;      rc = <a class="code" href="postpone_8c.html#aacde94d20e952e822eac92e0fbf74682">mutt_get_postponed</a>(m, e_templ, &amp;e_cur, &amp;fcc);</div><div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;      <span class="keywordflow">if</span> (rc &lt; 0)</div><div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;      {</div><div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;        flags = <a class="code" href="send_8h.html#a819cb72f23fd5b12401baf2963bc694f">SEND_POSTPONED</a>;</div><div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;        <span class="keywordflow">goto</span> cleanup;</div><div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;      }</div><div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;      flags = rc;</div><div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;<span class="preprocessor">#ifdef USE_NNTP</span></div><div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;      <span class="comment">/* If postponed message is a news article, it have</span></div><div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;<span class="comment">       * a &quot;Newsgroups:&quot; header line, then set appropriate flag.  */</span></div><div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;      <span class="keywordflow">if</span> (e_templ-&gt;<a class="code" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code" href="structEnvelope.html#a5f680f60f1713477a879877dcbd21a5c">newsgroups</a>)</div><div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;      {</div><div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;        flags |= <a class="code" href="send_8h.html#ae31498a0e61355a0b4ece8f0c89daf49">SEND_NEWS</a>;</div><div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;        <a class="code" href="options_8h.html#affdfc25e31602911d236c7d283865f1c">OptNewsSend</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;      }</div><div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;      {</div><div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;        flags &amp;= ~SEND_NEWS;</div><div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;        <a class="code" href="options_8h.html#affdfc25e31602911d236c7d283865f1c">OptNewsSend</a> = <span class="keyword">false</span>;</div><div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;      }</div><div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;    }</div><div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;</div><div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;    <span class="keywordflow">if</span> (flags &amp; (SEND_POSTPONED | <a class="code" href="send_8h.html#abeb38906954f30b89ad58ebbf95ac2b0">SEND_RESEND</a>))</div><div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;    {</div><div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;      fp_tmp = <a class="code" href="file_8c.html#ae1c0c19fec03274220b3ca065ad1e2e5">mutt_file_fopen</a>(e_templ-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>-&gt;<a class="code" href="structBody.html#afe3cd2c4b1070e3d0edbf1fed939ac5a">filename</a>, <span class="stringliteral">&quot;a+&quot;</span>);</div><div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;      <span class="keywordflow">if</span> (!fp_tmp)</div><div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;      {</div><div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;        <a class="code" href="logging_8h.html#afaa521ab22db877ccf1b87e679e1b43e">mutt_perror</a>(e_templ-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>-&gt;<a class="code" href="structBody.html#afe3cd2c4b1070e3d0edbf1fed939ac5a">filename</a>);</div><div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;        <span class="keywordflow">goto</span> cleanup;</div><div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;      }</div><div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;    }</div><div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;</div><div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;    <span class="keywordflow">if</span> (!e_templ-&gt;<a class="code" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>)</div><div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;      e_templ-&gt;<a class="code" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a> = <a class="code" href="email_2envelope_8c.html#a51f04365c2b348d829e7cd3710c55b5b">mutt_env_new</a>();</div><div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;  }</div><div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;</div><div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;  <span class="comment">/* Parse and use an eventual list-post header */</span></div><div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;  <span class="keywordflow">if</span> ((flags &amp; <a class="code" href="send_8h.html#a54e225c19799cf682ef8228825dbb3d8">SEND_LIST_REPLY</a>) &amp;&amp; e_cur &amp;&amp; e_cur-&gt;<a class="code" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a> &amp;&amp; e_cur-&gt;<a class="code" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code" href="structEnvelope.html#ad0b7bb8cf358dd2d5d1dc5733b3f0be1">list_post</a>)</div><div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;  {</div><div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;    <span class="comment">/* Use any list-post header as a template */</span></div><div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;    <a class="code" href="parse_8c.html#a40d55d4be6be11a22f0ac73fe251aa6e">mutt_parse_mailto</a>(e_templ-&gt;<a class="code" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>, NULL, e_cur-&gt;<a class="code" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code" href="structEnvelope.html#ad0b7bb8cf358dd2d5d1dc5733b3f0be1">list_post</a>);</div><div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;    <span class="comment">/* We don&#39;t let them set the sender&#39;s address. */</span></div><div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;    <a class="code" href="address_2address_8c.html#a396bcf6adfff6663096fa6ae99c31c9a">mutt_addrlist_clear</a>(&amp;e_templ-&gt;<a class="code" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code" href="structEnvelope.html#af1aa00aed4b8767cf98f08e45a432ad8">from</a>);</div><div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;  }</div><div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;</div><div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;  <span class="keywordflow">if</span> (!(flags &amp; (<a class="code" href="send_8h.html#a623f46e1bab1e562893dbd01bbbd92dd">SEND_KEY</a> | SEND_POSTPONED | <a class="code" href="send_8h.html#abeb38906954f30b89ad58ebbf95ac2b0">SEND_RESEND</a>)))</div><div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;  {</div><div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;    <span class="comment">/* When SEND_DRAFT_FILE is set, the caller has already</span></div><div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;<span class="comment">     * created the &quot;parent&quot; body structure.  */</span></div><div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;    <span class="keywordflow">if</span> (!(flags &amp; <a class="code" href="send_8h.html#a21bc6948879d93793ca7afac2c7964bb">SEND_DRAFT_FILE</a>))</div><div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;    {</div><div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;      pbody = <a class="code" href="email_2body_8c.html#aee001296b775e82e3988b5a81e53e30c">mutt_body_new</a>();</div><div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;      pbody-&gt;<a class="code" href="structBody.html#ac55cdfce46eed13151dcfe9b329d254c">next</a> = e_templ-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>; <span class="comment">/* don&#39;t kill command-line attachments */</span></div><div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;      e_templ-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a> = pbody;</div><div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;</div><div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keyword">const</span> c_content_type = <a class="code" href="helpers_8c.html#ac477c591155aa4ae0452bbabc0affffe">cs_subset_string</a>(sub, <span class="stringliteral">&quot;content_type&quot;</span>);</div><div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;      ctype = <a class="code" href="mutt_2string_8c.html#a4c2560f787bd1226b977992c16860c98">mutt_str_dup</a>(c_content_type);</div><div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;      <span class="keywordflow">if</span> (!ctype)</div><div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;        ctype = <a class="code" href="mutt_2string_8c.html#a4c2560f787bd1226b977992c16860c98">mutt_str_dup</a>(<span class="stringliteral">&quot;text/plain&quot;</span>);</div><div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;      <a class="code" href="parse_8c.html#a44cbe20da647bd7112cf1f4857ad01a3">mutt_parse_content_type</a>(ctype, e_templ-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>);</div><div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;      <a class="code" href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;ctype);</div><div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;      e_templ-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>-&gt;<a class="code" href="structBody.html#a47191eabf16d34d0deb412c898ed629b">unlink</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;      e_templ-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>-&gt;<a class="code" href="structBody.html#a86721d1d557276cbc9cf69777af8c305">use_disp</a> = <span class="keyword">false</span>;</div><div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;      e_templ-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>-&gt;<a class="code" href="structBody.html#a99aff302b287a47c407a7412a99630f5">disposition</a> = <a class="code" href="mime_8h.html#a5f93dab7807282e699a6bc1b2d18a2d8a691faf938d6b4cec05ea5e03d9dee073">DISP_INLINE</a>;</div><div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;</div><div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;      <span class="keywordflow">if</span> (tempfile)</div><div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;      {</div><div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;        fp_tmp = <a class="code" href="file_8c.html#ae1c0c19fec03274220b3ca065ad1e2e5">mutt_file_fopen</a>(tempfile, <span class="stringliteral">&quot;a+&quot;</span>);</div><div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;        e_templ-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>-&gt;<a class="code" href="structBody.html#afe3cd2c4b1070e3d0edbf1fed939ac5a">filename</a> = <a class="code" href="mutt_2string_8c.html#a4c2560f787bd1226b977992c16860c98">mutt_str_dup</a>(tempfile);</div><div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;      }</div><div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;      {</div><div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;        <a class="code" href="muttlib_8h.html#a93b346cfb36aac7c036bfaeea7f126e8">mutt_mktemp</a>(buf, <span class="keyword">sizeof</span>(buf));</div><div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;        fp_tmp = <a class="code" href="file_8c.html#ae1c0c19fec03274220b3ca065ad1e2e5">mutt_file_fopen</a>(buf, <span class="stringliteral">&quot;w+&quot;</span>);</div><div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;        e_templ-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>-&gt;<a class="code" href="structBody.html#afe3cd2c4b1070e3d0edbf1fed939ac5a">filename</a> = <a class="code" href="mutt_2string_8c.html#a4c2560f787bd1226b977992c16860c98">mutt_str_dup</a>(buf);</div><div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;      }</div><div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;    }</div><div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;      fp_tmp = <a class="code" href="file_8c.html#ae1c0c19fec03274220b3ca065ad1e2e5">mutt_file_fopen</a>(e_templ-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>-&gt;<a class="code" href="structBody.html#afe3cd2c4b1070e3d0edbf1fed939ac5a">filename</a>, <span class="stringliteral">&quot;a+&quot;</span>);</div><div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;</div><div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;    <span class="keywordflow">if</span> (!fp_tmp)</div><div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;    {</div><div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;      <a class="code" href="logging_8h.html#ae6c5fd73af3410b2d5e8099f8774c8da">mutt_debug</a>(<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab2c99902c587a013b358149516cceeb5">LL_DEBUG1</a>, <span class="stringliteral">&quot;can&#39;t create tempfile %s (errno=%d)\n&quot;</span>,</div><div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;                 e_templ-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>-&gt;<a class="code" href="structBody.html#afe3cd2c4b1070e3d0edbf1fed939ac5a">filename</a>, errno);</div><div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;      <a class="code" href="logging_8h.html#afaa521ab22db877ccf1b87e679e1b43e">mutt_perror</a>(e_templ-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>-&gt;<a class="code" href="structBody.html#afe3cd2c4b1070e3d0edbf1fed939ac5a">filename</a>);</div><div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;      <span class="keywordflow">goto</span> cleanup;</div><div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;    }</div><div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;  }</div><div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;</div><div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> c_reverse_name = <a class="code" href="helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(sub, <span class="stringliteral">&quot;reverse_name&quot;</span>);</div><div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;  <span class="comment">/* this is handled here so that the user can match ~f in send-hook */</span></div><div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;  <span class="keywordflow">if</span> (e_cur &amp;&amp; c_reverse_name &amp;&amp; !(flags &amp; (SEND_POSTPONED | <a class="code" href="send_8h.html#abeb38906954f30b89ad58ebbf95ac2b0">SEND_RESEND</a>)))</div><div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;  {</div><div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;    <span class="comment">/* We shouldn&#39;t have to worry about alias expansion here since we are</span></div><div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;<span class="comment">     * either replying to a real or postponed message, therefore no aliases</span></div><div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;<span class="comment">     * should exist since the user has not had the opportunity to add</span></div><div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;<span class="comment">     * addresses to the list.  We just have to ensure the postponed messages</span></div><div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;<span class="comment">     * have their aliases expanded.  */</span></div><div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;</div><div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="queue_8h.html#ac3c9da7ac712eacbbad5cc54d7a3477e">TAILQ_EMPTY</a>(&amp;e_templ-&gt;<a class="code" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code" href="structEnvelope.html#af1aa00aed4b8767cf98f08e45a432ad8">from</a>))</div><div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;    {</div><div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;      <a class="code" href="logging_8h.html#ae6c5fd73af3410b2d5e8099f8774c8da">mutt_debug</a>(<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a678d278eb301551ba0b3e0dbcfcee630">LL_DEBUG5</a>, <span class="stringliteral">&quot;e_templ-&gt;env-&gt;from before set_reverse_name: %s\n&quot;</span>,</div><div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;                 <a class="code" href="queue_8h.html#a7d6894360bd1c41e0e6f6d84998c1362">TAILQ_FIRST</a>(&amp;e_templ-&gt;<a class="code" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code" href="structEnvelope.html#af1aa00aed4b8767cf98f08e45a432ad8">from</a>)-&gt;mailbox);</div><div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;      <a class="code" href="address_2address_8c.html#a396bcf6adfff6663096fa6ae99c31c9a">mutt_addrlist_clear</a>(&amp;e_templ-&gt;<a class="code" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code" href="structEnvelope.html#af1aa00aed4b8767cf98f08e45a432ad8">from</a>);</div><div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;    }</div><div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;    <a class="code" href="send_8c.html#ac5be3d670b1d7e5cddb605652e9aa859">set_reverse_name</a>(&amp;e_templ-&gt;<a class="code" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code" href="structEnvelope.html#af1aa00aed4b8767cf98f08e45a432ad8">from</a>, e_cur-&gt;<a class="code" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>, sub);</div><div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;  }</div><div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;</div><div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> c_reply_with_xorig = <a class="code" href="helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(sub, <span class="stringliteral">&quot;reply_with_xorig&quot;</span>);</div><div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;  <span class="keywordflow">if</span> (e_cur &amp;&amp; c_reply_with_xorig &amp;&amp; !(flags &amp; (SEND_POSTPONED | <a class="code" href="send_8h.html#abeb38906954f30b89ad58ebbf95ac2b0">SEND_RESEND</a> | <a class="code" href="send_8h.html#af72e00ab3817e49360034f4d9593bb62">SEND_FORWARD</a>)))</div><div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;  {</div><div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;    <span class="comment">/* We shouldn&#39;t have to worry about freeing &#39;e_templ-&gt;env-&gt;from&#39; before</span></div><div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;<span class="comment">     * setting it here since this code will only execute when doing some</span></div><div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;<span class="comment">     * sort of reply. The pointer will only be set when using the -H command</span></div><div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;<span class="comment">     * line option.</span></div><div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;<span class="comment">     *</span></div><div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;<span class="comment">     * If there is already a from address recorded in &#39;e_templ-&gt;env-&gt;from&#39;,</span></div><div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;<span class="comment">     * then it theoretically comes from `$reverse_name` handling, and we don&#39;t use</span></div><div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;<span class="comment">     * the &#39;X-Orig-To header&#39;.  */</span></div><div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="queue_8h.html#ac3c9da7ac712eacbbad5cc54d7a3477e">TAILQ_EMPTY</a>(&amp;e_cur-&gt;<a class="code" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code" href="structEnvelope.html#a525bd5213606067d5c2be2e17fbe956b">x_original_to</a>) &amp;&amp; <a class="code" href="queue_8h.html#ac3c9da7ac712eacbbad5cc54d7a3477e">TAILQ_EMPTY</a>(&amp;e_templ-&gt;<a class="code" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code" href="structEnvelope.html#af1aa00aed4b8767cf98f08e45a432ad8">from</a>))</div><div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;    {</div><div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;      <a class="code" href="address_2address_8c.html#a16764dc80c9b3f6ad2897c8b7e59bd10">mutt_addrlist_copy</a>(&amp;e_templ-&gt;<a class="code" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code" href="structEnvelope.html#af1aa00aed4b8767cf98f08e45a432ad8">from</a>, &amp;e_cur-&gt;<a class="code" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code" href="structEnvelope.html#a525bd5213606067d5c2be2e17fbe956b">x_original_to</a>, <span class="keyword">false</span>);</div><div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;      <a class="code" href="logging_8h.html#ae6c5fd73af3410b2d5e8099f8774c8da">mutt_debug</a>(<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a678d278eb301551ba0b3e0dbcfcee630">LL_DEBUG5</a>, <span class="stringliteral">&quot;e_templ-&gt;env-&gt;from extracted from X-Original-To: header: %s\n&quot;</span>,</div><div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;                 <a class="code" href="queue_8h.html#a7d6894360bd1c41e0e6f6d84998c1362">TAILQ_FIRST</a>(&amp;e_templ-&gt;<a class="code" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code" href="structEnvelope.html#af1aa00aed4b8767cf98f08e45a432ad8">from</a>)-&gt;mailbox);</div><div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;    }</div><div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;  }</div><div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;</div><div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> c_resume_draft_files = <a class="code" href="helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(sub, <span class="stringliteral">&quot;resume_draft_files&quot;</span>);</div><div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;  <span class="keywordflow">if</span> (!(flags &amp; (SEND_POSTPONED | <a class="code" href="send_8h.html#abeb38906954f30b89ad58ebbf95ac2b0">SEND_RESEND</a>)) &amp;&amp;</div><div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;      !((flags &amp; <a class="code" href="send_8h.html#a21bc6948879d93793ca7afac2c7964bb">SEND_DRAFT_FILE</a>) &amp;&amp; c_resume_draft_files))</div><div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;  {</div><div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;    <span class="keywordflow">if</span> ((flags &amp; (<a class="code" href="send_8h.html#ac23e1891bcbc52cc25b5824acfb42d3c">SEND_REPLY</a> | <a class="code" href="send_8h.html#af72e00ab3817e49360034f4d9593bb62">SEND_FORWARD</a> | <a class="code" href="send_8h.html#aa0a201a6d90a4760c1e0ece8be43c1cb">SEND_TO_SENDER</a>)) &amp;&amp; m &amp;&amp;</div><div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;        (<a class="code" href="send_8c.html#a8491c02ca19dcad55ccdd2edb3bbcf24">envelope_defaults</a>(e_templ-&gt;<a class="code" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>, m, el, flags, sub) == -1))</div><div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;    {</div><div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;      <span class="keywordflow">goto</span> cleanup;</div><div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;    }</div><div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;</div><div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> c_hdrs = <a class="code" href="helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(sub, <span class="stringliteral">&quot;hdrs&quot;</span>);</div><div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;    <span class="keywordflow">if</span> (c_hdrs)</div><div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;      <a class="code" href="send_8c.html#a93b53146e2fbfb6657f83297e722fdac">process_user_recips</a>(e_templ-&gt;<a class="code" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>);</div><div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;</div><div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;    <span class="comment">/* Expand aliases and remove duplicates/crossrefs */</span></div><div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;    <a class="code" href="alias_8c.html#aa90fd4b086aebbf4fed5245ecaca1ac1">mutt_expand_aliases_env</a>(e_templ-&gt;<a class="code" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>);</div><div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;</div><div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;    <span class="keywordflow">if</span> (flags &amp; <a class="code" href="send_8h.html#ac23e1891bcbc52cc25b5824acfb42d3c">SEND_REPLY</a>)</div><div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;      <a class="code" href="send_8c.html#a527f182325365ed083dad7be735bab25">mutt_fix_reply_recipients</a>(e_templ-&gt;<a class="code" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>, sub);</div><div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;</div><div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;<span class="preprocessor">#ifdef USE_NNTP</span></div><div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;    <span class="keywordflow">if</span> ((flags &amp; SEND_NEWS) &amp;&amp; (m &amp;&amp; m-&gt;<a class="code" href="structMailbox.html#a5638329fb2ebd4bbe1f4a949ec8de174">type</a> == <a class="code" href="mailbox_8h.html#af65addf714c28dd5d483cb426100921da6d3955b4b5acc450ba154b6ec9100803">MUTT_NNTP</a>) &amp;&amp; !e_templ-&gt;<a class="code" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code" href="structEnvelope.html#a5f680f60f1713477a879877dcbd21a5c">newsgroups</a>)</div><div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;    {</div><div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;      e_templ-&gt;<a class="code" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code" href="structEnvelope.html#a5f680f60f1713477a879877dcbd21a5c">newsgroups</a> = <a class="code" href="mutt_2string_8c.html#a4c2560f787bd1226b977992c16860c98">mutt_str_dup</a>(((<span class="keyword">struct</span> <a class="code" href="structNntpMboxData.html">NntpMboxData</a> *) m-&gt;<a class="code" href="structMailbox.html#a69b544c5c748ab3046dcc6e61a41f595">mdata</a>)-&gt;group);</div><div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;    }</div><div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;</div><div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> c_auto_edit = <a class="code" href="helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(sub, <span class="stringliteral">&quot;auto_edit&quot;</span>);</div><div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> c_edit_headers = <a class="code" href="helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(sub, <span class="stringliteral">&quot;edit_headers&quot;</span>);</div><div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> c_fast_reply = <a class="code" href="helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(sub, <span class="stringliteral">&quot;fast_reply&quot;</span>);</div><div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;    <span class="keywordflow">if</span> (!(flags &amp; <a class="code" href="send_8h.html#a05caaa1cac7622dce2a0e32d75619b48">SEND_BATCH</a>) &amp;&amp; !(c_auto_edit &amp;&amp; c_edit_headers) &amp;&amp;</div><div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;        !((flags &amp; SEND_REPLY) &amp;&amp; c_fast_reply))</div><div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;    {</div><div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="send_8c.html#a9fb4ee964889bd118582f0938027a659">edit_envelope</a>(e_templ-&gt;<a class="code" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>, flags, sub) == -1)</div><div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;        <span class="keywordflow">goto</span> cleanup;</div><div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;    }</div><div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;</div><div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;    <span class="comment">/* the from address must be set here regardless of whether or not</span></div><div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;<span class="comment">     * $use_from is set so that the &#39;~P&#39; (from you) operator in send-hook</span></div><div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;<span class="comment">     * patterns will work.  if $use_from is unset, the from address is killed</span></div><div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;<span class="comment">     * after send-hooks are evaluated */</span></div><div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;</div><div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> killfrom = <a class="code" href="queue_8h.html#ac3c9da7ac712eacbbad5cc54d7a3477e">TAILQ_EMPTY</a>(&amp;e_templ-&gt;<a class="code" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code" href="structEnvelope.html#af1aa00aed4b8767cf98f08e45a432ad8">from</a>);</div><div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;    <span class="keywordflow">if</span> (killfrom)</div><div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;    {</div><div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;      <a class="code" href="address_2address_8c.html#a68385b174baad74a9aecf3dec61432a0">mutt_addrlist_append</a>(&amp;e_templ-&gt;<a class="code" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code" href="structEnvelope.html#af1aa00aed4b8767cf98f08e45a432ad8">from</a>, <a class="code" href="send_8c.html#aa93b7a6bc9e26176ebf17bf37c7d2a87">mutt_default_from</a>(sub));</div><div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;    }</div><div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;</div><div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;    <span class="keywordflow">if</span> ((flags &amp; SEND_REPLY) &amp;&amp; e_cur)</div><div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;    {</div><div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;      <span class="comment">/* change setting based upon message we are replying to */</span></div><div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;      <a class="code" href="hook_8c.html#af487ca5e3f7da21c86e3ad61fdb55faa">mutt_message_hook</a>(m, e_cur, <a class="code" href="hook_8h.html#ab6ec93bff7f691fb01cb5233f4040f62">MUTT_REPLY_HOOK</a>);</div><div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;</div><div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;      <span class="comment">/* set the replied flag for the message we are generating so that the</span></div><div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;<span class="comment">       * user can use ~Q in a send-hook to know when reply-hook&#39;s are also</span></div><div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;<span class="comment">       * being used.  */</span></div><div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;      e_templ-&gt;<a class="code" href="structEmail.html#aa26dd591f92e548bc3c56d0b7fdb3e8c">replied</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;    }</div><div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;</div><div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;    <span class="comment">/* change settings based upon recipients */</span></div><div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;</div><div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;    <a class="code" href="hook_8c.html#af487ca5e3f7da21c86e3ad61fdb55faa">mutt_message_hook</a>(NULL, e_templ, <a class="code" href="hook_8h.html#a365ef87efead32b0e7a8265927171dc1">MUTT_SEND_HOOK</a>);</div><div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;</div><div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;    <span class="comment">/* Unset the replied flag from the message we are composing since it is</span></div><div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;<span class="comment">     * no longer required.  This is done here because the FCC&#39;d copy of</span></div><div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;<span class="comment">     * this message was erroneously get the &#39;R&#39;eplied flag when stored in</span></div><div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;<span class="comment">     * a maildir-style mailbox.  */</span></div><div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;    e_templ-&gt;<a class="code" href="structEmail.html#aa26dd591f92e548bc3c56d0b7fdb3e8c">replied</a> = <span class="keyword">false</span>;</div><div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;</div><div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;    <span class="comment">/* $use_from and/or $from might have changed in a send-hook */</span></div><div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;    <span class="keywordflow">if</span> (killfrom)</div><div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;    {</div><div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;      <a class="code" href="address_2address_8c.html#a396bcf6adfff6663096fa6ae99c31c9a">mutt_addrlist_clear</a>(&amp;e_templ-&gt;<a class="code" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code" href="structEnvelope.html#af1aa00aed4b8767cf98f08e45a432ad8">from</a>);</div><div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;</div><div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">bool</span> c_use_from = <a class="code" href="helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(sub, <span class="stringliteral">&quot;use_from&quot;</span>);</div><div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;      <span class="keywordflow">if</span> (c_use_from &amp;&amp; !(flags &amp; (SEND_POSTPONED | <a class="code" href="send_8h.html#abeb38906954f30b89ad58ebbf95ac2b0">SEND_RESEND</a>)))</div><div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;        <a class="code" href="address_2address_8c.html#a68385b174baad74a9aecf3dec61432a0">mutt_addrlist_append</a>(&amp;e_templ-&gt;<a class="code" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code" href="structEnvelope.html#af1aa00aed4b8767cf98f08e45a432ad8">from</a>, <a class="code" href="send_8c.html#aa93b7a6bc9e26176ebf17bf37c7d2a87">mutt_default_from</a>(sub));</div><div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;    }</div><div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;</div><div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;    <span class="keywordflow">if</span> (c_hdrs)</div><div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;      <a class="code" href="send_8c.html#a9bca5c9f44a7908485389d16dcf20f96">process_user_header</a>(e_templ-&gt;<a class="code" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>);</div><div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;</div><div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;    <span class="keywordflow">if</span> (flags &amp; SEND_BATCH)</div><div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;    {</div><div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="file_8c.html#a0a6ff09a685fb6fa1120a582a5a6ef4a">mutt_file_copy_stream</a>(stdin, fp_tmp) &lt; 1)</div><div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;      {</div><div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;        <a class="code" href="logging_8h.html#acc1fd6d7ab1603e80e11e84e90d061e4">mutt_error</a>(<a class="code" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Refusing to send an empty email&quot;</span>));</div><div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;        <a class="code" href="logging_8h.html#ae108f891125caafa9250cf0959c40c04">mutt_message</a>(<a class="code" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Try: echo | neomutt -s &#39;subject&#39; user@example.com&quot;</span>));</div><div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;        <span class="keywordflow">goto</span> cleanup;</div><div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;      }</div><div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;    }</div><div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;</div><div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;    <span class="keywordflow">if</span> (!(flags &amp; SEND_BATCH))</div><div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;      <a class="code" href="send_8c.html#a08f60d273517436bc186ba194c086108">mutt_make_greeting</a>(m, e_templ, fp_tmp, sub);</div><div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;</div><div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> c_sig_on_top = <a class="code" href="helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(sub, <span class="stringliteral">&quot;sig_on_top&quot;</span>);</div><div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keyword">const</span> c_editor = <a class="code" href="helpers_8c.html#ac477c591155aa4ae0452bbabc0affffe">cs_subset_string</a>(sub, <span class="stringliteral">&quot;editor&quot;</span>);</div><div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;    <span class="keywordflow">if</span> (c_sig_on_top &amp;&amp; !(flags &amp; (<a class="code" href="send_8h.html#a623f46e1bab1e562893dbd01bbbd92dd">SEND_KEY</a> | SEND_BATCH)) &amp;&amp; c_editor)</div><div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;    {</div><div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;      <a class="code" href="send_8c.html#afa5258518aabbe76c14e64e105515acf">append_signature</a>(fp_tmp, sub);</div><div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;    }</div><div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;</div><div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;    <span class="comment">/* include replies/forwarded messages, unless we are given a template */</span></div><div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;    <span class="keywordflow">if</span> (!tempfile &amp;&amp; (m || !(flags &amp; (SEND_REPLY | <a class="code" href="send_8h.html#af72e00ab3817e49360034f4d9593bb62">SEND_FORWARD</a>))) &amp;&amp;</div><div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;        (<a class="code" href="send_8c.html#a0d247d6120598b06384009ea2bdb36af">generate_body</a>(fp_tmp, e_templ, flags, m, el, sub) == -1))</div><div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;    {</div><div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;      <span class="keywordflow">goto</span> cleanup;</div><div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;    }</div><div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;</div><div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;    <span class="keywordflow">if</span> (!c_sig_on_top &amp;&amp; !(flags &amp; (<a class="code" href="send_8h.html#a623f46e1bab1e562893dbd01bbbd92dd">SEND_KEY</a> | SEND_BATCH)) &amp;&amp; c_editor)</div><div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;    {</div><div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;      <a class="code" href="send_8c.html#afa5258518aabbe76c14e64e105515acf">append_signature</a>(fp_tmp, sub);</div><div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;    }</div><div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;  }</div><div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;</div><div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;  <span class="comment">/* Only set format=flowed for new messages.  postponed/resent/draftfiles</span></div><div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;<span class="comment">   * should respect the original email.</span></div><div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;<span class="comment">   *</span></div><div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;<span class="comment">   * This is set here so that send-hook can be used to turn the option on.  */</span></div><div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;  <span class="keywordflow">if</span> (!(flags &amp; (<a class="code" href="send_8h.html#a623f46e1bab1e562893dbd01bbbd92dd">SEND_KEY</a> | SEND_POSTPONED | <a class="code" href="send_8h.html#abeb38906954f30b89ad58ebbf95ac2b0">SEND_RESEND</a> | SEND_DRAFT_FILE)))</div><div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;  {</div><div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> c_text_flowed = <a class="code" href="helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(sub, <span class="stringliteral">&quot;text_flowed&quot;</span>);</div><div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;    <span class="keywordflow">if</span> (c_text_flowed &amp;&amp; <a class="code" href="send_8c.html#adaad7f2e93eb41299f638d224d90f82b">is_text_plain</a>(e_templ-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>))</div><div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;    {</div><div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;      <a class="code" href="parameter_8c.html#a42249fc15b1e52df046a0a10de29da44">mutt_param_set</a>(&amp;e_templ-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>-&gt;<a class="code" href="structBody.html#a782cee95e0064e3895b88248bdfc781a">parameter</a>, <span class="stringliteral">&quot;format&quot;</span>, <span class="stringliteral">&quot;flowed&quot;</span>);</div><div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;    }</div><div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;  }</div><div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;</div><div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;  <span class="comment">/* This hook is even called for postponed messages, and can, e.g., be used</span></div><div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;<span class="comment">   * for setting the editor, the sendmail path, or the envelope sender.  */</span></div><div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;  <a class="code" href="hook_8c.html#af487ca5e3f7da21c86e3ad61fdb55faa">mutt_message_hook</a>(NULL, e_templ, <a class="code" href="hook_8h.html#a709891b042fc13265a7971b2401081c9">MUTT_SEND2_HOOK</a>);</div><div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;</div><div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;  <span class="comment">/* wait until now to set the real name portion of our return address so</span></div><div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;<span class="comment">   * that $real_name can be set in a send-hook */</span></div><div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;  {</div><div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;    <span class="keyword">struct </span><a class="code" href="structAddress.html">Address</a> *from = <a class="code" href="queue_8h.html#a7d6894360bd1c41e0e6f6d84998c1362">TAILQ_FIRST</a>(&amp;e_templ-&gt;<a class="code" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code" href="structEnvelope.html#af1aa00aed4b8767cf98f08e45a432ad8">from</a>);</div><div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;    <span class="keywordflow">if</span> (from &amp;&amp; !from-&gt;<a class="code" href="structAddress.html#af4ac89f0f41e7872b4faeaedfcb709b4">personal</a> &amp;&amp; !(flags &amp; (<a class="code" href="send_8h.html#abeb38906954f30b89ad58ebbf95ac2b0">SEND_RESEND</a> | SEND_POSTPONED)))</div><div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;    {</div><div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keyword">const</span> c_real_name = <a class="code" href="helpers_8c.html#ac477c591155aa4ae0452bbabc0affffe">cs_subset_string</a>(sub, <span class="stringliteral">&quot;real_name&quot;</span>);</div><div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;      from-&gt;<a class="code" href="structAddress.html#af4ac89f0f41e7872b4faeaedfcb709b4">personal</a> = <a class="code" href="mutt_2string_8c.html#a4c2560f787bd1226b977992c16860c98">mutt_str_dup</a>(c_real_name);</div><div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;    }</div><div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;  }</div><div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;</div><div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;  <span class="keywordflow">if</span> (!(((<a class="code" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a>) != 0) &amp;&amp; (flags &amp; <a class="code" href="send_8h.html#a623f46e1bab1e562893dbd01bbbd92dd">SEND_KEY</a>)))</div><div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;    <a class="code" href="file_8c.html#a31f49795ff5b9558db5476e5777e63b6">mutt_file_fclose</a>(&amp;fp_tmp);</div><div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;</div><div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;  <span class="keywordflow">if</span> (!(flags &amp; <a class="code" href="send_8h.html#a05caaa1cac7622dce2a0e32d75619b48">SEND_BATCH</a>))</div><div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;  {</div><div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;    <span class="keyword">struct </span>stat st;</div><div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;    time_t mtime = <a class="code" href="file_8c.html#a61b50c8615492662cbc27ebbf83090ce">mutt_file_decrease_mtime</a>(e_templ-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>-&gt;<a class="code" href="structBody.html#afe3cd2c4b1070e3d0edbf1fed939ac5a">filename</a>, NULL);</div><div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;    <span class="keywordflow">if</span> (mtime == (time_t) -1)</div><div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;    {</div><div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;      <a class="code" href="logging_8h.html#afaa521ab22db877ccf1b87e679e1b43e">mutt_perror</a>(e_templ-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>-&gt;<a class="code" href="structBody.html#afe3cd2c4b1070e3d0edbf1fed939ac5a">filename</a>);</div><div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;      <span class="keywordflow">goto</span> cleanup;</div><div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;    }</div><div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;</div><div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;    <a class="code" href="sendlib_8c.html#ae4f3b3ef1863d9821af9f82d8963e5b8">mutt_update_encoding</a>(e_templ-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>, sub);</div><div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;</div><div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> c_edit_headers = <a class="code" href="helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(sub, <span class="stringliteral">&quot;edit_headers&quot;</span>);</div><div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> c_auto_edit = <a class="code" href="helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(sub, <span class="stringliteral">&quot;auto_edit&quot;</span>);</div><div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;    <span class="keyword">const</span> <span class="keyword">enum</span> <a class="code" href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35db">QuadOption</a> c_forward_edit = <a class="code" href="helpers_8c.html#a9154ba713ce99b0937f475eec7c61af9">cs_subset_quad</a>(sub, <span class="stringliteral">&quot;forward_edit&quot;</span>);</div><div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;</div><div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;    <span class="comment">/* Select whether or not the user&#39;s editor should be called now.  We</span></div><div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;<span class="comment">     * don&#39;t want to do this when:</span></div><div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;<span class="comment">     * 1) we are sending a key/cert</span></div><div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;<span class="comment">     * 2) we are forwarding a message and the user doesn&#39;t want to edit it.</span></div><div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;<span class="comment">     *    This is controlled by the quadoption $forward_edit.  However, if</span></div><div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;<span class="comment">     *    both $edit_headers and $auto_edit are set, we want to ignore the</span></div><div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;<span class="comment">     *    setting of $forward_edit because the user probably needs to add the</span></div><div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;<span class="comment">     *    recipients.  */</span></div><div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;    <span class="keywordflow">if</span> (!(flags &amp; SEND_KEY) &amp;&amp;</div><div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;        (((flags &amp; <a class="code" href="send_8h.html#af72e00ab3817e49360034f4d9593bb62">SEND_FORWARD</a>) == 0) || (c_edit_headers &amp;&amp; c_auto_edit) ||</div><div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;         (<a class="code" href="question_2lib_8h.html#ab02047769214ff014b9a8a1782babadc">query_quadoption</a>(c_forward_edit, <a class="code" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Edit forwarded message?&quot;</span>)) == <a class="code" href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35dbafee7088606c4724651c799a6a0b182b7">MUTT_YES</a>)))</div><div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;    {</div><div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;      <span class="comment">/* If the this isn&#39;t a text message, look for a mailcap edit command */</span></div><div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keyword">const</span> c_editor = <a class="code" href="helpers_8c.html#ac477c591155aa4ae0452bbabc0affffe">cs_subset_string</a>(sub, <span class="stringliteral">&quot;editor&quot;</span>);</div><div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="muttlib_8c.html#a408880eb332fd5a312dcae1df22ff688">mutt_needs_mailcap</a>(e_templ-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>))</div><div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;      {</div><div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="mutt__attach_8c.html#adef1563a136b685ed418f12a6228ef42">mutt_edit_attachment</a>(e_templ-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>))</div><div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;          <span class="keywordflow">goto</span> cleanup;</div><div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;      }</div><div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (c_edit_headers)</div><div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;      {</div><div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;        <a class="code" href="email_2envelope_8c.html#afd00cc8d84947cbd55e082420b5732f1">mutt_env_to_local</a>(e_templ-&gt;<a class="code" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>);</div><div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;        <a class="code" href="mutt__header_8c.html#add6fa85ce7ef8dcad27d465fbbc27708">mutt_edit_headers</a>(c_editor, e_templ-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>-&gt;<a class="code" href="structBody.html#afe3cd2c4b1070e3d0edbf1fed939ac5a">filename</a>, e_templ, &amp;fcc);</div><div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;        <a class="code" href="email_2envelope_8c.html#a0108f989ca58622df272cf31b610395e">mutt_env_to_intl</a>(e_templ-&gt;<a class="code" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>, NULL, NULL);</div><div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;      }</div><div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;      {</div><div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;        <a class="code" href="curs__lib_8c.html#a0590f11f42a6242002ea4c842438231b">mutt_edit_file</a>(c_editor, e_templ-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>-&gt;<a class="code" href="structBody.html#afe3cd2c4b1070e3d0edbf1fed939ac5a">filename</a>);</div><div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;        <span class="keywordflow">if</span> (stat(e_templ-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>-&gt;<a class="code" href="structBody.html#afe3cd2c4b1070e3d0edbf1fed939ac5a">filename</a>, &amp;st) == 0)</div><div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;        {</div><div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;          <span class="keywordflow">if</span> (mtime != st.st_mtime)</div><div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;            <a class="code" href="send_8c.html#ad5e73f6a253107a7f55ee7388fbbf92f">fix_end_of_file</a>(e_templ-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>-&gt;<a class="code" href="structBody.html#afe3cd2c4b1070e3d0edbf1fed939ac5a">filename</a>);</div><div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;        }</div><div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;          <a class="code" href="logging_8h.html#afaa521ab22db877ccf1b87e679e1b43e">mutt_perror</a>(e_templ-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>-&gt;<a class="code" href="structBody.html#afe3cd2c4b1070e3d0edbf1fed939ac5a">filename</a>);</div><div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;      }</div><div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;</div><div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;      <a class="code" href="hook_8c.html#af487ca5e3f7da21c86e3ad61fdb55faa">mutt_message_hook</a>(NULL, e_templ, <a class="code" href="hook_8h.html#a709891b042fc13265a7971b2401081c9">MUTT_SEND2_HOOK</a>);</div><div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;    }</div><div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;</div><div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;    <span class="keywordflow">if</span> (!(flags &amp; (SEND_POSTPONED | SEND_FORWARD | SEND_KEY | <a class="code" href="send_8h.html#abeb38906954f30b89ad58ebbf95ac2b0">SEND_RESEND</a> | SEND_DRAFT_FILE)))</div><div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;    {</div><div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;      <span class="keywordflow">if</span> (stat(e_templ-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>-&gt;<a class="code" href="structBody.html#afe3cd2c4b1070e3d0edbf1fed939ac5a">filename</a>, &amp;st) == 0)</div><div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;      {</div><div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;        <span class="keyword">const</span> <span class="keyword">enum</span> <a class="code" href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35db">QuadOption</a> c_abort_unmodified =</div><div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;            <a class="code" href="helpers_8c.html#a9154ba713ce99b0937f475eec7c61af9">cs_subset_quad</a>(sub, <span class="stringliteral">&quot;abort_unmodified&quot;</span>);</div><div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;</div><div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;        <span class="comment">/* if the file was not modified, bail out now */</span></div><div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;        <span class="keywordflow">if</span> ((mtime == st.st_mtime) &amp;&amp; !e_templ-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>-&gt;<a class="code" href="structBody.html#ac55cdfce46eed13151dcfe9b329d254c">next</a> &amp;&amp;</div><div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;            (<a class="code" href="question_2lib_8h.html#ab02047769214ff014b9a8a1782babadc">query_quadoption</a>(c_abort_unmodified,</div><div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;                              <a class="code" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Abort unmodified message?&quot;</span>)) == <a class="code" href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35dbafee7088606c4724651c799a6a0b182b7">MUTT_YES</a>))</div><div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;        {</div><div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;          <a class="code" href="logging_8h.html#ae108f891125caafa9250cf0959c40c04">mutt_message</a>(<a class="code" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Aborted unmodified message&quot;</span>));</div><div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;          <span class="keywordflow">goto</span> cleanup;</div><div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;        }</div><div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;      }</div><div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;        <a class="code" href="logging_8h.html#afaa521ab22db877ccf1b87e679e1b43e">mutt_perror</a>(e_templ-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>-&gt;<a class="code" href="structBody.html#afe3cd2c4b1070e3d0edbf1fed939ac5a">filename</a>);</div><div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;    }</div><div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;  }</div><div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;</div><div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;  <span class="comment">/* Set the message security unless:</span></div><div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;<span class="comment">   * 1) crypto support is not enabled (WithCrypto==0)</span></div><div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;<span class="comment">   * 2) pgp: header field was present during message editing with $edit_headers (e_templ-&gt;security != 0)</span></div><div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;<span class="comment">   * 3) we are resending a message</span></div><div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;<span class="comment">   * 4) we are recalling a postponed message (don&#39;t override the user&#39;s saved settings)</span></div><div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;<span class="comment">   * 5) we are in batch mode</span></div><div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;<span class="comment">   *</span></div><div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;<span class="comment">   * This is done after allowing the user to edit the message so that security</span></div><div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;<span class="comment">   * settings can be configured with send2-hook and $edit_headers.  */</span></div><div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;  <span class="keywordflow">if</span> ((<a class="code" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> != 0) &amp;&amp; (e_templ-&gt;<a class="code" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> == 0) &amp;&amp;</div><div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;      !(flags &amp; (SEND_BATCH | SEND_POSTPONED | <a class="code" href="send_8h.html#abeb38906954f30b89ad58ebbf95ac2b0">SEND_RESEND</a>)))</div><div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;  {</div><div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;    <span class="keywordtype">bool</span> c_autocrypt = <span class="keyword">false</span>;</div><div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;    <span class="keywordtype">bool</span> c_autocrypt_reply = <span class="keyword">false</span>;</div><div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;</div><div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;<span class="preprocessor">#ifdef USE_AUTOCRYPT</span></div><div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;    c_autocrypt = <a class="code" href="helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(sub, <span class="stringliteral">&quot;autocrypt&quot;</span>);</div><div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;    c_autocrypt_reply = <a class="code" href="helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(sub, <span class="stringliteral">&quot;autocrypt_reply&quot;</span>);</div><div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;</div><div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;    <span class="keywordflow">if</span> (c_autocrypt &amp;&amp; c_autocrypt_reply &amp;&amp; e_cur &amp;&amp; (e_cur-&gt;<a class="code" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> &amp; <a class="code" href="ncrypt_2lib_8h.html#a0b36be5c32ca90d8f2caef9ea9d627fc">SEC_AUTOCRYPT</a>))</div><div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;    {</div><div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;      e_templ-&gt;<a class="code" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> |= (<a class="code" href="ncrypt_2lib_8h.html#a0b36be5c32ca90d8f2caef9ea9d627fc">SEC_AUTOCRYPT</a> | <a class="code" href="ncrypt_2lib_8h.html#ae0ce4a742538f3ee3e1bfbf143c794fb">SEC_AUTOCRYPT_OVERRIDE</a> | <a class="code" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a>);</div><div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;    }</div><div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;    {</div><div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">bool</span> c_crypt_auto_sign = <a class="code" href="helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(sub, <span class="stringliteral">&quot;crypt_auto_sign&quot;</span>);</div><div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">bool</span> c_crypt_auto_encrypt =</div><div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;          <a class="code" href="helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(sub, <span class="stringliteral">&quot;crypt_auto_encrypt&quot;</span>);</div><div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">bool</span> c_crypt_reply_encrypt =</div><div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;          <a class="code" href="helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(sub, <span class="stringliteral">&quot;crypt_reply_encrypt&quot;</span>);</div><div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">bool</span> c_crypt_reply_sign = <a class="code" href="helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(sub, <span class="stringliteral">&quot;crypt_reply_sign&quot;</span>);</div><div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">bool</span> c_crypt_reply_sign_encrypted =</div><div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;          <a class="code" href="helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(sub, <span class="stringliteral">&quot;crypt_reply_sign_encrypted&quot;</span>);</div><div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;</div><div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;      <span class="keywordflow">if</span> (c_crypt_auto_sign)</div><div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;        e_templ-&gt;<a class="code" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> |= <a class="code" href="ncrypt_2lib_8h.html#ae12c003463c99d28f65f1d6b8b053b2c">SEC_SIGN</a>;</div><div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;      <span class="keywordflow">if</span> (c_crypt_auto_encrypt)</div><div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;        e_templ-&gt;<a class="code" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> |= <a class="code" href="ncrypt_2lib_8h.html#aacaa4abd4c0696e260b7a0f1d466360a">SEC_ENCRYPT</a>;</div><div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;      <span class="keywordflow">if</span> (c_crypt_reply_encrypt &amp;&amp; e_cur &amp;&amp; (e_cur-&gt;<a class="code" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> &amp; <a class="code" href="ncrypt_2lib_8h.html#aacaa4abd4c0696e260b7a0f1d466360a">SEC_ENCRYPT</a>))</div><div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;        e_templ-&gt;<a class="code" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> |= <a class="code" href="ncrypt_2lib_8h.html#aacaa4abd4c0696e260b7a0f1d466360a">SEC_ENCRYPT</a>;</div><div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;      <span class="keywordflow">if</span> (c_crypt_reply_sign &amp;&amp; e_cur &amp;&amp; (e_cur-&gt;<a class="code" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> &amp; <a class="code" href="ncrypt_2lib_8h.html#ae12c003463c99d28f65f1d6b8b053b2c">SEC_SIGN</a>))</div><div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;        e_templ-&gt;<a class="code" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> |= <a class="code" href="ncrypt_2lib_8h.html#ae12c003463c99d28f65f1d6b8b053b2c">SEC_SIGN</a>;</div><div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;      <span class="keywordflow">if</span> (c_crypt_reply_sign_encrypted &amp;&amp; e_cur &amp;&amp; (e_cur-&gt;<a class="code" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> &amp; <a class="code" href="ncrypt_2lib_8h.html#aacaa4abd4c0696e260b7a0f1d466360a">SEC_ENCRYPT</a>))</div><div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;        e_templ-&gt;<a class="code" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> |= <a class="code" href="ncrypt_2lib_8h.html#ae12c003463c99d28f65f1d6b8b053b2c">SEC_SIGN</a>;</div><div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;</div><div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">bool</span> c_crypt_opportunistic_encrypt =</div><div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;          <a class="code" href="helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(sub, <span class="stringliteral">&quot;crypt_opportunistic_encrypt&quot;</span>);</div><div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;</div><div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;      <span class="keywordflow">if</span> (((<a class="code" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; APPLICATION_PGP) != 0) &amp;&amp;</div><div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;          ((e_templ-&gt;<a class="code" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> &amp; (<a class="code" href="ncrypt_2lib_8h.html#aacaa4abd4c0696e260b7a0f1d466360a">SEC_ENCRYPT</a> | <a class="code" href="ncrypt_2lib_8h.html#ae12c003463c99d28f65f1d6b8b053b2c">SEC_SIGN</a>)) || c_crypt_opportunistic_encrypt))</div><div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;      {</div><div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">bool</span> c_pgp_auto_inline = <a class="code" href="helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(sub, <span class="stringliteral">&quot;pgp_auto_inline&quot;</span>);</div><div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">bool</span> c_pgp_reply_inline = <a class="code" href="helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(sub, <span class="stringliteral">&quot;pgp_reply_inline&quot;</span>);</div><div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;</div><div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;        <span class="keywordflow">if</span> (c_pgp_auto_inline)</div><div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;          e_templ-&gt;<a class="code" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> |= <a class="code" href="ncrypt_2lib_8h.html#a074f827472ad45f11ec1132cdfed2daf">SEC_INLINE</a>;</div><div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;        <span class="keywordflow">if</span> (c_pgp_reply_inline &amp;&amp; e_cur &amp;&amp; (e_cur-&gt;<a class="code" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> &amp; <a class="code" href="ncrypt_2lib_8h.html#a074f827472ad45f11ec1132cdfed2daf">SEC_INLINE</a>))</div><div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;          e_templ-&gt;<a class="code" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> |= <a class="code" href="ncrypt_2lib_8h.html#a074f827472ad45f11ec1132cdfed2daf">SEC_INLINE</a>;</div><div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;      }</div><div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;    }</div><div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;</div><div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> c_crypt_opportunistic_encrypt =</div><div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;        <a class="code" href="helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(sub, <span class="stringliteral">&quot;crypt_opportunistic_encrypt&quot;</span>);</div><div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;</div><div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;    <span class="keywordflow">if</span> (e_templ-&gt;<a class="code" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> || c_crypt_opportunistic_encrypt)</div><div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;    {</div><div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">bool</span> c_crypt_auto_pgp = <a class="code" href="helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(sub, <span class="stringliteral">&quot;crypt_auto_pgp&quot;</span>);</div><div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">bool</span> c_crypt_auto_smime = <a class="code" href="helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(sub, <span class="stringliteral">&quot;crypt_auto_smime&quot;</span>);</div><div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;</div><div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;      <span class="comment">/* When replying / forwarding, use the original message&#39;s</span></div><div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;<span class="comment">       * crypto system.  According to the documentation,</span></div><div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;<span class="comment">       * smime_is_default should be disregarded here.</span></div><div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;<span class="comment">       *</span></div><div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;<span class="comment">       * Problem: At least with forwarding, this doesn&#39;t really</span></div><div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;<span class="comment">       * make much sense. Should we have an option to completely</span></div><div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;<span class="comment">       * disable individual mechanisms at run-time?  */</span></div><div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;      <span class="keywordflow">if</span> (e_cur)</div><div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;      {</div><div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;        <span class="keywordflow">if</span> (((<a class="code" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; APPLICATION_PGP) != 0) &amp;&amp; c_crypt_auto_pgp &amp;&amp;</div><div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;            (e_cur-&gt;<a class="code" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> &amp; APPLICATION_PGP))</div><div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;        {</div><div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;          e_templ-&gt;<a class="code" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> |= <a class="code" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a>;</div><div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;        }</div><div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (((<a class="code" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code" href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a>) != 0) &amp;&amp;</div><div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;                 c_crypt_auto_smime &amp;&amp; (e_cur-&gt;<a class="code" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> &amp; APPLICATION_SMIME))</div><div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;        {</div><div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;          e_templ-&gt;<a class="code" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> |= <a class="code" href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a>;</div><div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;        }</div><div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;      }</div><div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;</div><div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">bool</span> c_smime_is_default = <a class="code" href="helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(sub, <span class="stringliteral">&quot;smime_is_default&quot;</span>);</div><div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;</div><div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;      <span class="comment">/* No crypto mechanism selected? Use availability + smime_is_default</span></div><div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;<span class="comment">       * for the decision.  */</span></div><div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;      <span class="keywordflow">if</span> (!(e_templ-&gt;<a class="code" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> &amp; (<a class="code" href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a> | APPLICATION_PGP)))</div><div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;      {</div><div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;        <span class="keywordflow">if</span> (((<a class="code" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code" href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a>) != 0) &amp;&amp; c_crypt_auto_smime &amp;&amp; c_smime_is_default)</div><div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;        {</div><div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;          e_templ-&gt;<a class="code" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> |= <a class="code" href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a>;</div><div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;        }</div><div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (((<a class="code" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; APPLICATION_PGP) != 0) &amp;&amp; c_crypt_auto_pgp)</div><div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;        {</div><div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;          e_templ-&gt;<a class="code" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> |= <a class="code" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a>;</div><div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;        }</div><div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (((<a class="code" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; APPLICATION_SMIME) != 0) &amp;&amp; c_crypt_auto_smime)</div><div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;        {</div><div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;          e_templ-&gt;<a class="code" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> |= <a class="code" href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a>;</div><div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;        }</div><div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;      }</div><div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;    }</div><div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;</div><div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;    <span class="comment">/* opportunistic encrypt relies on SMIME or PGP already being selected */</span></div><div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;    <span class="keywordflow">if</span> (c_crypt_opportunistic_encrypt)</div><div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;    {</div><div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;      <span class="comment">/* If something has already enabled encryption, e.g. `$crypt_auto_encrypt`</span></div><div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;<span class="comment">       * or `$crypt_reply_encrypt`, then don&#39;t enable opportunistic encrypt for</span></div><div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;<span class="comment">       * the message.  */</span></div><div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;      <span class="keywordflow">if</span> (!(e_templ-&gt;<a class="code" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> &amp; (<a class="code" href="ncrypt_2lib_8h.html#aacaa4abd4c0696e260b7a0f1d466360a">SEC_ENCRYPT</a> | <a class="code" href="ncrypt_2lib_8h.html#a0b36be5c32ca90d8f2caef9ea9d627fc">SEC_AUTOCRYPT</a>)))</div><div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;      {</div><div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;        e_templ-&gt;<a class="code" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> |= <a class="code" href="ncrypt_2lib_8h.html#a2fb0b0aa796d8d79a746001d09c2a2c7">SEC_OPPENCRYPT</a>;</div><div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;        <a class="code" href="crypt_8c.html#a8ebc13a33b0dd650151d5b1b37cb99e4">crypt_opportunistic_encrypt</a>(m, e_templ);</div><div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;      }</div><div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;    }</div><div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;</div><div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;    <span class="comment">/* No permissible mechanisms found.  Don&#39;t sign or encrypt. */</span></div><div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;    <span class="keywordflow">if</span> (!(e_templ-&gt;<a class="code" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> &amp; (<a class="code" href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a> | APPLICATION_PGP)))</div><div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;      e_templ-&gt;<a class="code" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> = <a class="code" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a>;</div><div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;  }</div><div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;</div><div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;  <span class="comment">/* Deal with the corner case where the crypto module backend is not available.</span></div><div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;<span class="comment">   * This can happen if configured without PGP/SMIME and with GPGME, but</span></div><div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;<span class="comment">   * $crypt_use_gpgme is unset.  */</span></div><div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;  <span class="keywordflow">if</span> (e_templ-&gt;<a class="code" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> &amp;&amp; !<a class="code" href="cryptglue_8c.html#a07a6c891658dd90ef8333a1e5bbcc285">crypt_has_module_backend</a>(e_templ-&gt;<a class="code" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a>))</div><div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;  {</div><div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;    <a class="code" href="logging_8h.html#acc1fd6d7ab1603e80e11e84e90d061e4">mutt_error</a>(<a class="code" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(</div><div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;        <span class="stringliteral">&quot;No crypto backend configured.  Disabling message security setting.&quot;</span>));</div><div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;    e_templ-&gt;<a class="code" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> = <a class="code" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a>;</div><div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;  }</div><div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;</div><div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;  <span class="comment">/* specify a default fcc.  if we are in batchmode, only save a copy of</span></div><div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;<span class="comment">   * the message if the value of $copy is yes or ask-yes */</span></div><div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;</div><div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;  <span class="keyword">const</span> <span class="keyword">enum</span> <a class="code" href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35db">QuadOption</a> c_copy = <a class="code" href="helpers_8c.html#a9154ba713ce99b0937f475eec7c61af9">cs_subset_quad</a>(sub, <span class="stringliteral">&quot;copy&quot;</span>);</div><div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;</div><div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="buffer_8c.html#a2d7c4a32422377609be66b0f620c4971">mutt_buffer_is_empty</a>(&amp;fcc) &amp;&amp; !(flags &amp; <a class="code" href="send_8h.html#a0124ba8cc117eff717a4ddf672c22018">SEND_POSTPONED_FCC</a>) &amp;&amp;</div><div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;      (!(flags &amp; SEND_BATCH) || (c_copy &amp; 0x1)))</div><div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;  {</div><div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;    <span class="comment">/* set the default FCC */</span></div><div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> killfrom = <a class="code" href="queue_8h.html#ac3c9da7ac712eacbbad5cc54d7a3477e">TAILQ_EMPTY</a>(&amp;e_templ-&gt;<a class="code" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code" href="structEnvelope.html#af1aa00aed4b8767cf98f08e45a432ad8">from</a>);</div><div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;    <span class="keywordflow">if</span> (killfrom)</div><div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;    {</div><div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;      <a class="code" href="address_2address_8c.html#a68385b174baad74a9aecf3dec61432a0">mutt_addrlist_append</a>(&amp;e_templ-&gt;<a class="code" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code" href="structEnvelope.html#af1aa00aed4b8767cf98f08e45a432ad8">from</a>, <a class="code" href="send_8c.html#aa93b7a6bc9e26176ebf17bf37c7d2a87">mutt_default_from</a>(sub));</div><div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;    }</div><div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;    <a class="code" href="hook_8c.html#a6d228c86f5a1900b27af0fde26991a63">mutt_select_fcc</a>(&amp;fcc, e_templ);</div><div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;    <span class="keywordflow">if</span> (killfrom)</div><div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;    {</div><div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;      <a class="code" href="address_2address_8c.html#a396bcf6adfff6663096fa6ae99c31c9a">mutt_addrlist_clear</a>(&amp;e_templ-&gt;<a class="code" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code" href="structEnvelope.html#af1aa00aed4b8767cf98f08e45a432ad8">from</a>);</div><div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;    }</div><div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;  }</div><div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;</div><div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;  <a class="code" href="rfc3676_8c.html#ae80c6b55541960f57f67f4ea3e4467e8">mutt_rfc3676_space_stuff</a>(e_templ);</div><div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;</div><div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;  <a class="code" href="sendlib_8c.html#ae4f3b3ef1863d9821af9f82d8963e5b8">mutt_update_encoding</a>(e_templ-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>, sub);</div><div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;</div><div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;  <span class="keywordflow">if</span> (!(flags &amp; SEND_BATCH))</div><div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;  {</div><div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;  main_loop:</div><div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;</div><div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;    <a class="code" href="muttlib_8c.html#a1c0d55a453ec4d4da581de386715f780">mutt_buffer_pretty_mailbox</a>(&amp;fcc);</div><div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;    i = <a class="code" href="compose_8c.html#ab41aa2ed639a1d884984f0d42d1cf827">mutt_compose_menu</a>(</div><div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;        e_templ, &amp;fcc,</div><div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;        ((flags &amp; <a class="code" href="send_8h.html#a160dd7bb90081f1d45201ef2ab6b46d3">SEND_NO_FREE_HEADER</a>) ? <a class="code" href="compose_2lib_8h.html#adf568d592758fae1758bbb4dc4e3e554">MUTT_COMPOSE_NOFREEHEADER</a> : 0), sub);</div><div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;    <span class="keywordflow">if</span> (i == -1)</div><div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;    {</div><div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;<span class="comment">/* abort */</span></div><div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;<span class="preprocessor">#ifdef USE_NNTP</span></div><div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;      <span class="keywordflow">if</span> (flags &amp; SEND_NEWS)</div><div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;        <a class="code" href="logging_8h.html#ae108f891125caafa9250cf0959c40c04">mutt_message</a>(<a class="code" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Article not posted&quot;</span>));</div><div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;        <a class="code" href="logging_8h.html#ae108f891125caafa9250cf0959c40c04">mutt_message</a>(<a class="code" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Mail not sent&quot;</span>));</div><div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;      <span class="keywordflow">goto</span> cleanup;</div><div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;    }</div><div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (i == 1)</div><div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;    {</div><div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="send_8c.html#a08794ff2edb022ef0c0f59086da9675f">postpone_message</a>(e_templ, e_cur, <a class="code" href="buffer_8h.html#a4aca040fb75bc1dfc086cbfbf14ac8cd">mutt_buffer_string</a>(&amp;fcc), flags, sub) != 0)</div><div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;        <span class="keywordflow">goto</span> main_loop;</div><div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;      <a class="code" href="logging_8h.html#ae108f891125caafa9250cf0959c40c04">mutt_message</a>(<a class="code" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Message postponed&quot;</span>));</div><div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;      rc = 1;</div><div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;      <span class="keywordflow">goto</span> cleanup;</div><div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;    }</div><div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;  }</div><div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;</div><div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;<span class="preprocessor">#ifdef USE_NNTP</span></div><div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;  <span class="keywordflow">if</span> (!(flags &amp; SEND_NEWS))</div><div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="address_2address_8c.html#a9a6c4ff878258def25f155501ddb3e7a">mutt_addrlist_count_recips</a>(&amp;e_templ-&gt;<a class="code" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code" href="structEnvelope.html#a2d927371b3b80e025d6f7522b7361fe7">to</a>) == 0) &amp;&amp;</div><div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;        (<a class="code" href="address_2address_8c.html#a9a6c4ff878258def25f155501ddb3e7a">mutt_addrlist_count_recips</a>(&amp;e_templ-&gt;<a class="code" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code" href="structEnvelope.html#a6b00837b3cb4b41898b42307135be8b6">cc</a>) == 0) &amp;&amp;</div><div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;        (<a class="code" href="address_2address_8c.html#a9a6c4ff878258def25f155501ddb3e7a">mutt_addrlist_count_recips</a>(&amp;e_templ-&gt;<a class="code" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code" href="structEnvelope.html#aad427832f4ae422f1b16d0896c1d3af6">bcc</a>) == 0))</div><div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;    {</div><div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;      <span class="keywordflow">if</span> (flags &amp; SEND_BATCH)</div><div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;      {</div><div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;        puts(<a class="code" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;No recipients specified&quot;</span>));</div><div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;        <span class="keywordflow">goto</span> cleanup;</div><div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;      }</div><div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;</div><div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;      <a class="code" href="logging_8h.html#acc1fd6d7ab1603e80e11e84e90d061e4">mutt_error</a>(<a class="code" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;No recipients specified&quot;</span>));</div><div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;      <span class="keywordflow">goto</span> main_loop;</div><div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;    }</div><div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;</div><div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="email_2envelope_8c.html#a0108f989ca58622df272cf31b610395e">mutt_env_to_intl</a>(e_templ-&gt;<a class="code" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>, &amp;tag, &amp;err))</div><div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;  {</div><div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;    <a class="code" href="logging_8h.html#acc1fd6d7ab1603e80e11e84e90d061e4">mutt_error</a>(<a class="code" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Bad IDN in &#39;%s&#39;: &#39;%s&#39;&quot;</span>), tag, err);</div><div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;    <a class="code" href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;err);</div><div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;    <span class="keywordflow">if</span> (flags &amp; SEND_BATCH)</div><div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;      <span class="keywordflow">goto</span> cleanup;</div><div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;    <span class="keywordflow">goto</span> main_loop;</div><div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;  }</div><div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;</div><div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;  <span class="keyword">const</span> <span class="keyword">enum</span> <a class="code" href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35db">QuadOption</a> c_abort_nosubject =</div><div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;      <a class="code" href="helpers_8c.html#a9154ba713ce99b0937f475eec7c61af9">cs_subset_quad</a>(sub, <span class="stringliteral">&quot;abort_nosubject&quot;</span>);</div><div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;</div><div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;  <span class="keywordflow">if</span> (!e_templ-&gt;<a class="code" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code" href="structEnvelope.html#aa3d22c82ed26a0727508d26363e98ea7">subject</a> &amp;&amp; !(flags &amp; SEND_BATCH) &amp;&amp;</div><div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;      (<a class="code" href="question_2lib_8h.html#ab02047769214ff014b9a8a1782babadc">query_quadoption</a>(c_abort_nosubject, <a class="code" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;No subject, abort sending?&quot;</span>)) != <a class="code" href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35dbabe3800cc419f25384aaf1892fc3c812b">MUTT_NO</a>))</div><div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;  {</div><div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;    <span class="comment">/* if the abort is automatic, print an error message */</span></div><div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;    <span class="keywordflow">if</span> (c_abort_nosubject == <a class="code" href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35dbafee7088606c4724651c799a6a0b182b7">MUTT_YES</a>)</div><div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;      <a class="code" href="logging_8h.html#acc1fd6d7ab1603e80e11e84e90d061e4">mutt_error</a>(<a class="code" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;No subject specified&quot;</span>));</div><div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;    <span class="keywordflow">goto</span> main_loop;</div><div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;  }</div><div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;<span class="preprocessor">#ifdef USE_NNTP</span></div><div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;  <span class="keywordflow">if</span> ((flags &amp; SEND_NEWS) &amp;&amp; !e_templ-&gt;<a class="code" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code" href="structEnvelope.html#aa3d22c82ed26a0727508d26363e98ea7">subject</a>)</div><div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;  {</div><div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;    <a class="code" href="logging_8h.html#acc1fd6d7ab1603e80e11e84e90d061e4">mutt_error</a>(<a class="code" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;No subject specified&quot;</span>));</div><div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;    <span class="keywordflow">goto</span> main_loop;</div><div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;  }</div><div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;</div><div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;  <span class="keywordflow">if</span> ((flags &amp; SEND_NEWS) &amp;&amp; !e_templ-&gt;<a class="code" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code" href="structEnvelope.html#a5f680f60f1713477a879877dcbd21a5c">newsgroups</a>)</div><div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;  {</div><div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;    <a class="code" href="logging_8h.html#acc1fd6d7ab1603e80e11e84e90d061e4">mutt_error</a>(<a class="code" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;No newsgroup specified&quot;</span>));</div><div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;    <span class="keywordflow">goto</span> main_loop;</div><div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;  }</div><div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;</div><div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;  <span class="keywordflow">if</span> (!(flags &amp; SEND_BATCH) &amp;&amp; <a class="code" href="send_8c.html#aad5805f2620506ae4bc2d7f6474cb849">abort_for_missing_attachments</a>(e_templ-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>, sub))</div><div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;  {</div><div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;    <span class="keywordflow">goto</span> main_loop;</div><div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;  }</div><div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;</div><div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;  <span class="keywordflow">if</span> (e_templ-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>-&gt;<a class="code" href="structBody.html#ac55cdfce46eed13151dcfe9b329d254c">next</a>)</div><div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;    e_templ-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a> = <a class="code" href="multipart_8c.html#a336393521f79b3158f5da26385f20103">mutt_make_multipart</a>(e_templ-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>);</div><div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;</div><div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;  <span class="comment">/* Ok, we need to do it this way instead of handling all fcc stuff in</span></div><div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;<span class="comment">   * one place in order to avoid going to main_loop with encoded &quot;env&quot;</span></div><div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;<span class="comment">   * in case of error.  Ugh.  */</span></div><div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;</div><div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;  <a class="code" href="send_8c.html#a1ba9ce78a67261e872a264bc956ef857">mutt_encode_descriptions</a>(e_templ-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>, <span class="keyword">true</span>, sub);</div><div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;</div><div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;  <span class="comment">/* Make sure that clear_content and free_clear_content are</span></div><div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;<span class="comment">   * properly initialized -- we may visit this particular place in</span></div><div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;<span class="comment">   * the code multiple times, including after a failed call to</span></div><div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;<span class="comment">   * mutt_protect().  */</span></div><div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;</div><div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;  clear_content = NULL;</div><div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;  free_clear_content = <span class="keyword">false</span>;</div><div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;</div><div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a>)</div><div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;  {</div><div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;    <span class="keywordflow">if</span> (e_templ-&gt;<a class="code" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> &amp; (<a class="code" href="ncrypt_2lib_8h.html#aacaa4abd4c0696e260b7a0f1d466360a">SEC_ENCRYPT</a> | <a class="code" href="ncrypt_2lib_8h.html#ae12c003463c99d28f65f1d6b8b053b2c">SEC_SIGN</a> | <a class="code" href="ncrypt_2lib_8h.html#a0b36be5c32ca90d8f2caef9ea9d627fc">SEC_AUTOCRYPT</a>))</div><div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;    {</div><div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;      <span class="comment">/* save the decrypted attachments */</span></div><div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;      clear_content = e_templ-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>;</div><div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;</div><div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;      <span class="keywordflow">if</span> ((<a class="code" href="crypt_8c.html#a35eba8f2cd36c286f2226ff748ee63e6">crypt_get_keys</a>(m, e_templ, &amp;pgpkeylist, 0) == -1) ||</div><div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;          (<a class="code" href="crypt_8c.html#afb7fbdc0157b9f7fd68b378232d554fc">mutt_protect</a>(m, e_templ, pgpkeylist, <span class="keyword">false</span>) == -1))</div><div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;      {</div><div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;        e_templ-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a> = <a class="code" href="multipart_8c.html#a71d5ccd20fbbbe2fa56e6d1f577e34ae">mutt_remove_multipart</a>(e_templ-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>);</div><div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;</div><div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;        <a class="code" href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;pgpkeylist);</div><div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;</div><div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160;        <a class="code" href="send_8c.html#af1b54154700865964598299ed1cf9a6a">decode_descriptions</a>(e_templ-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>);</div><div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;        <span class="keywordflow">goto</span> main_loop;</div><div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;      }</div><div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;      <a class="code" href="send_8c.html#a1ba9ce78a67261e872a264bc956ef857">mutt_encode_descriptions</a>(e_templ-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>, <span class="keyword">false</span>, sub);</div><div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;    }</div><div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;</div><div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;    <span class="comment">/* at this point, e_templ-&gt;body is one of the following three things:</span></div><div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;<span class="comment">     * - multipart/signed.     In this case, clear_content is a child</span></div><div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;<span class="comment">     * - multipart/encrypted.  In this case, clear_content exists independently</span></div><div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160;<span class="comment">     * - application/pgp.      In this case, clear_content exists independently</span></div><div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160;<span class="comment">     * - something else.       In this case, it&#39;s the same as clear_content */</span></div><div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;</div><div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;    <span class="comment">/* This is ugly -- lack of &quot;reporting back&quot; from mutt_protect(). */</span></div><div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;</div><div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160;    <span class="keywordflow">if</span> (clear_content &amp;&amp; (e_templ-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a> != clear_content) &amp;&amp;</div><div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;        (e_templ-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>-&gt;<a class="code" href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">parts</a> != clear_content))</div><div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;      free_clear_content = <span class="keyword">true</span>;</div><div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;  }</div><div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;</div><div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="options_8h.html#a1301697a6664d40900be2c4761c192c7">OptNoCurses</a>)</div><div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160;    <a class="code" href="logging_8h.html#ae108f891125caafa9250cf0959c40c04">mutt_message</a>(<a class="code" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Sending message...&quot;</span>));</div><div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;</div><div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160;  <a class="code" href="sendlib_8c.html#ac35da3d19eb0d95d4f6260adab57b4c9">mutt_prepare_envelope</a>(e_templ-&gt;<a class="code" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>, <span class="keyword">true</span>, sub);</div><div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;</div><div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> c_fcc_before_send = <a class="code" href="helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(sub, <span class="stringliteral">&quot;fcc_before_send&quot;</span>);</div><div class="line"><a name="l02862"></a><span class="lineno"> 2862</span>&#160;  <span class="keywordflow">if</span> (c_fcc_before_send)</div><div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160;    <a class="code" href="send_8c.html#a255efc8a4a366c3de07d48da23d03a32">save_fcc</a>(m, e_templ, &amp;fcc, clear_content, pgpkeylist, flags, &amp;finalpath, sub);</div><div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160;</div><div class="line"><a name="l02865"></a><span class="lineno"> 2865</span>&#160;  i = <a class="code" href="send_8c.html#a859ddbab5f9384328fd06bf9c18c02f2">invoke_mta</a>(m, e_templ, sub);</div><div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160;  <span class="keywordflow">if</span> (i &lt; 0)</div><div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160;  {</div><div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160;    <span class="keywordflow">if</span> (!(flags &amp; SEND_BATCH))</div><div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160;    {</div><div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a>)</div><div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160;        ; <span class="comment">// do nothing</span></div><div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((e_templ-&gt;<a class="code" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> &amp; (<a class="code" href="ncrypt_2lib_8h.html#aacaa4abd4c0696e260b7a0f1d466360a">SEC_ENCRYPT</a> | <a class="code" href="ncrypt_2lib_8h.html#a0b36be5c32ca90d8f2caef9ea9d627fc">SEC_AUTOCRYPT</a>)) ||</div><div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160;               ((e_templ-&gt;<a class="code" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> &amp; <a class="code" href="ncrypt_2lib_8h.html#ae12c003463c99d28f65f1d6b8b053b2c">SEC_SIGN</a>) &amp;&amp; (e_templ-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>-&gt;<a class="code" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a> == <a class="code" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79ac5074066199e3f540550ca0b1a38978e">TYPE_APPLICATION</a>)))</div><div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;      {</div><div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160;        <span class="keywordflow">if</span> (e_templ-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a> != clear_content)</div><div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;        {</div><div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160;          <a class="code" href="email_2body_8c.html#a129af1c316fcbc26b55fb48957bab2cb">mutt_body_free</a>(&amp;e_templ-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>); <span class="comment">/* destroy PGP data */</span></div><div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160;          e_templ-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a> = clear_content;  <span class="comment">/* restore clear text. */</span></div><div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;        }</div><div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160;      }</div><div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((e_templ-&gt;<a class="code" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> &amp; <a class="code" href="ncrypt_2lib_8h.html#ae12c003463c99d28f65f1d6b8b053b2c">SEC_SIGN</a>) &amp;&amp; (e_templ-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>-&gt;<a class="code" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a> == <a class="code" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79a877e24e62c85f20ff0e0f09ab983031e">TYPE_MULTIPART</a>))</div><div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;      {</div><div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;        <a class="code" href="email_2body_8c.html#a129af1c316fcbc26b55fb48957bab2cb">mutt_body_free</a>(&amp;e_templ-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>-&gt;<a class="code" href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">parts</a>-&gt;<a class="code" href="structBody.html#ac55cdfce46eed13151dcfe9b329d254c">next</a>); <span class="comment">/* destroy sig */</span></div><div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;        e_templ-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a> = <a class="code" href="multipart_8c.html#a71d5ccd20fbbbe2fa56e6d1f577e34ae">mutt_remove_multipart</a>(e_templ-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>);</div><div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;      }</div><div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;</div><div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160;      <a class="code" href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;pgpkeylist);</div><div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160;      <a class="code" href="email_2envelope_8c.html#a244dacf9b1001c9ce1dbd473e001381f">mutt_env_free</a>(&amp;e_templ-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>-&gt;<a class="code" href="structBody.html#a62f6c9b4245ed3b6b9296adb45aa4010">mime_headers</a>); <span class="comment">/* protected headers */</span></div><div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160;      e_templ-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a> = <a class="code" href="multipart_8c.html#a71d5ccd20fbbbe2fa56e6d1f577e34ae">mutt_remove_multipart</a>(e_templ-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>);</div><div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160;      <a class="code" href="send_8c.html#af1b54154700865964598299ed1cf9a6a">decode_descriptions</a>(e_templ-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>);</div><div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160;      <a class="code" href="sendlib_8c.html#a99b5cff5076c9e25bce367f0bae45f4c">mutt_unprepare_envelope</a>(e_templ-&gt;<a class="code" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>);</div><div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160;      <a class="code" href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;finalpath);</div><div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160;      <span class="keywordflow">goto</span> main_loop;</div><div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160;    }</div><div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;    {</div><div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;      puts(<a class="code" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Could not send the message&quot;</span>));</div><div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160;      <span class="keywordflow">goto</span> cleanup;</div><div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;    }</div><div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160;  }</div><div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160;</div><div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160;  <span class="keywordflow">if</span> (!c_fcc_before_send)</div><div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160;    <a class="code" href="send_8c.html#a255efc8a4a366c3de07d48da23d03a32">save_fcc</a>(m, e_templ, &amp;fcc, clear_content, pgpkeylist, flags, &amp;finalpath, sub);</div><div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160;</div><div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="options_8h.html#a1301697a6664d40900be2c4761c192c7">OptNoCurses</a>)</div><div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160;  {</div><div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160;    <a class="code" href="logging_8h.html#ae108f891125caafa9250cf0959c40c04">mutt_message</a>((i != 0) ? <a class="code" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Sending in background&quot;</span>) :</div><div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160;                            (flags &amp; SEND_NEWS) ? <a class="code" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Article posted&quot;</span>) : <span class="comment">/* USE_NNTP */</span></div><div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160;                                <a class="code" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Mail sent&quot;</span>));</div><div class="line"><a name="l02910"></a><span class="lineno"> 2910</span>&#160;<span class="preprocessor">#ifdef USE_NOTMUCH</span></div><div class="line"><a name="l02911"></a><span class="lineno"> 2911</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> c_nm_record = <a class="code" href="helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(sub, <span class="stringliteral">&quot;nm_record&quot;</span>);</div><div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160;    <span class="keywordflow">if</span> (c_nm_record)</div><div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160;      <a class="code" href="notmuch_2lib_8h.html#a76a97a39757a2e0441d23eab1ba5a221">nm_record_message</a>(m, finalpath, e_cur);</div><div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02915"></a><span class="lineno"> 2915</span>&#160;    <a class="code" href="muttlib_8c.html#a6fbcbe533be7c4e05d99b0eb9cdb2581">mutt_sleep</a>(0);</div><div class="line"><a name="l02916"></a><span class="lineno"> 2916</span>&#160;  }</div><div class="line"><a name="l02917"></a><span class="lineno"> 2917</span>&#160;</div><div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a>)</div><div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160;    <a class="code" href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;pgpkeylist);</div><div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160;</div><div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160;  <span class="keywordflow">if</span> ((<a class="code" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> != 0) &amp;&amp; free_clear_content)</div><div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160;    <a class="code" href="email_2body_8c.html#a129af1c316fcbc26b55fb48957bab2cb">mutt_body_free</a>(&amp;clear_content);</div><div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160;</div><div class="line"><a name="l02924"></a><span class="lineno"> 2924</span>&#160;  <span class="comment">/* set &#39;replied&#39; flag only if the user didn&#39;t change/remove</span></div><div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160;<span class="comment">   * In-Reply-To: and References: headers during edit */</span></div><div class="line"><a name="l02926"></a><span class="lineno"> 2926</span>&#160;  <span class="keywordflow">if</span> (flags &amp; <a class="code" href="send_8h.html#ac23e1891bcbc52cc25b5824acfb42d3c">SEND_REPLY</a>)</div><div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160;  {</div><div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160;    <span class="keywordflow">if</span> (!(flags &amp; SEND_POSTPONED) &amp;&amp; m)</div><div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160;    {</div><div class="line"><a name="l02930"></a><span class="lineno"> 2930</span>&#160;      <a class="code" href="queue_8h.html#a77999ebdf5aaf7af8b8ea22bf208c432">STAILQ_FOREACH</a>(en, el, entries)</div><div class="line"><a name="l02931"></a><span class="lineno"> 2931</span>&#160;      {</div><div class="line"><a name="l02932"></a><span class="lineno"> 2932</span>&#160;        <a class="code" href="protos_8h.html#a6fdc3f2ea4f35b0e8e1fbd6b17d2b27c">mutt_set_flag</a>(m, en-&gt;<a class="code" href="structEmailNode.html#a812e5a33b27b12a78daacbe246089abb">email</a>, <a class="code" href="mutt_8h.html#ac6606ebe91c8ac66a2c314c79f5ab013af85858c2c1c662fe4c0407b31c75410b">MUTT_REPLIED</a>, <a class="code" href="send_8c.html#a19cc8b134c97bc3752c778d8b4977e8c">is_reply</a>(en-&gt;<a class="code" href="structEmailNode.html#a812e5a33b27b12a78daacbe246089abb">email</a>, e_templ));</div><div class="line"><a name="l02933"></a><span class="lineno"> 2933</span>&#160;      }</div><div class="line"><a name="l02934"></a><span class="lineno"> 2934</span>&#160;    }</div><div class="line"><a name="l02935"></a><span class="lineno"> 2935</span>&#160;  }</div><div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160;</div><div class="line"><a name="l02937"></a><span class="lineno"> 2937</span>&#160;  rc = 0;</div><div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160;</div><div class="line"><a name="l02939"></a><span class="lineno"> 2939</span>&#160;cleanup:</div><div class="line"><a name="l02940"></a><span class="lineno"> 2940</span>&#160;  <a class="code" href="buffer_8c.html#a59b13bca38b1b314e2bc5ad142d2df49">mutt_buffer_dealloc</a>(&amp;fcc);</div><div class="line"><a name="l02941"></a><span class="lineno"> 2941</span>&#160;</div><div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160;  <span class="keywordflow">if</span> (flags &amp; SEND_POSTPONED)</div><div class="line"><a name="l02943"></a><span class="lineno"> 2943</span>&#160;  {</div><div class="line"><a name="l02944"></a><span class="lineno"> 2944</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; APPLICATION_PGP)</div><div class="line"><a name="l02945"></a><span class="lineno"> 2945</span>&#160;    {</div><div class="line"><a name="l02946"></a><span class="lineno"> 2946</span>&#160;      <a class="code" href="subset_8c.html#a8d7d5e60bd8f7f0f8ffd8522de126b12">cs_subset_str_string_set</a>(sub, <span class="stringliteral">&quot;pgp_sign_as&quot;</span>, pgp_sign_as, NULL);</div><div class="line"><a name="l02947"></a><span class="lineno"> 2947</span>&#160;      <a class="code" href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;pgp_sign_as);</div><div class="line"><a name="l02948"></a><span class="lineno"> 2948</span>&#160;    }</div><div class="line"><a name="l02949"></a><span class="lineno"> 2949</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code" href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a>)</div><div class="line"><a name="l02950"></a><span class="lineno"> 2950</span>&#160;    {</div><div class="line"><a name="l02951"></a><span class="lineno"> 2951</span>&#160;      <a class="code" href="subset_8c.html#a8d7d5e60bd8f7f0f8ffd8522de126b12">cs_subset_str_string_set</a>(sub, <span class="stringliteral">&quot;smime_sign_as&quot;</span>, smime_sign_as, NULL);</div><div class="line"><a name="l02952"></a><span class="lineno"> 2952</span>&#160;      <a class="code" href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;smime_sign_as);</div><div class="line"><a name="l02953"></a><span class="lineno"> 2953</span>&#160;    }</div><div class="line"><a name="l02954"></a><span class="lineno"> 2954</span>&#160;  }</div><div class="line"><a name="l02955"></a><span class="lineno"> 2955</span>&#160;</div><div class="line"><a name="l02956"></a><span class="lineno"> 2956</span>&#160;  <a class="code" href="file_8c.html#a31f49795ff5b9558db5476e5777e63b6">mutt_file_fclose</a>(&amp;fp_tmp);</div><div class="line"><a name="l02957"></a><span class="lineno"> 2957</span>&#160;  <span class="keywordflow">if</span> (!(flags &amp; <a class="code" href="send_8h.html#a160dd7bb90081f1d45201ef2ab6b46d3">SEND_NO_FREE_HEADER</a>))</div><div class="line"><a name="l02958"></a><span class="lineno"> 2958</span>&#160;    <a class="code" href="email_2email_8c.html#ae9f719d3fc31d00b92bcf9f77d56ee67">email_free</a>(&amp;e_templ);</div><div class="line"><a name="l02959"></a><span class="lineno"> 2959</span>&#160;</div><div class="line"><a name="l02960"></a><span class="lineno"> 2960</span>&#160;  <a class="code" href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;finalpath);</div><div class="line"><a name="l02961"></a><span class="lineno"> 2961</span>&#160;  <span class="keywordflow">return</span> rc;</div><div class="line"><a name="l02962"></a><span class="lineno"> 2962</span>&#160;}</div><div class="ttc" id="hook_8h_html_a365ef87efead32b0e7a8265927171dc1"><div class="ttname"><a href="hook_8h.html#a365ef87efead32b0e7a8265927171dc1">MUTT_SEND_HOOK</a></div><div class="ttdeci">#define MUTT_SEND_HOOK</div><div class="ttdoc">send-hook: when composing a new email </div><div class="ttdef"><b>Definition:</b> <a href="hook_8h_source.html#l00041">hook.h:41</a></div></div>
<div class="ttc" id="attachments_8c_html_a9fb5dd768a13b9f083ca3a5e2e713db6"><div class="ttname"><a href="attachments_8c.html#a9fb5dd768a13b9f083ca3a5e2e713db6">mutt_parse_mime_message</a></div><div class="ttdeci">void mutt_parse_mime_message(struct Mailbox *m, struct Email *e, FILE *fp)</div><div class="ttdoc">Parse a MIME email. </div><div class="ttdef"><b>Definition:</b> <a href="attachments_8c_source.html#l00591">attachments.c:591</a></div></div>
<div class="ttc" id="notmuch_2lib_8h_html_a76a97a39757a2e0441d23eab1ba5a221"><div class="ttname"><a href="notmuch_2lib_8h.html#a76a97a39757a2e0441d23eab1ba5a221">nm_record_message</a></div><div class="ttdeci">int nm_record_message(struct Mailbox *m, char *path, struct Email *e)</div><div class="ttdoc">Add a message to the Notmuch database. </div><div class="ttdef"><b>Definition:</b> <a href="notmuch_8c_source.html#l01890">notmuch.c:1890</a></div></div>
<div class="ttc" id="mutt_2string_8c_html_a6b6a50296dd2a31863a43379ef4a343d"><div class="ttname"><a href="mutt_2string_8c.html#a6b6a50296dd2a31863a43379ef4a343d">mutt_str_equal</a></div><div class="ttdeci">bool mutt_str_equal(const char *a, const char *b)</div><div class="ttdoc">Compare two strings. </div><div class="ttdef"><b>Definition:</b> <a href="mutt_2string_8c_source.html#l00904">string.c:904</a></div></div>
<div class="ttc" id="gui_2lib_8h_html"><div class="ttname"><a href="gui_2lib_8h.html">lib.h</a></div><div class="ttdoc">Convenience wrapper for the gui headers. </div></div>
<div class="ttc" id="date_8c_html_a97bacb1574ec0b1c69b6236fbacceccf"><div class="ttname"><a href="date_8c.html#a97bacb1574ec0b1c69b6236fbacceccf">mutt_date_epoch</a></div><div class="ttdeci">time_t mutt_date_epoch(void)</div><div class="ttdoc">Return the number of seconds since the Unix epoch. </div><div class="ttdef"><b>Definition:</b> <a href="date_8c_source.html#l00427">date.c:427</a></div></div>
<div class="ttc" id="structContext_html"><div class="ttname"><a href="structContext.html">Context</a></div><div class="ttdoc">The &quot;current&quot; mailbox. </div><div class="ttdef"><b>Definition:</b> <a href="context_8h_source.html#l00037">context.h:37</a></div></div>
<div class="ttc" id="muttlib_8h_html_a7f1db9db6f710a84cace77248096e2ac"><div class="ttname"><a href="muttlib_8h.html#a7f1db9db6f710a84cace77248096e2ac">mutt_buffer_mktemp</a></div><div class="ttdeci">#define mutt_buffer_mktemp(buf)</div><div class="ttdef"><b>Definition:</b> <a href="muttlib_8h_source.html#l00074">muttlib.h:74</a></div></div>
<div class="ttc" id="quad_8h_html_a738f558a271fe5035e0ee3b700ee35dbaaf90604c0e1430d5002944c93ac46952"><div class="ttname"><a href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35dbaaf90604c0e1430d5002944c93ac46952">MUTT_ASKNO</a></div><div class="ttdoc">Ask the user, defaulting to &amp;#39;No&amp;#39;. </div><div class="ttdef"><b>Definition:</b> <a href="quad_8h_source.html#l00040">quad.h:40</a></div></div>
<div class="ttc" id="structBody_html_afe3cd2c4b1070e3d0edbf1fed939ac5a"><div class="ttname"><a href="structBody.html#afe3cd2c4b1070e3d0edbf1fed939ac5a">Body::filename</a></div><div class="ttdeci">char * filename</div><div class="ttdoc">when sending a message, this is the file to which this structure refers </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00046">body.h:46</a></div></div>
<div class="ttc" id="structMailbox_html_a5638329fb2ebd4bbe1f4a949ec8de174"><div class="ttname"><a href="structMailbox.html#a5638329fb2ebd4bbe1f4a949ec8de174">Mailbox::type</a></div><div class="ttdeci">enum MailboxType type</div><div class="ttdoc">Mailbox type. </div><div class="ttdef"><b>Definition:</b> <a href="mailbox_8h_source.html#l00105">mailbox.h:105</a></div></div>
<div class="ttc" id="format__flags_8h_html_ad2734d319d795141616e1b5f241be1b2"><div class="ttname"><a href="format__flags_8h.html#ad2734d319d795141616e1b5f241be1b2">MuttFormatFlags</a></div><div class="ttdeci">uint8_t MuttFormatFlags</div><div class="ttdoc">Flags for mutt_expando_format(), e.g. MUTT_FORMAT_FORCESUBJ. </div><div class="ttdef"><b>Definition:</b> <a href="format__flags_8h_source.html#l00029">format_flags.h:29</a></div></div>
<div class="ttc" id="string2_8h_html_a7e0481bed27661ea2679f256b24e0283"><div class="ttname"><a href="string2_8h.html#a7e0481bed27661ea2679f256b24e0283">NONULL</a></div><div class="ttdeci">#define NONULL(x)</div><div class="ttdef"><b>Definition:</b> <a href="string2_8h_source.html#l00037">string2.h:37</a></div></div>
<div class="ttc" id="memory_8c_html_a4c1612d209c7825d55e6a014df352f03"><div class="ttname"><a href="memory_8c.html#a4c1612d209c7825d55e6a014df352f03">mutt_mem_calloc</a></div><div class="ttdeci">void * mutt_mem_calloc(size_t nmemb, size_t size)</div><div class="ttdoc">Allocate zeroed memory on the heap. </div><div class="ttdef"><b>Definition:</b> <a href="memory_8c_source.html#l00050">memory.c:50</a></div></div>
<div class="ttc" id="structBody_html_a62f6c9b4245ed3b6b9296adb45aa4010"><div class="ttname"><a href="structBody.html#a62f6c9b4245ed3b6b9296adb45aa4010">Body::mime_headers</a></div><div class="ttdeci">struct Envelope * mime_headers</div><div class="ttdoc">Memory hole protected headers. </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00063">body.h:63</a></div></div>
<div class="ttc" id="buffer_8c_html_adb26acff5f6b9bb7c322669bcb7c48e3"><div class="ttname"><a href="buffer_8c.html#adb26acff5f6b9bb7c322669bcb7c48e3">mutt_buffer_reset</a></div><div class="ttdeci">void mutt_buffer_reset(struct Buffer *buf)</div><div class="ttdoc">Reset an existing Buffer. </div><div class="ttdef"><b>Definition:</b> <a href="buffer_8c_source.html#l00079">buffer.c:79</a></div></div>
<div class="ttc" id="protos_8h_html_a6fdc3f2ea4f35b0e8e1fbd6b17d2b27c"><div class="ttname"><a href="protos_8h.html#a6fdc3f2ea4f35b0e8e1fbd6b17d2b27c">mutt_set_flag</a></div><div class="ttdeci">#define mutt_set_flag(m, e, flag, bf)</div><div class="ttdef"><b>Definition:</b> <a href="protos_8h_source.html#l00066">protos.h:66</a></div></div>
<div class="ttc" id="helpers_8c_html_ae50f679dd6c5bd1ba820884c8602f038"><div class="ttname"><a href="helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a></div><div class="ttdeci">bool cs_subset_bool(const struct ConfigSubset *sub, const char *name)</div><div class="ttdoc">Get a boolean config item by name. </div><div class="ttdef"><b>Definition:</b> <a href="helpers_8c_source.html#l00071">helpers.c:71</a></div></div>
<div class="ttc" id="mutt__header_8h_html"><div class="ttname"><a href="mutt__header_8h.html">mutt_header.h</a></div><div class="ttdoc">Representation of the email&amp;#39;s header. </div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_ad980bff69bb614893ad8e7e1c28a5023"><div class="ttname"><a href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a></div><div class="ttdeci">#define WithCrypto</div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00113">lib.h:113</a></div></div>
<div class="ttc" id="alias_8c_html_a7c57d5376e9a1cf5e1f504a452996b86"><div class="ttname"><a href="alias_8c.html#a7c57d5376e9a1cf5e1f504a452996b86">mutt_expand_aliases</a></div><div class="ttdeci">void mutt_expand_aliases(struct AddressList *al)</div><div class="ttdoc">Expand aliases in a List of Addresses. </div><div class="ttdef"><b>Definition:</b> <a href="alias_8c_source.html#l00300">alias.c:300</a></div></div>
<div class="ttc" id="email_2envelope_8c_html_a244dacf9b1001c9ce1dbd473e001381f"><div class="ttname"><a href="email_2envelope_8c.html#a244dacf9b1001c9ce1dbd473e001381f">mutt_env_free</a></div><div class="ttdeci">void mutt_env_free(struct Envelope **ptr)</div><div class="ttdoc">Free an Envelope. </div><div class="ttdef"><b>Definition:</b> <a href="email_2envelope_8c_source.html#l00096">envelope.c:96</a></div></div>
<div class="ttc" id="send_8h_html_a0124ba8cc117eff717a4ddf672c22018"><div class="ttname"><a href="send_8h.html#a0124ba8cc117eff717a4ddf672c22018">SEND_POSTPONED_FCC</a></div><div class="ttdeci">#define SEND_POSTPONED_FCC</div><div class="ttdoc">Used by mutt_get_postponed() to signal that the x-mutt-fcc header field was present. </div><div class="ttdef"><b>Definition:</b> <a href="send_8h_source.html#l00048">send.h:48</a></div></div>
<div class="ttc" id="send_8h_html_aa0a201a6d90a4760c1e0ece8be43c1cb"><div class="ttname"><a href="send_8h.html#aa0a201a6d90a4760c1e0ece8be43c1cb">SEND_TO_SENDER</a></div><div class="ttdeci">#define SEND_TO_SENDER</div><div class="ttdoc">Compose new email to sender. </div><div class="ttdef"><b>Definition:</b> <a href="send_8h_source.html#l00051">send.h:51</a></div></div>
<div class="ttc" id="imap_2lib_8h_html"><div class="ttname"><a href="imap_2lib_8h.html">lib.h</a></div><div class="ttdoc">IMAP network mailbox. </div></div>
<div class="ttc" id="send_8c_html_a08f60d273517436bc186ba194c086108"><div class="ttname"><a href="send_8c.html#a08f60d273517436bc186ba194c086108">mutt_make_greeting</a></div><div class="ttdeci">static void mutt_make_greeting(struct Mailbox *m, struct Email *e, FILE *fp_out, struct ConfigSubset *sub)</div><div class="ttdoc">Add greetings string. </div><div class="ttdef"><b>Definition:</b> <a href="send_8c_source.html#l00706">send.c:706</a></div></div>
<div class="ttc" id="structEmail_html"><div class="ttname"><a href="structEmail.html">Email</a></div><div class="ttdoc">The envelope/body of an email. </div><div class="ttdef"><b>Definition:</b> <a href="email_8h_source.html#l00037">email.h:37</a></div></div>
<div class="ttc" id="pool_8c_html_a2129d5ea0085753afdd37cf62161845d"><div class="ttname"><a href="pool_8c.html#a2129d5ea0085753afdd37cf62161845d">mutt_buffer_pool_get</a></div><div class="ttdeci">struct Buffer * mutt_buffer_pool_get(void)</div><div class="ttdoc">Get a Buffer from the pool. </div><div class="ttdef"><b>Definition:</b> <a href="pool_8c_source.html#l00101">pool.c:101</a></div></div>
<div class="ttc" id="queue_8h_html_a7d6894360bd1c41e0e6f6d84998c1362"><div class="ttname"><a href="queue_8h.html#a7d6894360bd1c41e0e6f6d84998c1362">TAILQ_FIRST</a></div><div class="ttdeci">#define TAILQ_FIRST(head)</div><div class="ttdef"><b>Definition:</b> <a href="queue_8h_source.html#l00716">queue.h:716</a></div></div>
<div class="ttc" id="email_2email_8c_html_ae9f719d3fc31d00b92bcf9f77d56ee67"><div class="ttname"><a href="email_2email_8c.html#ae9f719d3fc31d00b92bcf9f77d56ee67">email_free</a></div><div class="ttdeci">void email_free(struct Email **ptr)</div><div class="ttdoc">Free an Email. </div><div class="ttdef"><b>Definition:</b> <a href="email_2email_8c_source.html#l00044">email.c:44</a></div></div>
<div class="ttc" id="logging_8h_html_afaa521ab22db877ccf1b87e679e1b43e"><div class="ttname"><a href="logging_8h.html#afaa521ab22db877ccf1b87e679e1b43e">mutt_perror</a></div><div class="ttdeci">#define mutt_perror(...)</div><div class="ttdef"><b>Definition:</b> <a href="logging_8h_source.html#l00085">logging.h:85</a></div></div>
<div class="ttc" id="send_8c_html_ad5e73f6a253107a7f55ee7388fbbf92f"><div class="ttname"><a href="send_8c.html#ad5e73f6a253107a7f55ee7388fbbf92f">fix_end_of_file</a></div><div class="ttdeci">static void fix_end_of_file(const char *data)</div><div class="ttdoc">Ensure a file ends with a linefeed. </div><div class="ttdef"><b>Definition:</b> <a href="send_8c_source.html#l01608">send.c:1608</a></div></div>
<div class="ttc" id="mutt_8h_html_aa576482dcb86d7d547476221029b176a"><div class="ttname"><a href="mutt_8h.html#aa576482dcb86d7d547476221029b176a">MUTT_ALIAS</a></div><div class="ttdeci">#define MUTT_ALIAS</div><div class="ttdoc">Do alias &quot;completion&quot; by calling up the alias-menu. </div><div class="ttdef"><b>Definition:</b> <a href="mutt_8h_source.html#l00053">mutt.h:53</a></div></div>
<div class="ttc" id="sendlib_8c_html_ae4f3b3ef1863d9821af9f82d8963e5b8"><div class="ttname"><a href="sendlib_8c.html#ae4f3b3ef1863d9821af9f82d8963e5b8">mutt_update_encoding</a></div><div class="ttdeci">void mutt_update_encoding(struct Body *a, struct ConfigSubset *sub)</div><div class="ttdoc">Update the encoding type. </div><div class="ttdef"><b>Definition:</b> <a href="sendlib_8c_source.html#l00904">sendlib.c:904</a></div></div>
<div class="ttc" id="imap_8c_html_ab4f27af8eb857a20834f445be3f498de"><div class="ttname"><a href="imap_8c.html#ab4f27af8eb857a20834f445be3f498de">imap_path_probe</a></div><div class="ttdeci">enum MailboxType imap_path_probe(const char *path, const struct stat *st)</div><div class="ttdoc">Is this an IMAP Mailbox? - Implements MxOps::path_probe() </div><div class="ttdef"><b>Definition:</b> <a href="imap_8c_source.html#l02400">imap.c:2400</a></div></div>
<div class="ttc" id="structEnvelope_html_a6044b60220b8029a6a505e5b61f1cadc"><div class="ttname"><a href="structEnvelope.html#a6044b60220b8029a6a505e5b61f1cadc">Envelope::mail_followup_to</a></div><div class="ttdeci">struct AddressList mail_followup_to</div><div class="ttdoc">Email&amp;#39;s &amp;#39;mail-followup-to&amp;#39;. </div><div class="ttdef"><b>Definition:</b> <a href="envelope_8h_source.html#l00063">envelope.h:63</a></div></div>
<div class="ttc" id="queue_8h_html_a16e5fc168e7f3494d4b1df54447d871e"><div class="ttname"><a href="queue_8h.html#a16e5fc168e7f3494d4b1df54447d871e">TAILQ_FOREACH</a></div><div class="ttdeci">#define TAILQ_FOREACH(var, head, field)</div><div class="ttdef"><b>Definition:</b> <a href="queue_8h_source.html#l00718">queue.h:718</a></div></div>
<div class="ttc" id="structEmail_html_a57ad6ac618c0f685804f6f5bb390b3a6"><div class="ttname"><a href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">Email::body</a></div><div class="ttdeci">struct Body * body</div><div class="ttdoc">List of MIME parts. </div><div class="ttdef"><b>Definition:</b> <a href="email_8h_source.html#l00091">email.h:91</a></div></div>
<div class="ttc" id="context_8c_html_a3d99ae9e3203ce327227f9ab3f711427"><div class="ttname"><a href="context_8c.html#a3d99ae9e3203ce327227f9ab3f711427">ctx_mailbox</a></div><div class="ttdeci">struct Mailbox * ctx_mailbox(struct Context *ctx)</div><div class="ttdoc">wrapper to get the mailbox in a Context, or NULL </div><div class="ttdef"><b>Definition:</b> <a href="context_8c_source.html#l00444">context.c:444</a></div></div>
<div class="ttc" id="mailbox_8h_html_af65addf714c28dd5d483cb426100921da6d3955b4b5acc450ba154b6ec9100803"><div class="ttname"><a href="mailbox_8h.html#af65addf714c28dd5d483cb426100921da6d3955b4b5acc450ba154b6ec9100803">MUTT_NNTP</a></div><div class="ttdoc">&amp;#39;NNTP&amp;#39; (Usenet) Mailbox type </div><div class="ttdef"><b>Definition:</b> <a href="mailbox_8h_source.html#l00052">mailbox.h:52</a></div></div>
<div class="ttc" id="send_8c_html_a5e533b7adb511ebbadbd637e3264fb05"><div class="ttname"><a href="send_8c.html#a5e533b7adb511ebbadbd637e3264fb05">include_forward</a></div><div class="ttdeci">static int include_forward(struct Mailbox *m, struct Email *e, FILE *fp_out, struct ConfigSubset *sub)</div><div class="ttdoc">Write out a forwarded message. </div><div class="ttdef"><b>Definition:</b> <a href="send_8c_source.html#l00483">send.c:483</a></div></div>
<div class="ttc" id="email_2lib_8h_html"><div class="ttname"><a href="email_2lib_8h.html">lib.h</a></div><div class="ttdoc">Structs that make up an email. </div></div>
<div class="ttc" id="hdrline_8h_html"><div class="ttname"><a href="hdrline_8h.html">hdrline.h</a></div><div class="ttdoc">String processing routines to generate the mail index. </div></div>
<div class="ttc" id="recvattach_8c_html_a7688e395101baa5931494c883909d1da"><div class="ttname"><a href="recvattach_8c.html#a7688e395101baa5931494c883909d1da">mutt_generate_recvattach_list</a></div><div class="ttdeci">void mutt_generate_recvattach_list(struct AttachCtx *actx, struct Email *e, struct Body *parts, FILE *fp, int parent_type, int level, bool decrypted)</div><div class="ttdoc">Create a list of attachments. </div><div class="ttdef"><b>Definition:</b> <a href="recvattach_8c_source.html#l01468">recvattach.c:1468</a></div></div>
<div class="ttc" id="context_8h_html"><div class="ttname"><a href="context_8h.html">context.h</a></div><div class="ttdoc">The &quot;currently-open&quot; mailbox. </div></div>
<div class="ttc" id="structEnvelope_html_a4b75ab1853f95878dec079371bb0d799"><div class="ttname"><a href="structEnvelope.html#a4b75ab1853f95878dec079371bb0d799">Envelope::reply_to</a></div><div class="ttdeci">struct AddressList reply_to</div><div class="ttdoc">Email&amp;#39;s &amp;#39;reply-to&amp;#39;. </div><div class="ttdef"><b>Definition:</b> <a href="envelope_8h_source.html#l00062">envelope.h:62</a></div></div>
<div class="ttc" id="autocrypt_2lib_8h_html"><div class="ttname"><a href="autocrypt_2lib_8h.html">lib.h</a></div><div class="ttdoc">Autocrypt end-to-end encryption. </div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a95845954210adfc850d5602843f858d4"><div class="ttname"><a href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a></div><div class="ttdeci">#define SEC_NO_FLAGS</div><div class="ttdoc">No flags are set. </div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00074">lib.h:74</a></div></div>
<div class="ttc" id="address_2address_8c_html_a9bb4abe92405bac67f03e36936a29b6e"><div class="ttname"><a href="address_2address_8c.html#a9bb4abe92405bac67f03e36936a29b6e">mutt_addrlist_parse</a></div><div class="ttdeci">int mutt_addrlist_parse(struct AddressList *al, const char *s)</div><div class="ttdoc">Parse a list of email addresses. </div><div class="ttdef"><b>Definition:</b> <a href="address_2address_8c_source.html#l00458">address.c:458</a></div></div>
<div class="ttc" id="send_8c_html_a40683be6f58e2cdf321c3e30a494fbde"><div class="ttname"><a href="send_8c.html#a40683be6f58e2cdf321c3e30a494fbde">mutt_forward_intro</a></div><div class="ttdeci">void mutt_forward_intro(struct Email *e, FILE *fp, struct ConfigSubset *sub)</div><div class="ttdoc">Add the &quot;start of forwarded message&quot; text. </div><div class="ttdef"><b>Definition:</b> <a href="send_8c_source.html#l00429">send.c:429</a></div></div>
<div class="ttc" id="logging_8h_html_ae108f891125caafa9250cf0959c40c04"><div class="ttname"><a href="logging_8h.html#ae108f891125caafa9250cf0959c40c04">mutt_message</a></div><div class="ttdeci">#define mutt_message(...)</div><div class="ttdef"><b>Definition:</b> <a href="logging_8h_source.html#l00083">logging.h:83</a></div></div>
<div class="ttc" id="structAttachCtx_html_a8753a1c1a51b26d4a628861dfd56294f"><div class="ttname"><a href="structAttachCtx.html#a8753a1c1a51b26d4a628861dfd56294f">AttachCtx::email</a></div><div class="ttdeci">struct Email * email</div><div class="ttdoc">Used by recvattach for updating. </div><div class="ttdef"><b>Definition:</b> <a href="attach_8h_source.html#l00051">attach.h:51</a></div></div>
<div class="ttc" id="send_8c_html_af14544f55d0b62fcba84643fadec4890"><div class="ttname"><a href="send_8c.html#af14544f55d0b62fcba84643fadec4890">add_references</a></div><div class="ttdeci">static void add_references(struct ListHead *head, struct Envelope *env)</div><div class="ttdoc">Add the email&amp;#39;s references to a list. </div><div class="ttdef"><b>Definition:</b> <a href="send_8c_source.html#l00975">send.c:975</a></div></div>
<div class="ttc" id="address_2address_8c_html_a7b1224fc8c5dde7114228cfc8ffbbc23"><div class="ttname"><a href="address_2address_8c.html#a7b1224fc8c5dde7114228cfc8ffbbc23">mutt_addrlist_to_local</a></div><div class="ttdeci">int mutt_addrlist_to_local(struct AddressList *al)</div><div class="ttdoc">Convert an Address list from Punycode. </div><div class="ttdef"><b>Definition:</b> <a href="address_2address_8c_source.html#l01388">address.c:1388</a></div></div>
<div class="ttc" id="structEnvelope_html_aad427832f4ae422f1b16d0896c1d3af6"><div class="ttname"><a href="structEnvelope.html#aad427832f4ae422f1b16d0896c1d3af6">Envelope::bcc</a></div><div class="ttdeci">struct AddressList bcc</div><div class="ttdoc">Email&amp;#39;s &amp;#39;Bcc&amp;#39; list. </div><div class="ttdef"><b>Definition:</b> <a href="envelope_8h_source.html#l00060">envelope.h:60</a></div></div>
<div class="ttc" id="address_2address_8c_html_a396bcf6adfff6663096fa6ae99c31c9a"><div class="ttname"><a href="address_2address_8c.html#a396bcf6adfff6663096fa6ae99c31c9a">mutt_addrlist_clear</a></div><div class="ttdeci">void mutt_addrlist_clear(struct AddressList *al)</div><div class="ttdoc">Unlink and free all Address in an AddressList. </div><div class="ttdef"><b>Definition:</b> <a href="address_2address_8c_source.html#l01470">address.c:1470</a></div></div>
<div class="ttc" id="curs__lib_8c_html_ab5fab29957531e6df60881531c22e907"><div class="ttname"><a href="curs__lib_8c.html#ab5fab29957531e6df60881531c22e907">mutt_get_field</a></div><div class="ttdeci">int mutt_get_field(const char *field, char *buf, size_t buflen, CompletionFlags complete, bool multiple, char ***files, int *numfiles)</div><div class="ttdoc">Ask the user for a string. </div><div class="ttdef"><b>Definition:</b> <a href="curs__lib_8c_source.html#l00335">curs_lib.c:335</a></div></div>
<div class="ttc" id="send_8h_html_a21bc6948879d93793ca7afac2c7964bb"><div class="ttname"><a href="send_8h.html#a21bc6948879d93793ca7afac2c7964bb">SEND_DRAFT_FILE</a></div><div class="ttdeci">#define SEND_DRAFT_FILE</div><div class="ttdoc">Used by the -H flag. </div><div class="ttdef"><b>Definition:</b> <a href="send_8h_source.html#l00050">send.h:50</a></div></div>
<div class="ttc" id="send_8c_html_a08794ff2edb022ef0c0f59086da9675f"><div class="ttname"><a href="send_8c.html#a08794ff2edb022ef0c0f59086da9675f">postpone_message</a></div><div class="ttdeci">static int postpone_message(struct Email *e_post, struct Email *e_cur, const char *fcc, SendFlags flags, struct ConfigSubset *sub)</div><div class="ttdoc">Save an Email for another day. </div><div class="ttdef"><b>Definition:</b> <a href="send_8c_source.html#l01945">send.c:1945</a></div></div>
<div class="ttc" id="send_2body_8c_html_a7ed09e9904a3693633204577be91f413"><div class="ttname"><a href="send_2body_8c.html#a7ed09e9904a3693633204577be91f413">mutt_write_mime_body</a></div><div class="ttdeci">int mutt_write_mime_body(struct Body *a, FILE *fp, struct ConfigSubset *sub)</div><div class="ttdoc">Write a MIME part. </div><div class="ttdef"><b>Definition:</b> <a href="send_2body_8c_source.html#l00314">body.c:314</a></div></div>
<div class="ttc" id="send_8c_html_a1f444e7c2a2266af7e16fade94f07841"><div class="ttname"><a href="send_8c.html#a1f444e7c2a2266af7e16fade94f07841">nntp_get_header</a></div><div class="ttdeci">static char * nntp_get_header(const char *s)</div><div class="ttdoc">Get the trimmed header. </div><div class="ttdef"><b>Definition:</b> <a href="send_8c_source.html#l00340">send.c:340</a></div></div>
<div class="ttc" id="send_8c_html_a441dbd4f179147fa14692a98acbd8f26"><div class="ttname"><a href="send_8c.html#a441dbd4f179147fa14692a98acbd8f26">mutt_make_forward_subject</a></div><div class="ttdeci">void mutt_make_forward_subject(struct Envelope *env, struct Email *e, struct ConfigSubset *sub)</div><div class="ttdoc">Create a subject for a forwarded email. </div><div class="ttdef"><b>Definition:</b> <a href="send_8c_source.html#l01034">send.c:1034</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_aacaa4abd4c0696e260b7a0f1d466360a"><div class="ttname"><a href="ncrypt_2lib_8h.html#aacaa4abd4c0696e260b7a0f1d466360a">SEC_ENCRYPT</a></div><div class="ttdeci">#define SEC_ENCRYPT</div><div class="ttdoc">Email is encrypted. </div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00075">lib.h:75</a></div></div>
<div class="ttc" id="alias_8c_html_aa90fd4b086aebbf4fed5245ecaca1ac1"><div class="ttname"><a href="alias_8c.html#aa90fd4b086aebbf4fed5245ecaca1ac1">mutt_expand_aliases_env</a></div><div class="ttdeci">void mutt_expand_aliases_env(struct Envelope *env)</div><div class="ttdoc">Expand aliases in all the fields of an Envelope. </div><div class="ttdef"><b>Definition:</b> <a href="alias_8c_source.html#l00314">alias.c:314</a></div></div>
<div class="ttc" id="pgppacket_8c_html_af86b82f9e1d828f6609218d3787e6ea1"><div class="ttname"><a href="pgppacket_8c.html#af86b82f9e1d828f6609218d3787e6ea1">plen</a></div><div class="ttdeci">static size_t plen</div><div class="ttdoc">Length of cached packet. </div><div class="ttdef"><b>Definition:</b> <a href="pgppacket_8c_source.html#l00039">pgppacket.c:39</a></div></div>
<div class="ttc" id="send_8c_html_a9bca5c9f44a7908485389d16dcf20f96"><div class="ttname"><a href="send_8c.html#a9bca5c9f44a7908485389d16dcf20f96">process_user_header</a></div><div class="ttdeci">static void process_user_header(struct Envelope *env)</div><div class="ttdoc">Process the user headers. </div><div class="ttdef"><b>Definition:</b> <a href="send_8c_source.html#l00378">send.c:378</a></div></div>
<div class="ttc" id="maillist_8c_html_a546aac24675f5681df8fe2ccd17aece8"><div class="ttname"><a href="maillist_8c.html#a546aac24675f5681df8fe2ccd17aece8">mutt_is_mail_list</a></div><div class="ttdeci">bool mutt_is_mail_list(const struct Address *addr)</div><div class="ttdoc">Is this the email address of a mailing list? - Implements addr_predicate_t. </div><div class="ttdef"><b>Definition:</b> <a href="maillist_8c_source.html#l00044">maillist.c:44</a></div></div>
<div class="ttc" id="crypt_8c_html_a52c65477f5b80ad3dc8028663653771d"><div class="ttname"><a href="crypt_8c.html#a52c65477f5b80ad3dc8028663653771d">mutt_should_hide_protected_subject</a></div><div class="ttdeci">bool mutt_should_hide_protected_subject(struct Email *e)</div><div class="ttdoc">Should NeoMutt hide the protected subject? </div><div class="ttdef"><b>Definition:</b> <a href="crypt_8c_source.html#l01108">crypt.c:1108</a></div></div>
<div class="ttc" id="send_8h_html_af72e00ab3817e49360034f4d9593bb62"><div class="ttname"><a href="send_8h.html#af72e00ab3817e49360034f4d9593bb62">SEND_FORWARD</a></div><div class="ttdeci">#define SEND_FORWARD</div><div class="ttdoc">Forward email. </div><div class="ttdef"><b>Definition:</b> <a href="send_8h_source.html#l00043">send.h:43</a></div></div>
<div class="ttc" id="sendlib_8c_html_acd4f22db21ca81a6a845ffe6888d141f"><div class="ttname"><a href="sendlib_8c.html#acd4f22db21ca81a6a845ffe6888d141f">mutt_write_fcc</a></div><div class="ttdeci">int mutt_write_fcc(const char *path, struct Email *e, const char *msgid, bool post, const char *fcc, char **finalpath, struct ConfigSubset *sub)</div><div class="ttdoc">Write email to FCC mailbox. </div><div class="ttdef"><b>Definition:</b> <a href="sendlib_8c_source.html#l01515">sendlib.c:1515</a></div></div>
<div class="ttc" id="mutt__logging_8h_html"><div class="ttname"><a href="mutt__logging_8h.html">mutt_logging.h</a></div><div class="ttdoc">NeoMutt Logging. </div></div>
<div class="ttc" id="pool_8c_html_a08b48e2ac8849341888ee7429cc5093c"><div class="ttname"><a href="pool_8c.html#a08b48e2ac8849341888ee7429cc5093c">mutt_buffer_pool_release</a></div><div class="ttdeci">void mutt_buffer_pool_release(struct Buffer **pbuf)</div><div class="ttdoc">Free a Buffer from the pool. </div><div class="ttdef"><b>Definition:</b> <a href="pool_8c_source.html#l00112">pool.c:112</a></div></div>
<div class="ttc" id="address_2address_8c_html_a16764dc80c9b3f6ad2897c8b7e59bd10"><div class="ttname"><a href="address_2address_8c.html#a16764dc80c9b3f6ad2897c8b7e59bd10">mutt_addrlist_copy</a></div><div class="ttdeci">void mutt_addrlist_copy(struct AddressList *dst, const struct AddressList *src, bool prune)</div><div class="ttdoc">Copy a list of addresses into another list. </div><div class="ttdef"><b>Definition:</b> <a href="address_2address_8c_source.html#l00737">address.c:737</a></div></div>
<div class="ttc" id="structRegex_html_af9ccc25da6324c9055e53966abe9a7b3"><div class="ttname"><a href="structRegex.html#af9ccc25da6324c9055e53966abe9a7b3">Regex::regex</a></div><div class="ttdeci">regex_t * regex</div><div class="ttdoc">compiled expression </div><div class="ttdef"><b>Definition:</b> <a href="regex3_8h_source.html#l00092">regex3.h:92</a></div></div>
<div class="ttc" id="email_2envelope_8c_html_a0108f989ca58622df272cf31b610395e"><div class="ttname"><a href="email_2envelope_8c.html#a0108f989ca58622df272cf31b610395e">mutt_env_to_intl</a></div><div class="ttdeci">int mutt_env_to_intl(struct Envelope *env, const char **tag, char **err)</div><div class="ttdoc">Convert an Envelope&amp;#39;s Address fields to Punycode format. </div><div class="ttdef"><b>Definition:</b> <a href="email_2envelope_8c_source.html#l00309">envelope.c:309</a></div></div>
<div class="ttc" id="buffer_8c_html_a0242aaa9a400d0722a99828776c0403b"><div class="ttname"><a href="buffer_8c.html#a0242aaa9a400d0722a99828776c0403b">mutt_buffer_make</a></div><div class="ttdeci">struct Buffer mutt_buffer_make(size_t size)</div><div class="ttdoc">Make a new buffer on the stack. </div><div class="ttdef"><b>Definition:</b> <a href="buffer_8c_source.html#l00061">buffer.c:61</a></div></div>
<div class="ttc" id="mutt__attach_8c_html_adef1563a136b685ed418f12a6228ef42"><div class="ttname"><a href="mutt__attach_8c.html#adef1563a136b685ed418f12a6228ef42">mutt_edit_attachment</a></div><div class="ttdeci">int mutt_edit_attachment(struct Body *a)</div><div class="ttdoc">Edit an attachment. </div><div class="ttdef"><b>Definition:</b> <a href="mutt__attach_8c_source.html#l00258">mutt_attach.c:258</a></div></div>
<div class="ttc" id="structAttachCtx_html_a6bd678fc233b795a978f78f786f89f1c"><div class="ttname"><a href="structAttachCtx.html#a6bd678fc233b795a978f78f786f89f1c">AttachCtx::fp_root</a></div><div class="ttdeci">FILE * fp_root</div><div class="ttdoc">Used by recvattach for updating. </div><div class="ttdef"><b>Definition:</b> <a href="attach_8h_source.html#l00052">attach.h:52</a></div></div>
<div class="ttc" id="copy_8h_html_a2184765637d3fe603457f28a20eccb41"><div class="ttname"><a href="copy_8h.html#a2184765637d3fe603457f28a20eccb41">MUTT_CM_WEED</a></div><div class="ttdeci">#define MUTT_CM_WEED</div><div class="ttdoc">Weed message/rfc822 attachment headers. </div><div class="ttdef"><b>Definition:</b> <a href="copy_8h_source.html#l00041">copy.h:41</a></div></div>
<div class="ttc" id="structBuffer_html"><div class="ttname"><a href="structBuffer.html">Buffer</a></div><div class="ttdoc">String manipulation buffer. </div><div class="ttdef"><b>Definition:</b> <a href="buffer_8h_source.html#l00033">buffer.h:33</a></div></div>
<div class="ttc" id="queue_8h_html_a2a85f19896399eecd0ebf91cb8176166"><div class="ttname"><a href="queue_8h.html#a2a85f19896399eecd0ebf91cb8176166">TAILQ_FOREACH_SAFE</a></div><div class="ttdeci">#define TAILQ_FOREACH_SAFE(var, head, field, tvar)</div><div class="ttdef"><b>Definition:</b> <a href="queue_8h_source.html#l00728">queue.h:728</a></div></div>
<div class="ttc" id="mutt_2string_8c_html_a4c2560f787bd1226b977992c16860c98"><div class="ttname"><a href="mutt_2string_8c.html#a4c2560f787bd1226b977992c16860c98">mutt_str_dup</a></div><div class="ttdeci">char * mutt_str_dup(const char *str)</div><div class="ttdoc">Copy a string, safely. </div><div class="ttdef"><b>Definition:</b> <a href="mutt_2string_8c_source.html#l00370">string.c:370</a></div></div>
<div class="ttc" id="structEnvelope_html_a005f4bd665ae1ae362add27948753fe1"><div class="ttname"><a href="structEnvelope.html#a005f4bd665ae1ae362add27948753fe1">Envelope::userhdrs</a></div><div class="ttdeci">struct ListHead userhdrs</div><div class="ttdoc">user defined headers </div><div class="ttdef"><b>Definition:</b> <a href="envelope_8h_source.html#l00083">envelope.h:83</a></div></div>
<div class="ttc" id="mutt_2message_8h_html_a479d658dfd60fe8d9709ec67a58b34ca"><div class="ttname"><a href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a></div><div class="ttdeci">#define _(a)</div><div class="ttdef"><b>Definition:</b> <a href="mutt_2message_8h_source.html#l00028">message.h:28</a></div></div>
<div class="ttc" id="address_2address_8c_html_ac9b323dadeb2a55ce6e9cd4763b9d832"><div class="ttname"><a href="address_2address_8c.html#ac9b323dadeb2a55ce6e9cd4763b9d832">mutt_addr_new</a></div><div class="ttdeci">struct Address * mutt_addr_new(void)</div><div class="ttdoc">Create a new Address. </div><div class="ttdef"><b>Definition:</b> <a href="address_2address_8c_source.html#l00385">address.c:385</a></div></div>
<div class="ttc" id="structEnvelope_html_adea069c71a9e00c79e1233f0fb51f824"><div class="ttname"><a href="structEnvelope.html#adea069c71a9e00c79e1233f0fb51f824">Envelope::real_subj</a></div><div class="ttdeci">char * real_subj</div><div class="ttdoc">Offset of the real subject. </div><div class="ttdef"><b>Definition:</b> <a href="envelope_8h_source.html#l00067">envelope.h:67</a></div></div>
<div class="ttc" id="send_8c_html_a6c0f91c0d2e3bb30c0dc096c2d5d5361"><div class="ttname"><a href="send_8c.html#a6c0f91c0d2e3bb30c0dc096c2d5d5361">add_message_id</a></div><div class="ttdeci">static void add_message_id(struct ListHead *head, struct Envelope *env)</div><div class="ttdoc">Add the email&amp;#39;s message ID to a list. </div><div class="ttdef"><b>Definition:</b> <a href="send_8c_source.html#l00991">send.c:991</a></div></div>
<div class="ttc" id="send_8c_html_afa5258518aabbe76c14e64e105515acf"><div class="ttname"><a href="send_8c.html#afa5258518aabbe76c14e64e105515acf">append_signature</a></div><div class="ttdeci">static void append_signature(FILE *fp, struct ConfigSubset *sub)</div><div class="ttdoc">Append a signature to an email. </div><div class="ttdef"><b>Definition:</b> <a href="send_8c_source.html#l00104">send.c:104</a></div></div>
<div class="ttc" id="structBody_html_ac55cdfce46eed13151dcfe9b329d254c"><div class="ttname"><a href="structBody.html#ac55cdfce46eed13151dcfe9b329d254c">Body::next</a></div><div class="ttdeci">struct Body * next</div><div class="ttdoc">next attachment in the list </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00053">body.h:53</a></div></div>
<div class="ttc" id="structAttachCtx_html_af02af835a67d8b3467f3a52ede4897f0"><div class="ttname"><a href="structAttachCtx.html#af02af835a67d8b3467f3a52ede4897f0">AttachCtx::idxlen</a></div><div class="ttdeci">short idxlen</div><div class="ttdoc">Number of attachmentes. </div><div class="ttdef"><b>Definition:</b> <a href="attach_8h_source.html#l00055">attach.h:55</a></div></div>
<div class="ttc" id="structAddress_html"><div class="ttname"><a href="structAddress.html">Address</a></div><div class="ttdoc">An email address. </div><div class="ttdef"><b>Definition:</b> <a href="address_2address_8h_source.html#l00035">address.h:35</a></div></div>
<div class="ttc" id="mime_8h_html_a1757cddbe4d3d273bf8fbffde3489a61a7c05065f79f9ed33904677a211ec3466"><div class="ttname"><a href="mime_8h.html#a1757cddbe4d3d273bf8fbffde3489a61a7c05065f79f9ed33904677a211ec3466">ENC_8BIT</a></div><div class="ttdoc">8-bit text </div><div class="ttdef"><b>Definition:</b> <a href="mime_8h_source.html#l00050">mime.h:50</a></div></div>
<div class="ttc" id="options_8h_html_a1301697a6664d40900be2c4761c192c7"><div class="ttname"><a href="options_8h.html#a1301697a6664d40900be2c4761c192c7">OptNoCurses</a></div><div class="ttdeci">WHERE bool OptNoCurses</div><div class="ttdoc">(pseudo) when sending in batch mode </div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00047">options.h:47</a></div></div>
<div class="ttc" id="email_2envelope_8c_html_afd00cc8d84947cbd55e082420b5732f1"><div class="ttname"><a href="email_2envelope_8c.html#afd00cc8d84947cbd55e082420b5732f1">mutt_env_to_local</a></div><div class="ttdeci">void mutt_env_to_local(struct Envelope *env)</div><div class="ttdoc">Convert an Envelope&amp;#39;s Address fields to local format. </div><div class="ttdef"><b>Definition:</b> <a href="email_2envelope_8c_source.html#l00271">envelope.c:271</a></div></div>
<div class="ttc" id="browser_8h_html_aef17206dea5302001a39f3c633e731d3"><div class="ttname"><a href="browser_8h.html#aef17206dea5302001a39f3c633e731d3">MUTT_SEL_NO_FLAGS</a></div><div class="ttdeci">#define MUTT_SEL_NO_FLAGS</div><div class="ttdoc">No flags are set. </div><div class="ttdef"><b>Definition:</b> <a href="browser_8h_source.html#l00036">browser.h:36</a></div></div>
<div class="ttc" id="structAddress_html_a8ea3ae93a2550c76c392a9001dbbaefd"><div class="ttname"><a href="structAddress.html#a8ea3ae93a2550c76c392a9001dbbaefd">Address::mailbox</a></div><div class="ttdeci">char * mailbox</div><div class="ttdoc">Mailbox and host address. </div><div class="ttdef"><b>Definition:</b> <a href="address_2address_8h_source.html#l00038">address.h:38</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a0b36be5c32ca90d8f2caef9ea9d627fc"><div class="ttname"><a href="ncrypt_2lib_8h.html#a0b36be5c32ca90d8f2caef9ea9d627fc">SEC_AUTOCRYPT</a></div><div class="ttdeci">#define SEC_AUTOCRYPT</div><div class="ttdoc">(Autocrypt) Message will be, or was Autocrypt encrypt+signed </div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00084">lib.h:84</a></div></div>
<div class="ttc" id="email_2envelope_8c_html_a51f04365c2b348d829e7cd3710c55b5b"><div class="ttname"><a href="email_2envelope_8c.html#a51f04365c2b348d829e7cd3710c55b5b">mutt_env_new</a></div><div class="ttdeci">struct Envelope * mutt_env_new(void)</div><div class="ttdoc">Create a new Envelope. </div><div class="ttdef"><b>Definition:</b> <a href="email_2envelope_8c_source.html#l00042">envelope.c:42</a></div></div>
<div class="ttc" id="hook_8h_html_ac4fada4e7df870f12ec6387389bba8c4"><div class="ttname"><a href="hook_8h.html#ac4fada4e7df870f12ec6387389bba8c4">MUTT_MESSAGE_HOOK</a></div><div class="ttdeci">#define MUTT_MESSAGE_HOOK</div><div class="ttdoc">message-hook: run before displaying a message </div><div class="ttdef"><b>Definition:</b> <a href="hook_8h_source.html#l00046">hook.h:46</a></div></div>
<div class="ttc" id="email_2email_8c_html_af751cd283c12c90ca470959861930feb"><div class="ttname"><a href="email_2email_8c.html#af751cd283c12c90ca470959861930feb">emaillist_clear</a></div><div class="ttdeci">void emaillist_clear(struct EmailList *el)</div><div class="ttdoc">Drop a private list of Emails. </div><div class="ttdef"><b>Definition:</b> <a href="email_2email_8c_source.html#l00138">email.c:138</a></div></div>
<div class="ttc" id="copy_8h_html_adc738493d51f47c7dd372f3ebd53223a"><div class="ttname"><a href="copy_8h.html#adc738493d51f47c7dd372f3ebd53223a">CopyMessageFlags</a></div><div class="ttdeci">uint16_t CopyMessageFlags</div><div class="ttdoc">Flags for mutt_copy_message(), e.g. MUTT_CM_NOHEADER. </div><div class="ttdef"><b>Definition:</b> <a href="copy_8h_source.html#l00032">copy.h:32</a></div></div>
<div class="ttc" id="helpers_8c_html_a1118361831f5c60ec14ce80ae37267d9"><div class="ttname"><a href="helpers_8c.html#a1118361831f5c60ec14ce80ae37267d9">cs_subset_address</a></div><div class="ttdeci">const struct Address * cs_subset_address(const struct ConfigSubset *sub, const char *name)</div><div class="ttdoc">Get an Address config item by name. </div><div class="ttdef"><b>Definition:</b> <a href="helpers_8c_source.html#l00049">helpers.c:49</a></div></div>
<div class="ttc" id="address_2address_8c_html_a16a97a499073187e58d4022ad6de29d1"><div class="ttname"><a href="address_2address_8c.html#a16a97a499073187e58d4022ad6de29d1">mutt_addr_copy</a></div><div class="ttdeci">struct Address * mutt_addr_copy(const struct Address *addr)</div><div class="ttdoc">Copy the real address. </div><div class="ttdef"><b>Definition:</b> <a href="address_2address_8c_source.html#l00716">address.c:716</a></div></div>
<div class="ttc" id="address_2address_8c_html_a8ac391285f1af69a114544e6575b597a"><div class="ttname"><a href="address_2address_8c.html#a8ac391285f1af69a114544e6575b597a">mutt_addrlist_parse2</a></div><div class="ttdeci">int mutt_addrlist_parse2(struct AddressList *al, const char *s)</div><div class="ttdoc">Parse a list of email addresses. </div><div class="ttdef"><b>Definition:</b> <a href="address_2address_8c_source.html#l00616">address.c:616</a></div></div>
<div class="ttc" id="send_8h_html_af731a62ddd44f1d907196beef8f8f19f"><div class="ttname"><a href="send_8h.html#af731a62ddd44f1d907196beef8f8f19f">SendFlags</a></div><div class="ttdeci">uint16_t SendFlags</div><div class="ttdoc">Flags for mutt_send_message(), e.g. SEND_REPLY. </div><div class="ttdef"><b>Definition:</b> <a href="send_8h_source.html#l00036">send.h:36</a></div></div>
<div class="ttc" id="format__flags_8h_html"><div class="ttname"><a href="format__flags_8h.html">format_flags.h</a></div><div class="ttdoc">Flags to control mutt_expando_format() </div></div>
<div class="ttc" id="copy_8h_html_ac778c083de78e4fb27889f345f242d13"><div class="ttname"><a href="copy_8h.html#ac778c083de78e4fb27889f345f242d13">MUTT_CM_NO_FLAGS</a></div><div class="ttdeci">#define MUTT_CM_NO_FLAGS</div><div class="ttdoc">No flags are set. </div><div class="ttdef"><b>Definition:</b> <a href="copy_8h_source.html#l00035">copy.h:35</a></div></div>
<div class="ttc" id="address_2address_8c_html_a40eda06e6e64ff9d9f1e7d3b69e7c846"><div class="ttname"><a href="address_2address_8c.html#a40eda06e6e64ff9d9f1e7d3b69e7c846">mutt_addr_free</a></div><div class="ttdeci">void mutt_addr_free(struct Address **ptr)</div><div class="ttdoc">Free a single Address. </div><div class="ttdef"><b>Definition:</b> <a href="address_2address_8c_source.html#l00440">address.c:440</a></div></div>
<div class="ttc" id="address_2address_8c_html_a4b1281c02f8b158f174c0b7c57af3d83"><div class="ttname"><a href="address_2address_8c.html#a4b1281c02f8b158f174c0b7c57af3d83">mutt_addr_create</a></div><div class="ttdeci">struct Address * mutt_addr_create(const char *personal, const char *mailbox)</div><div class="ttdoc">Create and populate a new Address. </div><div class="ttdef"><b>Definition:</b> <a href="address_2address_8c_source.html#l00398">address.c:398</a></div></div>
<div class="ttc" id="send_8h_html_a819cb72f23fd5b12401baf2963bc694f"><div class="ttname"><a href="send_8h.html#a819cb72f23fd5b12401baf2963bc694f">SEND_POSTPONED</a></div><div class="ttdeci">#define SEND_POSTPONED</div><div class="ttdoc">Recall a postponed email. </div><div class="ttdef"><b>Definition:</b> <a href="send_8h_source.html#l00044">send.h:44</a></div></div>
<div class="ttc" id="exec_8c_html_a668a02e9879868145b1da7edbc8c4508"><div class="ttname"><a href="exec_8c.html#a668a02e9879868145b1da7edbc8c4508">mutt_is_subscribed_list_recipient</a></div><div class="ttdeci">int mutt_is_subscribed_list_recipient(bool all_addr, struct Envelope *e)</div><div class="ttdoc">Matches subscribed mailing lists. </div><div class="ttdef"><b>Definition:</b> <a href="exec_8c_source.html#l00441">exec.c:441</a></div></div>
<div class="ttc" id="autocrypt_2config_8c_html_a933b5108398b46e2aadfe51b4ce466a7"><div class="ttname"><a href="autocrypt_2config_8c.html#a933b5108398b46e2aadfe51b4ce466a7">AutocryptDefaultKey</a></div><div class="ttdeci">char * AutocryptDefaultKey</div><div class="ttdoc">Autocrypt default key id (used for postponing messages) </div><div class="ttdef"><b>Definition:</b> <a href="autocrypt_2config_8c_source.html#l00036">config.c:36</a></div></div>
<div class="ttc" id="crypt_8c_html_a35eba8f2cd36c286f2226ff748ee63e6"><div class="ttname"><a href="crypt_8c.html#a35eba8f2cd36c286f2226ff748ee63e6">crypt_get_keys</a></div><div class="ttdeci">int crypt_get_keys(struct Mailbox *m, struct Email *e, char **keylist, bool oppenc_mode)</div><div class="ttdoc">Check we have all the keys we need. </div><div class="ttdef"><b>Definition:</b> <a href="crypt_8c_source.html#l00963">crypt.c:963</a></div></div>
<div class="ttc" id="muttlib_8c_html_a1c0d55a453ec4d4da581de386715f780"><div class="ttname"><a href="muttlib_8c.html#a1c0d55a453ec4d4da581de386715f780">mutt_buffer_pretty_mailbox</a></div><div class="ttdeci">void mutt_buffer_pretty_mailbox(struct Buffer *buf)</div><div class="ttdoc">Shorten a mailbox path using &amp;#39;~&amp;#39; or &amp;#39;=&amp;#39;. </div><div class="ttdef"><b>Definition:</b> <a href="muttlib_8c_source.html#l00603">muttlib.c:603</a></div></div>
<div class="ttc" id="copy_8h_html_a21e9ee6d7c3e70ffe4775aa9a90ac8c6"><div class="ttname"><a href="copy_8h.html#a21e9ee6d7c3e70ffe4775aa9a90ac8c6">MUTT_CM_REPLYING</a></div><div class="ttdeci">#define MUTT_CM_REPLYING</div><div class="ttdoc">Replying the message. </div><div class="ttdef"><b>Definition:</b> <a href="copy_8h_source.html#l00044">copy.h:44</a></div></div>
<div class="ttc" id="list_8c_html_ab5c53ce94cc2aafa4299dbc81a37f4a4"><div class="ttname"><a href="list_8c.html#ab5c53ce94cc2aafa4299dbc81a37f4a4">mutt_list_free</a></div><div class="ttdeci">void mutt_list_free(struct ListHead *h)</div><div class="ttdoc">Free a List AND its strings. </div><div class="ttdef"><b>Definition:</b> <a href="list_8c_source.html#l00122">list.c:122</a></div></div>
<div class="ttc" id="format__flags_8h_html_a5167e8b2777abe5e02be90e0d2a816de"><div class="ttname"><a href="format__flags_8h.html#a5167e8b2777abe5e02be90e0d2a816de">MUTT_FORMAT_NO_FLAGS</a></div><div class="ttdeci">#define MUTT_FORMAT_NO_FLAGS</div><div class="ttdoc">No flags are set. </div><div class="ttdef"><b>Definition:</b> <a href="format__flags_8h_source.html#l00030">format_flags.h:30</a></div></div>
<div class="ttc" id="mutt_8h_html_ac6606ebe91c8ac66a2c314c79f5ab013af85858c2c1c662fe4c0407b31c75410b"><div class="ttname"><a href="mutt_8h.html#ac6606ebe91c8ac66a2c314c79f5ab013af85858c2c1c662fe4c0407b31c75410b">MUTT_REPLIED</a></div><div class="ttdoc">Messages that have been replied to. </div><div class="ttdef"><b>Definition:</b> <a href="mutt_8h_source.html#l00091">mutt.h:91</a></div></div>
<div class="ttc" id="structBody_html"><div class="ttname"><a href="structBody.html">Body</a></div><div class="ttdoc">The body of an email. </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00034">body.h:34</a></div></div>
<div class="ttc" id="postpone_8c_html_aacde94d20e952e822eac92e0fbf74682"><div class="ttname"><a href="postpone_8c.html#aacde94d20e952e822eac92e0fbf74682">mutt_get_postponed</a></div><div class="ttdeci">int mutt_get_postponed(struct Mailbox *m_cur, struct Email *hdr, struct Email **cur, struct Buffer *fcc)</div><div class="ttdoc">Recall a postponed message. </div><div class="ttdef"><b>Definition:</b> <a href="postpone_8c_source.html#l00425">postpone.c:425</a></div></div>
<div class="ttc" id="quad_8h_html_a738f558a271fe5035e0ee3b700ee35db"><div class="ttname"><a href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35db">QuadOption</a></div><div class="ttdeci">QuadOption</div><div class="ttdoc">Possible values for a quad-option. </div><div class="ttdef"><b>Definition:</b> <a href="quad_8h_source.html#l00035">quad.h:35</a></div></div>
<div class="ttc" id="structBody_html_a99aff302b287a47c407a7412a99630f5"><div class="ttname"><a href="structBody.html#a99aff302b287a47c407a7412a99630f5">Body::disposition</a></div><div class="ttdeci">unsigned int disposition</div><div class="ttdoc">content-disposition, ContentDisposition </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00067">body.h:67</a></div></div>
<div class="ttc" id="config_2lib_8h_html"><div class="ttname"><a href="config_2lib_8h.html">lib.h</a></div><div class="ttdoc">Convenience wrapper for the config headers. </div></div>
<div class="ttc" id="browser_8h_html"><div class="ttname"><a href="browser_8h.html">browser.h</a></div><div class="ttdoc">GUI component for displaying/selecting items from a list. </div></div>
<div class="ttc" id="send_8h_html"><div class="ttname"><a href="send_8h.html">send.h</a></div><div class="ttdoc">Prepare and send an email. </div></div>
<div class="ttc" id="config_2path_8c_html_a6f7b1cf93328b961c3e3a64f300d75b0"><div class="ttname"><a href="config_2path_8c.html#a6f7b1cf93328b961c3e3a64f300d75b0">HomeDir</a></div><div class="ttdeci">char * HomeDir</div><div class="ttdoc">User&amp;#39;s home directory. </div><div class="ttdef"><b>Definition:</b> <a href="mutt__globals_8h_source.html#l00045">mutt_globals.h:45</a></div></div>
<div class="ttc" id="address_2lib_8h_html"><div class="ttname"><a href="address_2lib_8h.html">lib.h</a></div><div class="ttdoc">Email Address Handling. </div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a074f827472ad45f11ec1132cdfed2daf"><div class="ttname"><a href="ncrypt_2lib_8h.html#a074f827472ad45f11ec1132cdfed2daf">SEC_INLINE</a></div><div class="ttdeci">#define SEC_INLINE</div><div class="ttdoc">Email has an inline signature. </div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00082">lib.h:82</a></div></div>
<div class="ttc" id="send_8c_html_ab5edea027c9fa45beef0a68fb707789d"><div class="ttname"><a href="send_8c.html#ab5edea027c9fa45beef0a68fb707789d">default_to</a></div><div class="ttdeci">static int default_to(struct AddressList *to, struct Envelope *env, SendFlags flags, int hmfupto, struct ConfigSubset *sub)</div><div class="ttdoc">Generate default email addresses. </div><div class="ttdef"><b>Definition:</b> <a href="send_8c_source.html#l00828">send.c:828</a></div></div>
<div class="ttc" id="email_2email_8c_html_a77c9ecff4b23001b81177ffe398bad44"><div class="ttname"><a href="email_2email_8c.html#a77c9ecff4b23001b81177ffe398bad44">email_new</a></div><div class="ttdeci">struct Email * email_new(void)</div><div class="ttdoc">Create a new Email. </div><div class="ttdef"><b>Definition:</b> <a href="email_2email_8c_source.html#l00078">email.c:78</a></div></div>
<div class="ttc" id="sort_8h_html"><div class="ttname"><a href="sort_8h.html">sort.h</a></div><div class="ttdoc">Assorted sorting methods. </div></div>
<div class="ttc" id="buffer_8h_html_a4aca040fb75bc1dfc086cbfbf14ac8cd"><div class="ttname"><a href="buffer_8h.html#a4aca040fb75bc1dfc086cbfbf14ac8cd">mutt_buffer_string</a></div><div class="ttdeci">static const char * mutt_buffer_string(const struct Buffer *buf)</div><div class="ttdoc">Convert a buffer to a const char * &quot;string&quot;. </div><div class="ttdef"><b>Definition:</b> <a href="buffer_8h_source.html#l00077">buffer.h:77</a></div></div>
<div class="ttc" id="mutt__globals_8h_html_a441e341e914ef8b06dbb797713a1e83b"><div class="ttname"><a href="mutt__globals_8h.html#a441e341e914ef8b06dbb797713a1e83b">Username</a></div><div class="ttdeci">WHERE char * Username</div><div class="ttdoc">User&amp;#39;s login name. </div><div class="ttdef"><b>Definition:</b> <a href="mutt__globals_8h_source.html#l00048">mutt_globals.h:48</a></div></div>
<div class="ttc" id="email_2body_8c_html_aee001296b775e82e3988b5a81e53e30c"><div class="ttname"><a href="email_2body_8c.html#aee001296b775e82e3988b5a81e53e30c">mutt_body_new</a></div><div class="ttdeci">struct Body * mutt_body_new(void)</div><div class="ttdoc">Create a new Body. </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8c_source.html#l00043">body.c:43</a></div></div>
<div class="ttc" id="muttlib_8h_html"><div class="ttname"><a href="muttlib_8h.html">muttlib.h</a></div><div class="ttdoc">Some miscellaneous functions. </div></div>
<div class="ttc" id="helpers_8c_html_ae5ccc8068dd017455c38dd01982f7908"><div class="ttname"><a href="helpers_8c.html#ae5ccc8068dd017455c38dd01982f7908">cs_subset_regex</a></div><div class="ttdeci">const struct Regex * cs_subset_regex(const struct ConfigSubset *sub, const char *name)</div><div class="ttdoc">Get a regex config item by name. </div><div class="ttdef"><b>Definition:</b> <a href="helpers_8c_source.html#l00227">helpers.c:227</a></div></div>
<div class="ttc" id="subset_8c_html_a6ee598a96defed645b11cad6e6cb6512"><div class="ttname"><a href="subset_8c.html#a6ee598a96defed645b11cad6e6cb6512">cs_subset_str_native_set</a></div><div class="ttdeci">int cs_subset_str_native_set(const struct ConfigSubset *sub, const char *name, intptr_t value, struct Buffer *err)</div><div class="ttdoc">Natively set the value of a string config item. </div><div class="ttdef"><b>Definition:</b> <a href="subset_8c_source.html#l00305">subset.c:305</a></div></div>
<div class="ttc" id="memory_8h_html_afe62718c7d5ad088c3ea1dc4c28ccea3"><div class="ttname"><a href="memory_8h.html#afe62718c7d5ad088c3ea1dc4c28ccea3">mutt_array_size</a></div><div class="ttdeci">#define mutt_array_size(x)</div><div class="ttdef"><b>Definition:</b> <a href="memory_8h_source.html#l00033">memory.h:33</a></div></div>
<div class="ttc" id="send_8c_html_a0d247d6120598b06384009ea2bdb36af"><div class="ttname"><a href="send_8c.html#a0d247d6120598b06384009ea2bdb36af">generate_body</a></div><div class="ttdeci">static int generate_body(FILE *fp_tmp, struct Email *e, SendFlags flags, struct Mailbox *m, struct EmailList *el, struct ConfigSubset *sub)</div><div class="ttdoc">Create a new email body. </div><div class="ttdef"><b>Definition:</b> <a href="send_8c_source.html#l01212">send.c:1212</a></div></div>
<div class="ttc" id="mx_8c_html_a2172d90c08b5a2b293d22ed13ee0e7a8"><div class="ttname"><a href="mx_8c.html#a2172d90c08b5a2b293d22ed13ee0e7a8">mx_msg_close</a></div><div class="ttdeci">int mx_msg_close(struct Mailbox *m, struct Message **msg)</div><div class="ttdoc">Close a message. </div><div class="ttdef"><b>Definition:</b> <a href="mx_8c_source.html#l01186">mx.c:1186</a></div></div>
<div class="ttc" id="crypt_8c_html_a4ee7f1419a7e39b0e9f1f9d550f4de43"><div class="ttname"><a href="crypt_8c.html#a4ee7f1419a7e39b0e9f1f9d550f4de43">crypt_valid_passphrase</a></div><div class="ttdeci">bool crypt_valid_passphrase(SecurityFlags flags)</div><div class="ttdoc">Check that we have a usable passphrase, ask if not. </div><div class="ttdef"><b>Definition:</b> <a href="crypt_8c_source.html#l00135">crypt.c:135</a></div></div>
<div class="ttc" id="structBuffer_html_a1d9ee60bcf94de702b15ec2b5d811995"><div class="ttname"><a href="structBuffer.html#a1d9ee60bcf94de702b15ec2b5d811995">Buffer::dsize</a></div><div class="ttdeci">size_t dsize</div><div class="ttdoc">Length of data. </div><div class="ttdef"><b>Definition:</b> <a href="buffer_8h_source.html#l00037">buffer.h:37</a></div></div>
<div class="ttc" id="address_2address_8c_html_aee5d40d84136d3a7adba727e2908ad66"><div class="ttname"><a href="address_2address_8c.html#aee5d40d84136d3a7adba727e2908ad66">mutt_addrlist_dedupe</a></div><div class="ttdeci">void mutt_addrlist_dedupe(struct AddressList *al)</div><div class="ttdoc">Remove duplicate addresses. </div><div class="ttdef"><b>Definition:</b> <a href="address_2address_8c_source.html#l01407">address.c:1407</a></div></div>
<div class="ttc" id="structEmail_html_a0bd79550be901d44e50953fb43614e10"><div class="ttname"><a href="structEmail.html#a0bd79550be901d44e50953fb43614e10">Email::read</a></div><div class="ttdeci">bool read</div><div class="ttdoc">Email is read. </div><div class="ttdef"><b>Definition:</b> <a href="email_8h_source.html#l00051">email.h:51</a></div></div>
<div class="ttc" id="address_2address_8c_html_a64951ec4d595356746ef4d26dd7533c6"><div class="ttname"><a href="address_2address_8c.html#a64951ec4d595356746ef4d26dd7533c6">mutt_addr_for_display</a></div><div class="ttdeci">const char * mutt_addr_for_display(const struct Address *a)</div><div class="ttdoc">Convert an Address for display purposes. </div><div class="ttdef"><b>Definition:</b> <a href="address_2address_8c_source.html#l00986">address.c:986</a></div></div>
<div class="ttc" id="dlg__pager_8c_html_a1f9daa6945087758fdee1bdf76e62354"><div class="ttname"><a href="dlg__pager_8c.html#a1f9daa6945087758fdee1bdf76e62354">mutt_is_quote_line</a></div><div class="ttdeci">int mutt_is_quote_line(char *line, regmatch_t *pmatch)</div><div class="ttdoc">Is a line of message text a quote? </div><div class="ttdef"><b>Definition:</b> <a href="dlg__pager_8c_source.html#l00968">dlg_pager.c:968</a></div></div>
<div class="ttc" id="structConfigSubset_html_a910a9162ee6326d796e785a03dc8b47a"><div class="ttname"><a href="structConfigSubset.html#a910a9162ee6326d796e785a03dc8b47a">ConfigSubset::cs</a></div><div class="ttdeci">struct ConfigSet * cs</div><div class="ttdoc">Parent ConfigSet. </div><div class="ttdef"><b>Definition:</b> <a href="subset_8h_source.html#l00051">subset.h:51</a></div></div>
<div class="ttc" id="subset_8c_html_a8d7d5e60bd8f7f0f8ffd8522de126b12"><div class="ttname"><a href="subset_8c.html#a8d7d5e60bd8f7f0f8ffd8522de126b12">cs_subset_str_string_set</a></div><div class="ttdeci">int cs_subset_str_string_set(const struct ConfigSubset *sub, const char *name, const char *value, struct Buffer *err)</div><div class="ttdoc">Set a config item by string. </div><div class="ttdef"><b>Definition:</b> <a href="subset_8c_source.html#l00408">subset.c:408</a></div></div>
<div class="ttc" id="muttlib_8c_html_a6fbcbe533be7c4e05d99b0eb9cdb2581"><div class="ttname"><a href="muttlib_8c.html#a6fbcbe533be7c4e05d99b0eb9cdb2581">mutt_sleep</a></div><div class="ttdeci">void mutt_sleep(short s)</div><div class="ttdoc">Sleep for a while. </div><div class="ttdef"><b>Definition:</b> <a href="muttlib_8c_source.html#l01461">muttlib.c:1461</a></div></div>
<div class="ttc" id="send_8c_html_ac4e76f02be95b09bccb7806659fa0ea6"><div class="ttname"><a href="send_8c.html#ac4e76f02be95b09bccb7806659fa0ea6">make_reference_headers</a></div><div class="ttdeci">static void make_reference_headers(struct EmailList *el, struct Envelope *env, struct ConfigSubset *sub)</div><div class="ttdoc">Generate reference headers for an email. </div><div class="ttdef"><b>Definition:</b> <a href="send_8c_source.html#l01101">send.c:1101</a></div></div>
<div class="ttc" id="structEnvelope_html_a9ae6d450b2f012c37d3350f4305fbb90"><div class="ttname"><a href="structEnvelope.html#a9ae6d450b2f012c37d3350f4305fbb90">Envelope::in_reply_to</a></div><div class="ttdeci">struct ListHead in_reply_to</div><div class="ttdoc">in-reply-to header content </div><div class="ttdef"><b>Definition:</b> <a href="envelope_8h_source.html#l00082">envelope.h:82</a></div></div>
<div class="ttc" id="structEnvelope_html_a50418c13a849bf27b22922bd5867e5e1"><div class="ttname"><a href="structEnvelope.html#a50418c13a849bf27b22922bd5867e5e1">Envelope::message_id</a></div><div class="ttdeci">char * message_id</div><div class="ttdoc">Message ID. </div><div class="ttdef"><b>Definition:</b> <a href="envelope_8h_source.html#l00069">envelope.h:69</a></div></div>
<div class="ttc" id="set_8c_html_a1bc435f8e505a9274333899fa70250ce"><div class="ttname"><a href="set_8c.html#a1bc435f8e505a9274333899fa70250ce">cs_str_initial_get</a></div><div class="ttdeci">int cs_str_initial_get(const struct ConfigSet *cs, const char *name, struct Buffer *result)</div><div class="ttdoc">Get the initial, or parent, value of a config item. </div><div class="ttdef"><b>Definition:</b> <a href="set_8c_source.html#l00520">set.c:520</a></div></div>
<div class="ttc" id="send_8c_html_a8119a731eeae7c3e754315e585169c33"><div class="ttname"><a href="send_8c.html#a8119a731eeae7c3e754315e585169c33">mutt_make_attribution</a></div><div class="ttdeci">void mutt_make_attribution(struct Email *e, FILE *fp_out, struct ConfigSubset *sub)</div><div class="ttdoc">Add &quot;on DATE, PERSON wrote&quot; header. </div><div class="ttdef"><b>Definition:</b> <a href="send_8c_source.html#l00618">send.c:618</a></div></div>
<div class="ttc" id="sendlib_8c_html_ac35da3d19eb0d95d4f6260adab57b4c9"><div class="ttname"><a href="sendlib_8c.html#ac35da3d19eb0d95d4f6260adab57b4c9">mutt_prepare_envelope</a></div><div class="ttdeci">void mutt_prepare_envelope(struct Envelope *env, bool final, struct ConfigSubset *sub)</div><div class="ttdoc">Prepare an email header. </div><div class="ttdef"><b>Definition:</b> <a href="sendlib_8c_source.html#l01243">sendlib.c:1243</a></div></div>
<div class="ttc" id="hook_8h_html"><div class="ttname"><a href="hook_8h.html">hook.h</a></div><div class="ttdoc">Parse and execute user-defined hooks. </div></div>
<div class="ttc" id="send_8c_html_a69f63db0bf88ead16cba146fc3ef26ae"><div class="ttname"><a href="send_8c.html#a69f63db0bf88ead16cba146fc3ef26ae">choose_default_to</a></div><div class="ttdeci">static const struct AddressList * choose_default_to(const struct Address *from, const struct Envelope *env, struct ConfigSubset *sub)</div><div class="ttdoc">Pick the best &amp;#39;to:&amp;#39; value. </div><div class="ttdef"><b>Definition:</b> <a href="send_8c_source.html#l00802">send.c:802</a></div></div>
<div class="ttc" id="parse_8c_html_a40d55d4be6be11a22f0ac73fe251aa6e"><div class="ttname"><a href="parse_8c.html#a40d55d4be6be11a22f0ac73fe251aa6e">mutt_parse_mailto</a></div><div class="ttdeci">bool mutt_parse_mailto(struct Envelope *e, char **body, const char *src)</div><div class="ttdoc">Parse a mailto:// url. </div><div class="ttdef"><b>Definition:</b> <a href="parse_8c_source.html#l01612">parse.c:1612</a></div></div>
<div class="ttc" id="compose_2lib_8h_html_adf568d592758fae1758bbb4dc4e3e554"><div class="ttname"><a href="compose_2lib_8h.html#adf568d592758fae1758bbb4dc4e3e554">MUTT_COMPOSE_NOFREEHEADER</a></div><div class="ttdeci">#define MUTT_COMPOSE_NOFREEHEADER</div><div class="ttdef"><b>Definition:</b> <a href="compose_2lib_8h_source.html#l00051">lib.h:51</a></div></div>
<div class="ttc" id="mutt_8h_html"><div class="ttname"><a href="mutt_8h.html">mutt.h</a></div><div class="ttdoc">Many unsorted constants and some structs. </div></div>
<div class="ttc" id="mx_8h_html"><div class="ttname"><a href="mx_8h.html">mx.h</a></div><div class="ttdoc">API for mailboxes. </div></div>
<div class="ttc" id="structEmail_html_a6d9062408a8c89b19cf25584dd2ffb57"><div class="ttname"><a href="structEmail.html#a6d9062408a8c89b19cf25584dd2ffb57">Email::old</a></div><div class="ttdeci">bool old</div><div class="ttdoc">Email is seen, but unread. </div><div class="ttdef"><b>Definition:</b> <a href="email_8h_source.html#l00050">email.h:50</a></div></div>
<div class="ttc" id="queue_8h_html_aa7f65c910cd4616fcfa9723c5763b1a5"><div class="ttname"><a href="queue_8h.html#aa7f65c910cd4616fcfa9723c5763b1a5">TAILQ_FOREACH_REVERSE</a></div><div class="ttdeci">#define TAILQ_FOREACH_REVERSE(var, head, headname, field)</div><div class="ttdef"><b>Definition:</b> <a href="queue_8h_source.html#l00738">queue.h:738</a></div></div>
<div class="ttc" id="crypt_8c_html_a8ebc13a33b0dd650151d5b1b37cb99e4"><div class="ttname"><a href="crypt_8c.html#a8ebc13a33b0dd650151d5b1b37cb99e4">crypt_opportunistic_encrypt</a></div><div class="ttdeci">void crypt_opportunistic_encrypt(struct Mailbox *m, struct Email *e)</div><div class="ttdoc">Can all recipients be determined. </div><div class="ttdef"><b>Definition:</b> <a href="crypt_8c_source.html#l01054">crypt.c:1054</a></div></div>
<div class="ttc" id="rfc2047_8c_html_a89c57c82465740567f73641c9397d760"><div class="ttname"><a href="rfc2047_8c.html#a89c57c82465740567f73641c9397d760">rfc2047_decode</a></div><div class="ttdeci">void rfc2047_decode(char **pd)</div><div class="ttdoc">Decode any RFC2047-encoded header fields. </div><div class="ttdef"><b>Definition:</b> <a href="rfc2047_8c_source.html#l00641">rfc2047.c:641</a></div></div>
<div class="ttc" id="mutt_8h_html_ab0d3fda521b45dec654ff46bac59c8c2"><div class="ttname"><a href="mutt_8h.html#ab0d3fda521b45dec654ff46bac59c8c2">MUTT_COMP_NO_FLAGS</a></div><div class="ttdeci">#define MUTT_COMP_NO_FLAGS</div><div class="ttdoc">No flags are set. </div><div class="ttdef"><b>Definition:</b> <a href="mutt_8h_source.html#l00052">mutt.h:52</a></div></div>
<div class="ttc" id="structEnvelope_html_af1aa00aed4b8767cf98f08e45a432ad8"><div class="ttname"><a href="structEnvelope.html#af1aa00aed4b8767cf98f08e45a432ad8">Envelope::from</a></div><div class="ttdeci">struct AddressList from</div><div class="ttdoc">Email&amp;#39;s &amp;#39;From&amp;#39; list. </div><div class="ttdef"><b>Definition:</b> <a href="envelope_8h_source.html#l00057">envelope.h:57</a></div></div>
<div class="ttc" id="send_8c_html_a089f8240c097d82940d94b4cf094fc81"><div class="ttname"><a href="send_8c.html#a089f8240c097d82940d94b4cf094fc81">mutt_make_post_indent</a></div><div class="ttdeci">void mutt_make_post_indent(struct Email *e, FILE *fp_out, struct ConfigSubset *sub)</div><div class="ttdoc">Add suffix to replied email text. </div><div class="ttdef"><b>Definition:</b> <a href="send_8c_source.html#l00729">send.c:729</a></div></div>
<div class="ttc" id="send_8c_html_a93b53146e2fbfb6657f83297e722fdac"><div class="ttname"><a href="send_8c.html#a93b53146e2fbfb6657f83297e722fdac">process_user_recips</a></div><div class="ttdeci">static void process_user_recips(struct Envelope *env)</div><div class="ttdoc">Process the user headers. </div><div class="ttdef"><b>Definition:</b> <a href="send_8c_source.html#l00351">send.c:351</a></div></div>
<div class="ttc" id="copy_8h_html_a5e818fe5d60277b658d3f98ee7e0e675"><div class="ttname"><a href="copy_8h.html#a5e818fe5d60277b658d3f98ee7e0e675">CH_WEED</a></div><div class="ttdeci">#define CH_WEED</div><div class="ttdoc">Weed the headers? </div><div class="ttdef"><b>Definition:</b> <a href="copy_8h_source.html#l00053">copy.h:53</a></div></div>
<div class="ttc" id="file_8c_html_a31f49795ff5b9558db5476e5777e63b6"><div class="ttname"><a href="file_8c.html#a31f49795ff5b9558db5476e5777e63b6">mutt_file_fclose</a></div><div class="ttdeci">int mutt_file_fclose(FILE **fp)</div><div class="ttdoc">Close a FILE handle (and NULL the pointer) </div><div class="ttdef"><b>Definition:</b> <a href="file_8c_source.html#l00153">file.c:153</a></div></div>
<div class="ttc" id="hdrline_8c_html_a5ff2b7d1b1e2dbd345801cdda1e3af14"><div class="ttname"><a href="hdrline_8c.html#a5ff2b7d1b1e2dbd345801cdda1e3af14">mutt_make_string</a></div><div class="ttdeci">void mutt_make_string(char *buf, size_t buflen, int cols, const char *s, struct Mailbox *m, int inpgr, struct Email *e, MuttFormatFlags flags, const char *progress)</div><div class="ttdoc">Create formatted strings using mailbox expandos. </div><div class="ttdef"><b>Definition:</b> <a href="hdrline_8c_source.html#l01410">hdrline.c:1410</a></div></div>
<div class="ttc" id="structEmail_html_a34cc4493729d7a3b1f4ed783e739a9ec"><div class="ttname"><a href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">Email::env</a></div><div class="ttdeci">struct Envelope * env</div><div class="ttdoc">Envelope information. </div><div class="ttdef"><b>Definition:</b> <a href="email_8h_source.html#l00090">email.h:90</a></div></div>
<div class="ttc" id="core_2lib_8h_html"><div class="ttname"><a href="core_2lib_8h.html">lib.h</a></div><div class="ttdoc">Convenience wrapper for the core headers. </div></div>
<div class="ttc" id="send_8c_html_a886452bec277bd3e4169d0863b7768ae"><div class="ttname"><a href="send_8c.html#a886452bec277bd3e4169d0863b7768ae">mutt_send_message</a></div><div class="ttdeci">int mutt_send_message(SendFlags flags, struct Email *e_templ, const char *tempfile, struct Mailbox *m, struct EmailList *el, struct ConfigSubset *sub)</div><div class="ttdoc">Send an email. </div><div class="ttdef"><b>Definition:</b> <a href="send_8c_source.html#l02125">send.c:2125</a></div></div>
<div class="ttc" id="mutt__body_8c_html_a34765b4c275e55006a2203472caa0294"><div class="ttname"><a href="mutt__body_8c.html#a34765b4c275e55006a2203472caa0294">mutt_body_copy</a></div><div class="ttdeci">int mutt_body_copy(FILE *fp, struct Body **tgt, struct Body *src)</div><div class="ttdoc">Create a send-mode duplicate from a receive-mode body. </div><div class="ttdef"><b>Definition:</b> <a href="mutt__body_8c_source.html#l00048">mutt_body.c:48</a></div></div>
<div class="ttc" id="send_8c_html_af1b54154700865964598299ed1cf9a6a"><div class="ttname"><a href="send_8c.html#af1b54154700865964598299ed1cf9a6a">decode_descriptions</a></div><div class="ttdeci">static void decode_descriptions(struct Body *b)</div><div class="ttdoc">rfc2047 decode them in case of an error </div><div class="ttdef"><b>Definition:</b> <a href="send_8c_source.html#l01591">send.c:1591</a></div></div>
<div class="ttc" id="list_8c_html_a4a88586627792b16d55bd2e164a59e0a"><div class="ttname"><a href="list_8c.html#a4a88586627792b16d55bd2e164a59e0a">mutt_list_find</a></div><div class="ttdeci">struct ListNode * mutt_list_find(const struct ListHead *h, const char *data)</div><div class="ttdoc">Find a string in a List. </div><div class="ttdef"><b>Definition:</b> <a href="list_8c_source.html#l00102">list.c:102</a></div></div>
<div class="ttc" id="string2_8h_html_aebd4477213a7b706515efaffdec64181"><div class="ttname"><a href="string2_8h.html#aebd4477213a7b706515efaffdec64181">SKIPWS</a></div><div class="ttdeci">#define SKIPWS(ch)</div><div class="ttdef"><b>Definition:</b> <a href="string2_8h_source.html#l00046">string2.h:46</a></div></div>
<div class="ttc" id="compose_8c_html_ab41aa2ed639a1d884984f0d42d1cf827"><div class="ttname"><a href="compose_8c.html#ab41aa2ed639a1d884984f0d42d1cf827">mutt_compose_menu</a></div><div class="ttdeci">int mutt_compose_menu(struct Email *e, struct Buffer *fcc, uint8_t flags, struct ConfigSubset *sub)</div><div class="ttdoc">Allow the user to edit the message envelope. </div><div class="ttdef"><b>Definition:</b> <a href="compose_8c_source.html#l00757">compose.c:757</a></div></div>
<div class="ttc" id="structEnvelope_html_a6b00837b3cb4b41898b42307135be8b6"><div class="ttname"><a href="structEnvelope.html#a6b00837b3cb4b41898b42307135be8b6">Envelope::cc</a></div><div class="ttdeci">struct AddressList cc</div><div class="ttdoc">Email&amp;#39;s &amp;#39;Cc&amp;#39; list. </div><div class="ttdef"><b>Definition:</b> <a href="envelope_8h_source.html#l00059">envelope.h:59</a></div></div>
<div class="ttc" id="header_8h_html_a610db600447893b501a944c8e5dbb9f7ab8ca5468a3e97884fe52cfc76ff40fa8"><div class="ttname"><a href="header_8h.html#a610db600447893b501a944c8e5dbb9f7ab8ca5468a3e97884fe52cfc76ff40fa8">MUTT_WRITE_HEADER_NORMAL</a></div><div class="ttdoc">A normal Email, write full header + MIME headers. </div><div class="ttdef"><b>Definition:</b> <a href="header_8h_source.html#l00040">header.h:40</a></div></div>
<div class="ttc" id="buffer_8c_html_a59b13bca38b1b314e2bc5ad142d2df49"><div class="ttname"><a href="buffer_8c.html#a59b13bca38b1b314e2bc5ad142d2df49">mutt_buffer_dealloc</a></div><div class="ttdeci">void mutt_buffer_dealloc(struct Buffer *buf)</div><div class="ttdoc">Release the memory allocated by a buffer. </div><div class="ttdef"><b>Definition:</b> <a href="buffer_8c_source.html#l00294">buffer.c:294</a></div></div>
<div class="ttc" id="question_2lib_8h_html_ab02047769214ff014b9a8a1782babadc"><div class="ttname"><a href="question_2lib_8h.html#ab02047769214ff014b9a8a1782babadc">query_quadoption</a></div><div class="ttdeci">enum QuadOption query_quadoption(enum QuadOption opt, const char *prompt)</div><div class="ttdoc">Ask the user a quad-question. </div><div class="ttdef"><b>Definition:</b> <a href="question_8c_source.html#l00347">question.c:347</a></div></div>
<div class="ttc" id="send_8h_html_a54e225c19799cf682ef8228825dbb3d8"><div class="ttname"><a href="send_8h.html#a54e225c19799cf682ef8228825dbb3d8">SEND_LIST_REPLY</a></div><div class="ttdeci">#define SEND_LIST_REPLY</div><div class="ttdoc">Reply to mailing list. </div><div class="ttdef"><b>Definition:</b> <a href="send_8h_source.html#l00042">send.h:42</a></div></div>
<div class="ttc" id="send_8c_html_a19cc8b134c97bc3752c778d8b4977e8c"><div class="ttname"><a href="send_8c.html#a19cc8b134c97bc3752c778d8b4977e8c">is_reply</a></div><div class="ttdeci">static bool is_reply(struct Email *reply, struct Email *orig)</div><div class="ttdoc">Is one email a reply to another? </div><div class="ttdef"><b>Definition:</b> <a href="send_8c_source.html#l01682">send.c:1682</a></div></div>
<div class="ttc" id="alias_2lib_8h_html"><div class="ttname"><a href="alias_2lib_8h.html">lib.h</a></div><div class="ttdoc">Email Aliases. </div></div>
<div class="ttc" id="mutt__logging_8c_html_af068b3f524a31fad293b2fb61dfc4534"><div class="ttname"><a href="mutt__logging_8c.html#af068b3f524a31fad293b2fb61dfc4534">mutt_clear_error</a></div><div class="ttdeci">void mutt_clear_error(void)</div><div class="ttdoc">Clear the message line (bottom line of screen) </div><div class="ttdef"><b>Definition:</b> <a href="mutt__logging_8c_source.html#l00112">mutt_logging.c:112</a></div></div>
<div class="ttc" id="structBody_html_ad2f05b8ff24813de41988e63de5d6a31"><div class="ttname"><a href="structBody.html#ad2f05b8ff24813de41988e63de5d6a31">Body::encoding</a></div><div class="ttdeci">unsigned int encoding</div><div class="ttdoc">content-transfer-encoding, ContentEncoding </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00066">body.h:66</a></div></div>
<div class="ttc" id="quad_8h_html_a738f558a271fe5035e0ee3b700ee35dbaaa75b5db14c0aed1fde665034f113339"><div class="ttname"><a href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35dbaaa75b5db14c0aed1fde665034f113339">MUTT_ABORT</a></div><div class="ttdoc">User aborted the question (with Ctrl-G) </div><div class="ttdef"><b>Definition:</b> <a href="quad_8h_source.html#l00037">quad.h:37</a></div></div>
<div class="ttc" id="send_8c_html_adaad7f2e93eb41299f638d224d90f82b"><div class="ttname"><a href="send_8c.html#adaad7f2e93eb41299f638d224d90f82b">is_text_plain</a></div><div class="ttdeci">static bool is_text_plain(const struct Body *b)</div><div class="ttdoc">is a Body a text/plain MIME part? </div><div class="ttdef"><b>Definition:</b> <a href="send_8c_source.html#l02059">send.c:2059</a></div></div>
<div class="ttc" id="structMailbox_html_a69b544c5c748ab3046dcc6e61a41f595"><div class="ttname"><a href="structMailbox.html#a69b544c5c748ab3046dcc6e61a41f595">Mailbox::mdata</a></div><div class="ttdeci">void * mdata</div><div class="ttdoc">Driver specific data. </div><div class="ttdef"><b>Definition:</b> <a href="mailbox_8h_source.html#l00136">mailbox.h:136</a></div></div>
<div class="ttc" id="multipart_8c_html_a336393521f79b3158f5da26385f20103"><div class="ttname"><a href="multipart_8c.html#a336393521f79b3158f5da26385f20103">mutt_make_multipart</a></div><div class="ttdeci">struct Body * mutt_make_multipart(struct Body *b)</div><div class="ttdoc">Create a multipart email. </div><div class="ttdef"><b>Definition:</b> <a href="multipart_8c_source.html#l00100">multipart.c:100</a></div></div>
<div class="ttc" id="autocrypt_8c_html_a23ccdf8d23c4c9ec7f9517e5d2942429"><div class="ttname"><a href="autocrypt_8c.html#a23ccdf8d23c4c9ec7f9517e5d2942429">mutt_autocrypt_set_sign_as_default_key</a></div><div class="ttdeci">int mutt_autocrypt_set_sign_as_default_key(struct Mailbox *m, struct Email *e)</div><div class="ttdoc">Set the Autocrypt default key for signing. </div><div class="ttdef"><b>Definition:</b> <a href="autocrypt_8c_source.html#l00712">autocrypt.c:712</a></div></div>
<div class="ttc" id="send_8h_html_a623f46e1bab1e562893dbd01bbbd92dd"><div class="ttname"><a href="send_8h.html#a623f46e1bab1e562893dbd01bbbd92dd">SEND_KEY</a></div><div class="ttdeci">#define SEND_KEY</div><div class="ttdoc">Mail a PGP public key. </div><div class="ttdef"><b>Definition:</b> <a href="send_8h_source.html#l00046">send.h:46</a></div></div>
<div class="ttc" id="mutt_2string_8c_html_a29db81d6f5a7dd216cbea75ecf8a5885"><div class="ttname"><a href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a></div><div class="ttdeci">bool mutt_istr_equal(const char *a, const char *b)</div><div class="ttdoc">Compare two strings, ignoring case. </div><div class="ttdef"><b>Definition:</b> <a href="mutt_2string_8c_source.html#l00916">string.c:916</a></div></div>
<div class="ttc" id="structBody_html_ace00f9cba9b46a2d434764335d2fa43a"><div class="ttname"><a href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">Body::subtype</a></div><div class="ttdeci">char * subtype</div><div class="ttdoc">content-type subtype </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00037">body.h:37</a></div></div>
<div class="ttc" id="queue_8h_html_aaae87ca18c28066e1a96221e762d1209"><div class="ttname"><a href="queue_8h.html#aaae87ca18c28066e1a96221e762d1209">TAILQ_REMOVE</a></div><div class="ttdeci">#define TAILQ_REMOVE(head, elm, field)</div><div class="ttdef"><b>Definition:</b> <a href="queue_8h_source.html#l00834">queue.h:834</a></div></div>
<div class="ttc" id="list_8c_html_ace47a64c8bec9d1b24be6524f650293d"><div class="ttname"><a href="list_8c.html#ace47a64c8bec9d1b24be6524f650293d">mutt_list_insert_tail</a></div><div class="ttdeci">struct ListNode * mutt_list_insert_tail(struct ListHead *h, char *s)</div><div class="ttdoc">Append a string to the end of a List. </div><div class="ttdef"><b>Definition:</b> <a href="list_8c_source.html#l00064">list.c:64</a></div></div>
<div class="ttc" id="send_8c_html_ae0accb8ca6f488f8a6d77cd9fac7672b"><div class="ttname"><a href="send_8c.html#ae0accb8ca6f488f8a6d77cd9fac7672b">inline_forward_attachments</a></div><div class="ttdeci">static int inline_forward_attachments(struct Mailbox *m, struct Email *e, struct Body ***plast, enum QuadOption *forwardq, struct ConfigSubset *sub)</div><div class="ttdoc">Add attachments to an email, inline. </div><div class="ttdef"><b>Definition:</b> <a href="send_8c_source.html#l00542">send.c:542</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a798dfac1e8839ca89375b4ec62b3eff2"><div class="ttname"><a href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a></div><div class="ttdeci">#define APPLICATION_SMIME</div><div class="ttdoc">Use SMIME to encrypt/sign. </div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00088">lib.h:88</a></div></div>
<div class="ttc" id="copy_8h_html_a23b8aa8125d370213675b3c0b1c5e6fe"><div class="ttname"><a href="copy_8h.html#a23b8aa8125d370213675b3c0b1c5e6fe">MUTT_CM_PREFIX</a></div><div class="ttdeci">#define MUTT_CM_PREFIX</div><div class="ttdoc">Quote the header and body. </div><div class="ttdef"><b>Definition:</b> <a href="copy_8h_source.html#l00037">copy.h:37</a></div></div>
<div class="ttc" id="sendlib_8c_html_a8957ce367f6683e839e4ddb7245d466c"><div class="ttname"><a href="sendlib_8c.html#a8957ce367f6683e839e4ddb7245d466c">mutt_write_multiple_fcc</a></div><div class="ttdeci">int mutt_write_multiple_fcc(const char *path, struct Email *e, const char *msgid, bool post, char *fcc, char **finalpath, struct ConfigSubset *sub)</div><div class="ttdoc">Handle FCC with multiple, comma separated entries. </div><div class="ttdef"><b>Definition:</b> <a href="sendlib_8c_source.html#l01467">sendlib.c:1467</a></div></div>
<div class="ttc" id="protos_8h_html"><div class="ttname"><a href="protos_8h.html">protos.h</a></div><div class="ttdoc">Prototypes for many functions. </div></div>
<div class="ttc" id="structEnvelope_html_a52153c6e4fdb551233e26d4fdb48fb78"><div class="ttname"><a href="structEnvelope.html#a52153c6e4fdb551233e26d4fdb48fb78">Envelope::x_comment_to</a></div><div class="ttdeci">char * x_comment_to</div><div class="ttdoc">List of &amp;#39;X-comment-to&amp;#39; fields. </div><div class="ttdef"><b>Definition:</b> <a href="envelope_8h_source.html#l00078">envelope.h:78</a></div></div>
<div class="ttc" id="send_8h_html_abeb38906954f30b89ad58ebbf95ac2b0"><div class="ttname"><a href="send_8h.html#abeb38906954f30b89ad58ebbf95ac2b0">SEND_RESEND</a></div><div class="ttdeci">#define SEND_RESEND</div><div class="ttdoc">Reply using the current email as a template. </div><div class="ttdef"><b>Definition:</b> <a href="send_8h_source.html#l00047">send.h:47</a></div></div>
<div class="ttc" id="structEmail_html_a9a3c73dc042313773159d921a711c830"><div class="ttname"><a href="structEmail.html#a9a3c73dc042313773159d921a711c830">Email::chain</a></div><div class="ttdeci">struct ListHead chain</div><div class="ttdoc">Mixmaster chain. </div><div class="ttdef"><b>Definition:</b> <a href="email_8h_source.html#l00102">email.h:102</a></div></div>
<div class="ttc" id="mutt__body_8h_html"><div class="ttname"><a href="mutt__body_8h.html">mutt_body.h</a></div><div class="ttdoc">Representation of the body of an email. </div></div>
<div class="ttc" id="structConfigSubset_html"><div class="ttname"><a href="structConfigSubset.html">ConfigSubset</a></div><div class="ttdoc">A set of inherited config items. </div><div class="ttdef"><b>Definition:</b> <a href="subset_8h_source.html#l00046">subset.h:46</a></div></div>
<div class="ttc" id="sendlib_8c_html_a99b5cff5076c9e25bce367f0bae45f4c"><div class="ttname"><a href="sendlib_8c.html#a99b5cff5076c9e25bce367f0bae45f4c">mutt_unprepare_envelope</a></div><div class="ttdeci">void mutt_unprepare_envelope(struct Envelope *env)</div><div class="ttdoc">Undo the encodings of mutt_prepare_envelope() </div><div class="ttdef"><b>Definition:</b> <a href="sendlib_8c_source.html#l01282">sendlib.c:1282</a></div></div>
<div class="ttc" id="notmuch_2lib_8h_html"><div class="ttname"><a href="notmuch_2lib_8h.html">lib.h</a></div><div class="ttdoc">Notmuch virtual mailbox type. </div></div>
<div class="ttc" id="muttlib_8h_html_a93b346cfb36aac7c036bfaeea7f126e8"><div class="ttname"><a href="muttlib_8h.html#a93b346cfb36aac7c036bfaeea7f126e8">mutt_mktemp</a></div><div class="ttdeci">#define mutt_mktemp(buf, buflen)</div><div class="ttdef"><b>Definition:</b> <a href="muttlib_8h_source.html#l00071">muttlib.h:71</a></div></div>
<div class="ttc" id="multipart_8c_html_a71d5ccd20fbbbe2fa56e6d1f577e34ae"><div class="ttname"><a href="multipart_8c.html#a71d5ccd20fbbbe2fa56e6d1f577e34ae">mutt_remove_multipart</a></div><div class="ttdeci">struct Body * mutt_remove_multipart(struct Body *b)</div><div class="ttdoc">Extract the multipart body if it exists. </div><div class="ttdef"><b>Definition:</b> <a href="multipart_8c_source.html#l00126">multipart.c:126</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a587e679a4c9cc44f11f0c467bb22b0af"><div class="ttname"><a href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a></div><div class="ttdeci">#define APPLICATION_PGP</div><div class="ttdoc">Use PGP to encrypt/sign. </div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00087">lib.h:87</a></div></div>
<div class="ttc" id="structMessage_html"><div class="ttname"><a href="structMessage.html">Message</a></div><div class="ttdoc">A local copy of an email. </div><div class="ttdef"><b>Definition:</b> <a href="mxapi_8h_source.html#l00041">mxapi.h:41</a></div></div>
<div class="ttc" id="structMailbox_html"><div class="ttname"><a href="structMailbox.html">Mailbox</a></div><div class="ttdoc">A mailbox. </div><div class="ttdef"><b>Definition:</b> <a href="mailbox_8h_source.html#l00081">mailbox.h:81</a></div></div>
<div class="ttc" id="structMailbox_html_afbd00b44dedabb87c3b86042287a812a"><div class="ttname"><a href="structMailbox.html#afbd00b44dedabb87c3b86042287a812a">Mailbox::sub</a></div><div class="ttdeci">struct ConfigSubset * sub</div><div class="ttdoc">Inherited config items. </div><div class="ttdef"><b>Definition:</b> <a href="mailbox_8h_source.html#l00086">mailbox.h:86</a></div></div>
<div class="ttc" id="exec_8c_html_aa406114bea99ec4cdb561d61b3813c6d"><div class="ttname"><a href="exec_8c.html#aa406114bea99ec4cdb561d61b3813c6d">mutt_is_list_recipient</a></div><div class="ttdeci">int mutt_is_list_recipient(bool all_addr, struct Envelope *e)</div><div class="ttdoc">Matches known mailing lists. </div><div class="ttdef"><b>Definition:</b> <a href="exec_8c_source.html#l00454">exec.c:454</a></div></div>
<div class="ttc" id="send_8c_html_aa93b7a6bc9e26176ebf17bf37c7d2a87"><div class="ttname"><a href="send_8c.html#aa93b7a6bc9e26176ebf17bf37c7d2a87">mutt_default_from</a></div><div class="ttdeci">struct Address * mutt_default_from(struct ConfigSubset *sub)</div><div class="ttdoc">Get a default &amp;#39;from&amp;#39; Address. </div><div class="ttdef"><b>Definition:</b> <a href="send_8c_source.html#l01454">send.c:1454</a></div></div>
<div class="ttc" id="structMessage_html_aa0bd3611d117ed56d5c42380c05e429d"><div class="ttname"><a href="structMessage.html#aa0bd3611d117ed56d5c42380c05e429d">Message::flags</a></div><div class="ttdeci">struct Message::@1 flags</div></div>
<div class="ttc" id="structGreetingInfo_html_a8d8954bea1b907441e59e537bc41f4ce"><div class="ttname"><a href="structGreetingInfo.html#a8d8954bea1b907441e59e537bc41f4ce">GreetingInfo::email</a></div><div class="ttdeci">struct Email * email</div><div class="ttdef"><b>Definition:</b> <a href="send_8c_source.html#l00096">send.c:96</a></div></div>
<div class="ttc" id="memory_8c_html_a264da4dc58e6dc8983285bd1f538f24d"><div class="ttname"><a href="memory_8c.html#a264da4dc58e6dc8983285bd1f538f24d">mutt_mem_malloc</a></div><div class="ttdeci">void * mutt_mem_malloc(size_t size)</div><div class="ttdoc">Allocate memory on the heap. </div><div class="ttdef"><b>Definition:</b> <a href="memory_8c_source.html#l00090">memory.c:90</a></div></div>
<div class="ttc" id="send_8c_html_afa20b4cc93fe3d7cbc02675afeddcad4"><div class="ttname"><a href="send_8c.html#afa20b4cc93fe3d7cbc02675afeddcad4">mutt_set_followup_to</a></div><div class="ttdeci">void mutt_set_followup_to(struct Envelope *env, struct ConfigSubset *sub)</div><div class="ttdoc">Set followup-to field. </div><div class="ttdef"><b>Definition:</b> <a href="send_8c_source.html#l01329">send.c:1329</a></div></div>
<div class="ttc" id="parse_8c_html_a383628b0d4778ad83677498fab4132dd"><div class="ttname"><a href="parse_8c.html#a383628b0d4778ad83677498fab4132dd">mutt_extract_message_id</a></div><div class="ttdeci">char * mutt_extract_message_id(const char *s, size_t *len)</div><div class="ttdoc">Find a message-id. </div><div class="ttdef"><b>Definition:</b> <a href="parse_8c_source.html#l00363">parse.c:363</a></div></div>
<div class="ttc" id="send_8c_html_a527f182325365ed083dad7be735bab25"><div class="ttname"><a href="send_8c.html#a527f182325365ed083dad7be735bab25">mutt_fix_reply_recipients</a></div><div class="ttdeci">void mutt_fix_reply_recipients(struct Envelope *env, struct ConfigSubset *sub)</div><div class="ttdoc">Remove duplicate recipients. </div><div class="ttdef"><b>Definition:</b> <a href="send_8c_source.html#l01004">send.c:1004</a></div></div>
<div class="ttc" id="copy_8h_html_a4898a6c2c88fdba8ce7decdb6c125a96"><div class="ttname"><a href="copy_8h.html#a4898a6c2c88fdba8ce7decdb6c125a96">MUTT_CM_DECODE</a></div><div class="ttdeci">#define MUTT_CM_DECODE</div><div class="ttdoc">Decode the message body into text/plain. </div><div class="ttdef"><b>Definition:</b> <a href="copy_8h_source.html#l00038">copy.h:38</a></div></div>
<div class="ttc" id="sendmail_8c_html_a5562a863571c41379b43fd780735776c"><div class="ttname"><a href="sendmail_8c.html#a5562a863571c41379b43fd780735776c">mutt_invoke_sendmail</a></div><div class="ttdeci">int mutt_invoke_sendmail(struct Mailbox *m, struct AddressList *from, struct AddressList *to, struct AddressList *cc, struct AddressList *bcc, const char *msg, bool eightbit, struct ConfigSubset *sub)</div><div class="ttdoc">Run sendmail. </div><div class="ttdef"><b>Definition:</b> <a href="sendmail_8c_source.html#l00287">sendmail.c:287</a></div></div>
<div class="ttc" id="sendlib_8c_html_ac8ddd58faaec9226b8af76db09d4155c"><div class="ttname"><a href="sendlib_8c.html#ac8ddd58faaec9226b8af76db09d4155c">mutt_make_message_attach</a></div><div class="ttdeci">struct Body * mutt_make_message_attach(struct Mailbox *m, struct Email *e, bool attach_msg, struct ConfigSubset *sub)</div><div class="ttdoc">Create a message attachment. </div><div class="ttdef"><b>Definition:</b> <a href="sendlib_8c_source.html#l00936">sendlib.c:936</a></div></div>
<div class="ttc" id="hook_8c_html_a6d228c86f5a1900b27af0fde26991a63"><div class="ttname"><a href="hook_8c.html#a6d228c86f5a1900b27af0fde26991a63">mutt_select_fcc</a></div><div class="ttdeci">void mutt_select_fcc(struct Buffer *path, struct Email *e)</div><div class="ttdoc">Select the FCC path for an email. </div><div class="ttdef"><b>Definition:</b> <a href="hook_8c_source.html#l00715">hook.c:715</a></div></div>
<div class="ttc" id="copy_8h_html_a606b533a9896e294b1341e648f0b8ba2"><div class="ttname"><a href="copy_8h.html#a606b533a9896e294b1341e648f0b8ba2">CH_REORDER</a></div><div class="ttdeci">#define CH_REORDER</div><div class="ttdoc">Re-order output of headers (specified by &amp;#39;hdr_order&amp;#39;) </div><div class="ttdef"><b>Definition:</b> <a href="copy_8h_source.html#l00059">copy.h:59</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_ae0ce4a742538f3ee3e1bfbf143c794fb"><div class="ttname"><a href="ncrypt_2lib_8h.html#ae0ce4a742538f3ee3e1bfbf143c794fb">SEC_AUTOCRYPT_OVERRIDE</a></div><div class="ttdeci">#define SEC_AUTOCRYPT_OVERRIDE</div><div class="ttdoc">(Autocrypt) Indicates manual set/unset of encryption </div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00085">lib.h:85</a></div></div>
<div class="ttc" id="mime_8h_html_a3ccd048df649c335df5a7f82673bbc79ad88e88afaec507209421bba20aeeb167"><div class="ttname"><a href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79ad88e88afaec507209421bba20aeeb167">TYPE_TEXT</a></div><div class="ttdoc">Type: &amp;#39;text/*&amp;#39;. </div><div class="ttdef"><b>Definition:</b> <a href="mime_8h_source.html#l00038">mime.h:38</a></div></div>
<div class="ttc" id="structGreetingInfo_html"><div class="ttname"><a href="structGreetingInfo.html">GreetingInfo</a></div><div class="ttdoc">Data passed to greeting_string() </div><div class="ttdef"><b>Definition:</b> <a href="send_8c_source.html#l00093">send.c:93</a></div></div>
<div class="ttc" id="copy_8h_html_a648ee091378fa6c0f6f129f64fc7f22b"><div class="ttname"><a href="copy_8h.html#a648ee091378fa6c0f6f129f64fc7f22b">MUTT_CM_CHARCONV</a></div><div class="ttdeci">#define MUTT_CM_CHARCONV</div><div class="ttdoc">Perform character set conversions. </div><div class="ttdef"><b>Definition:</b> <a href="copy_8h_source.html#l00042">copy.h:42</a></div></div>
<div class="ttc" id="handler_8c_html_ad8ffd2d9dd15e18644b821ec35c7ce52"><div class="ttname"><a href="handler_8c.html#ad8ffd2d9dd15e18644b821ec35c7ce52">mutt_can_decode</a></div><div class="ttdeci">bool mutt_can_decode(struct Body *a)</div><div class="ttdoc">Will decoding the attachment produce any output. </div><div class="ttdef"><b>Definition:</b> <a href="handler_8c_source.html#l01821">handler.c:1821</a></div></div>
<div class="ttc" id="pattern_2lib_8h_html"><div class="ttname"><a href="pattern_2lib_8h.html">lib.h</a></div><div class="ttdoc">Match patterns to emails. </div></div>
<div class="ttc" id="structBuffer_html_aeec1fd4af0ddf6765b0187466d4361b8"><div class="ttname"><a href="structBuffer.html#aeec1fd4af0ddf6765b0187466d4361b8">Buffer::data</a></div><div class="ttdeci">char * data</div><div class="ttdoc">Pointer to data. </div><div class="ttdef"><b>Definition:</b> <a href="buffer_8h_source.html#l00035">buffer.h:35</a></div></div>
<div class="ttc" id="send_8c_html_ac5be3d670b1d7e5cddb605652e9aa859"><div class="ttname"><a href="send_8c.html#ac5be3d670b1d7e5cddb605652e9aa859">set_reverse_name</a></div><div class="ttdeci">static void set_reverse_name(struct AddressList *al, struct Envelope *env, struct ConfigSubset *sub)</div><div class="ttdoc">Try to set the &amp;#39;from&amp;#39; field from the recipients. </div><div class="ttdef"><b>Definition:</b> <a href="send_8c_source.html#l01402">send.c:1402</a></div></div>
<div class="ttc" id="crypt_8c_html_afb7fbdc0157b9f7fd68b378232d554fc"><div class="ttname"><a href="crypt_8c.html#afb7fbdc0157b9f7fd68b378232d554fc">mutt_protect</a></div><div class="ttdeci">int mutt_protect(struct Mailbox *m, struct Email *e, char *keylist, bool postpone)</div><div class="ttdoc">Encrypt and/or sign a message. </div><div class="ttdef"><b>Definition:</b> <a href="crypt_8c_source.html#l00161">crypt.c:161</a></div></div>
<div class="ttc" id="address_2address_8c_html_a60b3ced56e9f5be39c391250d951bf72"><div class="ttname"><a href="address_2address_8c.html#a60b3ced56e9f5be39c391250d951bf72">mutt_addr_cmp</a></div><div class="ttdeci">bool mutt_addr_cmp(const struct Address *a, const struct Address *b)</div><div class="ttdoc">Compare two e-mail addresses. </div><div class="ttdef"><b>Definition:</b> <a href="address_2address_8c_source.html#l00864">address.c:864</a></div></div>
<div class="ttc" id="copy_8h_html_a05de77c5d16eb6266cfb34b7b322a807"><div class="ttname"><a href="copy_8h.html#a05de77c5d16eb6266cfb34b7b322a807">CH_DECODE</a></div><div class="ttdeci">#define CH_DECODE</div><div class="ttdoc">Do RFC2047 header decoding. </div><div class="ttdef"><b>Definition:</b> <a href="copy_8h_source.html#l00054">copy.h:54</a></div></div>
<div class="ttc" id="structBody_html_a0b87b7bdb6faef44d9aac4854975f805"><div class="ttname"><a href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">Body::parts</a></div><div class="ttdeci">struct Body * parts</div><div class="ttdoc">parts of a multipart or message/rfc822 </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00054">body.h:54</a></div></div>
<div class="ttc" id="nntp_2mdata_8h_html"><div class="ttname"><a href="nntp_2mdata_8h.html">mdata.h</a></div><div class="ttdoc">Nntp-specific Mailbox data. </div></div>
<div class="ttc" id="rfc3676_8h_html"><div class="ttname"><a href="rfc3676_8h.html">rfc3676.h</a></div><div class="ttdoc">RFC3676 Format Flowed routines. </div></div>
<div class="ttc" id="structAttachPtr_html_a776ea6f490cedf7dc47accba055d964c"><div class="ttname"><a href="structAttachPtr.html#a776ea6f490cedf7dc47accba055d964c">AttachPtr::fp</a></div><div class="ttdeci">FILE * fp</div><div class="ttdoc">Used in the recvattach menu. </div><div class="ttdef"><b>Definition:</b> <a href="attach_8h_source.html#l00037">attach.h:37</a></div></div>
<div class="ttc" id="address_2address_8c_html_aa68a29c1feb5938596aa589cf2d6a1af"><div class="ttname"><a href="address_2address_8c.html#aa68a29c1feb5938596aa589cf2d6a1af">mutt_addrlist_prepend</a></div><div class="ttdeci">void mutt_addrlist_prepend(struct AddressList *al, struct Address *a)</div><div class="ttdoc">Prepend an Address to an AddressList. </div><div class="ttdef"><b>Definition:</b> <a href="address_2address_8c_source.html#l01501">address.c:1501</a></div></div>
<div class="ttc" id="helpers_8c_html_ac477c591155aa4ae0452bbabc0affffe"><div class="ttname"><a href="helpers_8c.html#ac477c591155aa4ae0452bbabc0affffe">cs_subset_string</a></div><div class="ttdeci">const char * cs_subset_string(const struct ConfigSubset *sub, const char *name)</div><div class="ttdoc">Get a string config item by name. </div><div class="ttdef"><b>Definition:</b> <a href="helpers_8c_source.html#l00295">helpers.c:295</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html"><div class="ttname"><a href="ncrypt_2lib_8h.html">lib.h</a></div><div class="ttdoc">API for encryption/signing of emails. </div></div>
<div class="ttc" id="send_8c_html_a255efc8a4a366c3de07d48da23d03a32"><div class="ttname"><a href="send_8c.html#a255efc8a4a366c3de07d48da23d03a32">save_fcc</a></div><div class="ttdeci">static int save_fcc(struct Mailbox *m, struct Email *e, struct Buffer *fcc, struct Body *clear_content, char *pgpkeylist, SendFlags flags, char **finalpath, struct ConfigSubset *sub)</div><div class="ttdoc">Save an Email to a &amp;#39;sent mail&amp;#39; folder. </div><div class="ttdef"><b>Definition:</b> <a href="send_8c_source.html#l01748">send.c:1748</a></div></div>
<div class="ttc" id="question_2lib_8h_html_a95d1cd189641185a743df0397ea072c8"><div class="ttname"><a href="question_2lib_8h.html#a95d1cd189641185a743df0397ea072c8">mutt_multi_choice</a></div><div class="ttdeci">int mutt_multi_choice(const char *prompt, const char *letters)</div><div class="ttdoc">Offer the user a multiple choice question. </div><div class="ttdef"><b>Definition:</b> <a href="question_8c_source.html#l00049">question.c:49</a></div></div>
<div class="ttc" id="question_2lib_8h_html"><div class="ttname"><a href="question_2lib_8h.html">lib.h</a></div><div class="ttdoc">Ask the user a question. </div></div>
<div class="ttc" id="email_2body_8c_html_a129af1c316fcbc26b55fb48957bab2cb"><div class="ttname"><a href="email_2body_8c.html#a129af1c316fcbc26b55fb48957bab2cb">mutt_body_free</a></div><div class="ttdeci">void mutt_body_free(struct Body **ptr)</div><div class="ttdoc">Free a Body. </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8c_source.html#l00057">body.c:57</a></div></div>
<div class="ttc" id="send_8c_html_a133621f63fdff19b66d2b833f29a7c0f"><div class="ttname"><a href="send_8c.html#a133621f63fdff19b66d2b833f29a7c0f">include_reply</a></div><div class="ttdeci">static int include_reply(struct Mailbox *m, struct Email *e, FILE *fp_out, struct ConfigSubset *sub)</div><div class="ttdoc">Generate the reply text for an email. </div><div class="ttdef"><b>Definition:</b> <a href="send_8c_source.html#l00752">send.c:752</a></div></div>
<div class="ttc" id="mutt_2string_8c_html_aa5fb929533630a48c6d2e893267ce208"><div class="ttname"><a href="mutt_2string_8c.html#aa5fb929533630a48c6d2e893267ce208">mutt_str_skip_email_wsp</a></div><div class="ttdeci">char * mutt_str_skip_email_wsp(const char *s)</div><div class="ttdoc">Skip over whitespace as defined by RFC5322. </div><div class="ttdef"><b>Definition:</b> <a href="mutt_2string_8c_source.html#l00776">string.c:776</a></div></div>
<div class="ttc" id="send_8h_html_ae31498a0e61355a0b4ece8f0c89daf49"><div class="ttname"><a href="send_8h.html#ae31498a0e61355a0b4ece8f0c89daf49">SEND_NEWS</a></div><div class="ttdeci">#define SEND_NEWS</div><div class="ttdoc">Reply to a news article. </div><div class="ttdef"><b>Definition:</b> <a href="send_8h_source.html#l00053">send.h:53</a></div></div>
<div class="ttc" id="mutt__attach_8h_html"><div class="ttname"><a href="mutt__attach_8h.html">mutt_attach.h</a></div><div class="ttdoc">Handling of email attachments. </div></div>
<div class="ttc" id="mutt_2string_8c_html_aebd2a8a3f8a30062c31fa1474d87cc41"><div class="ttname"><a href="mutt_2string_8c.html#aebd2a8a3f8a30062c31fa1474d87cc41">mutt_istr_startswith</a></div><div class="ttdeci">size_t mutt_istr_startswith(const char *str, const char *prefix)</div><div class="ttdoc">Check whether a string starts with a prefix, ignoring case. </div><div class="ttdef"><b>Definition:</b> <a href="mutt_2string_8c_source.html#l00172">string.c:172</a></div></div>
<div class="ttc" id="send_8c_html_a78de7631e05a4bde3c61e5f5d2c34921"><div class="ttname"><a href="send_8c.html#a78de7631e05a4bde3c61e5f5d2c34921">mutt_fetch_recips</a></div><div class="ttdeci">int mutt_fetch_recips(struct Envelope *out, struct Envelope *in, SendFlags flags, struct ConfigSubset *sub)</div><div class="ttdoc">Generate recpients for a reply email. </div><div class="ttdef"><b>Definition:</b> <a href="send_8c_source.html#l00915">send.c:915</a></div></div>
<div class="ttc" id="list_8c_html_a53adfccd4c8b3409a1fa09aa5daf405b"><div class="ttname"><a href="list_8c.html#a53adfccd4c8b3409a1fa09aa5daf405b">mutt_list_insert_head</a></div><div class="ttdeci">struct ListNode * mutt_list_insert_head(struct ListHead *h, char *s)</div><div class="ttdoc">Insert a string at the beginning of a List. </div><div class="ttdef"><b>Definition:</b> <a href="list_8c_source.html#l00045">list.c:45</a></div></div>
<div class="ttc" id="remailer_8c_html_a0b48fa9d9df7079340bb349c86635738"><div class="ttname"><a href="remailer_8c.html#a0b48fa9d9df7079340bb349c86635738">mix_send_message</a></div><div class="ttdeci">int mix_send_message(struct ListHead *chain, const char *tempfile)</div><div class="ttdoc">Send an email via Mixmaster. </div><div class="ttdef"><b>Definition:</b> <a href="remailer_8c_source.html#l00935">remailer.c:935</a></div></div>
<div class="ttc" id="smtp_8c_html_ae59289bca751588d49e12337981f375d"><div class="ttname"><a href="smtp_8c.html#ae59289bca751588d49e12337981f375d">mutt_smtp_send</a></div><div class="ttdeci">int mutt_smtp_send(const struct AddressList *from, const struct AddressList *to, const struct AddressList *cc, const struct AddressList *bcc, const char *msgfile, bool eightbit, struct ConfigSubset *sub)</div><div class="ttdoc">Send a message using SMTP. </div><div class="ttdef"><b>Definition:</b> <a href="smtp_8c_source.html#l00882">smtp.c:882</a></div></div>
<div class="ttc" id="queue_8h_html_a77999ebdf5aaf7af8b8ea22bf208c432"><div class="ttname"><a href="queue_8h.html#a77999ebdf5aaf7af8b8ea22bf208c432">STAILQ_FOREACH</a></div><div class="ttdeci">#define STAILQ_FOREACH(var, head, field)</div><div class="ttdef"><b>Definition:</b> <a href="queue_8h_source.html#l00349">queue.h:349</a></div></div>
<div class="ttc" id="address_2address_8c_html_ad602a3cf6ff5c7fb79d21627553a586d"><div class="ttname"><a href="address_2address_8c.html#ad602a3cf6ff5c7fb79d21627553a586d">mutt_addrlist_search</a></div><div class="ttdeci">bool mutt_addrlist_search(const struct AddressList *haystack, const struct Address *needle)</div><div class="ttdoc">Search for an e-mail address in a list. </div><div class="ttdef"><b>Definition:</b> <a href="address_2address_8c_source.html#l00881">address.c:881</a></div></div>
<div class="ttc" id="helpers_8c_html_acadf9e29fd733422508496a70a080c09"><div class="ttname"><a href="helpers_8c.html#acadf9e29fd733422508496a70a080c09">cs_subset_path</a></div><div class="ttdeci">const char * cs_subset_path(const struct ConfigSubset *sub, const char *name)</div><div class="ttdoc">Get a path config item by name. </div><div class="ttdef"><b>Definition:</b> <a href="helpers_8c_source.html#l00182">helpers.c:182</a></div></div>
<div class="ttc" id="postpone_8c_html_a6d6fb2f03b78be714443316f335c90ae"><div class="ttname"><a href="postpone_8c.html#a6d6fb2f03b78be714443316f335c90ae">mutt_update_num_postponed</a></div><div class="ttdeci">void mutt_update_num_postponed(void)</div><div class="ttdoc">Force the update of the number of postponed messages. </div><div class="ttdef"><b>Definition:</b> <a href="postpone_8c_source.html#l00241">postpone.c:241</a></div></div>
<div class="ttc" id="queue_8h_html_ad89ac472696d006112dface9c2d75e47"><div class="ttname"><a href="queue_8h.html#ad89ac472696d006112dface9c2d75e47">STAILQ_NEXT</a></div><div class="ttdeci">#define STAILQ_NEXT(elm, field)</div><div class="ttdef"><b>Definition:</b> <a href="queue_8h_source.html#l00397">queue.h:397</a></div></div>
<div class="ttc" id="structEmail_html_a570a81cd747437c9ea4357947731ae10"><div class="ttname"><a href="structEmail.html#a570a81cd747437c9ea4357947731ae10">Email::security</a></div><div class="ttdeci">SecurityFlags security</div><div class="ttdoc">bit 0-10: flags, bit 11,12: application, bit 13: traditional pgp See: ncrypt/lib.h pgplib...</div><div class="ttdef"><b>Definition:</b> <a href="email_8h_source.html#l00039">email.h:39</a></div></div>
<div class="ttc" id="email_2email_8c_html_a0c1d7a53b53fccd8f52dc45f69282318"><div class="ttname"><a href="email_2email_8c.html#a0c1d7a53b53fccd8f52dc45f69282318">emaillist_add_email</a></div><div class="ttdeci">int emaillist_add_email(struct EmailList *el, struct Email *e)</div><div class="ttdoc">Add an Email to a list. </div><div class="ttdef"><b>Definition:</b> <a href="email_2email_8c_source.html#l00159">email.c:159</a></div></div>
<div class="ttc" id="send_8h_html_ac23e1891bcbc52cc25b5824acfb42d3c"><div class="ttname"><a href="send_8h.html#ac23e1891bcbc52cc25b5824acfb42d3c">SEND_REPLY</a></div><div class="ttdeci">#define SEND_REPLY</div><div class="ttdoc">Reply to sender. </div><div class="ttdef"><b>Definition:</b> <a href="send_8h_source.html#l00040">send.h:40</a></div></div>
<div class="ttc" id="structNntpMboxData_html"><div class="ttname"><a href="structNntpMboxData.html">NntpMboxData</a></div><div class="ttdoc">NNTP-specific Mailbox data -. </div><div class="ttdef"><b>Definition:</b> <a href="nntp_2mdata_8h_source.html#l00032">mdata.h:32</a></div></div>
<div class="ttc" id="maillist_8h_html"><div class="ttname"><a href="maillist_8h.html">maillist.h</a></div><div class="ttdoc">Handle mailing lists. </div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a2fb0b0aa796d8d79a746001d09c2a2c7"><div class="ttname"><a href="ncrypt_2lib_8h.html#a2fb0b0aa796d8d79a746001d09c2a2c7">SEC_OPPENCRYPT</a></div><div class="ttdeci">#define SEC_OPPENCRYPT</div><div class="ttdoc">Opportunistic encrypt mode. </div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00083">lib.h:83</a></div></div>
<div class="ttc" id="helpers_8c_html_a9154ba713ce99b0937f475eec7c61af9"><div class="ttname"><a href="helpers_8c.html#a9154ba713ce99b0937f475eec7c61af9">cs_subset_quad</a></div><div class="ttdeci">enum QuadOption cs_subset_quad(const struct ConfigSubset *sub, const char *name)</div><div class="ttdoc">Get a quad-value config item by name. </div><div class="ttdef"><b>Definition:</b> <a href="helpers_8c_source.html#l00204">helpers.c:204</a></div></div>
<div class="ttc" id="send_8h_html_a160dd7bb90081f1d45201ef2ab6b46d3"><div class="ttname"><a href="send_8h.html#a160dd7bb90081f1d45201ef2ab6b46d3">SEND_NO_FREE_HEADER</a></div><div class="ttdeci">#define SEND_NO_FREE_HEADER</div><div class="ttdoc">Used by the -E flag. </div><div class="ttdef"><b>Definition:</b> <a href="send_8h_source.html#l00049">send.h:49</a></div></div>
<div class="ttc" id="send_8c_html_a43b8e36cf2d3908ed8484cceeab3de63"><div class="ttname"><a href="send_8c.html#a43b8e36cf2d3908ed8484cceeab3de63">greeting_string</a></div><div class="ttdeci">static const char * greeting_string(char *buf, size_t buflen, size_t col, int cols, char op, const char *src, const char *prec, const char *if_str, const char *else_str, intptr_t data, MuttFormatFlags flags)</div><div class="ttdoc">Format a greetings string. </div><div class="ttdef"><b>Definition:</b> <a href="send_8c_source.html#l00645">send.c:645</a></div></div>
<div class="ttc" id="rfc2047_8c_html_a3cc43939d840544876d40c8da1f99b7d"><div class="ttname"><a href="rfc2047_8c.html#a3cc43939d840544876d40c8da1f99b7d">rfc2047_encode</a></div><div class="ttdeci">void rfc2047_encode(char **pd, const char *specials, int col, const char *charsets)</div><div class="ttdoc">RFC-2047-encode a string. </div><div class="ttdef"><b>Definition:</b> <a href="rfc2047_8c_source.html#l00616">rfc2047.c:616</a></div></div>
<div class="ttc" id="structBody_html_af77d79aadb278bef8f2829c268f2486f"><div class="ttname"><a href="structBody.html#af77d79aadb278bef8f2829c268f2486f">Body::type</a></div><div class="ttdeci">unsigned int type</div><div class="ttdoc">content-type primary type, ContentType </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00065">body.h:65</a></div></div>
<div class="ttc" id="structGreetingInfo_html_a287c96c716ab398fb5f062bd504b9a08"><div class="ttname"><a href="structGreetingInfo.html#a287c96c716ab398fb5f062bd504b9a08">GreetingInfo::mailbox</a></div><div class="ttdeci">struct Mailbox * mailbox</div><div class="ttdef"><b>Definition:</b> <a href="send_8c_source.html#l00095">send.c:95</a></div></div>
<div class="ttc" id="structEnvelope_html_ad0b7bb8cf358dd2d5d1dc5733b3f0be1"><div class="ttname"><a href="structEnvelope.html#ad0b7bb8cf358dd2d5d1dc5733b3f0be1">Envelope::list_post</a></div><div class="ttdeci">char * list_post</div><div class="ttdoc">This stores a mailto URL, or nothing. </div><div class="ttdef"><b>Definition:</b> <a href="envelope_8h_source.html#l00065">envelope.h:65</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_ae12c003463c99d28f65f1d6b8b053b2c"><div class="ttname"><a href="ncrypt_2lib_8h.html#ae12c003463c99d28f65f1d6b8b053b2c">SEC_SIGN</a></div><div class="ttdeci">#define SEC_SIGN</div><div class="ttdoc">Email is signed. </div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00076">lib.h:76</a></div></div>
<div class="ttc" id="address_2address_8c_html_a9a6c4ff878258def25f155501ddb3e7a"><div class="ttname"><a href="address_2address_8c.html#a9a6c4ff878258def25f155501ddb3e7a">mutt_addrlist_count_recips</a></div><div class="ttdeci">int mutt_addrlist_count_recips(const struct AddressList *al)</div><div class="ttdoc">Count the number of Addresses with valid recipients. </div><div class="ttdef"><b>Definition:</b> <a href="address_2address_8c_source.html#l00844">address.c:844</a></div></div>
<div class="ttc" id="cryptglue_8c_html_a07a6c891658dd90ef8333a1e5bbcc285"><div class="ttname"><a href="cryptglue_8c.html#a07a6c891658dd90ef8333a1e5bbcc285">crypt_has_module_backend</a></div><div class="ttdeci">bool crypt_has_module_backend(SecurityFlags type)</div><div class="ttdoc">Is there a crypto backend for a given type? </div><div class="ttdef"><b>Definition:</b> <a href="cryptglue_8c_source.html#l00172">cryptglue.c:172</a></div></div>
<div class="ttc" id="structAddress_html_af4ac89f0f41e7872b4faeaedfcb709b4"><div class="ttname"><a href="structAddress.html#af4ac89f0f41e7872b4faeaedfcb709b4">Address::personal</a></div><div class="ttdeci">char * personal</div><div class="ttdoc">Real name of address. </div><div class="ttdef"><b>Definition:</b> <a href="address_2address_8h_source.html#l00037">address.h:37</a></div></div>
<div class="ttc" id="structMailbox_html_af35ab91f4bcebac7a06a1b0aae9dc4e7"><div class="ttname"><a href="structMailbox.html#af35ab91f4bcebac7a06a1b0aae9dc4e7">Mailbox::flags</a></div><div class="ttdeci">uint8_t flags</div><div class="ttdoc">e.g. MB_NORMAL </div><div class="ttdef"><b>Definition:</b> <a href="mailbox_8h_source.html#l00134">mailbox.h:134</a></div></div>
<div class="ttc" id="postpone_8c_html_a42853d2d4da10271644dc7083ae1c453"><div class="ttname"><a href="postpone_8c.html#a42853d2d4da10271644dc7083ae1c453">mutt_num_postponed</a></div><div class="ttdeci">int mutt_num_postponed(struct Mailbox *m, bool force)</div><div class="ttdoc">Return the number of postponed messages. </div><div class="ttdef"><b>Definition:</b> <a href="postpone_8c_source.html#l00128">postpone.c:128</a></div></div>
<div class="ttc" id="parse_8c_html_a44cbe20da647bd7112cf1f4857ad01a3"><div class="ttname"><a href="parse_8c.html#a44cbe20da647bd7112cf1f4857ad01a3">mutt_parse_content_type</a></div><div class="ttdeci">void mutt_parse_content_type(const char *s, struct Body *ct)</div><div class="ttdoc">Parse a content type. </div><div class="ttdef"><b>Definition:</b> <a href="parse_8c_source.html#l00427">parse.c:427</a></div></div>
<div class="ttc" id="mutt__header_8c_html_add6fa85ce7ef8dcad27d465fbbc27708"><div class="ttname"><a href="mutt__header_8c.html#add6fa85ce7ef8dcad27d465fbbc27708">mutt_edit_headers</a></div><div class="ttdeci">void mutt_edit_headers(const char *editor, const char *body, struct Email *e, struct Buffer *fcc)</div><div class="ttdoc">Let the user edit the message header and body. </div><div class="ttdef"><b>Definition:</b> <a href="mutt__header_8c_source.html#l00170">mutt_header.c:170</a></div></div>
<div class="ttc" id="mutt_2string_8c_html_acca6786b903b22a5924219f9db96e10d"><div class="ttname"><a href="mutt_2string_8c.html#acca6786b903b22a5924219f9db96e10d">mutt_str_len</a></div><div class="ttdeci">size_t mutt_str_len(const char *a)</div><div class="ttdoc">Calculate the length of a string, safely. </div><div class="ttdef"><b>Definition:</b> <a href="mutt_2string_8c_source.html#l00664">string.c:664</a></div></div>
<div class="ttc" id="cryptglue_8c_html_ac671b1b0cd5df34d49ea749d29df8d3f"><div class="ttname"><a href="cryptglue_8c.html#ac671b1b0cd5df34d49ea749d29df8d3f">crypt_pgp_make_key_attachment</a></div><div class="ttdeci">struct Body * crypt_pgp_make_key_attachment(void)</div><div class="ttdoc">Wrapper for CryptModuleSpecs::pgp_make_key_attachment() </div><div class="ttdef"><b>Definition:</b> <a href="cryptglue_8c_source.html#l00310">cryptglue.c:310</a></div></div>
<div class="ttc" id="sendlib_8c_html_a3214a4d6985ca1a64f72d21f6f8c252f"><div class="ttname"><a href="sendlib_8c.html#a3214a4d6985ca1a64f72d21f6f8c252f">mutt_fqdn</a></div><div class="ttdeci">const char * mutt_fqdn(bool may_hide_host, const struct ConfigSubset *sub)</div><div class="ttdoc">Get the Fully-Qualified Domain Name. </div><div class="ttdef"><b>Definition:</b> <a href="sendlib_8c_source.html#l01187">sendlib.c:1187</a></div></div>
<div class="ttc" id="send_8h_html_a47e90c63dbdc4426d0630139c04cc8f3"><div class="ttname"><a href="send_8h.html#a47e90c63dbdc4426d0630139c04cc8f3">SEND_GROUP_REPLY</a></div><div class="ttdeci">#define SEND_GROUP_REPLY</div><div class="ttdoc">Reply to all. </div><div class="ttdef"><b>Definition:</b> <a href="send_8h_source.html#l00041">send.h:41</a></div></div>
<div class="ttc" id="structListNode_html_aafe688d670318196766392d8235d00a7"><div class="ttname"><a href="structListNode.html#aafe688d670318196766392d8235d00a7">ListNode::data</a></div><div class="ttdeci">char * data</div><div class="ttdoc">String. </div><div class="ttdef"><b>Definition:</b> <a href="list_8h_source.html#l00036">list.h:36</a></div></div>
<div class="ttc" id="structEnvelope_html_aa3d22c82ed26a0727508d26363e98ea7"><div class="ttname"><a href="structEnvelope.html#aa3d22c82ed26a0727508d26363e98ea7">Envelope::subject</a></div><div class="ttdeci">char * subject</div><div class="ttdoc">Email&amp;#39;s subject. </div><div class="ttdef"><b>Definition:</b> <a href="envelope_8h_source.html#l00066">envelope.h:66</a></div></div>
<div class="ttc" id="mime_8h_html_a3ccd048df649c335df5a7f82673bbc79a877e24e62c85f20ff0e0f09ab983031e"><div class="ttname"><a href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79a877e24e62c85f20ff0e0f09ab983031e">TYPE_MULTIPART</a></div><div class="ttdoc">Type: &amp;#39;multipart/*&amp;#39;. </div><div class="ttdef"><b>Definition:</b> <a href="mime_8h_source.html#l00037">mime.h:37</a></div></div>
<div class="ttc" id="mutt_2path_8c_html_aa0bcac4d1513357fbd5fea73f25b63a5"><div class="ttname"><a href="mutt_2path_8c.html#aa0bcac4d1513357fbd5fea73f25b63a5">mutt_path_canon</a></div><div class="ttdeci">bool mutt_path_canon(char *buf, size_t buflen, const char *homedir, bool is_dir)</div><div class="ttdoc">Create the canonical version of a path. </div><div class="ttdef"><b>Definition:</b> <a href="mutt_2path_8c_source.html#l00285">path.c:285</a></div></div>
<div class="ttc" id="curs__lib_8c_html_a8323a2c35930da81a8f0c63545537839"><div class="ttname"><a href="curs__lib_8c.html#a8323a2c35930da81a8f0c63545537839">mutt_buffer_enter_fname</a></div><div class="ttdeci">int mutt_buffer_enter_fname(const char *prompt, struct Buffer *fname, bool mailbox, struct Mailbox *m, bool multiple, char ***files, int *numfiles, SelectFileFlags flags)</div><div class="ttdoc">Ask the user to select a file. </div><div class="ttdef"><b>Definition:</b> <a href="curs__lib_8c_source.html#l00513">curs_lib.c:513</a></div></div>
<div class="ttc" id="copy_8h_html"><div class="ttname"><a href="copy_8h.html">copy.h</a></div><div class="ttdoc">Duplicate the structure of an entire email. </div></div>
<div class="ttc" id="muttlib_8c_html_a21df22e3d202586bf463caf3c9e718cc"><div class="ttname"><a href="muttlib_8c.html#a21df22e3d202586bf463caf3c9e718cc">mutt_buffer_expand_path</a></div><div class="ttdeci">void mutt_buffer_expand_path(struct Buffer *buf)</div><div class="ttdoc">Create the canonical path. </div><div class="ttdef"><b>Definition:</b> <a href="muttlib_8c_source.html#l00322">muttlib.c:322</a></div></div>
<div class="ttc" id="curs__lib_8c_html_af100ad8efff5639c6e0ed7d3e37030eb"><div class="ttname"><a href="curs__lib_8c.html#af100ad8efff5639c6e0ed7d3e37030eb">mutt_format_s</a></div><div class="ttdeci">void mutt_format_s(char *buf, size_t buflen, const char *prec, const char *s)</div><div class="ttdoc">Format a simple string. </div><div class="ttdef"><b>Definition:</b> <a href="curs__lib_8c_source.html#l00867">curs_lib.c:867</a></div></div>
<div class="ttc" id="address_2address_8c_html_abe8afdaeb5bdca19a1867823d73a1ec4"><div class="ttname"><a href="address_2address_8c.html#abe8afdaeb5bdca19a1867823d73a1ec4">mutt_addrlist_to_intl</a></div><div class="ttdeci">int mutt_addrlist_to_intl(struct AddressList *al, char **err)</div><div class="ttdoc">Convert an Address list to Punycode. </div><div class="ttdef"><b>Definition:</b> <a href="address_2address_8c_source.html#l01305">address.c:1305</a></div></div>
<div class="ttc" id="send_8c_html_a9fb4ee964889bd118582f0938027a659"><div class="ttname"><a href="send_8c.html#a9fb4ee964889bd118582f0938027a659">edit_envelope</a></div><div class="ttdeci">static int edit_envelope(struct Envelope *en, SendFlags flags, struct ConfigSubset *sub)</div><div class="ttdoc">Edit Envelope fields. </div><div class="ttdef"><b>Definition:</b> <a href="send_8c_source.html#l00222">send.c:222</a></div></div>
<div class="ttc" id="recvattach_8h_html"><div class="ttname"><a href="recvattach_8h.html">recvattach.h</a></div><div class="ttdoc">Routines for managing attachments. </div></div>
<div class="ttc" id="logging_8h_html_aca1fd1d8935433e6ba2e3918214e07f9ab2c99902c587a013b358149516cceeb5"><div class="ttname"><a href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab2c99902c587a013b358149516cceeb5">LL_DEBUG1</a></div><div class="ttdoc">Log at debug level 1. </div><div class="ttdef"><b>Definition:</b> <a href="logging_8h_source.html#l00040">logging.h:40</a></div></div>
<div class="ttc" id="structAddress_html_a12bd44ccc016e50c674ec3a902ba1c28"><div class="ttname"><a href="structAddress.html#a12bd44ccc016e50c674ec3a902ba1c28">Address::group</a></div><div class="ttdeci">bool group</div><div class="ttdoc">Group mailbox? </div><div class="ttdef"><b>Definition:</b> <a href="address_2address_8h_source.html#l00039">address.h:39</a></div></div>
<div class="ttc" id="structEnvelope_html_a5f680f60f1713477a879877dcbd21a5c"><div class="ttname"><a href="structEnvelope.html#a5f680f60f1713477a879877dcbd21a5c">Envelope::newsgroups</a></div><div class="ttdeci">char * newsgroups</div><div class="ttdoc">List of newsgroups. </div><div class="ttdef"><b>Definition:</b> <a href="envelope_8h_source.html#l00075">envelope.h:75</a></div></div>
<div class="ttc" id="hook_8h_html_a709891b042fc13265a7971b2401081c9"><div class="ttname"><a href="hook_8h.html#a709891b042fc13265a7971b2401081c9">MUTT_SEND2_HOOK</a></div><div class="ttdeci">#define MUTT_SEND2_HOOK</div><div class="ttdoc">send2-hook: when changing fields in the compose menu </div><div class="ttdef"><b>Definition:</b> <a href="hook_8h_source.html#l00050">hook.h:50</a></div></div>
<div class="ttc" id="mutt_2string_8c_html_ad20e00309de897a1e882fc7400335b83"><div class="ttname"><a href="mutt_2string_8c.html#ad20e00309de897a1e882fc7400335b83">mutt_str_copy</a></div><div class="ttdeci">size_t mutt_str_copy(char *dest, const char *src, size_t dsize)</div><div class="ttdoc">Copy a string into a buffer (guaranteeing NUL-termination) </div><div class="ttdef"><b>Definition:</b> <a href="mutt_2string_8c_source.html#l00749">string.c:749</a></div></div>
<div class="ttc" id="structBody_html_a86721d1d557276cbc9cf69777af8c305"><div class="ttname"><a href="structBody.html#a86721d1d557276cbc9cf69777af8c305">Body::use_disp</a></div><div class="ttdeci">bool use_disp</div><div class="ttdoc">Content-Disposition uses filename= ? </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00068">body.h:68</a></div></div>
<div class="ttc" id="file_8c_html_a0a6ff09a685fb6fa1120a582a5a6ef4a"><div class="ttname"><a href="file_8c.html#a0a6ff09a685fb6fa1120a582a5a6ef4a">mutt_file_copy_stream</a></div><div class="ttdeci">int mutt_file_copy_stream(FILE *fp_in, FILE *fp_out)</div><div class="ttdoc">Copy the contents of one file into another. </div><div class="ttdef"><b>Definition:</b> <a href="file_8c_source.html#l00271">file.c:271</a></div></div>
<div class="ttc" id="send_8c_html_a7513f0a7dea1ccf4de7506399771a4c2"><div class="ttname"><a href="send_8c.html#a7513f0a7dea1ccf4de7506399771a4c2">add_mailing_lists</a></div><div class="ttdeci">static void add_mailing_lists(struct AddressList *out, const struct AddressList *t, const struct AddressList *c)</div><div class="ttdoc">Search Address lists for mailing lists. </div><div class="ttdef"><b>Definition:</b> <a href="send_8c_source.html#l00160">send.c:160</a></div></div>
<div class="ttc" id="mutt_2string_8c_html_ae9b6bbaa52b6ce51f2a384fe500e028e"><div class="ttname"><a href="mutt_2string_8c.html#ae9b6bbaa52b6ce51f2a384fe500e028e">mutt_str_replace</a></div><div class="ttdeci">char * mutt_str_replace(char **p, const char *s)</div><div class="ttdoc">Replace one string with another. </div><div class="ttdef"><b>Definition:</b> <a href="mutt_2string_8c_source.html#l00446">string.c:446</a></div></div>
<div class="ttc" id="structEmailNode_html_a812e5a33b27b12a78daacbe246089abb"><div class="ttname"><a href="structEmailNode.html#a812e5a33b27b12a78daacbe246089abb">EmailNode::email</a></div><div class="ttdeci">struct Email * email</div><div class="ttdoc">Email in the list. </div><div class="ttdef"><b>Definition:</b> <a href="email_8h_source.html#l00131">email.h:131</a></div></div>
<div class="ttc" id="copy_8h_html_a88a40e8f238a8478b885c90d1ce53e9c"><div class="ttname"><a href="copy_8h.html#a88a40e8f238a8478b885c90d1ce53e9c">CopyHeaderFlags</a></div><div class="ttdeci">uint32_t CopyHeaderFlags</div><div class="ttdoc">Flags for mutt_copy_header(), e.g. CH_UPDATE. </div><div class="ttdef"><b>Definition:</b> <a href="copy_8h_source.html#l00050">copy.h:50</a></div></div>
<div class="ttc" id="structRegex_html"><div class="ttname"><a href="structRegex.html">Regex</a></div><div class="ttdoc">Cached regular expression. </div><div class="ttdef"><b>Definition:</b> <a href="regex3_8h_source.html#l00089">regex3.h:89</a></div></div>
<div class="ttc" id="muttlib_8c_html_a8972094c1e995739c8b072c8be3ce453"><div class="ttname"><a href="muttlib_8c.html#a8972094c1e995739c8b072c8be3ce453">mutt_expando_format</a></div><div class="ttdeci">void mutt_expando_format(char *buf, size_t buflen, size_t col, int cols, const char *src, format_t callback, intptr_t data, MuttFormatFlags flags)</div><div class="ttdoc">Expand expandos (x) in a string. </div><div class="ttdef"><b>Definition:</b> <a href="muttlib_8c_source.html#l00780">muttlib.c:780</a></div></div>
<div class="ttc" id="logging_8h_html_acc1fd6d7ab1603e80e11e84e90d061e4"><div class="ttname"><a href="logging_8h.html#acc1fd6d7ab1603e80e11e84e90d061e4">mutt_error</a></div><div class="ttdeci">#define mutt_error(...)</div><div class="ttdef"><b>Definition:</b> <a href="logging_8h_source.html#l00084">logging.h:84</a></div></div>
<div class="ttc" id="muttlib_8c_html_a408880eb332fd5a312dcae1df22ff688"><div class="ttname"><a href="muttlib_8c.html#a408880eb332fd5a312dcae1df22ff688">mutt_needs_mailcap</a></div><div class="ttdeci">bool mutt_needs_mailcap(struct Body *m)</div><div class="ttdoc">Does this type need a mailcap entry do display. </div><div class="ttdef"><b>Definition:</b> <a href="muttlib_8c_source.html#l00406">muttlib.c:406</a></div></div>
<div class="ttc" id="address_2address_8c_html_a434492a707aadd897d74bdf7b493bbc2"><div class="ttname"><a href="address_2address_8c.html#a434492a707aadd897d74bdf7b493bbc2">mutt_addr_valid_msgid</a></div><div class="ttdeci">bool mutt_addr_valid_msgid(const char *msgid)</div><div class="ttdoc">Is this a valid Message ID? </div><div class="ttdef"><b>Definition:</b> <a href="address_2address_8c_source.html#l00764">address.c:764</a></div></div>
<div class="ttc" id="structBody_html_a47191eabf16d34d0deb412c898ed629b"><div class="ttname"><a href="structBody.html#a47191eabf16d34d0deb412c898ed629b">Body::unlink</a></div><div class="ttdeci">bool unlink</div><div class="ttdoc">If true, filename should be unlink()ed before free()ing this structure. </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00069">body.h:69</a></div></div>
<div class="ttc" id="structEmail_html_aa26dd591f92e548bc3c56d0b7fdb3e8c"><div class="ttname"><a href="structEmail.html#aa26dd591f92e548bc3c56d0b7fdb3e8c">Email::replied</a></div><div class="ttdeci">bool replied</div><div class="ttdoc">Email has been replied to. </div><div class="ttdef"><b>Definition:</b> <a href="email_8h_source.html#l00054">email.h:54</a></div></div>
<div class="ttc" id="send_8c_html_ad951cc16f636045622b313f89278627a"><div class="ttname"><a href="send_8c.html#ad951cc16f636045622b313f89278627a">mutt_forward_trailer</a></div><div class="ttdeci">void mutt_forward_trailer(struct Email *e, FILE *fp, struct ConfigSubset *sub)</div><div class="ttdoc">Add a &quot;end of forwarded message&quot; text. </div><div class="ttdef"><b>Definition:</b> <a href="send_8c_source.html#l00454">send.c:454</a></div></div>
<div class="ttc" id="rfc3676_8c_html_ae80c6b55541960f57f67f4ea3e4467e8"><div class="ttname"><a href="rfc3676_8c.html#ae80c6b55541960f57f67f4ea3e4467e8">mutt_rfc3676_space_stuff</a></div><div class="ttdeci">void mutt_rfc3676_space_stuff(struct Email *e)</div><div class="ttdoc">Perform RFC3676 space stuffing on an Email. </div><div class="ttdef"><b>Definition:</b> <a href="rfc3676_8c_source.html#l00483">rfc3676.c:483</a></div></div>
<div class="ttc" id="structEnvelope_html_a46a9e33786aa5394ad768cbcc2357d65"><div class="ttname"><a href="structEnvelope.html#a46a9e33786aa5394ad768cbcc2357d65">Envelope::followup_to</a></div><div class="ttdeci">char * followup_to</div><div class="ttdoc">List of &amp;#39;followup-to&amp;#39; fields. </div><div class="ttdef"><b>Definition:</b> <a href="envelope_8h_source.html#l00077">envelope.h:77</a></div></div>
<div class="ttc" id="mutt_2regex_8c_html_ad25947e610db74945537b99edf428982"><div class="ttname"><a href="mutt_2regex_8c.html#ad25947e610db74945537b99edf428982">mutt_regex_match</a></div><div class="ttdeci">bool mutt_regex_match(const struct Regex *regex, const char *str)</div><div class="ttdoc">Shorthand to mutt_regex_capture() </div><div class="ttdef"><b>Definition:</b> <a href="mutt_2regex_8c_source.html#l00613">regex.c:613</a></div></div>
<div class="ttc" id="structMessage_html_a11d53ee4319e8735c1677d8780a7b517"><div class="ttname"><a href="structMessage.html#a11d53ee4319e8735c1677d8780a7b517">Message::fp</a></div><div class="ttdeci">FILE * fp</div><div class="ttdoc">pointer to the message data </div><div class="ttdef"><b>Definition:</b> <a href="mxapi_8h_source.html#l00043">mxapi.h:43</a></div></div>
<div class="ttc" id="file_8c_html_a61b50c8615492662cbc27ebbf83090ce"><div class="ttname"><a href="file_8c.html#a61b50c8615492662cbc27ebbf83090ce">mutt_file_decrease_mtime</a></div><div class="ttdeci">time_t mutt_file_decrease_mtime(const char *fp, struct stat *st)</div><div class="ttdoc">Decrease a file&amp;#39;s modification time by 1 second. </div><div class="ttdef"><b>Definition:</b> <a href="file_8c_source.html#l00966">file.c:966</a></div></div>
<div class="ttc" id="hook_8h_html_ab6ec93bff7f691fb01cb5233f4040f62"><div class="ttname"><a href="hook_8h.html#ab6ec93bff7f691fb01cb5233f4040f62">MUTT_REPLY_HOOK</a></div><div class="ttdeci">#define MUTT_REPLY_HOOK</div><div class="ttdoc">reply-hook: when replying to an email </div><div class="ttdef"><b>Definition:</b> <a href="hook_8h_source.html#l00049">hook.h:49</a></div></div>
<div class="ttc" id="address_2address_8c_html_a968e9f56e7408d5e0fa1d1135bdee017"><div class="ttname"><a href="address_2address_8c.html#a968e9f56e7408d5e0fa1d1135bdee017">mutt_addrlist_remove_xrefs</a></div><div class="ttdeci">void mutt_addrlist_remove_xrefs(const struct AddressList *a, struct AddressList *b)</div><div class="ttdoc">Remove cross-references. </div><div class="ttdef"><b>Definition:</b> <a href="address_2address_8c_source.html#l01443">address.c:1443</a></div></div>
<div class="ttc" id="copy_8c_html_aa0dd608f4ed300454d97ac83ade160ac"><div class="ttname"><a href="copy_8c.html#aa0dd608f4ed300454d97ac83ade160ac">mutt_copy_message</a></div><div class="ttdeci">int mutt_copy_message(FILE *fp_out, struct Mailbox *m, struct Email *e, struct Message *msg, CopyMessageFlags cmflags, CopyHeaderFlags chflags, int wraplen)</div><div class="ttdoc">Copy a message from a Mailbox. </div><div class="ttdef"><b>Definition:</b> <a href="copy_8c_source.html#l00853">copy.c:853</a></div></div>
<div class="ttc" id="memory_8h_html_a25875003b43b81a4302256caa4a13599"><div class="ttname"><a href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a></div><div class="ttdeci">#define FREE(x)</div><div class="ttdef"><b>Definition:</b> <a href="memory_8h_source.html#l00040">memory.h:40</a></div></div>
<div class="ttc" id="alias_8c_html_a9d6f6b4ea9d79c9c33ddd7c6b6ef764b"><div class="ttname"><a href="alias_8c.html#a9d6f6b4ea9d79c9c33ddd7c6b6ef764b">mutt_addr_is_user</a></div><div class="ttdeci">bool mutt_addr_is_user(const struct Address *addr)</div><div class="ttdoc">Does the address belong to the user. </div><div class="ttdef"><b>Definition:</b> <a href="alias_8c_source.html#l00562">alias.c:562</a></div></div>
<div class="ttc" id="send_8c_html_aad5805f2620506ae4bc2d7f6474cb849"><div class="ttname"><a href="send_8c.html#aad5805f2620506ae4bc2d7f6474cb849">abort_for_missing_attachments</a></div><div class="ttdeci">static bool abort_for_missing_attachments(const struct Body *b, struct ConfigSubset *sub)</div><div class="ttdoc">Should we abort sending because of missing attachments? </div><div class="ttdef"><b>Definition:</b> <a href="send_8c_source.html#l02070">send.c:2070</a></div></div>
<div class="ttc" id="queue_8h_html_a8427c8f43d09d73062cf6b37f303aff5"><div class="ttname"><a href="queue_8h.html#a8427c8f43d09d73062cf6b37f303aff5">STAILQ_EMPTY</a></div><div class="ttdeci">#define STAILQ_EMPTY(head)</div><div class="ttdef"><b>Definition:</b> <a href="queue_8h_source.html#l00345">queue.h:345</a></div></div>
<div class="ttc" id="compose_2lib_8h_html"><div class="ttname"><a href="compose_2lib_8h.html">lib.h</a></div><div class="ttdoc">GUI editor for an email&amp;#39;s headers. </div></div>
<div class="ttc" id="queue_8h_html_a3d41ce2c3f1dd21c0d4051d13204c321"><div class="ttname"><a href="queue_8h.html#a3d41ce2c3f1dd21c0d4051d13204c321">STAILQ_HEAD_INITIALIZER</a></div><div class="ttdeci">#define STAILQ_HEAD_INITIALIZER(head)</div><div class="ttdef"><b>Definition:</b> <a href="queue_8h_source.html#l00321">queue.h:321</a></div></div>
<div class="ttc" id="quad_8h_html_a738f558a271fe5035e0ee3b700ee35dbabe3800cc419f25384aaf1892fc3c812b"><div class="ttname"><a href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35dbabe3800cc419f25384aaf1892fc3c812b">MUTT_NO</a></div><div class="ttdoc">User answered &amp;#39;No&amp;#39;, or assume &amp;#39;No&amp;#39;. </div><div class="ttdef"><b>Definition:</b> <a href="quad_8h_source.html#l00038">quad.h:38</a></div></div>
<div class="ttc" id="format__flags_8h_html_a74b6a43a2681d01209a8caa889779938"><div class="ttname"><a href="format__flags_8h.html#a74b6a43a2681d01209a8caa889779938">MUTT_FORMAT_OPTIONAL</a></div><div class="ttdeci">#define MUTT_FORMAT_OPTIONAL</div><div class="ttdoc">Allow optional field processing. </div><div class="ttdef"><b>Definition:</b> <a href="format__flags_8h_source.html#l00033">format_flags.h:33</a></div></div>
<div class="ttc" id="structEnvelope_html_a2d927371b3b80e025d6f7522b7361fe7"><div class="ttname"><a href="structEnvelope.html#a2d927371b3b80e025d6f7522b7361fe7">Envelope::to</a></div><div class="ttdeci">struct AddressList to</div><div class="ttdoc">Email&amp;#39;s &amp;#39;To&amp;#39; list. </div><div class="ttdef"><b>Definition:</b> <a href="envelope_8h_source.html#l00058">envelope.h:58</a></div></div>
<div class="ttc" id="structEmailNode_html"><div class="ttname"><a href="structEmailNode.html">EmailNode</a></div><div class="ttdoc">List of Emails. </div><div class="ttdef"><b>Definition:</b> <a href="email_8h_source.html#l00129">email.h:129</a></div></div>
<div class="ttc" id="send_8c_html_ad829e8c88d7630a8a6ed719378dd4570"><div class="ttname"><a href="send_8c.html#ad829e8c88d7630a8a6ed719378dd4570">search_attach_keyword</a></div><div class="ttdeci">static bool search_attach_keyword(char *filename, struct ConfigSubset *sub)</div><div class="ttdoc">Search an email for &amp;#39;attachment&amp;#39; keywords. </div><div class="ttdef"><b>Definition:</b> <a href="send_8c_source.html#l01701">send.c:1701</a></div></div>
<div class="ttc" id="queue_8h_html_abd57fe9bdea6007a602f8c7d61bd5265"><div class="ttname"><a href="queue_8h.html#abd57fe9bdea6007a602f8c7d61bd5265">TAILQ_NEXT</a></div><div class="ttdeci">#define TAILQ_NEXT(elm, field)</div><div class="ttdef"><b>Definition:</b> <a href="queue_8h_source.html#l00825">queue.h:825</a></div></div>
<div class="ttc" id="send_8c_html_a247e6a821f797b77785f3a724baa44c3"><div class="ttname"><a href="send_8c.html#a247e6a821f797b77785f3a724baa44c3">mutt_make_misc_reply_headers</a></div><div class="ttdeci">void mutt_make_misc_reply_headers(struct Envelope *env, struct Envelope *curenv, struct ConfigSubset *sub)</div><div class="ttdoc">Set subject for a reply. </div><div class="ttdef"><b>Definition:</b> <a href="send_8c_source.html#l01054">send.c:1054</a></div></div>
<div class="ttc" id="mutt__globals_8h_html"><div class="ttname"><a href="mutt__globals_8h.html">mutt_globals.h</a></div><div class="ttdoc">Hundreds of global variables to back the user variables. </div></div>
<div class="ttc" id="options_8h_html"><div class="ttname"><a href="options_8h.html">options.h</a></div><div class="ttdoc">Handling of global boolean variables. </div></div>
<div class="ttc" id="logging_8h_html_ae6c5fd73af3410b2d5e8099f8774c8da"><div class="ttname"><a href="logging_8h.html#ae6c5fd73af3410b2d5e8099f8774c8da">mutt_debug</a></div><div class="ttdeci">#define mutt_debug(LEVEL,...)</div><div class="ttdef"><b>Definition:</b> <a href="logging_8h_source.html#l00081">logging.h:81</a></div></div>
<div class="ttc" id="hook_8c_html_af487ca5e3f7da21c86e3ad61fdb55faa"><div class="ttname"><a href="hook_8c.html#af487ca5e3f7da21c86e3ad61fdb55faa">mutt_message_hook</a></div><div class="ttdeci">void mutt_message_hook(struct Mailbox *m, struct Email *e, HookFlags type)</div><div class="ttdoc">Perform a message hook. </div><div class="ttdef"><b>Definition:</b> <a href="hook_8c_source.html#l00598">hook.c:598</a></div></div>
<div class="ttc" id="send_8c_html_a58823b3164da72a6429664e1091d12a8"><div class="ttname"><a href="send_8c.html#a58823b3164da72a6429664e1091d12a8">mutt_resend_message</a></div><div class="ttdeci">int mutt_resend_message(FILE *fp, struct Mailbox *m, struct Email *e_cur, struct ConfigSubset *sub)</div><div class="ttdoc">Resend an email. </div><div class="ttdef"><b>Definition:</b> <a href="send_8c_source.html#l01632">send.c:1632</a></div></div>
<div class="ttc" id="queue_8h_html_ac3c9da7ac712eacbbad5cc54d7a3477e"><div class="ttname"><a href="queue_8h.html#ac3c9da7ac712eacbbad5cc54d7a3477e">TAILQ_EMPTY</a></div><div class="ttdeci">#define TAILQ_EMPTY(head)</div><div class="ttdef"><b>Definition:</b> <a href="queue_8h_source.html#l00714">queue.h:714</a></div></div>
<div class="ttc" id="mutt_2string_8c_html_a4388c16988fac9a7596dee4d4af89595"><div class="ttname"><a href="mutt_2string_8c.html#a4388c16988fac9a7596dee4d4af89595">mutt_str_asprintf</a></div><div class="ttdeci">int mutt_str_asprintf(char **strp, const char *fmt,...)</div><div class="ttdef"><b>Definition:</b> <a href="mutt_2string_8c_source.html#l01128">string.c:1128</a></div></div>
<div class="ttc" id="send_8h_html_a0e11db957196a8cc43bbe955178f3686"><div class="ttname"><a href="send_8h.html#a0e11db957196a8cc43bbe955178f3686">SEND_GROUP_CHAT_REPLY</a></div><div class="ttdeci">#define SEND_GROUP_CHAT_REPLY</div><div class="ttdoc">Reply to all recipients preserving To/Cc. </div><div class="ttdef"><b>Definition:</b> <a href="send_8h_source.html#l00052">send.h:52</a></div></div>
<div class="ttc" id="copy_8h_html_ad0d836342af33c74966ba719fd33c475"><div class="ttname"><a href="copy_8h.html#ad0d836342af33c74966ba719fd33c475">MUTT_CM_NOHEADER</a></div><div class="ttdeci">#define MUTT_CM_NOHEADER</div><div class="ttdoc">Don&amp;#39;t copy the message header. </div><div class="ttdef"><b>Definition:</b> <a href="copy_8h_source.html#l00036">copy.h:36</a></div></div>
<div class="ttc" id="options_8h_html_affdfc25e31602911d236c7d283865f1c"><div class="ttname"><a href="options_8h.html#affdfc25e31602911d236c7d283865f1c">OptNewsSend</a></div><div class="ttdeci">WHERE bool OptNewsSend</div><div class="ttdoc">(pseudo) used to change behavior when posting </div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00045">options.h:45</a></div></div>
<div class="ttc" id="logging_8h_html_aca1fd1d8935433e6ba2e3918214e07f9a678d278eb301551ba0b3e0dbcfcee630"><div class="ttname"><a href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a678d278eb301551ba0b3e0dbcfcee630">LL_DEBUG5</a></div><div class="ttdoc">Log at debug level 5. </div><div class="ttdef"><b>Definition:</b> <a href="logging_8h_source.html#l00044">logging.h:44</a></div></div>
<div class="ttc" id="mutt_2lib_8h_html"><div class="ttname"><a href="mutt_2lib_8h.html">lib.h</a></div><div class="ttdoc">Convenience wrapper for the library headers. </div></div>
<div class="ttc" id="file_8c_html_ae1c0c19fec03274220b3ca065ad1e2e5"><div class="ttname"><a href="file_8c.html#ae1c0c19fec03274220b3ca065ad1e2e5">mutt_file_fopen</a></div><div class="ttdeci">FILE * mutt_file_fopen(const char *path, const char *mode)</div><div class="ttdoc">Call fopen() safely. </div><div class="ttdef"><b>Definition:</b> <a href="file_8c_source.html#l00589">file.c:589</a></div></div>
<div class="ttc" id="send_8c_html_a6671477ec99e59665fcbac17986d6e93"><div class="ttname"><a href="send_8c.html#a6671477ec99e59665fcbac17986d6e93">remove_user</a></div><div class="ttdeci">static void remove_user(struct AddressList *al, bool leave_only)</div><div class="ttdoc">Remove any address which matches the current user. </div><div class="ttdef"><b>Definition:</b> <a href="send_8c_source.html#l00141">send.c:141</a></div></div>
<div class="ttc" id="structEnvelope_html_a832eec73356a806761e26f0bc40d9083"><div class="ttname"><a href="structEnvelope.html#a832eec73356a806761e26f0bc40d9083">Envelope::references</a></div><div class="ttdeci">struct ListHead references</div><div class="ttdoc">message references (in reverse order) </div><div class="ttdef"><b>Definition:</b> <a href="envelope_8h_source.html#l00081">envelope.h:81</a></div></div>
<div class="ttc" id="structListNode_html"><div class="ttname"><a href="structListNode.html">ListNode</a></div><div class="ttdoc">A List node for strings. </div><div class="ttdef"><b>Definition:</b> <a href="list_8h_source.html#l00034">list.h:34</a></div></div>
<div class="ttc" id="queue_8h_html_aa4cf483c7dcddd1d89a00886b5466bac"><div class="ttname"><a href="queue_8h.html#aa4cf483c7dcddd1d89a00886b5466bac">TAILQ_SWAP</a></div><div class="ttdeci">#define TAILQ_SWAP(head1, head2, type, field)</div><div class="ttdef"><b>Definition:</b> <a href="queue_8h_source.html#l00852">queue.h:852</a></div></div>
<div class="ttc" id="muttlib_8c_html_a99ddb819be19b4db97884f1d2b9984d8"><div class="ttname"><a href="muttlib_8c.html#a99ddb819be19b4db97884f1d2b9984d8">mutt_open_read</a></div><div class="ttdeci">FILE * mutt_open_read(const char *path, pid_t *thepid)</div><div class="ttdoc">Run a command to read from. </div><div class="ttdef"><b>Definition:</b> <a href="muttlib_8c_source.html#l01315">muttlib.c:1315</a></div></div>
<div class="ttc" id="filter_8c_html_a22c6912b837b1114c3276c990e73dca3"><div class="ttname"><a href="filter_8c.html#a22c6912b837b1114c3276c990e73dca3">filter_wait</a></div><div class="ttdeci">int filter_wait(pid_t pid)</div><div class="ttdoc">Wait for the exit of a process and return its status. </div><div class="ttdef"><b>Definition:</b> <a href="filter_8c_source.html#l00217">filter.c:217</a></div></div>
<div class="ttc" id="attachments_8h_html"><div class="ttname"><a href="attachments_8h.html">attachments.h</a></div><div class="ttdoc">Miscellaneous email parsing routines. </div></div>
<div class="ttc" id="buffer_8c_html_a2d7c4a32422377609be66b0f620c4971"><div class="ttname"><a href="buffer_8c.html#a2d7c4a32422377609be66b0f620c4971">mutt_buffer_is_empty</a></div><div class="ttdeci">bool mutt_buffer_is_empty(const struct Buffer *buf)</div><div class="ttdoc">Is the Buffer empty? </div><div class="ttdef"><b>Definition:</b> <a href="buffer_8c_source.html#l00252">buffer.c:252</a></div></div>
<div class="ttc" id="handler_8h_html"><div class="ttname"><a href="handler_8h.html">handler.h</a></div><div class="ttdoc">Decide how to display email content. </div></div>
<div class="ttc" id="mime_8h_html_a5f93dab7807282e699a6bc1b2d18a2d8a691faf938d6b4cec05ea5e03d9dee073"><div class="ttname"><a href="mime_8h.html#a5f93dab7807282e699a6bc1b2d18a2d8a691faf938d6b4cec05ea5e03d9dee073">DISP_INLINE</a></div><div class="ttdoc">Content is inline. </div><div class="ttdef"><b>Definition:</b> <a href="mime_8h_source.html#l00062">mime.h:62</a></div></div>
<div class="ttc" id="structBody_html_a782cee95e0064e3895b88248bdfc781a"><div class="ttname"><a href="structBody.html#a782cee95e0064e3895b88248bdfc781a">Body::parameter</a></div><div class="ttdeci">struct ParameterList parameter</div><div class="ttdoc">parameters of the content-type </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00039">body.h:39</a></div></div>
<div class="ttc" id="mailbox_8h_html_af65addf714c28dd5d483cb426100921da7f541a03089370b1a260e344f8d1809b"><div class="ttname"><a href="mailbox_8h.html#af65addf714c28dd5d483cb426100921da7f541a03089370b1a260e344f8d1809b">MUTT_IMAP</a></div><div class="ttdoc">&amp;#39;IMAP&amp;#39; Mailbox type </div><div class="ttdef"><b>Definition:</b> <a href="mailbox_8h_source.html#l00053">mailbox.h:53</a></div></div>
<div class="ttc" id="structEnvelope_html_a525bd5213606067d5c2be2e17fbe956b"><div class="ttname"><a href="structEnvelope.html#a525bd5213606067d5c2be2e17fbe956b">Envelope::x_original_to</a></div><div class="ttdeci">struct AddressList x_original_to</div><div class="ttdoc">Email&amp;#39;s &amp;#39;X-Orig-to&amp;#39;. </div><div class="ttdef"><b>Definition:</b> <a href="envelope_8h_source.html#l00064">envelope.h:64</a></div></div>
<div class="ttc" id="queue_8h_html_a3e2eb7535019a2829399b24744dd1a66"><div class="ttname"><a href="queue_8h.html#a3e2eb7535019a2829399b24744dd1a66">STAILQ_FIRST</a></div><div class="ttdeci">#define STAILQ_FIRST(head)</div><div class="ttdef"><b>Definition:</b> <a href="queue_8h_source.html#l00347">queue.h:347</a></div></div>
<div class="ttc" id="structAttachCtx_html"><div class="ttname"><a href="structAttachCtx.html">AttachCtx</a></div><div class="ttdoc">A set of attachments. </div><div class="ttdef"><b>Definition:</b> <a href="attach_8h_source.html#l00049">attach.h:49</a></div></div>
<div class="ttc" id="send_8c_html_a4ac367179189d865ae41a5366bc6bec7"><div class="ttname"><a href="send_8c.html#a4ac367179189d865ae41a5366bc6bec7">mutt_add_to_reference_headers</a></div><div class="ttdeci">void mutt_add_to_reference_headers(struct Envelope *env, struct Envelope *curenv, struct ConfigSubset *sub)</div><div class="ttdoc">Generate references for a reply email. </div><div class="ttdef"><b>Definition:</b> <a href="send_8c_source.html#l01081">send.c:1081</a></div></div>
<div class="ttc" id="structAttachCtx_html_a8954cda6f07f33628b3addf8bc2621fd"><div class="ttname"><a href="structAttachCtx.html#a8954cda6f07f33628b3addf8bc2621fd">AttachCtx::idx</a></div><div class="ttdeci">struct AttachPtr ** idx</div><div class="ttdoc">Array of attachments. </div><div class="ttdef"><b>Definition:</b> <a href="attach_8h_source.html#l00054">attach.h:54</a></div></div>
<div class="ttc" id="curs__lib_8c_html_a0590f11f42a6242002ea4c842438231b"><div class="ttname"><a href="curs__lib_8c.html#a0590f11f42a6242002ea4c842438231b">mutt_edit_file</a></div><div class="ttdeci">void mutt_edit_file(const char *editor, const char *file)</div><div class="ttdoc">Let the user edit a file. </div><div class="ttdef"><b>Definition:</b> <a href="curs__lib_8c_source.html#l00380">curs_lib.c:380</a></div></div>
<div class="ttc" id="send_8c_html_a1ba9ce78a67261e872a264bc956ef857"><div class="ttname"><a href="send_8c.html#a1ba9ce78a67261e872a264bc956ef857">mutt_encode_descriptions</a></div><div class="ttdeci">void mutt_encode_descriptions(struct Body *b, bool recurse, struct ConfigSubset *sub)</div><div class="ttdoc">rfc2047 encode the content-descriptions </div><div class="ttdef"><b>Definition:</b> <a href="send_8c_source.html#l01573">send.c:1573</a></div></div>
<div class="ttc" id="address_2address_8c_html_a69d612ac8c7f2fc7e471561216bd1c41"><div class="ttname"><a href="address_2address_8c.html#a69d612ac8c7f2fc7e471561216bd1c41">mutt_addrlist_write</a></div><div class="ttdeci">size_t mutt_addrlist_write(const struct AddressList *al, char *buf, size_t buflen, bool display)</div><div class="ttdoc">Write an Address to a buffer. </div><div class="ttdef"><b>Definition:</b> <a href="address_2address_8c_source.html#l01150">address.c:1150</a></div></div>
<div class="ttc" id="send_8c_html_a8491c02ca19dcad55ccdd2edb3bbcf24"><div class="ttname"><a href="send_8c.html#a8491c02ca19dcad55ccdd2edb3bbcf24">envelope_defaults</a></div><div class="ttdeci">static int envelope_defaults(struct Envelope *env, struct Mailbox *m, struct EmailList *el, SendFlags flags, struct ConfigSubset *sub)</div><div class="ttdoc">Fill in some defaults for a new email. </div><div class="ttdef"><b>Definition:</b> <a href="send_8c_source.html#l01140">send.c:1140</a></div></div>
<div class="ttc" id="mx_8c_html_a7df2f9d4d83ce9fca2cf48e08f8a4bc0"><div class="ttname"><a href="mx_8c.html#a7df2f9d4d83ce9fca2cf48e08f8a4bc0">mx_msg_open</a></div><div class="ttdeci">struct Message * mx_msg_open(struct Mailbox *m, int msgno)</div><div class="ttdoc">return a stream pointer for a message </div><div class="ttdef"><b>Definition:</b> <a href="mx_8c_source.html#l01140">mx.c:1140</a></div></div>
<div class="ttc" id="mime_8h_html_a3ccd048df649c335df5a7f82673bbc79ac5074066199e3f540550ca0b1a38978e"><div class="ttname"><a href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79ac5074066199e3f540550ca0b1a38978e">TYPE_APPLICATION</a></div><div class="ttdoc">Type: &amp;#39;application/*&amp;#39;. </div><div class="ttdef"><b>Definition:</b> <a href="mime_8h_source.html#l00033">mime.h:33</a></div></div>
<div class="ttc" id="postpone_8c_html_aad14aaca518d6c005ec318f14114d5ec"><div class="ttname"><a href="postpone_8c.html#aad14aaca518d6c005ec318f14114d5ec">mutt_prepare_template</a></div><div class="ttdeci">int mutt_prepare_template(FILE *fp, struct Mailbox *m, struct Email *e_new, struct Email *e, bool resend)</div><div class="ttdoc">Prepare a message template. </div><div class="ttdef"><b>Definition:</b> <a href="postpone_8c_source.html#l00737">postpone.c:737</a></div></div>
<div class="ttc" id="send_8c_html_a3a50e112e7c0ddd1270a550e63fdd80f"><div class="ttname"><a href="send_8c.html#a3a50e112e7c0ddd1270a550e63fdd80f">mutt_edit_address</a></div><div class="ttdeci">int mutt_edit_address(struct AddressList *al, const char *field, bool expand_aliases)</div><div class="ttdoc">Edit an email address. </div><div class="ttdef"><b>Definition:</b> <a href="send_8c_source.html#l00187">send.c:187</a></div></div>
<div class="ttc" id="header_8c_html_a400e83b7e5612f974ef543ff3cd237d8"><div class="ttname"><a href="header_8c.html#a400e83b7e5612f974ef543ff3cd237d8">mutt_rfc822_write_header</a></div><div class="ttdeci">int mutt_rfc822_write_header(FILE *fp, struct Envelope *env, struct Body *attach, enum MuttWriteHeaderMode mode, bool privacy, bool hide_protected_subject, struct ConfigSubset *sub)</div><div class="ttdoc">Write out one RFC822 header line. </div><div class="ttdef"><b>Definition:</b> <a href="header_8c_source.html#l00574">header.c:574</a></div></div>
<div class="ttc" id="send_8c_html_a859ddbab5f9384328fd06bf9c18c02f2"><div class="ttname"><a href="send_8c.html#a859ddbab5f9384328fd06bf9c18c02f2">invoke_mta</a></div><div class="ttdeci">static int invoke_mta(struct Mailbox *m, struct Email *e, struct ConfigSubset *sub)</div><div class="ttdoc">Send an email. </div><div class="ttdef"><b>Definition:</b> <a href="send_8c_source.html#l01487">send.c:1487</a></div></div>
<div class="ttc" id="parameter_8c_html_a42249fc15b1e52df046a0a10de29da44"><div class="ttname"><a href="parameter_8c.html#a42249fc15b1e52df046a0a10de29da44">mutt_param_set</a></div><div class="ttdeci">void mutt_param_set(struct ParameterList *pl, const char *attribute, const char *value)</div><div class="ttdoc">Set a Parameter. </div><div class="ttdef"><b>Definition:</b> <a href="parameter_8c_source.html#l00110">parameter.c:110</a></div></div>
<div class="ttc" id="remailer_8h_html"><div class="ttname"><a href="remailer_8h.html">remailer.h</a></div><div class="ttdoc">Support of Mixmaster anonymous remailer. </div></div>
<div class="ttc" id="structEmail_html_af64bcf33ccd8b0ba248fc8d427c21264"><div class="ttname"><a href="structEmail.html#af64bcf33ccd8b0ba248fc8d427c21264">Email::received</a></div><div class="ttdeci">time_t received</div><div class="ttdoc">Time when the message was placed in the mailbox. </div><div class="ttdef"><b>Definition:</b> <a href="email_8h_source.html#l00083">email.h:83</a></div></div>
<div class="ttc" id="send_8h_html_a05caaa1cac7622dce2a0e32d75619b48"><div class="ttname"><a href="send_8h.html#a05caaa1cac7622dce2a0e32d75619b48">SEND_BATCH</a></div><div class="ttdeci">#define SEND_BATCH</div><div class="ttdoc">Send email in batch mode (without user interaction) </div><div class="ttdef"><b>Definition:</b> <a href="send_8h_source.html#l00045">send.h:45</a></div></div>
<div class="ttc" id="structEnvelope_html"><div class="ttname"><a href="structEnvelope.html">Envelope</a></div><div class="ttdoc">The header of an Email. </div><div class="ttdef"><b>Definition:</b> <a href="envelope_8h_source.html#l00054">envelope.h:54</a></div></div>
<div class="ttc" id="mutt_8h_html_a9e6a54c16b89088342e5ed4054d35a83"><div class="ttname"><a href="mutt_8h.html#a9e6a54c16b89088342e5ed4054d35a83">MUTT_TOKEN_NO_FLAGS</a></div><div class="ttdeci">#define MUTT_TOKEN_NO_FLAGS</div><div class="ttdoc">No flags are set. </div><div class="ttdef"><b>Definition:</b> <a href="mutt_8h_source.html#l00066">mutt.h:66</a></div></div>
<div class="ttc" id="structEmail_html_abd3d551204f4ea232a304c1c4c4c149d"><div class="ttname"><a href="structEmail.html#abd3d551204f4ea232a304c1c4c4c149d">Email::msgno</a></div><div class="ttdeci">int msgno</div><div class="ttdoc">Number displayed to the user. </div><div class="ttdef"><b>Definition:</b> <a href="email_8h_source.html#l00087">email.h:87</a></div></div>
<div class="ttc" id="address_2address_8c_html_a68385b174baad74a9aecf3dec61432a0"><div class="ttname"><a href="address_2address_8c.html#a68385b174baad74a9aecf3dec61432a0">mutt_addrlist_append</a></div><div class="ttdeci">void mutt_addrlist_append(struct AddressList *al, struct Address *a)</div><div class="ttdoc">Append an Address to an AddressList. </div><div class="ttdef"><b>Definition:</b> <a href="address_2address_8c_source.html#l01490">address.c:1490</a></div></div>
<div class="ttc" id="quad_8h_html_a738f558a271fe5035e0ee3b700ee35dbafee7088606c4724651c799a6a0b182b7"><div class="ttname"><a href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35dbafee7088606c4724651c799a6a0b182b7">MUTT_YES</a></div><div class="ttdoc">User answered &amp;#39;Yes&amp;#39;, or assume &amp;#39;Yes&amp;#39;. </div><div class="ttdef"><b>Definition:</b> <a href="quad_8h_source.html#l00039">quad.h:39</a></div></div>
<div class="ttc" id="buffer_8c_html_a2837f43a0e59e6cf2f83f23c81e53498"><div class="ttname"><a href="buffer_8c.html#a2837f43a0e59e6cf2f83f23c81e53498">mutt_buffer_alloc</a></div><div class="ttdeci">void mutt_buffer_alloc(struct Buffer *buf, size_t new_size)</div><div class="ttdoc">Make sure a buffer can store at least new_size bytes. </div><div class="ttdef"><b>Definition:</b> <a href="buffer_8c_source.html#l00265">buffer.c:265</a></div></div>
<div class="ttc" id="sort_8c_html_a9a230efa9217e987ca1d1adb14b7e235"><div class="ttname"><a href="sort_8c.html#a9a230efa9217e987ca1d1adb14b7e235">mutt_get_name</a></div><div class="ttdeci">const char * mutt_get_name(const struct Address *a)</div><div class="ttdoc">Pick the best name to display from an address. </div><div class="ttdef"><b>Definition:</b> <a href="sort_8c_source.html#l00136">sort.c:136</a></div></div>
<div class="ttc" id="email_2attach_8c_html_ac215772ab5cc4d60e0a64fd5c84513e1"><div class="ttname"><a href="email_2attach_8c.html#ac215772ab5cc4d60e0a64fd5c84513e1">mutt_actx_free</a></div><div class="ttdeci">void mutt_actx_free(struct AttachCtx **ptr)</div><div class="ttdoc">Free an Attachment Context. </div><div class="ttdef"><b>Definition:</b> <a href="email_2attach_8c_source.html#l00140">attach.c:140</a></div></div>
<div class="ttc" id="structAttachPtr_html_a0546c0753a6155ae9555c290b80d0356"><div class="ttname"><a href="structAttachPtr.html#a0546c0753a6155ae9555c290b80d0356">AttachPtr::body</a></div><div class="ttdeci">struct Body * body</div><div class="ttdoc">Attachment. </div><div class="ttdef"><b>Definition:</b> <a href="attach_8h_source.html#l00036">attach.h:36</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
</body>
</html>
