<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NeoMutt: send/sendlib.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><a href="https://neomutt.org"><img alt="Logo" src="neomutt-64.png"/></a></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <a style="color: black; text-decoration: none;" href="https://neomutt.org">
   <div id="projectname">NeoMutt
   &#160;<span id="projectnumber">2021-02-05-647-g5d4e00</span>
   </div>
   <div id="projectbrief">Teaching an old dog new tricks</div>
   </a>
   <a href="https://github.com/neomutt/neomutt" class="github-corner" aria-label="View source on Github"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#000000; color:#fff; position: fixed; top: 0; border: 0; right: 0; z-index: 9999;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
  </td>
   <td><a style="text-decoration: none; position: absolute; right: 0; top: 25px; margin-right: 100px; color: #66d866; font-size: 400%;" href="http://www.doxygen.org/index.html">DOXYGEN</a></td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('sendlib_8h.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">sendlib.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Miscellaneous functions for sending an email.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdbool.h&gt;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
<code>#include &quot;<a class="el" href="email_2lib_8h_source.html">email/lib.h</a>&quot;</code><br />
</div><div class="textblock"><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Include dependency graph for sendlib.h:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="sendlib_8h__incl.svg" width="299" height="112"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</div><div class="textblock"><div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="closed.png" alt="+"/> This graph shows which files directly or indirectly include this file:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="sendlib_8h__dep__incl.svg" width="299" height="187"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</div>
<p><a href="sendlib_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a3eb2475f59b97dda306d28971399217a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sendlib_8h.html#a3eb2475f59b97dda306d28971399217a">MUTT_RANDTAG_LEN</a>&#160;&#160;&#160;16</td></tr>
<tr class="separator:a3eb2475f59b97dda306d28971399217a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a7848f294cb015bff75efc45e2d15494c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sendlib_8h.html#a7848f294cb015bff75efc45e2d15494c">mutt_bounce_message</a> (FILE *fp, struct <a class="el" href="structMailbox.html">Mailbox</a> *m, struct <a class="el" href="structEmail.html">Email</a> *e, struct AddressList *to, struct <a class="el" href="structConfigSubset.html">ConfigSubset</a> *sub)</td></tr>
<tr class="memdesc:a7848f294cb015bff75efc45e2d15494c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Bounce an email message.  <a href="#a7848f294cb015bff75efc45e2d15494c">More...</a><br /></td></tr>
<tr class="separator:a7848f294cb015bff75efc45e2d15494c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3214a4d6985ca1a64f72d21f6f8c252f"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sendlib_8h.html#a3214a4d6985ca1a64f72d21f6f8c252f">mutt_fqdn</a> (bool may_hide_host, const struct <a class="el" href="structConfigSubset.html">ConfigSubset</a> *sub)</td></tr>
<tr class="memdesc:a3214a4d6985ca1a64f72d21f6f8c252f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the Fully-Qualified Domain Name.  <a href="#a3214a4d6985ca1a64f72d21f6f8c252f">More...</a><br /></td></tr>
<tr class="separator:a3214a4d6985ca1a64f72d21f6f8c252f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8621a45f0aa4aea9e2613207be4fa717"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structContent.html">Content</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sendlib_8h.html#a8621a45f0aa4aea9e2613207be4fa717">mutt_get_content_info</a> (const char *fname, struct <a class="el" href="structBody.html">Body</a> *b, struct <a class="el" href="structConfigSubset.html">ConfigSubset</a> *sub)</td></tr>
<tr class="memdesc:a8621a45f0aa4aea9e2613207be4fa717"><td class="mdescLeft">&#160;</td><td class="mdescRight">Analyze file to determine MIME encoding to use.  <a href="#a8621a45f0aa4aea9e2613207be4fa717">More...</a><br /></td></tr>
<tr class="separator:a8621a45f0aa4aea9e2613207be4fa717"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1431e9401865165dfef92315f3ca7ae2"><td class="memItemLeft" align="right" valign="top">enum <a class="el" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79">ContentType</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sendlib_8h.html#a1431e9401865165dfef92315f3ca7ae2">mutt_lookup_mime_type</a> (struct <a class="el" href="structBody.html">Body</a> *att, const char *path)</td></tr>
<tr class="memdesc:a1431e9401865165dfef92315f3ca7ae2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find the MIME type for an attachment.  <a href="#a1431e9401865165dfef92315f3ca7ae2">More...</a><br /></td></tr>
<tr class="separator:a1431e9401865165dfef92315f3ca7ae2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4151ab9123ccb452ca911515b80ac85e"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structBody.html">Body</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sendlib_8h.html#a4151ab9123ccb452ca911515b80ac85e">mutt_make_file_attach</a> (const char *path, struct <a class="el" href="structConfigSubset.html">ConfigSubset</a> *sub)</td></tr>
<tr class="memdesc:a4151ab9123ccb452ca911515b80ac85e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a file attachment.  <a href="#a4151ab9123ccb452ca911515b80ac85e">More...</a><br /></td></tr>
<tr class="separator:a4151ab9123ccb452ca911515b80ac85e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8ddd58faaec9226b8af76db09d4155c"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structBody.html">Body</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sendlib_8h.html#ac8ddd58faaec9226b8af76db09d4155c">mutt_make_message_attach</a> (struct <a class="el" href="structMailbox.html">Mailbox</a> *m, struct <a class="el" href="structEmail.html">Email</a> *e, bool attach_msg, struct <a class="el" href="structConfigSubset.html">ConfigSubset</a> *sub)</td></tr>
<tr class="memdesc:ac8ddd58faaec9226b8af76db09d4155c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a message attachment.  <a href="#ac8ddd58faaec9226b8af76db09d4155c">More...</a><br /></td></tr>
<tr class="separator:ac8ddd58faaec9226b8af76db09d4155c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a303061e1e0c0ea966b224a5c1d3b64"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sendlib_8h.html#a8a303061e1e0c0ea966b224a5c1d3b64">mutt_message_to_7bit</a> (struct <a class="el" href="structBody.html">Body</a> *a, FILE *fp, struct <a class="el" href="structConfigSubset.html">ConfigSubset</a> *sub)</td></tr>
<tr class="memdesc:a8a303061e1e0c0ea966b224a5c1d3b64"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert an email's MIME parts to 7-bit.  <a href="#a8a303061e1e0c0ea966b224a5c1d3b64">More...</a><br /></td></tr>
<tr class="separator:a8a303061e1e0c0ea966b224a5c1d3b64"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac35da3d19eb0d95d4f6260adab57b4c9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sendlib_8h.html#ac35da3d19eb0d95d4f6260adab57b4c9">mutt_prepare_envelope</a> (struct <a class="el" href="structEnvelope.html">Envelope</a> *env, bool final, struct <a class="el" href="structConfigSubset.html">ConfigSubset</a> *sub)</td></tr>
<tr class="memdesc:ac35da3d19eb0d95d4f6260adab57b4c9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prepare an email header.  <a href="#ac35da3d19eb0d95d4f6260adab57b4c9">More...</a><br /></td></tr>
<tr class="separator:ac35da3d19eb0d95d4f6260adab57b4c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ee1ea636faabfacf94efbd968b0bea9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sendlib_8h.html#a0ee1ea636faabfacf94efbd968b0bea9">mutt_stamp_attachment</a> (struct <a class="el" href="structBody.html">Body</a> *a)</td></tr>
<tr class="memdesc:a0ee1ea636faabfacf94efbd968b0bea9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Timestamp an Attachment.  <a href="#a0ee1ea636faabfacf94efbd968b0bea9">More...</a><br /></td></tr>
<tr class="separator:a0ee1ea636faabfacf94efbd968b0bea9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a99b5cff5076c9e25bce367f0bae45f4c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sendlib_8h.html#a99b5cff5076c9e25bce367f0bae45f4c">mutt_unprepare_envelope</a> (struct <a class="el" href="structEnvelope.html">Envelope</a> *env)</td></tr>
<tr class="memdesc:a99b5cff5076c9e25bce367f0bae45f4c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Undo the encodings of <a class="el" href="sendlib_8c.html#ac35da3d19eb0d95d4f6260adab57b4c9" title="Prepare an email header. ">mutt_prepare_envelope()</a>  <a href="#a99b5cff5076c9e25bce367f0bae45f4c">More...</a><br /></td></tr>
<tr class="separator:a99b5cff5076c9e25bce367f0bae45f4c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4f3b3ef1863d9821af9f82d8963e5b8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sendlib_8h.html#ae4f3b3ef1863d9821af9f82d8963e5b8">mutt_update_encoding</a> (struct <a class="el" href="structBody.html">Body</a> *a, struct <a class="el" href="structConfigSubset.html">ConfigSubset</a> *sub)</td></tr>
<tr class="memdesc:ae4f3b3ef1863d9821af9f82d8963e5b8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update the encoding type.  <a href="#ae4f3b3ef1863d9821af9f82d8963e5b8">More...</a><br /></td></tr>
<tr class="separator:ae4f3b3ef1863d9821af9f82d8963e5b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd4f22db21ca81a6a845ffe6888d141f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sendlib_8h.html#acd4f22db21ca81a6a845ffe6888d141f">mutt_write_fcc</a> (const char *path, struct <a class="el" href="structEmail.html">Email</a> *e, const char *msgid, bool post, const char *fcc, char **finalpath, struct <a class="el" href="structConfigSubset.html">ConfigSubset</a> *sub)</td></tr>
<tr class="memdesc:acd4f22db21ca81a6a845ffe6888d141f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write email to FCC mailbox.  <a href="#acd4f22db21ca81a6a845ffe6888d141f">More...</a><br /></td></tr>
<tr class="separator:acd4f22db21ca81a6a845ffe6888d141f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8957ce367f6683e839e4ddb7245d466c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sendlib_8h.html#a8957ce367f6683e839e4ddb7245d466c">mutt_write_multiple_fcc</a> (const char *path, struct <a class="el" href="structEmail.html">Email</a> *e, const char *msgid, bool post, char *fcc, char **finalpath, struct <a class="el" href="structConfigSubset.html">ConfigSubset</a> *sub)</td></tr>
<tr class="memdesc:a8957ce367f6683e839e4ddb7245d466c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handle FCC with multiple, comma separated entries.  <a href="#a8957ce367f6683e839e4ddb7245d466c">More...</a><br /></td></tr>
<tr class="separator:a8957ce367f6683e839e4ddb7245d466c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Miscellaneous functions for sending an email. </p>
<dl class="section author"><dt>Authors</dt><dd><ul>
<li>Richard Russon</li>
<li>Pietro Cerutti</li>
</ul>
</dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>This program is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 2 of the License, or (at your option) any later version.</dd></dl>
<p>This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.</p>
<p>You should have received a copy of the GNU General Public License along with this program. If not, see <a href="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</a>. </p>

<p class="definition">Definition in file <a class="el" href="sendlib_8h_source.html">sendlib.h</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a3eb2475f59b97dda306d28971399217a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3eb2475f59b97dda306d28971399217a">&#9670;&nbsp;</a></span>MUTT_RANDTAG_LEN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MUTT_RANDTAG_LEN&#160;&#160;&#160;16</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="sendlib_8h_source.html#l00035">35</a> of file <a class="el" href="sendlib_8h_source.html">sendlib.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a7848f294cb015bff75efc45e2d15494c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7848f294cb015bff75efc45e2d15494c">&#9670;&nbsp;</a></span>mutt_bounce_message()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mutt_bounce_message </td>
          <td>(</td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>fp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structMailbox.html">Mailbox</a> *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structEmail.html">Email</a> *&#160;</td>
          <td class="paramname"><em>e</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct AddressList *&#160;</td>
          <td class="paramname"><em>to</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structConfigSubset.html">ConfigSubset</a> *&#160;</td>
          <td class="paramname"><em>sub</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Bounce an email message. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fp</td><td>Handle of message </td></tr>
    <tr><td class="paramname">m</td><td><a class="el" href="structMailbox.html" title="A mailbox. ">Mailbox</a> </td></tr>
    <tr><td class="paramname">e</td><td><a class="el" href="structEmail.html" title="The envelope/body of an email. ">Email</a> </td></tr>
    <tr><td class="paramname">to</td><td>AddressList to bounce to </td></tr>
    <tr><td class="paramname">sub</td><td>Config Subset </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Success </td></tr>
    <tr><td class="paramname">-1</td><td>Failure </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="sendlib_8c_source.html#l01379">1379</a> of file <a class="el" href="sendlib_8c_source.html">sendlib.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;{</div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;  <span class="keywordflow">if</span> (!fp || !e || !to || <a class="code" href="queue_8h.html#ac3c9da7ac712eacbbad5cc54d7a3477e">TAILQ_EMPTY</a>(to))</div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;</div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *fqdn = <a class="code" href="sendlib_8c.html#a3214a4d6985ca1a64f72d21f6f8c252f">mutt_fqdn</a>(<span class="keyword">true</span>, sub);</div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;  <span class="keywordtype">char</span> resent_from[256];</div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;  <span class="keywordtype">char</span> *err = NULL;</div><div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;</div><div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;  resent_from[0] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;  <span class="keyword">struct </span><a class="code" href="structAddress.html">Address</a> *from = <a class="code" href="send_8c.html#aa93b7a6bc9e26176ebf17bf37c7d2a87">mutt_default_from</a>(sub);</div><div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;  <span class="keyword">struct </span>AddressList from_list = <a class="code" href="queue_8h.html#ac269df7d4126ed9885156cbad2cbf8af">TAILQ_HEAD_INITIALIZER</a>(from_list);</div><div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;  <a class="code" href="address_2address_8c.html#a68385b174baad74a9aecf3dec61432a0">mutt_addrlist_append</a>(&amp;from_list, from);</div><div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;</div><div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;  <span class="comment">/* mutt_default_from() does not use $real_name if the real name is not set</span></div><div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;<span class="comment">   * in $from, so we add it here.  The reason it is not added in</span></div><div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;<span class="comment">   * mutt_default_from() is that during normal sending, we execute</span></div><div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;<span class="comment">   * send-hooks and set the real_name last so that it can be changed based</span></div><div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;<span class="comment">   * upon message criteria.  */</span></div><div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;  <span class="keywordflow">if</span> (!from-&gt;<a class="code" href="structAddress.html#af4ac89f0f41e7872b4faeaedfcb709b4">personal</a>)</div><div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;  {</div><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keyword">const</span> c_real_name = <a class="code" href="helpers_8c.html#ac477c591155aa4ae0452bbabc0affffe">cs_subset_string</a>(sub, <span class="stringliteral">&quot;real_name&quot;</span>);</div><div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;    from-&gt;<a class="code" href="structAddress.html#af4ac89f0f41e7872b4faeaedfcb709b4">personal</a> = <a class="code" href="mutt_2string_8c.html#a4c2560f787bd1226b977992c16860c98">mutt_str_dup</a>(c_real_name);</div><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;  }</div><div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;</div><div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;  <a class="code" href="address_2address_8c.html#a1de5e467c74e205ff465fd601c275b88">mutt_addrlist_qualify</a>(&amp;from_list, fqdn);</div><div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;</div><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;  <a class="code" href="rfc2047_8c.html#a4f979b4ba087d3291049da868935e005">rfc2047_encode_addrlist</a>(&amp;from_list, <span class="stringliteral">&quot;Resent-From&quot;</span>);</div><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="address_2address_8c.html#abe8afdaeb5bdca19a1867823d73a1ec4">mutt_addrlist_to_intl</a>(&amp;from_list, &amp;err))</div><div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;  {</div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;    <a class="code" href="group__logging__api.html#gacc1fd6d7ab1603e80e11e84e90d061e4">mutt_error</a>(<a class="code" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Bad IDN %s while preparing resent-from&quot;</span>), err);</div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;    <a class="code" href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;err);</div><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;    <a class="code" href="address_2address_8c.html#a396bcf6adfff6663096fa6ae99c31c9a">mutt_addrlist_clear</a>(&amp;from_list);</div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;  }</div><div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;  <a class="code" href="address_2address_8c.html#a69d612ac8c7f2fc7e471561216bd1c41">mutt_addrlist_write</a>(&amp;from_list, resent_from, <span class="keyword">sizeof</span>(resent_from), <span class="keyword">false</span>);</div><div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;</div><div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;<span class="preprocessor">#ifdef USE_NNTP</span></div><div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;  <a class="code" href="options_8h.html#affdfc25e31602911d236c7d283865f1c">OptNewsSend</a> = <span class="keyword">false</span>;</div><div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;</div><div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;  <span class="comment">/* prepare recipient list. idna conversion appears to happen before this</span></div><div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;<span class="comment">   * function is called, since the user receives confirmation of the address</span></div><div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;<span class="comment">   * list being bounced to.  */</span></div><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;  <span class="keyword">struct </span>AddressList resent_to = <a class="code" href="queue_8h.html#ac269df7d4126ed9885156cbad2cbf8af">TAILQ_HEAD_INITIALIZER</a>(resent_to);</div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;  <a class="code" href="address_2address_8c.html#a16764dc80c9b3f6ad2897c8b7e59bd10">mutt_addrlist_copy</a>(&amp;resent_to, to, <span class="keyword">false</span>);</div><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;  <a class="code" href="rfc2047_8c.html#a4f979b4ba087d3291049da868935e005">rfc2047_encode_addrlist</a>(&amp;resent_to, <span class="stringliteral">&quot;Resent-To&quot;</span>);</div><div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;  <span class="keywordtype">int</span> rc = <a class="code" href="sendlib_8c.html#ae7871ca3c3ec4c32f93348ba08595dfc">bounce_message</a>(fp, m, e, &amp;resent_to, resent_from, &amp;from_list, sub);</div><div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;  <a class="code" href="address_2address_8c.html#a396bcf6adfff6663096fa6ae99c31c9a">mutt_addrlist_clear</a>(&amp;resent_to);</div><div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;  <a class="code" href="address_2address_8c.html#a396bcf6adfff6663096fa6ae99c31c9a">mutt_addrlist_clear</a>(&amp;from_list);</div><div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;</div><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;  <span class="keywordflow">return</span> rc;</div><div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;}</div><div class="ttc" id="group__logging__api_html_gacc1fd6d7ab1603e80e11e84e90d061e4"><div class="ttname"><a href="group__logging__api.html#gacc1fd6d7ab1603e80e11e84e90d061e4">mutt_error</a></div><div class="ttdeci">#define mutt_error(...)</div><div class="ttdef"><b>Definition:</b> <a href="logging_8h_source.html#l00088">logging.h:88</a></div></div>
<div class="ttc" id="address_2address_8c_html_a396bcf6adfff6663096fa6ae99c31c9a"><div class="ttname"><a href="address_2address_8c.html#a396bcf6adfff6663096fa6ae99c31c9a">mutt_addrlist_clear</a></div><div class="ttdeci">void mutt_addrlist_clear(struct AddressList *al)</div><div class="ttdoc">Unlink and free all Address in an AddressList. </div><div class="ttdef"><b>Definition:</b> <a href="address_2address_8c_source.html#l01470">address.c:1470</a></div></div>
<div class="ttc" id="address_2address_8c_html_a16764dc80c9b3f6ad2897c8b7e59bd10"><div class="ttname"><a href="address_2address_8c.html#a16764dc80c9b3f6ad2897c8b7e59bd10">mutt_addrlist_copy</a></div><div class="ttdeci">void mutt_addrlist_copy(struct AddressList *dst, const struct AddressList *src, bool prune)</div><div class="ttdoc">Copy a list of addresses into another list. </div><div class="ttdef"><b>Definition:</b> <a href="address_2address_8c_source.html#l00737">address.c:737</a></div></div>
<div class="ttc" id="mutt_2string_8c_html_a4c2560f787bd1226b977992c16860c98"><div class="ttname"><a href="mutt_2string_8c.html#a4c2560f787bd1226b977992c16860c98">mutt_str_dup</a></div><div class="ttdeci">char * mutt_str_dup(const char *str)</div><div class="ttdoc">Copy a string, safely. </div><div class="ttdef"><b>Definition:</b> <a href="mutt_2string_8c_source.html#l00370">string.c:370</a></div></div>
<div class="ttc" id="mutt_2message_8h_html_a479d658dfd60fe8d9709ec67a58b34ca"><div class="ttname"><a href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a></div><div class="ttdeci">#define _(a)</div><div class="ttdef"><b>Definition:</b> <a href="mutt_2message_8h_source.html#l00028">message.h:28</a></div></div>
<div class="ttc" id="structAddress_html"><div class="ttname"><a href="structAddress.html">Address</a></div><div class="ttdoc">An email address. </div><div class="ttdef"><b>Definition:</b> <a href="address_2address_8h_source.html#l00035">address.h:35</a></div></div>
<div class="ttc" id="rfc2047_8c_html_a4f979b4ba087d3291049da868935e005"><div class="ttname"><a href="rfc2047_8c.html#a4f979b4ba087d3291049da868935e005">rfc2047_encode_addrlist</a></div><div class="ttdeci">void rfc2047_encode_addrlist(struct AddressList *al, const char *tag)</div><div class="ttdoc">Encode any RFC2047 headers, where required, in an Address list. </div><div class="ttdef"><b>Definition:</b> <a href="rfc2047_8c_source.html#l00742">rfc2047.c:742</a></div></div>
<div class="ttc" id="sendlib_8c_html_ae7871ca3c3ec4c32f93348ba08595dfc"><div class="ttname"><a href="sendlib_8c.html#ae7871ca3c3ec4c32f93348ba08595dfc">bounce_message</a></div><div class="ttdeci">static int bounce_message(FILE *fp, struct Mailbox *m, struct Email *e, struct AddressList *to, const char *resent_from, struct AddressList *env_from, struct ConfigSubset *sub)</div><div class="ttdoc">Bounce an email message. </div><div class="ttdef"><b>Definition:</b> <a href="sendlib_8c_source.html#l01308">sendlib.c:1308</a></div></div>
<div class="ttc" id="send_8c_html_aa93b7a6bc9e26176ebf17bf37c7d2a87"><div class="ttname"><a href="send_8c.html#aa93b7a6bc9e26176ebf17bf37c7d2a87">mutt_default_from</a></div><div class="ttdeci">struct Address * mutt_default_from(struct ConfigSubset *sub)</div><div class="ttdoc">Get a default &amp;#39;from&amp;#39; Address. </div><div class="ttdef"><b>Definition:</b> <a href="send_8c_source.html#l01454">send.c:1454</a></div></div>
<div class="ttc" id="helpers_8c_html_ac477c591155aa4ae0452bbabc0affffe"><div class="ttname"><a href="helpers_8c.html#ac477c591155aa4ae0452bbabc0affffe">cs_subset_string</a></div><div class="ttdeci">const char * cs_subset_string(const struct ConfigSubset *sub, const char *name)</div><div class="ttdoc">Get a string config item by name. </div><div class="ttdef"><b>Definition:</b> <a href="helpers_8c_source.html#l00317">helpers.c:317</a></div></div>
<div class="ttc" id="structAddress_html_af4ac89f0f41e7872b4faeaedfcb709b4"><div class="ttname"><a href="structAddress.html#af4ac89f0f41e7872b4faeaedfcb709b4">Address::personal</a></div><div class="ttdeci">char * personal</div><div class="ttdoc">Real name of address. </div><div class="ttdef"><b>Definition:</b> <a href="address_2address_8h_source.html#l00037">address.h:37</a></div></div>
<div class="ttc" id="address_2address_8c_html_a1de5e467c74e205ff465fd601c275b88"><div class="ttname"><a href="address_2address_8c.html#a1de5e467c74e205ff465fd601c275b88">mutt_addrlist_qualify</a></div><div class="ttdeci">void mutt_addrlist_qualify(struct AddressList *al, const char *host)</div><div class="ttdoc">Expand local names in an Address list using a hostname. </div><div class="ttdef"><b>Definition:</b> <a href="address_2address_8c_source.html#l00650">address.c:650</a></div></div>
<div class="ttc" id="sendlib_8c_html_a3214a4d6985ca1a64f72d21f6f8c252f"><div class="ttname"><a href="sendlib_8c.html#a3214a4d6985ca1a64f72d21f6f8c252f">mutt_fqdn</a></div><div class="ttdeci">const char * mutt_fqdn(bool may_hide_host, const struct ConfigSubset *sub)</div><div class="ttdoc">Get the Fully-Qualified Domain Name. </div><div class="ttdef"><b>Definition:</b> <a href="sendlib_8c_source.html#l01187">sendlib.c:1187</a></div></div>
<div class="ttc" id="address_2address_8c_html_abe8afdaeb5bdca19a1867823d73a1ec4"><div class="ttname"><a href="address_2address_8c.html#abe8afdaeb5bdca19a1867823d73a1ec4">mutt_addrlist_to_intl</a></div><div class="ttdeci">int mutt_addrlist_to_intl(struct AddressList *al, char **err)</div><div class="ttdoc">Convert an Address list to Punycode. </div><div class="ttdef"><b>Definition:</b> <a href="address_2address_8c_source.html#l01305">address.c:1305</a></div></div>
<div class="ttc" id="memory_8h_html_a25875003b43b81a4302256caa4a13599"><div class="ttname"><a href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a></div><div class="ttdeci">#define FREE(x)</div><div class="ttdef"><b>Definition:</b> <a href="memory_8h_source.html#l00040">memory.h:40</a></div></div>
<div class="ttc" id="queue_8h_html_ac3c9da7ac712eacbbad5cc54d7a3477e"><div class="ttname"><a href="queue_8h.html#ac3c9da7ac712eacbbad5cc54d7a3477e">TAILQ_EMPTY</a></div><div class="ttdeci">#define TAILQ_EMPTY(head)</div><div class="ttdef"><b>Definition:</b> <a href="queue_8h_source.html#l00721">queue.h:721</a></div></div>
<div class="ttc" id="options_8h_html_affdfc25e31602911d236c7d283865f1c"><div class="ttname"><a href="options_8h.html#affdfc25e31602911d236c7d283865f1c">OptNewsSend</a></div><div class="ttdeci">WHERE bool OptNewsSend</div><div class="ttdoc">(pseudo) used to change behavior when posting </div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00045">options.h:45</a></div></div>
<div class="ttc" id="queue_8h_html_ac269df7d4126ed9885156cbad2cbf8af"><div class="ttname"><a href="queue_8h.html#ac269df7d4126ed9885156cbad2cbf8af">TAILQ_HEAD_INITIALIZER</a></div><div class="ttdeci">#define TAILQ_HEAD_INITIALIZER(head)</div><div class="ttdef"><b>Definition:</b> <a href="queue_8h_source.html#l00637">queue.h:637</a></div></div>
<div class="ttc" id="address_2address_8c_html_a69d612ac8c7f2fc7e471561216bd1c41"><div class="ttname"><a href="address_2address_8c.html#a69d612ac8c7f2fc7e471561216bd1c41">mutt_addrlist_write</a></div><div class="ttdeci">size_t mutt_addrlist_write(const struct AddressList *al, char *buf, size_t buflen, bool display)</div><div class="ttdoc">Write an Address to a buffer. </div><div class="ttdef"><b>Definition:</b> <a href="address_2address_8c_source.html#l01150">address.c:1150</a></div></div>
<div class="ttc" id="address_2address_8c_html_a68385b174baad74a9aecf3dec61432a0"><div class="ttname"><a href="address_2address_8c.html#a68385b174baad74a9aecf3dec61432a0">mutt_addrlist_append</a></div><div class="ttdeci">void mutt_addrlist_append(struct AddressList *al, struct Address *a)</div><div class="ttdoc">Append an Address to an AddressList. </div><div class="ttdef"><b>Definition:</b> <a href="address_2address_8c_source.html#l01490">address.c:1490</a></div></div>
</div><!-- fragment --><div id="dynsection-2" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-2-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-2-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-2-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="sendlib_8h_a7848f294cb015bff75efc45e2d15494c_cgraph.svg" width="802" height="572"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div id="dynsection-3" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-3-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-3-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-3-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="sendlib_8h_a7848f294cb015bff75efc45e2d15494c_icgraph.svg" width="387" height="88"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a3214a4d6985ca1a64f72d21f6f8c252f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3214a4d6985ca1a64f72d21f6f8c252f">&#9670;&nbsp;</a></span>mutt_fqdn()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* mutt_fqdn </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>may_hide_host</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structConfigSubset.html">ConfigSubset</a> *&#160;</td>
          <td class="paramname"><em>sub</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the Fully-Qualified Domain Name. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">may_hide_host</td><td>If true, hide the hostname (leaving just the domain) </td></tr>
    <tr><td class="paramname">sub</td><td>Config Subset </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">ptr</td><td>string pointer into Hostname </td></tr>
    <tr><td class="paramname">NULL</td><td>Error, e.g no Hostname</td></tr>
  </table>
  </dd>
</dl>
<dl class="section warning"><dt>Warning</dt><dd>Do not free the returned pointer </dd></dl>

<p class="definition">Definition at line <a class="el" href="sendlib_8c_source.html#l01187">1187</a> of file <a class="el" href="sendlib_8c_source.html">sendlib.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;{</div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keyword">const</span> c_hostname = <a class="code" href="helpers_8c.html#ac477c591155aa4ae0452bbabc0affffe">cs_subset_string</a>(sub, <span class="stringliteral">&quot;hostname&quot;</span>);</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;  <span class="keywordflow">if</span> (!c_hostname || (c_hostname[0] == <span class="charliteral">&#39;@&#39;</span>))</div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;    <span class="keywordflow">return</span> NULL;</div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;</div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *p = c_hostname;</div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;</div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> c_hidden_host = <a class="code" href="helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(sub, <span class="stringliteral">&quot;hidden_host&quot;</span>);</div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;  <span class="keywordflow">if</span> (may_hide_host &amp;&amp; c_hidden_host)</div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;  {</div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;    p = strchr(c_hostname, <span class="charliteral">&#39;.&#39;</span>);</div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;    <span class="keywordflow">if</span> (p)</div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;      p++;</div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;</div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;    <span class="comment">// sanity check: don&#39;t hide the host if the fqdn is something like example.com</span></div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;    <span class="keywordflow">if</span> (!p || !strchr(p, <span class="charliteral">&#39;.&#39;</span>))</div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;      p = c_hostname;</div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;  }</div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;</div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;  <span class="keywordflow">return</span> p;</div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;}</div><div class="ttc" id="helpers_8c_html_ae50f679dd6c5bd1ba820884c8602f038"><div class="ttname"><a href="helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a></div><div class="ttdeci">bool cs_subset_bool(const struct ConfigSubset *sub, const char *name)</div><div class="ttdoc">Get a boolean config item by name. </div><div class="ttdef"><b>Definition:</b> <a href="helpers_8c_source.html#l00073">helpers.c:73</a></div></div>
<div class="ttc" id="helpers_8c_html_ac477c591155aa4ae0452bbabc0affffe"><div class="ttname"><a href="helpers_8c.html#ac477c591155aa4ae0452bbabc0affffe">cs_subset_string</a></div><div class="ttdeci">const char * cs_subset_string(const struct ConfigSubset *sub, const char *name)</div><div class="ttdoc">Get a string config item by name. </div><div class="ttdef"><b>Definition:</b> <a href="helpers_8c_source.html#l00317">helpers.c:317</a></div></div>
</div><!-- fragment --><div id="dynsection-4" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-4-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-4-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-4-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="sendlib_8h_a3214a4d6985ca1a64f72d21f6f8c252f_cgraph.svg" width="279" height="88"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div id="dynsection-5" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-5-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-5-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-5-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="sendlib_8h_a3214a4d6985ca1a64f72d21f6f8c252f_icgraph.svg" width="528" height="494"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a8621a45f0aa4aea9e2613207be4fa717"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8621a45f0aa4aea9e2613207be4fa717">&#9670;&nbsp;</a></span>mutt_get_content_info()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structContent.html">Content</a>* mutt_get_content_info </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>fname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structBody.html">Body</a> *&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structConfigSubset.html">ConfigSubset</a> *&#160;</td>
          <td class="paramname"><em>sub</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Analyze file to determine MIME encoding to use. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fname</td><td>File to examine </td></tr>
    <tr><td class="paramname">b</td><td><a class="el" href="structBody.html" title="The body of an email. ">Body</a> to update </td></tr>
    <tr><td class="paramname">sub</td><td>Config Subset </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">ptr</td><td>Newly allocated <a class="el" href="structContent.html" title="Info about an attachment. ">Content</a></td></tr>
  </table>
  </dd>
</dl>
<p>Also set the body charset, sometimes, or not. </p>

<p class="definition">Definition at line <a class="el" href="sendlib_8c_source.html#l00465">465</a> of file <a class="el" href="sendlib_8c_source.html">sendlib.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;{</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;  <span class="keyword">struct </span><a class="code" href="structContent.html">Content</a> *info = NULL;</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;  <span class="keyword">struct </span><a class="code" href="structContentState.html">ContentState</a> state = { 0 };</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;  FILE *fp = NULL;</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;  <span class="keywordtype">char</span> *fromcode = NULL;</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;  <span class="keywordtype">char</span> *tocode = NULL;</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;  <span class="keywordtype">char</span> buf[100];</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;  <span class="keywordtype">size_t</span> r;</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;  <span class="keyword">struct </span>stat sb;</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;  <span class="keywordflow">if</span> (b &amp;&amp; !fname)</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    fname = b-&gt;<a class="code" href="structBody.html#afe3cd2c4b1070e3d0edbf1fed939ac5a">filename</a>;</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;  <span class="keywordflow">if</span> (!fname)</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <span class="keywordflow">return</span> NULL;</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;  <span class="keywordflow">if</span> (stat(fname, &amp;sb) == -1)</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;  {</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    <a class="code" href="group__logging__api.html#gacc1fd6d7ab1603e80e11e84e90d061e4">mutt_error</a>(<a class="code" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Can&#39;t stat %s: %s&quot;</span>), fname, strerror(errno));</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    <span class="keywordflow">return</span> NULL;</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;  }</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;  <span class="keywordflow">if</span> (!S_ISREG(sb.st_mode))</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;  {</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    <a class="code" href="group__logging__api.html#gacc1fd6d7ab1603e80e11e84e90d061e4">mutt_error</a>(<a class="code" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;%s isn&#39;t a regular file&quot;</span>), fname);</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <span class="keywordflow">return</span> NULL;</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;  }</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;  fp = fopen(fname, <span class="stringliteral">&quot;r&quot;</span>);</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;  <span class="keywordflow">if</span> (!fp)</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;  {</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    <a class="code" href="group__logging__api.html#gae6c5fd73af3410b2d5e8099f8774c8da">mutt_debug</a>(<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab2c99902c587a013b358149516cceeb5">LL_DEBUG1</a>, <span class="stringliteral">&quot;%s: %s (errno %d)\n&quot;</span>, fname, strerror(errno), errno);</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    <span class="keywordflow">return</span> NULL;</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;  }</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;  info = <a class="code" href="memory_8c.html#a4c1612d209c7825d55e6a014df352f03">mutt_mem_calloc</a>(1, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structContent.html">Content</a>));</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keyword">const</span> c_charset = <a class="code" href="helpers_8c.html#ac477c591155aa4ae0452bbabc0affffe">cs_subset_string</a>(sub, <span class="stringliteral">&quot;charset&quot;</span>);</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;  <span class="keywordflow">if</span> (b &amp;&amp; (b-&gt;<a class="code" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a> == <a class="code" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79ad88e88afaec507209421bba20aeeb167">TYPE_TEXT</a>) &amp;&amp; (!b-&gt;<a class="code" href="structBody.html#a2f795dc4337b500fbf2ae6682dc5360b">noconv</a> &amp;&amp; !b-&gt;<a class="code" href="structBody.html#ac64b7e1868a8d7115b9067e34c8e7aa8">force_charset</a>))</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;  {</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keyword">const</span> c_attach_charset =</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;        <a class="code" href="helpers_8c.html#ac477c591155aa4ae0452bbabc0affffe">cs_subset_string</a>(sub, <span class="stringliteral">&quot;attach_charset&quot;</span>);</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keyword">const</span> c_send_charset = <a class="code" href="helpers_8c.html#ac477c591155aa4ae0452bbabc0affffe">cs_subset_string</a>(sub, <span class="stringliteral">&quot;send_charset&quot;</span>);</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    <span class="keywordtype">char</span> *<a class="code" href="gnupgparse_8c.html#a1c5900af8271e75f8e5fb45dc2fa84bb">chs</a> = <a class="code" href="parameter_8c.html#a0c6d54a87e015a496c8dbecfcd4002c9">mutt_param_get</a>(&amp;b-&gt;<a class="code" href="structBody.html#a782cee95e0064e3895b88248bdfc781a">parameter</a>, <span class="stringliteral">&quot;charset&quot;</span>);</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *fchs =</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;        b-&gt;<a class="code" href="structBody.html#a86721d1d557276cbc9cf69777af8c305">use_disp</a> ? (c_attach_charset ? c_attach_charset : c_charset) : c_charset;</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    <span class="keywordflow">if</span> (c_charset &amp;&amp; (chs || c_send_charset) &amp;&amp;</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;        (<a class="code" href="sendlib_8c.html#a785759e368e9558d74a8d99292967dfd">convert_file_from_to</a>(fp, fchs, chs ? chs : c_send_charset, &amp;fromcode,</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;                              &amp;tocode, info) != (size_t) (-1)))</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    {</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;      <span class="keywordflow">if</span> (!chs)</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;      {</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;        <span class="keywordtype">char</span> chsbuf[256];</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;        <a class="code" href="mutt_2charset_8c.html#a4b347dd75af05a18dbe328c354c18fe8">mutt_ch_canonical_charset</a>(chsbuf, <span class="keyword">sizeof</span>(chsbuf), tocode);</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;        <a class="code" href="parameter_8c.html#a42249fc15b1e52df046a0a10de29da44">mutt_param_set</a>(&amp;b-&gt;<a class="code" href="structBody.html#a782cee95e0064e3895b88248bdfc781a">parameter</a>, <span class="stringliteral">&quot;charset&quot;</span>, chsbuf);</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;      }</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;      <a class="code" href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;b-&gt;<a class="code" href="structBody.html#a70436d272fe1e795057f48a508db3397">charset</a>);</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;      b-&gt;<a class="code" href="structBody.html#a70436d272fe1e795057f48a508db3397">charset</a> = fromcode;</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;      <a class="code" href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;tocode);</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;      <a class="code" href="file_8c.html#a31f49795ff5b9558db5476e5777e63b6">mutt_file_fclose</a>(&amp;fp);</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;      <span class="keywordflow">return</span> info;</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    }</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;  }</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;  rewind(fp);</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;  <span class="keywordflow">while</span> ((r = fread(buf, 1, <span class="keyword">sizeof</span>(buf), fp)))</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    <a class="code" href="sendlib_8c.html#ac3e92e1179befa263745dcfa128bc8a6">update_content_info</a>(info, &amp;state, buf, r);</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;  <a class="code" href="sendlib_8c.html#ac3e92e1179befa263745dcfa128bc8a6">update_content_info</a>(info, &amp;state, 0, 0);</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;  <a class="code" href="file_8c.html#a31f49795ff5b9558db5476e5777e63b6">mutt_file_fclose</a>(&amp;fp);</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;  <span class="keywordflow">if</span> (b &amp;&amp; (b-&gt;<a class="code" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a> == <a class="code" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79ad88e88afaec507209421bba20aeeb167">TYPE_TEXT</a>) &amp;&amp; (!b-&gt;<a class="code" href="structBody.html#a2f795dc4337b500fbf2ae6682dc5360b">noconv</a> &amp;&amp; !b-&gt;<a class="code" href="structBody.html#ac64b7e1868a8d7115b9067e34c8e7aa8">force_charset</a>))</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;  {</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    <a class="code" href="parameter_8c.html#a42249fc15b1e52df046a0a10de29da44">mutt_param_set</a>(&amp;b-&gt;<a class="code" href="structBody.html#a782cee95e0064e3895b88248bdfc781a">parameter</a>, <span class="stringliteral">&quot;charset&quot;</span>,</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;                   (!info-&gt;<a class="code" href="structContent.html#a462631638a7f0de6f461df75fcd43b63">hibin</a> ? <span class="stringliteral">&quot;us-ascii&quot;</span> :</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;                    c_charset &amp;&amp; !<a class="code" href="mutt_2charset_8h.html#a3ef43eece2b49fd708887669f556a15b">mutt_ch_is_us_ascii</a>(c_charset) ?</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;                                   c_charset :</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;                                   <span class="stringliteral">&quot;unknown-8bit&quot;</span>));</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;  }</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;  <span class="keywordflow">return</span> info;</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;}</div><div class="ttc" id="structContentState_html"><div class="ttname"><a href="structContentState.html">ContentState</a></div><div class="ttdoc">Info about the body of an email. </div><div class="ttdef"><b>Definition:</b> <a href="sendlib_8c_source.html#l00063">sendlib.c:63</a></div></div>
<div class="ttc" id="sendlib_8c_html_ac3e92e1179befa263745dcfa128bc8a6"><div class="ttname"><a href="sendlib_8c.html#ac3e92e1179befa263745dcfa128bc8a6">update_content_info</a></div><div class="ttdeci">static void update_content_info(struct Content *info, struct ContentState *s, char *buf, size_t buflen)</div><div class="ttdoc">Cache some info about an email. </div><div class="ttdef"><b>Definition:</b> <a href="sendlib_8c_source.html#l00079">sendlib.c:79</a></div></div>
<div class="ttc" id="structBody_html_afe3cd2c4b1070e3d0edbf1fed939ac5a"><div class="ttname"><a href="structBody.html#afe3cd2c4b1070e3d0edbf1fed939ac5a">Body::filename</a></div><div class="ttdeci">char * filename</div><div class="ttdoc">when sending a message, this is the file to which this structure refers </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00046">body.h:46</a></div></div>
<div class="ttc" id="memory_8c_html_a4c1612d209c7825d55e6a014df352f03"><div class="ttname"><a href="memory_8c.html#a4c1612d209c7825d55e6a014df352f03">mutt_mem_calloc</a></div><div class="ttdeci">void * mutt_mem_calloc(size_t nmemb, size_t size)</div><div class="ttdoc">Allocate zeroed memory on the heap. </div><div class="ttdef"><b>Definition:</b> <a href="memory_8c_source.html#l00050">memory.c:50</a></div></div>
<div class="ttc" id="group__logging__api_html_gacc1fd6d7ab1603e80e11e84e90d061e4"><div class="ttname"><a href="group__logging__api.html#gacc1fd6d7ab1603e80e11e84e90d061e4">mutt_error</a></div><div class="ttdeci">#define mutt_error(...)</div><div class="ttdef"><b>Definition:</b> <a href="logging_8h_source.html#l00088">logging.h:88</a></div></div>
<div class="ttc" id="structBody_html_a2f795dc4337b500fbf2ae6682dc5360b"><div class="ttname"><a href="structBody.html#a2f795dc4337b500fbf2ae6682dc5360b">Body::noconv</a></div><div class="ttdeci">bool noconv</div><div class="ttdoc">Don&amp;#39;t do character set conversion. </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00073">body.h:73</a></div></div>
<div class="ttc" id="mutt_2message_8h_html_a479d658dfd60fe8d9709ec67a58b34ca"><div class="ttname"><a href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a></div><div class="ttdeci">#define _(a)</div><div class="ttdef"><b>Definition:</b> <a href="mutt_2message_8h_source.html#l00028">message.h:28</a></div></div>
<div class="ttc" id="structContent_html_a462631638a7f0de6f461df75fcd43b63"><div class="ttname"><a href="structContent.html#a462631638a7f0de6f461df75fcd43b63">Content::hibin</a></div><div class="ttdeci">long hibin</div><div class="ttdoc">8-bit characters </div><div class="ttdef"><b>Definition:</b> <a href="content_8h_source.html#l00035">content.h:35</a></div></div>
<div class="ttc" id="file_8c_html_a31f49795ff5b9558db5476e5777e63b6"><div class="ttname"><a href="file_8c.html#a31f49795ff5b9558db5476e5777e63b6">mutt_file_fclose</a></div><div class="ttdeci">int mutt_file_fclose(FILE **fp)</div><div class="ttdoc">Close a FILE handle (and NULL the pointer) </div><div class="ttdef"><b>Definition:</b> <a href="file_8c_source.html#l00153">file.c:153</a></div></div>
<div class="ttc" id="structBody_html_ac64b7e1868a8d7115b9067e34c8e7aa8"><div class="ttname"><a href="structBody.html#ac64b7e1868a8d7115b9067e34c8e7aa8">Body::force_charset</a></div><div class="ttdeci">bool force_charset</div><div class="ttdoc">Send mode: don&amp;#39;t adjust the character set when in send-mode. </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00075">body.h:75</a></div></div>
<div class="ttc" id="gnupgparse_8c_html_a1c5900af8271e75f8e5fb45dc2fa84bb"><div class="ttname"><a href="gnupgparse_8c.html#a1c5900af8271e75f8e5fb45dc2fa84bb">chs</a></div><div class="ttdeci">static char * chs</div><div class="ttdef"><b>Definition:</b> <a href="gnupgparse_8c_source.html#l00073">gnupgparse.c:73</a></div></div>
<div class="ttc" id="structContent_html"><div class="ttname"><a href="structContent.html">Content</a></div><div class="ttdoc">Info about an attachment. </div><div class="ttdef"><b>Definition:</b> <a href="content_8h_source.html#l00033">content.h:33</a></div></div>
<div class="ttc" id="mime_8h_html_a3ccd048df649c335df5a7f82673bbc79ad88e88afaec507209421bba20aeeb167"><div class="ttname"><a href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79ad88e88afaec507209421bba20aeeb167">TYPE_TEXT</a></div><div class="ttdoc">Type: &amp;#39;text/*&amp;#39;. </div><div class="ttdef"><b>Definition:</b> <a href="mime_8h_source.html#l00038">mime.h:38</a></div></div>
<div class="ttc" id="structBody_html_a70436d272fe1e795057f48a508db3397"><div class="ttname"><a href="structBody.html#a70436d272fe1e795057f48a508db3397">Body::charset</a></div><div class="ttdeci">char * charset</div><div class="ttdoc">Send mode: charset of attached file as stored on disk. </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00049">body.h:49</a></div></div>
<div class="ttc" id="helpers_8c_html_ac477c591155aa4ae0452bbabc0affffe"><div class="ttname"><a href="helpers_8c.html#ac477c591155aa4ae0452bbabc0affffe">cs_subset_string</a></div><div class="ttdeci">const char * cs_subset_string(const struct ConfigSubset *sub, const char *name)</div><div class="ttdoc">Get a string config item by name. </div><div class="ttdef"><b>Definition:</b> <a href="helpers_8c_source.html#l00317">helpers.c:317</a></div></div>
<div class="ttc" id="group__logging__api_html_gae6c5fd73af3410b2d5e8099f8774c8da"><div class="ttname"><a href="group__logging__api.html#gae6c5fd73af3410b2d5e8099f8774c8da">mutt_debug</a></div><div class="ttdeci">#define mutt_debug(LEVEL,...)</div><div class="ttdef"><b>Definition:</b> <a href="logging_8h_source.html#l00085">logging.h:85</a></div></div>
<div class="ttc" id="structBody_html_af77d79aadb278bef8f2829c268f2486f"><div class="ttname"><a href="structBody.html#af77d79aadb278bef8f2829c268f2486f">Body::type</a></div><div class="ttdeci">unsigned int type</div><div class="ttdoc">content-type primary type, ContentType </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00065">body.h:65</a></div></div>
<div class="ttc" id="mutt_2charset_8h_html_a3ef43eece2b49fd708887669f556a15b"><div class="ttname"><a href="mutt_2charset_8h.html#a3ef43eece2b49fd708887669f556a15b">mutt_ch_is_us_ascii</a></div><div class="ttdeci">#define mutt_ch_is_us_ascii(str)</div><div class="ttdef"><b>Definition:</b> <a href="mutt_2charset_8h_source.html#l00096">charset.h:96</a></div></div>
<div class="ttc" id="logging_8h_html_aca1fd1d8935433e6ba2e3918214e07f9ab2c99902c587a013b358149516cceeb5"><div class="ttname"><a href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab2c99902c587a013b358149516cceeb5">LL_DEBUG1</a></div><div class="ttdoc">Log at debug level 1. </div><div class="ttdef"><b>Definition:</b> <a href="logging_8h_source.html#l00040">logging.h:40</a></div></div>
<div class="ttc" id="structBody_html_a86721d1d557276cbc9cf69777af8c305"><div class="ttname"><a href="structBody.html#a86721d1d557276cbc9cf69777af8c305">Body::use_disp</a></div><div class="ttdeci">bool use_disp</div><div class="ttdoc">Content-Disposition uses filename= ? </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00068">body.h:68</a></div></div>
<div class="ttc" id="memory_8h_html_a25875003b43b81a4302256caa4a13599"><div class="ttname"><a href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a></div><div class="ttdeci">#define FREE(x)</div><div class="ttdef"><b>Definition:</b> <a href="memory_8h_source.html#l00040">memory.h:40</a></div></div>
<div class="ttc" id="parameter_8c_html_a0c6d54a87e015a496c8dbecfcd4002c9"><div class="ttname"><a href="parameter_8c.html#a0c6d54a87e015a496c8dbecfcd4002c9">mutt_param_get</a></div><div class="ttdeci">char * mutt_param_get(const struct ParameterList *pl, const char *s)</div><div class="ttdoc">Find a matching Parameter. </div><div class="ttdef"><b>Definition:</b> <a href="parameter_8c_source.html#l00084">parameter.c:84</a></div></div>
<div class="ttc" id="structBody_html_a782cee95e0064e3895b88248bdfc781a"><div class="ttname"><a href="structBody.html#a782cee95e0064e3895b88248bdfc781a">Body::parameter</a></div><div class="ttdeci">struct ParameterList parameter</div><div class="ttdoc">parameters of the content-type </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00039">body.h:39</a></div></div>
<div class="ttc" id="mutt_2charset_8c_html_a4b347dd75af05a18dbe328c354c18fe8"><div class="ttname"><a href="mutt_2charset_8c.html#a4b347dd75af05a18dbe328c354c18fe8">mutt_ch_canonical_charset</a></div><div class="ttdeci">void mutt_ch_canonical_charset(char *buf, size_t buflen, const char *name)</div><div class="ttdoc">Canonicalise the charset of a string. </div><div class="ttdef"><b>Definition:</b> <a href="mutt_2charset_8c_source.html#l00354">charset.c:354</a></div></div>
<div class="ttc" id="parameter_8c_html_a42249fc15b1e52df046a0a10de29da44"><div class="ttname"><a href="parameter_8c.html#a42249fc15b1e52df046a0a10de29da44">mutt_param_set</a></div><div class="ttdeci">void mutt_param_set(struct ParameterList *pl, const char *attribute, const char *value)</div><div class="ttdoc">Set a Parameter. </div><div class="ttdef"><b>Definition:</b> <a href="parameter_8c_source.html#l00110">parameter.c:110</a></div></div>
<div class="ttc" id="sendlib_8c_html_a785759e368e9558d74a8d99292967dfd"><div class="ttname"><a href="sendlib_8c.html#a785759e368e9558d74a8d99292967dfd">convert_file_from_to</a></div><div class="ttdeci">static size_t convert_file_from_to(FILE *fp, const char *fromcodes, const char *tocodes, char **fromcode, char **tocode, struct Content *info)</div><div class="ttdoc">Convert a file between encodings. </div><div class="ttdef"><b>Definition:</b> <a href="sendlib_8c_source.html#l00379">sendlib.c:379</a></div></div>
</div><!-- fragment --><div id="dynsection-6" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-6-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-6-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-6-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="sendlib_8h_a8621a45f0aa4aea9e2613207be4fa717_cgraph.svg" width="427" height="392"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div id="dynsection-7" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-7-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-7-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-7-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="sendlib_8h_a8621a45f0aa4aea9e2613207be4fa717_icgraph.svg" width="619" height="114"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a1431e9401865165dfef92315f3ca7ae2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1431e9401865165dfef92315f3ca7ae2">&#9670;&nbsp;</a></span>mutt_lookup_mime_type()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79">ContentType</a> mutt_lookup_mime_type </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structBody.html">Body</a> *&#160;</td>
          <td class="paramname"><em>att</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>path</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Find the MIME type for an attachment. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">att</td><td><a class="el" href="structEmail.html" title="The envelope/body of an email. ">Email</a> with attachment </td></tr>
    <tr><td class="paramname">path</td><td>Path to attachment </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">num</td><td>MIME type, e.g. <a class="el" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79a1c84f9cd2b0d05b7d3f7711fcc0caad8" title="Type: &#39;image/*&#39;. ">TYPE_IMAGE</a></td></tr>
  </table>
  </dd>
</dl>
<p>Given a file at 'path', see if there is a registered MIME type. Returns the major MIME type, and copies the subtype to "d". First look in a system mime.types if we can find one, then look for ~/.mime.types. The longest match is used so that we can match 'ps.gz' when 'gz' also exists. </p>

<p class="definition">Definition at line <a class="el" href="sendlib_8c_source.html#l00564">564</a> of file <a class="el" href="sendlib_8c_source.html">sendlib.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;{</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;  FILE *fp = NULL;</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;  <span class="keywordtype">char</span> *p = NULL, *q = NULL, *ct = NULL;</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;  <span class="keywordtype">char</span> buf[<a class="code" href="mutt_8h.html#ae688d728e1acdfe5988c7db45d6f0166">PATH_MAX</a>];</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;  <span class="keywordtype">char</span> subtype[256] = { 0 };</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;  <span class="keywordtype">char</span> xtype[256] = { 0 };</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;  <span class="keywordtype">int</span> sze, cur_sze = 0;</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;  <span class="keywordtype">bool</span> found_mimetypes = <span class="keyword">false</span>;</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;  <span class="keyword">enum</span> <a class="code" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79">ContentType</a> type = <a class="code" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79a2c4c96a2b998731adad0506fabeb9c17">TYPE_OTHER</a>;</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;  <span class="keywordtype">int</span> szf = <a class="code" href="mutt_2string_8c.html#acca6786b903b22a5924219f9db96e10d">mutt_str_len</a>(path);</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> count = 0; count &lt; 4; count++)</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;  {</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    <span class="comment">/* can&#39;t use strtok() because we use it in an inner loop below, so use</span></div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;<span class="comment">     * a switch statement here instead.  */</span></div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    <span class="keywordflow">switch</span> (count)</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    {</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;      <span class="comment">/* last file with last entry to match wins type/xtype */</span></div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;      <span class="keywordflow">case</span> 0:</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;        <span class="comment">/* check default unix mimetypes location first */</span></div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;        <a class="code" href="mutt_2string_8c.html#ad20e00309de897a1e882fc7400335b83">mutt_str_copy</a>(buf, <span class="stringliteral">&quot;/etc/mime.types&quot;</span>, <span class="keyword">sizeof</span>(buf));</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;      <span class="keywordflow">case</span> 1:</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;        <a class="code" href="mutt_2string_8c.html#ad20e00309de897a1e882fc7400335b83">mutt_str_copy</a>(buf, SYSCONFDIR <span class="stringliteral">&quot;/mime.types&quot;</span>, <span class="keyword">sizeof</span>(buf));</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;      <span class="keywordflow">case</span> 2:</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;        <a class="code" href="mutt_2string_8c.html#ad20e00309de897a1e882fc7400335b83">mutt_str_copy</a>(buf, PKGDATADIR <span class="stringliteral">&quot;/mime.types&quot;</span>, <span class="keyword">sizeof</span>(buf));</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;      <span class="keywordflow">case</span> 3:</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;        snprintf(buf, <span class="keyword">sizeof</span>(buf), <span class="stringliteral">&quot;%s/.mime.types&quot;</span>, <a class="code" href="string2_8h.html#a7e0481bed27661ea2679f256b24e0283">NONULL</a>(<a class="code" href="config_2path_8c.html#a6f7b1cf93328b961c3e3a64f300d75b0">HomeDir</a>));</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;      <span class="keywordflow">default</span>:</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;        <a class="code" href="group__logging__api.html#gae6c5fd73af3410b2d5e8099f8774c8da">mutt_debug</a>(<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab2c99902c587a013b358149516cceeb5">LL_DEBUG1</a>, <span class="stringliteral">&quot;Internal error, count = %d\n&quot;</span>, count);</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;        <span class="keywordflow">goto</span> bye; <span class="comment">/* shouldn&#39;t happen */</span></div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    }</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    fp = fopen(buf, <span class="stringliteral">&quot;r&quot;</span>);</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    <span class="keywordflow">if</span> (fp)</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;    {</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;      found_mimetypes = <span class="keyword">true</span>;</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;      <span class="keywordflow">while</span> (fgets(buf, <span class="keyword">sizeof</span>(buf) - 1, fp))</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;      {</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;        <span class="comment">/* weed out any comments */</span></div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;        p = strchr(buf, <span class="charliteral">&#39;#&#39;</span>);</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;        <span class="keywordflow">if</span> (p)</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;          *p = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;        <span class="comment">/* remove any leading space. */</span></div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;        ct = buf;</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;        <a class="code" href="string2_8h.html#aebd4477213a7b706515efaffdec64181">SKIPWS</a>(ct);</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;        <span class="comment">/* position on the next field in this line */</span></div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;        p = strpbrk(ct, <span class="stringliteral">&quot; \t&quot;</span>);</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;        <span class="keywordflow">if</span> (!p)</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;          <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;        *p++ = 0;</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;        <a class="code" href="string2_8h.html#aebd4477213a7b706515efaffdec64181">SKIPWS</a>(p);</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;        <span class="comment">/* cycle through the file extensions */</span></div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;        <span class="keywordflow">while</span> ((p = strtok(p, <span class="stringliteral">&quot; \t\n&quot;</span>)))</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;        {</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;          sze = <a class="code" href="mutt_2string_8c.html#acca6786b903b22a5924219f9db96e10d">mutt_str_len</a>(p);</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;          <span class="keywordflow">if</span> ((sze &gt; cur_sze) &amp;&amp; (szf &gt;= sze) &amp;&amp; <a class="code" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(path + szf - sze, p) &amp;&amp;</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;              ((szf == sze) || (path[szf - sze - 1] == <span class="charliteral">&#39;.&#39;</span>)))</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;          {</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;            <span class="comment">/* get the content-type */</span></div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;            p = strchr(ct, <span class="charliteral">&#39;/&#39;</span>);</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;            <span class="keywordflow">if</span> (!p)</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;            {</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;              <span class="comment">/* malformed line, just skip it. */</span></div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;              <span class="keywordflow">break</span>;</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;            }</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;            *p++ = 0;</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;            <span class="keywordflow">for</span> (q = p; *q &amp;&amp; !<a class="code" href="string2_8h.html#acf2117a80b76adbb0ad9019e63adce1f">IS_SPACE</a>(*q); q++)</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;              ; <span class="comment">// do nothing</span></div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;            <a class="code" href="mutt_2string_8c.html#a6e11bedb38e3937aa71b55ca24cfd274">mutt_strn_copy</a>(subtype, p, q - p, <span class="keyword">sizeof</span>(subtype));</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;            type = <a class="code" href="parse_8c.html#a6c22ec026399e230ecedab86f831a754">mutt_check_mime_type</a>(ct);</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;            <span class="keywordflow">if</span> (type == <a class="code" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79a2c4c96a2b998731adad0506fabeb9c17">TYPE_OTHER</a>)</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;              <a class="code" href="mutt_2string_8c.html#ad20e00309de897a1e882fc7400335b83">mutt_str_copy</a>(xtype, ct, <span class="keyword">sizeof</span>(xtype));</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;            cur_sze = sze;</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;          }</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;          p = NULL;</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;        }</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;      }</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;      <a class="code" href="file_8c.html#a31f49795ff5b9558db5476e5777e63b6">mutt_file_fclose</a>(&amp;fp);</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;    }</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;  }</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;bye:</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;  <span class="comment">/* no mime.types file found */</span></div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;  <span class="keywordflow">if</span> (!found_mimetypes)</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;  {</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    <a class="code" href="group__logging__api.html#gacc1fd6d7ab1603e80e11e84e90d061e4">mutt_error</a>(<a class="code" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Could not find any mime.types file&quot;</span>));</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;  }</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;  <span class="keywordflow">if</span> ((type != <a class="code" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79a2c4c96a2b998731adad0506fabeb9c17">TYPE_OTHER</a>) || (*xtype != <span class="charliteral">&#39;\0&#39;</span>))</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;  {</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;    att-&gt;<a class="code" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a> = type;</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    <a class="code" href="mutt_2string_8c.html#ae9b6bbaa52b6ce51f2a384fe500e028e">mutt_str_replace</a>(&amp;att-&gt;<a class="code" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>, subtype);</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;    <a class="code" href="mutt_2string_8c.html#ae9b6bbaa52b6ce51f2a384fe500e028e">mutt_str_replace</a>(&amp;att-&gt;<a class="code" href="structBody.html#a25c15115b34c11620fc995c13383fd9b">xtype</a>, xtype);</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;  }</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;  <span class="keywordflow">return</span> type;</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;}</div><div class="ttc" id="mime_8h_html_a3ccd048df649c335df5a7f82673bbc79a2c4c96a2b998731adad0506fabeb9c17"><div class="ttname"><a href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79a2c4c96a2b998731adad0506fabeb9c17">TYPE_OTHER</a></div><div class="ttdoc">Unknown Content-Type. </div><div class="ttdef"><b>Definition:</b> <a href="mime_8h_source.html#l00031">mime.h:31</a></div></div>
<div class="ttc" id="string2_8h_html_a7e0481bed27661ea2679f256b24e0283"><div class="ttname"><a href="string2_8h.html#a7e0481bed27661ea2679f256b24e0283">NONULL</a></div><div class="ttdeci">#define NONULL(x)</div><div class="ttdef"><b>Definition:</b> <a href="string2_8h_source.html#l00037">string2.h:37</a></div></div>
<div class="ttc" id="group__logging__api_html_gacc1fd6d7ab1603e80e11e84e90d061e4"><div class="ttname"><a href="group__logging__api.html#gacc1fd6d7ab1603e80e11e84e90d061e4">mutt_error</a></div><div class="ttdeci">#define mutt_error(...)</div><div class="ttdef"><b>Definition:</b> <a href="logging_8h_source.html#l00088">logging.h:88</a></div></div>
<div class="ttc" id="mutt_2message_8h_html_a479d658dfd60fe8d9709ec67a58b34ca"><div class="ttname"><a href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a></div><div class="ttdeci">#define _(a)</div><div class="ttdef"><b>Definition:</b> <a href="mutt_2message_8h_source.html#l00028">message.h:28</a></div></div>
<div class="ttc" id="config_2path_8c_html_a6f7b1cf93328b961c3e3a64f300d75b0"><div class="ttname"><a href="config_2path_8c.html#a6f7b1cf93328b961c3e3a64f300d75b0">HomeDir</a></div><div class="ttdeci">char * HomeDir</div><div class="ttdoc">User&amp;#39;s home directory. </div><div class="ttdef"><b>Definition:</b> <a href="mutt__globals_8h_source.html#l00045">mutt_globals.h:45</a></div></div>
<div class="ttc" id="parse_8c_html_a6c22ec026399e230ecedab86f831a754"><div class="ttname"><a href="parse_8c.html#a6c22ec026399e230ecedab86f831a754">mutt_check_mime_type</a></div><div class="ttdeci">enum ContentType mutt_check_mime_type(const char *s)</div><div class="ttdoc">Check a MIME type string. </div><div class="ttdef"><b>Definition:</b> <a href="parse_8c_source.html#l00326">parse.c:326</a></div></div>
<div class="ttc" id="file_8c_html_a31f49795ff5b9558db5476e5777e63b6"><div class="ttname"><a href="file_8c.html#a31f49795ff5b9558db5476e5777e63b6">mutt_file_fclose</a></div><div class="ttdeci">int mutt_file_fclose(FILE **fp)</div><div class="ttdoc">Close a FILE handle (and NULL the pointer) </div><div class="ttdef"><b>Definition:</b> <a href="file_8c_source.html#l00153">file.c:153</a></div></div>
<div class="ttc" id="string2_8h_html_aebd4477213a7b706515efaffdec64181"><div class="ttname"><a href="string2_8h.html#aebd4477213a7b706515efaffdec64181">SKIPWS</a></div><div class="ttdeci">#define SKIPWS(ch)</div><div class="ttdef"><b>Definition:</b> <a href="string2_8h_source.html#l00046">string2.h:46</a></div></div>
<div class="ttc" id="mutt_2string_8c_html_a6e11bedb38e3937aa71b55ca24cfd274"><div class="ttname"><a href="mutt_2string_8c.html#a6e11bedb38e3937aa71b55ca24cfd274">mutt_strn_copy</a></div><div class="ttdeci">char * mutt_strn_copy(char *dest, const char *src, size_t len, size_t dsize)</div><div class="ttdoc">Copy a sub-string into a buffer. </div><div class="ttdef"><b>Definition:</b> <a href="mutt_2string_8c_source.html#l00528">string.c:528</a></div></div>
<div class="ttc" id="mutt_2string_8c_html_a29db81d6f5a7dd216cbea75ecf8a5885"><div class="ttname"><a href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a></div><div class="ttdeci">bool mutt_istr_equal(const char *a, const char *b)</div><div class="ttdoc">Compare two strings, ignoring case. </div><div class="ttdef"><b>Definition:</b> <a href="mutt_2string_8c_source.html#l00916">string.c:916</a></div></div>
<div class="ttc" id="structBody_html_ace00f9cba9b46a2d434764335d2fa43a"><div class="ttname"><a href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">Body::subtype</a></div><div class="ttdeci">char * subtype</div><div class="ttdoc">content-type subtype </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00037">body.h:37</a></div></div>
<div class="ttc" id="mutt_8h_html_ae688d728e1acdfe5988c7db45d6f0166"><div class="ttname"><a href="mutt_8h.html#ae688d728e1acdfe5988c7db45d6f0166">PATH_MAX</a></div><div class="ttdeci">#define PATH_MAX</div><div class="ttdef"><b>Definition:</b> <a href="mutt_8h_source.html#l00040">mutt.h:40</a></div></div>
<div class="ttc" id="structBody_html_a25c15115b34c11620fc995c13383fd9b"><div class="ttname"><a href="structBody.html#a25c15115b34c11620fc995c13383fd9b">Body::xtype</a></div><div class="ttdeci">char * xtype</div><div class="ttdoc">content-type if x-unknown </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00036">body.h:36</a></div></div>
<div class="ttc" id="group__logging__api_html_gae6c5fd73af3410b2d5e8099f8774c8da"><div class="ttname"><a href="group__logging__api.html#gae6c5fd73af3410b2d5e8099f8774c8da">mutt_debug</a></div><div class="ttdeci">#define mutt_debug(LEVEL,...)</div><div class="ttdef"><b>Definition:</b> <a href="logging_8h_source.html#l00085">logging.h:85</a></div></div>
<div class="ttc" id="structBody_html_af77d79aadb278bef8f2829c268f2486f"><div class="ttname"><a href="structBody.html#af77d79aadb278bef8f2829c268f2486f">Body::type</a></div><div class="ttdeci">unsigned int type</div><div class="ttdoc">content-type primary type, ContentType </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00065">body.h:65</a></div></div>
<div class="ttc" id="string2_8h_html_acf2117a80b76adbb0ad9019e63adce1f"><div class="ttname"><a href="string2_8h.html#acf2117a80b76adbb0ad9019e63adce1f">IS_SPACE</a></div><div class="ttdeci">#define IS_SPACE(ch)</div><div class="ttdef"><b>Definition:</b> <a href="string2_8h_source.html#l00038">string2.h:38</a></div></div>
<div class="ttc" id="mutt_2string_8c_html_acca6786b903b22a5924219f9db96e10d"><div class="ttname"><a href="mutt_2string_8c.html#acca6786b903b22a5924219f9db96e10d">mutt_str_len</a></div><div class="ttdeci">size_t mutt_str_len(const char *a)</div><div class="ttdoc">Calculate the length of a string, safely. </div><div class="ttdef"><b>Definition:</b> <a href="mutt_2string_8c_source.html#l00664">string.c:664</a></div></div>
<div class="ttc" id="logging_8h_html_aca1fd1d8935433e6ba2e3918214e07f9ab2c99902c587a013b358149516cceeb5"><div class="ttname"><a href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab2c99902c587a013b358149516cceeb5">LL_DEBUG1</a></div><div class="ttdoc">Log at debug level 1. </div><div class="ttdef"><b>Definition:</b> <a href="logging_8h_source.html#l00040">logging.h:40</a></div></div>
<div class="ttc" id="mutt_2string_8c_html_ad20e00309de897a1e882fc7400335b83"><div class="ttname"><a href="mutt_2string_8c.html#ad20e00309de897a1e882fc7400335b83">mutt_str_copy</a></div><div class="ttdeci">size_t mutt_str_copy(char *dest, const char *src, size_t dsize)</div><div class="ttdoc">Copy a string into a buffer (guaranteeing NUL-termination) </div><div class="ttdef"><b>Definition:</b> <a href="mutt_2string_8c_source.html#l00749">string.c:749</a></div></div>
<div class="ttc" id="mutt_2string_8c_html_ae9b6bbaa52b6ce51f2a384fe500e028e"><div class="ttname"><a href="mutt_2string_8c.html#ae9b6bbaa52b6ce51f2a384fe500e028e">mutt_str_replace</a></div><div class="ttdeci">char * mutt_str_replace(char **p, const char *s)</div><div class="ttdoc">Replace one string with another. </div><div class="ttdef"><b>Definition:</b> <a href="mutt_2string_8c_source.html#l00446">string.c:446</a></div></div>
<div class="ttc" id="mime_8h_html_a3ccd048df649c335df5a7f82673bbc79"><div class="ttname"><a href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79">ContentType</a></div><div class="ttdeci">ContentType</div><div class="ttdoc">Content-Type. </div><div class="ttdef"><b>Definition:</b> <a href="mime_8h_source.html#l00029">mime.h:29</a></div></div>
</div><!-- fragment --><div id="dynsection-8" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-8-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-8-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-8-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="sendlib_8h_a1431e9401865165dfef92315f3ca7ae2_cgraph.svg" width="595" height="342"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div id="dynsection-9" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-9-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-9-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-9-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="sendlib_8h_a1431e9401865165dfef92315f3ca7ae2_icgraph.svg" width="420" height="88"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a4151ab9123ccb452ca911515b80ac85e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4151ab9123ccb452ca911515b80ac85e">&#9670;&nbsp;</a></span>mutt_make_file_attach()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structBody.html">Body</a>* mutt_make_file_attach </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structConfigSubset.html">ConfigSubset</a> *&#160;</td>
          <td class="paramname"><em>sub</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create a file attachment. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">path</td><td>File to attach </td></tr>
    <tr><td class="paramname">sub</td><td>Config Subset </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">ptr</td><td>Newly allocated <a class="el" href="structBody.html" title="The body of an email. ">Body</a> </td></tr>
    <tr><td class="paramname">NULL</td><td>Error </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="sendlib_8c_source.html#l01088">1088</a> of file <a class="el" href="sendlib_8c_source.html">sendlib.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;{</div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;  <span class="keyword">struct </span><a class="code" href="structBody.html">Body</a> *att = <a class="code" href="email_2body_8c.html#aee001296b775e82e3988b5a81e53e30c">mutt_body_new</a>();</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;  att-&gt;<a class="code" href="structBody.html#afe3cd2c4b1070e3d0edbf1fed939ac5a">filename</a> = <a class="code" href="mutt_2string_8c.html#a4c2560f787bd1226b977992c16860c98">mutt_str_dup</a>(path);</div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;</div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keyword">const</span> c_mime_type_query_command =</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;      <a class="code" href="helpers_8c.html#ac477c591155aa4ae0452bbabc0affffe">cs_subset_string</a>(sub, <span class="stringliteral">&quot;mime_type_query_command&quot;</span>);</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> c_mime_type_query_first =</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;      <a class="code" href="helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(sub, <span class="stringliteral">&quot;mime_type_query_first&quot;</span>);</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;  <span class="keywordflow">if</span> (c_mime_type_query_command &amp;&amp; c_mime_type_query_first)</div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;    <a class="code" href="sendlib_8c.html#aedf9e081d3acda51f669619b55cea4e7">run_mime_type_query</a>(att, sub);</div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;</div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;  <span class="comment">/* Attempt to determine the appropriate content-type based on the filename</span></div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;<span class="comment">   * suffix.  */</span></div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;  <span class="keywordflow">if</span> (!att-&gt;<a class="code" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>)</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;    <a class="code" href="sendlib_8c.html#a1431e9401865165dfef92315f3ca7ae2">mutt_lookup_mime_type</a>(att, path);</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;  <span class="keywordflow">if</span> (!att-&gt;<a class="code" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a> &amp;&amp; c_mime_type_query_command &amp;&amp; !c_mime_type_query_first)</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;  {</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;    <a class="code" href="sendlib_8c.html#aedf9e081d3acda51f669619b55cea4e7">run_mime_type_query</a>(att, sub);</div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;  }</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;  <span class="keyword">struct </span><a class="code" href="structContent.html">Content</a> *info = <a class="code" href="sendlib_8c.html#a8621a45f0aa4aea9e2613207be4fa717">mutt_get_content_info</a>(path, att, sub);</div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;  <span class="keywordflow">if</span> (!info)</div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;  {</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;    <a class="code" href="email_2body_8c.html#a129af1c316fcbc26b55fb48957bab2cb">mutt_body_free</a>(&amp;att);</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;    <span class="keywordflow">return</span> NULL;</div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;  }</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;</div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;  <span class="keywordflow">if</span> (!att-&gt;<a class="code" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>)</div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;  {</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;    <span class="keywordflow">if</span> ((info-&gt;<a class="code" href="structContent.html#ae2a914f5ad69e35003f328f905279910">nulbin</a> == 0) &amp;&amp;</div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;        ((info-&gt;<a class="code" href="structContent.html#af343f88281d3ac8e32f2ee27a18d67f3">lobin</a> == 0) || ((info-&gt;<a class="code" href="structContent.html#af343f88281d3ac8e32f2ee27a18d67f3">lobin</a> + info-&gt;<a class="code" href="structContent.html#a462631638a7f0de6f461df75fcd43b63">hibin</a> + info-&gt;<a class="code" href="structContent.html#a6896ff99c84f66ffd051fb55c3dfcddf">ascii</a>) / info-&gt;<a class="code" href="structContent.html#af343f88281d3ac8e32f2ee27a18d67f3">lobin</a> &gt;= 10)))</div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;    {</div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;      <span class="comment">/* Statistically speaking, there should be more than 10% &quot;lobin&quot;</span></div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;<span class="comment">       * chars if this is really a binary file...  */</span></div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;      att-&gt;<a class="code" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a> = <a class="code" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79ad88e88afaec507209421bba20aeeb167">TYPE_TEXT</a>;</div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;      att-&gt;<a class="code" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a> = <a class="code" href="mutt_2string_8c.html#a4c2560f787bd1226b977992c16860c98">mutt_str_dup</a>(<span class="stringliteral">&quot;plain&quot;</span>);</div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;    }</div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;    {</div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;      att-&gt;<a class="code" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a> = <a class="code" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79ac5074066199e3f540550ca0b1a38978e">TYPE_APPLICATION</a>;</div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;      att-&gt;<a class="code" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a> = <a class="code" href="mutt_2string_8c.html#a4c2560f787bd1226b977992c16860c98">mutt_str_dup</a>(<span class="stringliteral">&quot;octet-stream&quot;</span>);</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;    }</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;  }</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;  <a class="code" href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;info);</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;  <a class="code" href="sendlib_8c.html#ae4f3b3ef1863d9821af9f82d8963e5b8">mutt_update_encoding</a>(att, sub);</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;  <span class="keywordflow">return</span> att;</div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;}</div><div class="ttc" id="sendlib_8c_html_a8621a45f0aa4aea9e2613207be4fa717"><div class="ttname"><a href="sendlib_8c.html#a8621a45f0aa4aea9e2613207be4fa717">mutt_get_content_info</a></div><div class="ttdeci">struct Content * mutt_get_content_info(const char *fname, struct Body *b, struct ConfigSubset *sub)</div><div class="ttdoc">Analyze file to determine MIME encoding to use. </div><div class="ttdef"><b>Definition:</b> <a href="sendlib_8c_source.html#l00465">sendlib.c:465</a></div></div>
<div class="ttc" id="structBody_html_afe3cd2c4b1070e3d0edbf1fed939ac5a"><div class="ttname"><a href="structBody.html#afe3cd2c4b1070e3d0edbf1fed939ac5a">Body::filename</a></div><div class="ttdeci">char * filename</div><div class="ttdoc">when sending a message, this is the file to which this structure refers </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00046">body.h:46</a></div></div>
<div class="ttc" id="helpers_8c_html_ae50f679dd6c5bd1ba820884c8602f038"><div class="ttname"><a href="helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a></div><div class="ttdeci">bool cs_subset_bool(const struct ConfigSubset *sub, const char *name)</div><div class="ttdoc">Get a boolean config item by name. </div><div class="ttdef"><b>Definition:</b> <a href="helpers_8c_source.html#l00073">helpers.c:73</a></div></div>
<div class="ttc" id="sendlib_8c_html_ae4f3b3ef1863d9821af9f82d8963e5b8"><div class="ttname"><a href="sendlib_8c.html#ae4f3b3ef1863d9821af9f82d8963e5b8">mutt_update_encoding</a></div><div class="ttdeci">void mutt_update_encoding(struct Body *a, struct ConfigSubset *sub)</div><div class="ttdoc">Update the encoding type. </div><div class="ttdef"><b>Definition:</b> <a href="sendlib_8c_source.html#l00904">sendlib.c:904</a></div></div>
<div class="ttc" id="mutt_2string_8c_html_a4c2560f787bd1226b977992c16860c98"><div class="ttname"><a href="mutt_2string_8c.html#a4c2560f787bd1226b977992c16860c98">mutt_str_dup</a></div><div class="ttdeci">char * mutt_str_dup(const char *str)</div><div class="ttdoc">Copy a string, safely. </div><div class="ttdef"><b>Definition:</b> <a href="mutt_2string_8c_source.html#l00370">string.c:370</a></div></div>
<div class="ttc" id="structContent_html_a462631638a7f0de6f461df75fcd43b63"><div class="ttname"><a href="structContent.html#a462631638a7f0de6f461df75fcd43b63">Content::hibin</a></div><div class="ttdeci">long hibin</div><div class="ttdoc">8-bit characters </div><div class="ttdef"><b>Definition:</b> <a href="content_8h_source.html#l00035">content.h:35</a></div></div>
<div class="ttc" id="structBody_html"><div class="ttname"><a href="structBody.html">Body</a></div><div class="ttdoc">The body of an email. </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00034">body.h:34</a></div></div>
<div class="ttc" id="email_2body_8c_html_aee001296b775e82e3988b5a81e53e30c"><div class="ttname"><a href="email_2body_8c.html#aee001296b775e82e3988b5a81e53e30c">mutt_body_new</a></div><div class="ttdeci">struct Body * mutt_body_new(void)</div><div class="ttdoc">Create a new Body. </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8c_source.html#l00043">body.c:43</a></div></div>
<div class="ttc" id="structBody_html_ace00f9cba9b46a2d434764335d2fa43a"><div class="ttname"><a href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">Body::subtype</a></div><div class="ttdeci">char * subtype</div><div class="ttdoc">content-type subtype </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00037">body.h:37</a></div></div>
<div class="ttc" id="structContent_html"><div class="ttname"><a href="structContent.html">Content</a></div><div class="ttdoc">Info about an attachment. </div><div class="ttdef"><b>Definition:</b> <a href="content_8h_source.html#l00033">content.h:33</a></div></div>
<div class="ttc" id="structContent_html_a6896ff99c84f66ffd051fb55c3dfcddf"><div class="ttname"><a href="structContent.html#a6896ff99c84f66ffd051fb55c3dfcddf">Content::ascii</a></div><div class="ttdeci">long ascii</div><div class="ttdoc">Number of ascii chars. </div><div class="ttdef"><b>Definition:</b> <a href="content_8h_source.html#l00039">content.h:39</a></div></div>
<div class="ttc" id="mime_8h_html_a3ccd048df649c335df5a7f82673bbc79ad88e88afaec507209421bba20aeeb167"><div class="ttname"><a href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79ad88e88afaec507209421bba20aeeb167">TYPE_TEXT</a></div><div class="ttdoc">Type: &amp;#39;text/*&amp;#39;. </div><div class="ttdef"><b>Definition:</b> <a href="mime_8h_source.html#l00038">mime.h:38</a></div></div>
<div class="ttc" id="helpers_8c_html_ac477c591155aa4ae0452bbabc0affffe"><div class="ttname"><a href="helpers_8c.html#ac477c591155aa4ae0452bbabc0affffe">cs_subset_string</a></div><div class="ttdeci">const char * cs_subset_string(const struct ConfigSubset *sub, const char *name)</div><div class="ttdoc">Get a string config item by name. </div><div class="ttdef"><b>Definition:</b> <a href="helpers_8c_source.html#l00317">helpers.c:317</a></div></div>
<div class="ttc" id="email_2body_8c_html_a129af1c316fcbc26b55fb48957bab2cb"><div class="ttname"><a href="email_2body_8c.html#a129af1c316fcbc26b55fb48957bab2cb">mutt_body_free</a></div><div class="ttdeci">void mutt_body_free(struct Body **ptr)</div><div class="ttdoc">Free a Body. </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8c_source.html#l00057">body.c:57</a></div></div>
<div class="ttc" id="structBody_html_af77d79aadb278bef8f2829c268f2486f"><div class="ttname"><a href="structBody.html#af77d79aadb278bef8f2829c268f2486f">Body::type</a></div><div class="ttdeci">unsigned int type</div><div class="ttdoc">content-type primary type, ContentType </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00065">body.h:65</a></div></div>
<div class="ttc" id="structContent_html_af343f88281d3ac8e32f2ee27a18d67f3"><div class="ttname"><a href="structContent.html#af343f88281d3ac8e32f2ee27a18d67f3">Content::lobin</a></div><div class="ttdeci">long lobin</div><div class="ttdoc">Unprintable 7-bit chars (eg., control chars) </div><div class="ttdef"><b>Definition:</b> <a href="content_8h_source.html#l00036">content.h:36</a></div></div>
<div class="ttc" id="sendlib_8c_html_a1431e9401865165dfef92315f3ca7ae2"><div class="ttname"><a href="sendlib_8c.html#a1431e9401865165dfef92315f3ca7ae2">mutt_lookup_mime_type</a></div><div class="ttdeci">enum ContentType mutt_lookup_mime_type(struct Body *att, const char *path)</div><div class="ttdoc">Find the MIME type for an attachment. </div><div class="ttdef"><b>Definition:</b> <a href="sendlib_8c_source.html#l00564">sendlib.c:564</a></div></div>
<div class="ttc" id="memory_8h_html_a25875003b43b81a4302256caa4a13599"><div class="ttname"><a href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a></div><div class="ttdeci">#define FREE(x)</div><div class="ttdef"><b>Definition:</b> <a href="memory_8h_source.html#l00040">memory.h:40</a></div></div>
<div class="ttc" id="structContent_html_ae2a914f5ad69e35003f328f905279910"><div class="ttname"><a href="structContent.html#ae2a914f5ad69e35003f328f905279910">Content::nulbin</a></div><div class="ttdeci">long nulbin</div><div class="ttdoc">Null characters (0x0) </div><div class="ttdef"><b>Definition:</b> <a href="content_8h_source.html#l00037">content.h:37</a></div></div>
<div class="ttc" id="mime_8h_html_a3ccd048df649c335df5a7f82673bbc79ac5074066199e3f540550ca0b1a38978e"><div class="ttname"><a href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79ac5074066199e3f540550ca0b1a38978e">TYPE_APPLICATION</a></div><div class="ttdoc">Type: &amp;#39;application/*&amp;#39;. </div><div class="ttdef"><b>Definition:</b> <a href="mime_8h_source.html#l00033">mime.h:33</a></div></div>
<div class="ttc" id="sendlib_8c_html_aedf9e081d3acda51f669619b55cea4e7"><div class="ttname"><a href="sendlib_8c.html#aedf9e081d3acda51f669619b55cea4e7">run_mime_type_query</a></div><div class="ttdeci">static void run_mime_type_query(struct Body *att, struct ConfigSubset *sub)</div><div class="ttdoc">Run an external command to determine the MIME type. </div><div class="ttdef"><b>Definition:</b> <a href="sendlib_8c_source.html#l01046">sendlib.c:1046</a></div></div>
</div><!-- fragment --><div id="dynsection-10" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-10-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-10-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-10-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="sendlib_8h_a4151ab9123ccb452ca911515b80ac85e_cgraph.svg" width="812" height="467"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div id="dynsection-11" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-11-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-11-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-11-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="sendlib_8h_a4151ab9123ccb452ca911515b80ac85e_icgraph.svg" width="612" height="190"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="ac8ddd58faaec9226b8af76db09d4155c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac8ddd58faaec9226b8af76db09d4155c">&#9670;&nbsp;</a></span>mutt_make_message_attach()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structBody.html">Body</a>* mutt_make_message_attach </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structMailbox.html">Mailbox</a> *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structEmail.html">Email</a> *&#160;</td>
          <td class="paramname"><em>e</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>attach_msg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structConfigSubset.html">ConfigSubset</a> *&#160;</td>
          <td class="paramname"><em>sub</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create a message attachment. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">m</td><td><a class="el" href="structMailbox.html" title="A mailbox. ">Mailbox</a> </td></tr>
    <tr><td class="paramname">e</td><td><a class="el" href="structEmail.html" title="The envelope/body of an email. ">Email</a> </td></tr>
    <tr><td class="paramname">attach_msg</td><td>true if attaching a message </td></tr>
    <tr><td class="paramname">sub</td><td>Config Subset </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">ptr</td><td>Newly allocated <a class="el" href="structBody.html" title="The body of an email. ">Body</a> </td></tr>
    <tr><td class="paramname">NULL</td><td>Error </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="sendlib_8c_source.html#l00936">936</a> of file <a class="el" href="sendlib_8c_source.html">sendlib.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;{</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;  <span class="keyword">struct </span><a class="code" href="structBody.html">Body</a> *body = NULL;</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;  FILE *fp = NULL;</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;  <a class="code" href="copy_8h.html#adc738493d51f47c7dd372f3ebd53223a">CopyMessageFlags</a> cmflags;</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;  <a class="code" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a> pgp = <a class="code" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> ? e-&gt;<a class="code" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> : <a class="code" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a>;</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> c_mime_forward_decode = <a class="code" href="helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(sub, <span class="stringliteral">&quot;mime_forward_decode&quot;</span>);</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> c_forward_decrypt = <a class="code" href="helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(sub, <span class="stringliteral">&quot;forward_decrypt&quot;</span>);</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a>)</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;  {</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;    <span class="keywordflow">if</span> ((c_mime_forward_decode || c_forward_decrypt) &amp;&amp; (e-&gt;<a class="code" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> &amp; <a class="code" href="ncrypt_2lib_8h.html#aacaa4abd4c0696e260b7a0f1d466360a">SEC_ENCRYPT</a>))</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;    {</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="crypt_8c.html#a4ee7f1419a7e39b0e9f1f9d550f4de43">crypt_valid_passphrase</a>(e-&gt;<a class="code" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a>))</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;        <span class="keywordflow">return</span> NULL;</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;    }</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;  }</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;  <span class="keyword">struct </span><a class="code" href="structBuffer.html">Buffer</a> *buf = <a class="code" href="pool_8c.html#a2129d5ea0085753afdd37cf62161845d">mutt_buffer_pool_get</a>();</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;  <a class="code" href="muttlib_8h.html#a7f1db9db6f710a84cace77248096e2ac">mutt_buffer_mktemp</a>(buf);</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;  fp = <a class="code" href="file_8c.html#ae1c0c19fec03274220b3ca065ad1e2e5">mutt_file_fopen</a>(<a class="code" href="buffer_8h.html#a4aca040fb75bc1dfc086cbfbf14ac8cd">mutt_buffer_string</a>(buf), <span class="stringliteral">&quot;w+&quot;</span>);</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;  <span class="keywordflow">if</span> (!fp)</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;  {</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;    <a class="code" href="pool_8c.html#a08b48e2ac8849341888ee7429cc5093c">mutt_buffer_pool_release</a>(&amp;buf);</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;    <span class="keywordflow">return</span> NULL;</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;  }</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;  body = <a class="code" href="email_2body_8c.html#aee001296b775e82e3988b5a81e53e30c">mutt_body_new</a>();</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;  body-&gt;<a class="code" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a> = <a class="code" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79a2cbb8dddd761b8bfba754d933a979c1b">TYPE_MESSAGE</a>;</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;  body-&gt;<a class="code" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a> = <a class="code" href="mutt_2string_8c.html#a4c2560f787bd1226b977992c16860c98">mutt_str_dup</a>(<span class="stringliteral">&quot;rfc822&quot;</span>);</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;  body-&gt;<a class="code" href="structBody.html#afe3cd2c4b1070e3d0edbf1fed939ac5a">filename</a> = <a class="code" href="mutt_2string_8c.html#a4c2560f787bd1226b977992c16860c98">mutt_str_dup</a>(<a class="code" href="buffer_8h.html#a4aca040fb75bc1dfc086cbfbf14ac8cd">mutt_buffer_string</a>(buf));</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;  body-&gt;<a class="code" href="structBody.html#a47191eabf16d34d0deb412c898ed629b">unlink</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;  body-&gt;<a class="code" href="structBody.html#a86721d1d557276cbc9cf69777af8c305">use_disp</a> = <span class="keyword">false</span>;</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;  body-&gt;<a class="code" href="structBody.html#a99aff302b287a47c407a7412a99630f5">disposition</a> = <a class="code" href="mime_8h.html#a5f93dab7807282e699a6bc1b2d18a2d8a691faf938d6b4cec05ea5e03d9dee073">DISP_INLINE</a>;</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;  body-&gt;<a class="code" href="structBody.html#a2f795dc4337b500fbf2ae6682dc5360b">noconv</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;  <a class="code" href="pool_8c.html#a08b48e2ac8849341888ee7429cc5093c">mutt_buffer_pool_release</a>(&amp;buf);</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;  <span class="keyword">struct </span><a class="code" href="structMessage.html">Message</a> *msg = <a class="code" href="mx_8c.html#a7df2f9d4d83ce9fca2cf48e08f8a4bc0">mx_msg_open</a>(m, e-&gt;<a class="code" href="structEmail.html#abd3d551204f4ea232a304c1c4c4c149d">msgno</a>);</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;  <span class="keywordflow">if</span> (!msg)</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;  {</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;    <span class="keywordflow">return</span> NULL;</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;  }</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;  <a class="code" href="attachments_8c.html#a9fb5dd768a13b9f083ca3a5e2e713db6">mutt_parse_mime_message</a>(m, e, msg-&gt;<a class="code" href="structMessage.html#a11d53ee4319e8735c1677d8780a7b517">fp</a>);</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;  <a class="code" href="copy_8h.html#a88a40e8f238a8478b885c90d1ce53e9c">CopyHeaderFlags</a> chflags = <a class="code" href="copy_8h.html#a2a289d0d9f4ec7e2b2e29a483a9f9759">CH_XMIT</a>;</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;  cmflags = <a class="code" href="copy_8h.html#ac778c083de78e4fb27889f345f242d13">MUTT_CM_NO_FLAGS</a>;</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;  <span class="comment">/* If we are attaching a message, ignore `$mime_forward_decode` */</span></div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;  <span class="keywordflow">if</span> (!attach_msg &amp;&amp; c_mime_forward_decode)</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;  {</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;    chflags |= <a class="code" href="copy_8h.html#a7eafef308595ca62d50bb0087ee605ce">CH_MIME</a> | <a class="code" href="copy_8h.html#adc5d201eb6a28c40ea48ec714243e597">CH_TXTPLAIN</a>;</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;    cmflags = <a class="code" href="copy_8h.html#a4898a6c2c88fdba8ce7decdb6c125a96">MUTT_CM_DECODE</a> | <a class="code" href="copy_8h.html#a648ee091378fa6c0f6f129f64fc7f22b">MUTT_CM_CHARCONV</a>;</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a>)</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;      pgp &amp;= ~<a class="code" href="ncrypt_2lib_8h.html#a6694d25dff1ee1958351160a84bb2dc0">PGP_ENCRYPT</a>;</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code" href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a>)</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;      pgp &amp;= ~<a class="code" href="ncrypt_2lib_8h.html#ac25eb5415ebf34da68c39a3d4e3bc9ad">SMIME_ENCRYPT</a>;</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;  }</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((<a class="code" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> != 0) &amp;&amp; c_forward_decrypt &amp;&amp; (e-&gt;<a class="code" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> &amp; <a class="code" href="ncrypt_2lib_8h.html#aacaa4abd4c0696e260b7a0f1d466360a">SEC_ENCRYPT</a>))</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;  {</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;    <span class="keywordflow">if</span> (((<a class="code" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; APPLICATION_PGP) != 0) &amp;&amp; <a class="code" href="crypt_8c.html#a832e4b9f5a0e463876a3d8cfe852f12d">mutt_is_multipart_encrypted</a>(e-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>))</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;    {</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;      chflags |= <a class="code" href="copy_8h.html#a7eafef308595ca62d50bb0087ee605ce">CH_MIME</a> | <a class="code" href="copy_8h.html#a5456d9b0419ab775a33967dcdb978a3d">CH_NONEWLINE</a>;</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;      cmflags = <a class="code" href="copy_8h.html#a47437a254e166c0484abce93068e1399">MUTT_CM_DECODE_PGP</a>;</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;      pgp &amp;= ~<a class="code" href="ncrypt_2lib_8h.html#a6694d25dff1ee1958351160a84bb2dc0">PGP_ENCRYPT</a>;</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;    }</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (((<a class="code" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; APPLICATION_PGP) != 0) &amp;&amp;</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;             ((<a class="code" href="crypt_8c.html#a159d0d34a10b662acb2cc80099e5ecc7">mutt_is_application_pgp</a>(e-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>) &amp; <a class="code" href="ncrypt_2lib_8h.html#a6694d25dff1ee1958351160a84bb2dc0">PGP_ENCRYPT</a>) == <a class="code" href="ncrypt_2lib_8h.html#a6694d25dff1ee1958351160a84bb2dc0">PGP_ENCRYPT</a>))</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;    {</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;      chflags |= <a class="code" href="copy_8h.html#a7eafef308595ca62d50bb0087ee605ce">CH_MIME</a> | <a class="code" href="copy_8h.html#adc5d201eb6a28c40ea48ec714243e597">CH_TXTPLAIN</a>;</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;      cmflags = <a class="code" href="copy_8h.html#a4898a6c2c88fdba8ce7decdb6c125a96">MUTT_CM_DECODE</a> | <a class="code" href="copy_8h.html#a648ee091378fa6c0f6f129f64fc7f22b">MUTT_CM_CHARCONV</a>;</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;      pgp &amp;= ~<a class="code" href="ncrypt_2lib_8h.html#a6694d25dff1ee1958351160a84bb2dc0">PGP_ENCRYPT</a>;</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;    }</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (((<a class="code" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code" href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a>) != 0) &amp;&amp;</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;             ((<a class="code" href="crypt_8c.html#a4073ce5b5fcec6e245dbfa9369016b8e">mutt_is_application_smime</a>(e-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>) &amp; <a class="code" href="ncrypt_2lib_8h.html#ac25eb5415ebf34da68c39a3d4e3bc9ad">SMIME_ENCRYPT</a>) == <a class="code" href="ncrypt_2lib_8h.html#ac25eb5415ebf34da68c39a3d4e3bc9ad">SMIME_ENCRYPT</a>))</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;    {</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;      chflags |= <a class="code" href="copy_8h.html#a7eafef308595ca62d50bb0087ee605ce">CH_MIME</a> | <a class="code" href="copy_8h.html#adc5d201eb6a28c40ea48ec714243e597">CH_TXTPLAIN</a>;</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;      cmflags = <a class="code" href="copy_8h.html#a4898a6c2c88fdba8ce7decdb6c125a96">MUTT_CM_DECODE</a> | <a class="code" href="copy_8h.html#a648ee091378fa6c0f6f129f64fc7f22b">MUTT_CM_CHARCONV</a>;</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;      pgp &amp;= ~<a class="code" href="ncrypt_2lib_8h.html#ac25eb5415ebf34da68c39a3d4e3bc9ad">SMIME_ENCRYPT</a>;</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;    }</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;  }</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;  <a class="code" href="copy_8c.html#aa0dd608f4ed300454d97ac83ade160ac">mutt_copy_message</a>(fp, m, e, msg, cmflags, chflags, 0);</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;  <a class="code" href="mx_8c.html#a2172d90c08b5a2b293d22ed13ee0e7a8">mx_msg_close</a>(m, &amp;msg);</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;  fflush(fp);</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;  rewind(fp);</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;  body-&gt;<a class="code" href="structBody.html#a8e10ba22522218bd12bd3cb38dd3fcc9">email</a> = <a class="code" href="email_2email_8c.html#a77c9ecff4b23001b81177ffe398bad44">email_new</a>();</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;  body-&gt;<a class="code" href="structBody.html#a8e10ba22522218bd12bd3cb38dd3fcc9">email</a>-&gt;<a class="code" href="structEmail.html#a8d35ff6f232f83e89e2d46af416708cc">offset</a> = 0;</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;  <span class="comment">/* we don&#39;t need the user headers here */</span></div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;  body-&gt;<a class="code" href="structBody.html#a8e10ba22522218bd12bd3cb38dd3fcc9">email</a>-&gt;<a class="code" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a> = <a class="code" href="parse_8c.html#a32cd9ed48d31f100bd8525018e1450da">mutt_rfc822_read_header</a>(fp, body-&gt;<a class="code" href="structBody.html#a8e10ba22522218bd12bd3cb38dd3fcc9">email</a>, <span class="keyword">false</span>, <span class="keyword">false</span>);</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a>)</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;    body-&gt;<a class="code" href="structBody.html#a8e10ba22522218bd12bd3cb38dd3fcc9">email</a>-&gt;<a class="code" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> = pgp;</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;  <a class="code" href="sendlib_8c.html#ae4f3b3ef1863d9821af9f82d8963e5b8">mutt_update_encoding</a>(body, sub);</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;  body-&gt;<a class="code" href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">parts</a> = body-&gt;<a class="code" href="structBody.html#a8e10ba22522218bd12bd3cb38dd3fcc9">email</a>-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>;</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;  <a class="code" href="file_8c.html#a31f49795ff5b9558db5476e5777e63b6">mutt_file_fclose</a>(&amp;fp);</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;  <span class="keywordflow">return</span> body;</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;}</div><div class="ttc" id="attachments_8c_html_a9fb5dd768a13b9f083ca3a5e2e713db6"><div class="ttname"><a href="attachments_8c.html#a9fb5dd768a13b9f083ca3a5e2e713db6">mutt_parse_mime_message</a></div><div class="ttdeci">void mutt_parse_mime_message(struct Mailbox *m, struct Email *e, FILE *fp)</div><div class="ttdoc">Parse a MIME email. </div><div class="ttdef"><b>Definition:</b> <a href="attachments_8c_source.html#l00591">attachments.c:591</a></div></div>
<div class="ttc" id="muttlib_8h_html_a7f1db9db6f710a84cace77248096e2ac"><div class="ttname"><a href="muttlib_8h.html#a7f1db9db6f710a84cace77248096e2ac">mutt_buffer_mktemp</a></div><div class="ttdeci">#define mutt_buffer_mktemp(buf)</div><div class="ttdef"><b>Definition:</b> <a href="muttlib_8h_source.html#l00074">muttlib.h:74</a></div></div>
<div class="ttc" id="copy_8h_html_a7eafef308595ca62d50bb0087ee605ce"><div class="ttname"><a href="copy_8h.html#a7eafef308595ca62d50bb0087ee605ce">CH_MIME</a></div><div class="ttdeci">#define CH_MIME</div><div class="ttdoc">Ignore MIME fields. </div><div class="ttdef"><b>Definition:</b> <a href="copy_8h_source.html#l00061">copy.h:61</a></div></div>
<div class="ttc" id="structBody_html_afe3cd2c4b1070e3d0edbf1fed939ac5a"><div class="ttname"><a href="structBody.html#afe3cd2c4b1070e3d0edbf1fed939ac5a">Body::filename</a></div><div class="ttdeci">char * filename</div><div class="ttdoc">when sending a message, this is the file to which this structure refers </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00046">body.h:46</a></div></div>
<div class="ttc" id="helpers_8c_html_ae50f679dd6c5bd1ba820884c8602f038"><div class="ttname"><a href="helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a></div><div class="ttdeci">bool cs_subset_bool(const struct ConfigSubset *sub, const char *name)</div><div class="ttdoc">Get a boolean config item by name. </div><div class="ttdef"><b>Definition:</b> <a href="helpers_8c_source.html#l00073">helpers.c:73</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_ad980bff69bb614893ad8e7e1c28a5023"><div class="ttname"><a href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a></div><div class="ttdeci">#define WithCrypto</div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00113">lib.h:113</a></div></div>
<div class="ttc" id="pool_8c_html_a2129d5ea0085753afdd37cf62161845d"><div class="ttname"><a href="pool_8c.html#a2129d5ea0085753afdd37cf62161845d">mutt_buffer_pool_get</a></div><div class="ttdeci">struct Buffer * mutt_buffer_pool_get(void)</div><div class="ttdoc">Get a Buffer from the pool. </div><div class="ttdef"><b>Definition:</b> <a href="pool_8c_source.html#l00101">pool.c:101</a></div></div>
<div class="ttc" id="sendlib_8c_html_ae4f3b3ef1863d9821af9f82d8963e5b8"><div class="ttname"><a href="sendlib_8c.html#ae4f3b3ef1863d9821af9f82d8963e5b8">mutt_update_encoding</a></div><div class="ttdeci">void mutt_update_encoding(struct Body *a, struct ConfigSubset *sub)</div><div class="ttdoc">Update the encoding type. </div><div class="ttdef"><b>Definition:</b> <a href="sendlib_8c_source.html#l00904">sendlib.c:904</a></div></div>
<div class="ttc" id="structEmail_html_a57ad6ac618c0f685804f6f5bb390b3a6"><div class="ttname"><a href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">Email::body</a></div><div class="ttdeci">struct Body * body</div><div class="ttdoc">List of MIME parts. </div><div class="ttdef"><b>Definition:</b> <a href="email_8h_source.html#l00091">email.h:91</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a95845954210adfc850d5602843f858d4"><div class="ttname"><a href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a></div><div class="ttdeci">#define SEC_NO_FLAGS</div><div class="ttdoc">No flags are set. </div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00074">lib.h:74</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_ac25eb5415ebf34da68c39a3d4e3bc9ad"><div class="ttname"><a href="ncrypt_2lib_8h.html#ac25eb5415ebf34da68c39a3d4e3bc9ad">SMIME_ENCRYPT</a></div><div class="ttdeci">#define SMIME_ENCRYPT</div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00099">lib.h:99</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_aacaa4abd4c0696e260b7a0f1d466360a"><div class="ttname"><a href="ncrypt_2lib_8h.html#aacaa4abd4c0696e260b7a0f1d466360a">SEC_ENCRYPT</a></div><div class="ttdeci">#define SEC_ENCRYPT</div><div class="ttdoc">Email is encrypted. </div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00075">lib.h:75</a></div></div>
<div class="ttc" id="pool_8c_html_a08b48e2ac8849341888ee7429cc5093c"><div class="ttname"><a href="pool_8c.html#a08b48e2ac8849341888ee7429cc5093c">mutt_buffer_pool_release</a></div><div class="ttdeci">void mutt_buffer_pool_release(struct Buffer **pbuf)</div><div class="ttdoc">Free a Buffer from the pool. </div><div class="ttdef"><b>Definition:</b> <a href="pool_8c_source.html#l00112">pool.c:112</a></div></div>
<div class="ttc" id="structBody_html_a2f795dc4337b500fbf2ae6682dc5360b"><div class="ttname"><a href="structBody.html#a2f795dc4337b500fbf2ae6682dc5360b">Body::noconv</a></div><div class="ttdeci">bool noconv</div><div class="ttdoc">Don&amp;#39;t do character set conversion. </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00073">body.h:73</a></div></div>
<div class="ttc" id="crypt_8c_html_a4073ce5b5fcec6e245dbfa9369016b8e"><div class="ttname"><a href="crypt_8c.html#a4073ce5b5fcec6e245dbfa9369016b8e">mutt_is_application_smime</a></div><div class="ttdeci">SecurityFlags mutt_is_application_smime(struct Body *b)</div><div class="ttdoc">Does the message use S/MIME? </div><div class="ttdef"><b>Definition:</b> <a href="crypt_8c_source.html#l00623">crypt.c:623</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a6694d25dff1ee1958351160a84bb2dc0"><div class="ttname"><a href="ncrypt_2lib_8h.html#a6694d25dff1ee1958351160a84bb2dc0">PGP_ENCRYPT</a></div><div class="ttdeci">#define PGP_ENCRYPT</div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00093">lib.h:93</a></div></div>
<div class="ttc" id="structBuffer_html"><div class="ttname"><a href="structBuffer.html">Buffer</a></div><div class="ttdoc">String manipulation buffer. </div><div class="ttdef"><b>Definition:</b> <a href="buffer_8h_source.html#l00033">buffer.h:33</a></div></div>
<div class="ttc" id="mutt_2string_8c_html_a4c2560f787bd1226b977992c16860c98"><div class="ttname"><a href="mutt_2string_8c.html#a4c2560f787bd1226b977992c16860c98">mutt_str_dup</a></div><div class="ttdeci">char * mutt_str_dup(const char *str)</div><div class="ttdoc">Copy a string, safely. </div><div class="ttdef"><b>Definition:</b> <a href="mutt_2string_8c_source.html#l00370">string.c:370</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a2073a168ca3a64c3c30d13fa4917a05d"><div class="ttname"><a href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a></div><div class="ttdeci">uint16_t SecurityFlags</div><div class="ttdoc">Flags, e.g. SEC_ENCRYPT. </div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00071">lib.h:71</a></div></div>
<div class="ttc" id="copy_8h_html_adc738493d51f47c7dd372f3ebd53223a"><div class="ttname"><a href="copy_8h.html#adc738493d51f47c7dd372f3ebd53223a">CopyMessageFlags</a></div><div class="ttdeci">uint16_t CopyMessageFlags</div><div class="ttdoc">Flags for mutt_copy_message(), e.g. MUTT_CM_NOHEADER. </div><div class="ttdef"><b>Definition:</b> <a href="copy_8h_source.html#l00032">copy.h:32</a></div></div>
<div class="ttc" id="copy_8h_html_ac778c083de78e4fb27889f345f242d13"><div class="ttname"><a href="copy_8h.html#ac778c083de78e4fb27889f345f242d13">MUTT_CM_NO_FLAGS</a></div><div class="ttdeci">#define MUTT_CM_NO_FLAGS</div><div class="ttdoc">No flags are set. </div><div class="ttdef"><b>Definition:</b> <a href="copy_8h_source.html#l00035">copy.h:35</a></div></div>
<div class="ttc" id="structBody_html"><div class="ttname"><a href="structBody.html">Body</a></div><div class="ttdoc">The body of an email. </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00034">body.h:34</a></div></div>
<div class="ttc" id="structBody_html_a99aff302b287a47c407a7412a99630f5"><div class="ttname"><a href="structBody.html#a99aff302b287a47c407a7412a99630f5">Body::disposition</a></div><div class="ttdeci">unsigned int disposition</div><div class="ttdoc">content-disposition, ContentDisposition </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00067">body.h:67</a></div></div>
<div class="ttc" id="email_2email_8c_html_a77c9ecff4b23001b81177ffe398bad44"><div class="ttname"><a href="email_2email_8c.html#a77c9ecff4b23001b81177ffe398bad44">email_new</a></div><div class="ttdeci">struct Email * email_new(void)</div><div class="ttdoc">Create a new Email. </div><div class="ttdef"><b>Definition:</b> <a href="email_2email_8c_source.html#l00078">email.c:78</a></div></div>
<div class="ttc" id="buffer_8h_html_a4aca040fb75bc1dfc086cbfbf14ac8cd"><div class="ttname"><a href="buffer_8h.html#a4aca040fb75bc1dfc086cbfbf14ac8cd">mutt_buffer_string</a></div><div class="ttdeci">static const char * mutt_buffer_string(const struct Buffer *buf)</div><div class="ttdoc">Convert a buffer to a const char * &quot;string&quot;. </div><div class="ttdef"><b>Definition:</b> <a href="buffer_8h_source.html#l00077">buffer.h:77</a></div></div>
<div class="ttc" id="email_2body_8c_html_aee001296b775e82e3988b5a81e53e30c"><div class="ttname"><a href="email_2body_8c.html#aee001296b775e82e3988b5a81e53e30c">mutt_body_new</a></div><div class="ttdeci">struct Body * mutt_body_new(void)</div><div class="ttdoc">Create a new Body. </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8c_source.html#l00043">body.c:43</a></div></div>
<div class="ttc" id="mx_8c_html_a2172d90c08b5a2b293d22ed13ee0e7a8"><div class="ttname"><a href="mx_8c.html#a2172d90c08b5a2b293d22ed13ee0e7a8">mx_msg_close</a></div><div class="ttdeci">int mx_msg_close(struct Mailbox *m, struct Message **msg)</div><div class="ttdoc">Close a message. </div><div class="ttdef"><b>Definition:</b> <a href="mx_8c_source.html#l01186">mx.c:1186</a></div></div>
<div class="ttc" id="crypt_8c_html_a4ee7f1419a7e39b0e9f1f9d550f4de43"><div class="ttname"><a href="crypt_8c.html#a4ee7f1419a7e39b0e9f1f9d550f4de43">crypt_valid_passphrase</a></div><div class="ttdeci">bool crypt_valid_passphrase(SecurityFlags flags)</div><div class="ttdoc">Check that we have a usable passphrase, ask if not. </div><div class="ttdef"><b>Definition:</b> <a href="crypt_8c_source.html#l00135">crypt.c:135</a></div></div>
<div class="ttc" id="crypt_8c_html_a832e4b9f5a0e463876a3d8cfe852f12d"><div class="ttname"><a href="crypt_8c.html#a832e4b9f5a0e463876a3d8cfe852f12d">mutt_is_multipart_encrypted</a></div><div class="ttdeci">SecurityFlags mutt_is_multipart_encrypted(struct Body *b)</div><div class="ttdoc">Does the message have encrypted parts? </div><div class="ttdef"><b>Definition:</b> <a href="crypt_8c_source.html#l00460">crypt.c:460</a></div></div>
<div class="ttc" id="file_8c_html_a31f49795ff5b9558db5476e5777e63b6"><div class="ttname"><a href="file_8c.html#a31f49795ff5b9558db5476e5777e63b6">mutt_file_fclose</a></div><div class="ttdeci">int mutt_file_fclose(FILE **fp)</div><div class="ttdoc">Close a FILE handle (and NULL the pointer) </div><div class="ttdef"><b>Definition:</b> <a href="file_8c_source.html#l00153">file.c:153</a></div></div>
<div class="ttc" id="structEmail_html_a34cc4493729d7a3b1f4ed783e739a9ec"><div class="ttname"><a href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">Email::env</a></div><div class="ttdeci">struct Envelope * env</div><div class="ttdoc">Envelope information. </div><div class="ttdef"><b>Definition:</b> <a href="email_8h_source.html#l00090">email.h:90</a></div></div>
<div class="ttc" id="structBody_html_ace00f9cba9b46a2d434764335d2fa43a"><div class="ttname"><a href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">Body::subtype</a></div><div class="ttdeci">char * subtype</div><div class="ttdoc">content-type subtype </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00037">body.h:37</a></div></div>
<div class="ttc" id="copy_8h_html_adc5d201eb6a28c40ea48ec714243e597"><div class="ttname"><a href="copy_8h.html#adc5d201eb6a28c40ea48ec714243e597">CH_TXTPLAIN</a></div><div class="ttdeci">#define CH_TXTPLAIN</div><div class="ttdoc">Generate text/plain MIME headers. </div><div class="ttdef"><b>Definition:</b> <a href="copy_8h_source.html#l00063">copy.h:63</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a798dfac1e8839ca89375b4ec62b3eff2"><div class="ttname"><a href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a></div><div class="ttdeci">#define APPLICATION_SMIME</div><div class="ttdoc">Use SMIME to encrypt/sign. </div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00088">lib.h:88</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a587e679a4c9cc44f11f0c467bb22b0af"><div class="ttname"><a href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a></div><div class="ttdeci">#define APPLICATION_PGP</div><div class="ttdoc">Use PGP to encrypt/sign. </div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00087">lib.h:87</a></div></div>
<div class="ttc" id="structMessage_html"><div class="ttname"><a href="structMessage.html">Message</a></div><div class="ttdoc">A local copy of an email. </div><div class="ttdef"><b>Definition:</b> <a href="mxapi_8h_source.html#l00041">mxapi.h:41</a></div></div>
<div class="ttc" id="copy_8h_html_a4898a6c2c88fdba8ce7decdb6c125a96"><div class="ttname"><a href="copy_8h.html#a4898a6c2c88fdba8ce7decdb6c125a96">MUTT_CM_DECODE</a></div><div class="ttdeci">#define MUTT_CM_DECODE</div><div class="ttdoc">Decode the message body into text/plain. </div><div class="ttdef"><b>Definition:</b> <a href="copy_8h_source.html#l00038">copy.h:38</a></div></div>
<div class="ttc" id="copy_8h_html_a648ee091378fa6c0f6f129f64fc7f22b"><div class="ttname"><a href="copy_8h.html#a648ee091378fa6c0f6f129f64fc7f22b">MUTT_CM_CHARCONV</a></div><div class="ttdeci">#define MUTT_CM_CHARCONV</div><div class="ttdoc">Perform character set conversions. </div><div class="ttdef"><b>Definition:</b> <a href="copy_8h_source.html#l00042">copy.h:42</a></div></div>
<div class="ttc" id="copy_8h_html_a2a289d0d9f4ec7e2b2e29a483a9f9759"><div class="ttname"><a href="copy_8h.html#a2a289d0d9f4ec7e2b2e29a483a9f9759">CH_XMIT</a></div><div class="ttdeci">#define CH_XMIT</div><div class="ttdoc">Transmitting this message? (Ignore Lines: and Content-Length:) </div><div class="ttdef"><b>Definition:</b> <a href="copy_8h_source.html#l00055">copy.h:55</a></div></div>
<div class="ttc" id="structBody_html_a0b87b7bdb6faef44d9aac4854975f805"><div class="ttname"><a href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">Body::parts</a></div><div class="ttdeci">struct Body * parts</div><div class="ttdoc">parts of a multipart or message/rfc822 </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00054">body.h:54</a></div></div>
<div class="ttc" id="structEmail_html_a570a81cd747437c9ea4357947731ae10"><div class="ttname"><a href="structEmail.html#a570a81cd747437c9ea4357947731ae10">Email::security</a></div><div class="ttdeci">SecurityFlags security</div><div class="ttdoc">bit 0-10: flags, bit 11,12: application, bit 13: traditional pgp See: ncrypt/lib.h pgplib...</div><div class="ttdef"><b>Definition:</b> <a href="email_8h_source.html#l00039">email.h:39</a></div></div>
<div class="ttc" id="structBody_html_af77d79aadb278bef8f2829c268f2486f"><div class="ttname"><a href="structBody.html#af77d79aadb278bef8f2829c268f2486f">Body::type</a></div><div class="ttdeci">unsigned int type</div><div class="ttdoc">content-type primary type, ContentType </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00065">body.h:65</a></div></div>
<div class="ttc" id="structEmail_html_a8d35ff6f232f83e89e2d46af416708cc"><div class="ttname"><a href="structEmail.html#a8d35ff6f232f83e89e2d46af416708cc">Email::offset</a></div><div class="ttdeci">LOFF_T offset</div><div class="ttdoc">Where in the stream does this message begin? </div><div class="ttdef"><b>Definition:</b> <a href="email_8h_source.html#l00084">email.h:84</a></div></div>
<div class="ttc" id="mime_8h_html_a3ccd048df649c335df5a7f82673bbc79a2cbb8dddd761b8bfba754d933a979c1b"><div class="ttname"><a href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79a2cbb8dddd761b8bfba754d933a979c1b">TYPE_MESSAGE</a></div><div class="ttdoc">Type: &amp;#39;message/*&amp;#39;. </div><div class="ttdef"><b>Definition:</b> <a href="mime_8h_source.html#l00035">mime.h:35</a></div></div>
<div class="ttc" id="structBody_html_a86721d1d557276cbc9cf69777af8c305"><div class="ttname"><a href="structBody.html#a86721d1d557276cbc9cf69777af8c305">Body::use_disp</a></div><div class="ttdeci">bool use_disp</div><div class="ttdoc">Content-Disposition uses filename= ? </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00068">body.h:68</a></div></div>
<div class="ttc" id="copy_8h_html_a88a40e8f238a8478b885c90d1ce53e9c"><div class="ttname"><a href="copy_8h.html#a88a40e8f238a8478b885c90d1ce53e9c">CopyHeaderFlags</a></div><div class="ttdeci">uint32_t CopyHeaderFlags</div><div class="ttdoc">Flags for mutt_copy_header(), e.g. CH_UPDATE. </div><div class="ttdef"><b>Definition:</b> <a href="copy_8h_source.html#l00050">copy.h:50</a></div></div>
<div class="ttc" id="crypt_8c_html_a159d0d34a10b662acb2cc80099e5ecc7"><div class="ttname"><a href="crypt_8c.html#a159d0d34a10b662acb2cc80099e5ecc7">mutt_is_application_pgp</a></div><div class="ttdeci">SecurityFlags mutt_is_application_pgp(struct Body *b)</div><div class="ttdoc">Does the message use PGP? </div><div class="ttdef"><b>Definition:</b> <a href="crypt_8c_source.html#l00565">crypt.c:565</a></div></div>
<div class="ttc" id="structBody_html_a47191eabf16d34d0deb412c898ed629b"><div class="ttname"><a href="structBody.html#a47191eabf16d34d0deb412c898ed629b">Body::unlink</a></div><div class="ttdeci">bool unlink</div><div class="ttdoc">If true, filename should be unlink()ed before free()ing this structure. </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00069">body.h:69</a></div></div>
<div class="ttc" id="structMessage_html_a11d53ee4319e8735c1677d8780a7b517"><div class="ttname"><a href="structMessage.html#a11d53ee4319e8735c1677d8780a7b517">Message::fp</a></div><div class="ttdeci">FILE * fp</div><div class="ttdoc">pointer to the message data </div><div class="ttdef"><b>Definition:</b> <a href="mxapi_8h_source.html#l00043">mxapi.h:43</a></div></div>
<div class="ttc" id="copy_8c_html_aa0dd608f4ed300454d97ac83ade160ac"><div class="ttname"><a href="copy_8c.html#aa0dd608f4ed300454d97ac83ade160ac">mutt_copy_message</a></div><div class="ttdeci">int mutt_copy_message(FILE *fp_out, struct Mailbox *m, struct Email *e, struct Message *msg, CopyMessageFlags cmflags, CopyHeaderFlags chflags, int wraplen)</div><div class="ttdoc">Copy a message from a Mailbox. </div><div class="ttdef"><b>Definition:</b> <a href="copy_8c_source.html#l00853">copy.c:853</a></div></div>
<div class="ttc" id="copy_8h_html_a47437a254e166c0484abce93068e1399"><div class="ttname"><a href="copy_8h.html#a47437a254e166c0484abce93068e1399">MUTT_CM_DECODE_PGP</a></div><div class="ttdeci">#define MUTT_CM_DECODE_PGP</div><div class="ttdoc">Used for decoding PGP messages. </div><div class="ttdef"><b>Definition:</b> <a href="copy_8h_source.html#l00045">copy.h:45</a></div></div>
<div class="ttc" id="file_8c_html_ae1c0c19fec03274220b3ca065ad1e2e5"><div class="ttname"><a href="file_8c.html#ae1c0c19fec03274220b3ca065ad1e2e5">mutt_file_fopen</a></div><div class="ttdeci">FILE * mutt_file_fopen(const char *path, const char *mode)</div><div class="ttdoc">Call fopen() safely. </div><div class="ttdef"><b>Definition:</b> <a href="file_8c_source.html#l00589">file.c:589</a></div></div>
<div class="ttc" id="mime_8h_html_a5f93dab7807282e699a6bc1b2d18a2d8a691faf938d6b4cec05ea5e03d9dee073"><div class="ttname"><a href="mime_8h.html#a5f93dab7807282e699a6bc1b2d18a2d8a691faf938d6b4cec05ea5e03d9dee073">DISP_INLINE</a></div><div class="ttdoc">Content is inline. </div><div class="ttdef"><b>Definition:</b> <a href="mime_8h_source.html#l00062">mime.h:62</a></div></div>
<div class="ttc" id="parse_8c_html_a32cd9ed48d31f100bd8525018e1450da"><div class="ttname"><a href="parse_8c.html#a32cd9ed48d31f100bd8525018e1450da">mutt_rfc822_read_header</a></div><div class="ttdeci">struct Envelope * mutt_rfc822_read_header(FILE *fp, struct Email *e, bool user_hdrs, bool weed)</div><div class="ttdoc">parses an RFC822 header </div><div class="ttdef"><b>Definition:</b> <a href="parse_8c_source.html#l01124">parse.c:1124</a></div></div>
<div class="ttc" id="structBody_html_a8e10ba22522218bd12bd3cb38dd3fcc9"><div class="ttname"><a href="structBody.html#a8e10ba22522218bd12bd3cb38dd3fcc9">Body::email</a></div><div class="ttdeci">struct Email * email</div><div class="ttdoc">header information for message/rfc822 </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00055">body.h:55</a></div></div>
<div class="ttc" id="mx_8c_html_a7df2f9d4d83ce9fca2cf48e08f8a4bc0"><div class="ttname"><a href="mx_8c.html#a7df2f9d4d83ce9fca2cf48e08f8a4bc0">mx_msg_open</a></div><div class="ttdeci">struct Message * mx_msg_open(struct Mailbox *m, int msgno)</div><div class="ttdoc">return a stream pointer for a message </div><div class="ttdef"><b>Definition:</b> <a href="mx_8c_source.html#l01140">mx.c:1140</a></div></div>
<div class="ttc" id="copy_8h_html_a5456d9b0419ab775a33967dcdb978a3d"><div class="ttname"><a href="copy_8h.html#a5456d9b0419ab775a33967dcdb978a3d">CH_NONEWLINE</a></div><div class="ttdeci">#define CH_NONEWLINE</div><div class="ttdoc">Don&amp;#39;t output terminating newline after the header. </div><div class="ttdef"><b>Definition:</b> <a href="copy_8h_source.html#l00060">copy.h:60</a></div></div>
<div class="ttc" id="structEmail_html_abd3d551204f4ea232a304c1c4c4c149d"><div class="ttname"><a href="structEmail.html#abd3d551204f4ea232a304c1c4c4c149d">Email::msgno</a></div><div class="ttdeci">int msgno</div><div class="ttdoc">Number displayed to the user. </div><div class="ttdef"><b>Definition:</b> <a href="email_8h_source.html#l00087">email.h:87</a></div></div>
</div><!-- fragment --><div id="dynsection-12" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-12-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-12-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-12-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="sendlib_8h_ac8ddd58faaec9226b8af76db09d4155c_cgraph.svg" width="655" height="959"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div id="dynsection-13" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-13-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-13-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-13-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="sendlib_8h_ac8ddd58faaec9226b8af76db09d4155c_icgraph.svg" width="432" height="88"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a8a303061e1e0c0ea966b224a5c1d3b64"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a303061e1e0c0ea966b224a5c1d3b64">&#9670;&nbsp;</a></span>mutt_message_to_7bit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mutt_message_to_7bit </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structBody.html">Body</a> *&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>fp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structConfigSubset.html">ConfigSubset</a> *&#160;</td>
          <td class="paramname"><em>sub</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Convert an email's MIME parts to 7-bit. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">a</td><td><a class="el" href="structBody.html" title="The body of an email. ">Body</a> of the email </td></tr>
    <tr><td class="paramname">fp</td><td>File to read (OPTIONAL) </td></tr>
    <tr><td class="paramname">sub</td><td>Config Subset </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="sendlib_8c_source.html#l00747">747</a> of file <a class="el" href="sendlib_8c_source.html">sendlib.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;{</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;  <span class="keyword">struct </span><a class="code" href="structBuffer.html">Buffer</a> temp = <a class="code" href="buffer_8c.html#a0242aaa9a400d0722a99828776c0403b">mutt_buffer_make</a>(0);</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;  FILE *fp_in = NULL;</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;  FILE *fp_out = NULL;</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;  <span class="keyword">struct </span>stat sb;</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;  <span class="keywordflow">if</span> (!a-&gt;<a class="code" href="structBody.html#afe3cd2c4b1070e3d0edbf1fed939ac5a">filename</a> &amp;&amp; fp)</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;    fp_in = fp;</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!a-&gt;<a class="code" href="structBody.html#afe3cd2c4b1070e3d0edbf1fed939ac5a">filename</a> || !(fp_in = fopen(a-&gt;<a class="code" href="structBody.html#afe3cd2c4b1070e3d0edbf1fed939ac5a">filename</a>, <span class="stringliteral">&quot;r&quot;</span>)))</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;  {</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;    <a class="code" href="group__logging__api.html#gacc1fd6d7ab1603e80e11e84e90d061e4">mutt_error</a>(<a class="code" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Could not open %s&quot;</span>), a-&gt;<a class="code" href="structBody.html#afe3cd2c4b1070e3d0edbf1fed939ac5a">filename</a> ? a-&gt;<a class="code" href="structBody.html#afe3cd2c4b1070e3d0edbf1fed939ac5a">filename</a> : <span class="stringliteral">&quot;(null)&quot;</span>);</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;  }</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;  {</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;    a-&gt;<a class="code" href="structBody.html#a1969dfeb0a155ccb16153fe777a103b0">offset</a> = 0;</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;    <span class="keywordflow">if</span> (stat(a-&gt;<a class="code" href="structBody.html#afe3cd2c4b1070e3d0edbf1fed939ac5a">filename</a>, &amp;sb) == -1)</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;    {</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;      <a class="code" href="group__logging__api.html#gafaa521ab22db877ccf1b87e679e1b43e">mutt_perror</a>(<span class="stringliteral">&quot;stat&quot;</span>);</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;      <a class="code" href="file_8c.html#a31f49795ff5b9558db5476e5777e63b6">mutt_file_fclose</a>(&amp;fp_in);</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;      <span class="keywordflow">goto</span> cleanup;</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;    }</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;    a-&gt;<a class="code" href="structBody.html#a6f92d7ec8568ca04ae07931c56dd0790">length</a> = sb.st_size;</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;  }</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;  <span class="comment">/* Avoid buffer pool due to recursion */</span></div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;  <a class="code" href="muttlib_8h.html#a7f1db9db6f710a84cace77248096e2ac">mutt_buffer_mktemp</a>(&amp;temp);</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;  fp_out = <a class="code" href="file_8c.html#ae1c0c19fec03274220b3ca065ad1e2e5">mutt_file_fopen</a>(<a class="code" href="buffer_8h.html#a4aca040fb75bc1dfc086cbfbf14ac8cd">mutt_buffer_string</a>(&amp;temp), <span class="stringliteral">&quot;w+&quot;</span>);</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;  <span class="keywordflow">if</span> (!fp_out)</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;  {</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;    <a class="code" href="group__logging__api.html#gafaa521ab22db877ccf1b87e679e1b43e">mutt_perror</a>(<span class="stringliteral">&quot;fopen&quot;</span>);</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;    <span class="keywordflow">goto</span> cleanup;</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;  }</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;  fseeko(fp_in, a-&gt;<a class="code" href="structBody.html#a1969dfeb0a155ccb16153fe777a103b0">offset</a>, SEEK_SET);</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;  a-&gt;<a class="code" href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">parts</a> = <a class="code" href="parse_8c.html#ad06e310e34e4b864ba64ee9301c57664">mutt_rfc822_parse_message</a>(fp_in, a);</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;  <a class="code" href="sendlib_8c.html#aca446833041a05b67ddc60b40d558bea">transform_to_7bit</a>(a-&gt;<a class="code" href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">parts</a>, fp_in, sub);</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;  <a class="code" href="copy_8c.html#a52e9f9a52a91efbaeca673868cfc8b93">mutt_copy_hdr</a>(fp_in, fp_out, a-&gt;<a class="code" href="structBody.html#a1969dfeb0a155ccb16153fe777a103b0">offset</a>, a-&gt;<a class="code" href="structBody.html#a1969dfeb0a155ccb16153fe777a103b0">offset</a> + a-&gt;<a class="code" href="structBody.html#a6f92d7ec8568ca04ae07931c56dd0790">length</a>,</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;                <a class="code" href="copy_8h.html#a7eafef308595ca62d50bb0087ee605ce">CH_MIME</a> | <a class="code" href="copy_8h.html#a5456d9b0419ab775a33967dcdb978a3d">CH_NONEWLINE</a> | <a class="code" href="copy_8h.html#a2a289d0d9f4ec7e2b2e29a483a9f9759">CH_XMIT</a>, NULL, 0);</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;  fputs(<span class="stringliteral">&quot;MIME-Version: 1.0\n&quot;</span>, fp_out);</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;  <a class="code" href="header_8c.html#a8508813ef9f3b0de339ee10b1f788b32">mutt_write_mime_header</a>(a-&gt;<a class="code" href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">parts</a>, fp_out, sub);</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;  fputc(<span class="charliteral">&#39;\n&#39;</span>, fp_out);</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;  <a class="code" href="send_2body_8c.html#a7ed09e9904a3693633204577be91f413">mutt_write_mime_body</a>(a-&gt;<a class="code" href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">parts</a>, fp_out, sub);</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;  <span class="keywordflow">if</span> (fp_in != fp)</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;    <a class="code" href="file_8c.html#a31f49795ff5b9558db5476e5777e63b6">mutt_file_fclose</a>(&amp;fp_in);</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;  <a class="code" href="file_8c.html#a31f49795ff5b9558db5476e5777e63b6">mutt_file_fclose</a>(&amp;fp_out);</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;  a-&gt;<a class="code" href="structBody.html#ad2f05b8ff24813de41988e63de5d6a31">encoding</a> = <a class="code" href="mime_8h.html#a1757cddbe4d3d273bf8fbffde3489a61a0bc13f416d890a95b7d7e7c77b155f8e">ENC_7BIT</a>;</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;  <a class="code" href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;a-&gt;<a class="code" href="structBody.html#a0a77f105609a64f37c359b9c81d1f263">d_filename</a>);</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;  a-&gt;<a class="code" href="structBody.html#a0a77f105609a64f37c359b9c81d1f263">d_filename</a> = a-&gt;<a class="code" href="structBody.html#afe3cd2c4b1070e3d0edbf1fed939ac5a">filename</a>;</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;  <span class="keywordflow">if</span> (a-&gt;<a class="code" href="structBody.html#afe3cd2c4b1070e3d0edbf1fed939ac5a">filename</a> &amp;&amp; a-&gt;<a class="code" href="structBody.html#a47191eabf16d34d0deb412c898ed629b">unlink</a>)</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;    unlink(a-&gt;<a class="code" href="structBody.html#afe3cd2c4b1070e3d0edbf1fed939ac5a">filename</a>);</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;  a-&gt;<a class="code" href="structBody.html#afe3cd2c4b1070e3d0edbf1fed939ac5a">filename</a> = <a class="code" href="buffer_8c.html#aa43f3cb9584746ca0cf6720ac1fc38e7">mutt_buffer_strdup</a>(&amp;temp);</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;  a-&gt;<a class="code" href="structBody.html#a47191eabf16d34d0deb412c898ed629b">unlink</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;  <span class="keywordflow">if</span> (stat(a-&gt;<a class="code" href="structBody.html#afe3cd2c4b1070e3d0edbf1fed939ac5a">filename</a>, &amp;sb) == -1)</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;  {</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;    <a class="code" href="group__logging__api.html#gafaa521ab22db877ccf1b87e679e1b43e">mutt_perror</a>(<span class="stringliteral">&quot;stat&quot;</span>);</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;    <span class="keywordflow">goto</span> cleanup;</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;  }</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;  a-&gt;<a class="code" href="structBody.html#a6f92d7ec8568ca04ae07931c56dd0790">length</a> = sb.st_size;</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;  <a class="code" href="email_2body_8c.html#a129af1c316fcbc26b55fb48957bab2cb">mutt_body_free</a>(&amp;a-&gt;<a class="code" href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">parts</a>);</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;  a-&gt;<a class="code" href="structBody.html#a8e10ba22522218bd12bd3cb38dd3fcc9">email</a>-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a> = NULL;</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;cleanup:</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;  <span class="keywordflow">if</span> (fp_in &amp;&amp; (fp_in != fp))</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;    <a class="code" href="file_8c.html#a31f49795ff5b9558db5476e5777e63b6">mutt_file_fclose</a>(&amp;fp_in);</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;  <span class="keywordflow">if</span> (fp_out)</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;  {</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;    <a class="code" href="file_8c.html#a31f49795ff5b9558db5476e5777e63b6">mutt_file_fclose</a>(&amp;fp_out);</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;    <a class="code" href="file_8c.html#ae57463c2854c006a3c67b78736e9056e">mutt_file_unlink</a>(<a class="code" href="buffer_8h.html#a4aca040fb75bc1dfc086cbfbf14ac8cd">mutt_buffer_string</a>(&amp;temp));</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;  }</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;  <a class="code" href="buffer_8c.html#a59b13bca38b1b314e2bc5ad142d2df49">mutt_buffer_dealloc</a>(&amp;temp);</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;}</div><div class="ttc" id="muttlib_8h_html_a7f1db9db6f710a84cace77248096e2ac"><div class="ttname"><a href="muttlib_8h.html#a7f1db9db6f710a84cace77248096e2ac">mutt_buffer_mktemp</a></div><div class="ttdeci">#define mutt_buffer_mktemp(buf)</div><div class="ttdef"><b>Definition:</b> <a href="muttlib_8h_source.html#l00074">muttlib.h:74</a></div></div>
<div class="ttc" id="copy_8h_html_a7eafef308595ca62d50bb0087ee605ce"><div class="ttname"><a href="copy_8h.html#a7eafef308595ca62d50bb0087ee605ce">CH_MIME</a></div><div class="ttdeci">#define CH_MIME</div><div class="ttdoc">Ignore MIME fields. </div><div class="ttdef"><b>Definition:</b> <a href="copy_8h_source.html#l00061">copy.h:61</a></div></div>
<div class="ttc" id="structBody_html_afe3cd2c4b1070e3d0edbf1fed939ac5a"><div class="ttname"><a href="structBody.html#afe3cd2c4b1070e3d0edbf1fed939ac5a">Body::filename</a></div><div class="ttdeci">char * filename</div><div class="ttdoc">when sending a message, this is the file to which this structure refers </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00046">body.h:46</a></div></div>
<div class="ttc" id="structEmail_html_a57ad6ac618c0f685804f6f5bb390b3a6"><div class="ttname"><a href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">Email::body</a></div><div class="ttdeci">struct Body * body</div><div class="ttdoc">List of MIME parts. </div><div class="ttdef"><b>Definition:</b> <a href="email_8h_source.html#l00091">email.h:91</a></div></div>
<div class="ttc" id="group__logging__api_html_gacc1fd6d7ab1603e80e11e84e90d061e4"><div class="ttname"><a href="group__logging__api.html#gacc1fd6d7ab1603e80e11e84e90d061e4">mutt_error</a></div><div class="ttdeci">#define mutt_error(...)</div><div class="ttdef"><b>Definition:</b> <a href="logging_8h_source.html#l00088">logging.h:88</a></div></div>
<div class="ttc" id="buffer_8c_html_aa43f3cb9584746ca0cf6720ac1fc38e7"><div class="ttname"><a href="buffer_8c.html#aa43f3cb9584746ca0cf6720ac1fc38e7">mutt_buffer_strdup</a></div><div class="ttdeci">char * mutt_buffer_strdup(const struct Buffer *buf)</div><div class="ttdoc">Copy a Buffer&amp;#39;s string. </div><div class="ttdef"><b>Definition:</b> <a href="buffer_8c_source.html#l00432">buffer.c:432</a></div></div>
<div class="ttc" id="mime_8h_html_a1757cddbe4d3d273bf8fbffde3489a61a0bc13f416d890a95b7d7e7c77b155f8e"><div class="ttname"><a href="mime_8h.html#a1757cddbe4d3d273bf8fbffde3489a61a0bc13f416d890a95b7d7e7c77b155f8e">ENC_7BIT</a></div><div class="ttdoc">7-bit text </div><div class="ttdef"><b>Definition:</b> <a href="mime_8h_source.html#l00049">mime.h:49</a></div></div>
<div class="ttc" id="send_2body_8c_html_a7ed09e9904a3693633204577be91f413"><div class="ttname"><a href="send_2body_8c.html#a7ed09e9904a3693633204577be91f413">mutt_write_mime_body</a></div><div class="ttdeci">int mutt_write_mime_body(struct Body *a, FILE *fp, struct ConfigSubset *sub)</div><div class="ttdoc">Write a MIME part. </div><div class="ttdef"><b>Definition:</b> <a href="send_2body_8c_source.html#l00314">body.c:314</a></div></div>
<div class="ttc" id="file_8c_html_ae57463c2854c006a3c67b78736e9056e"><div class="ttname"><a href="file_8c.html#ae57463c2854c006a3c67b78736e9056e">mutt_file_unlink</a></div><div class="ttdeci">void mutt_file_unlink(const char *s)</div><div class="ttdoc">Delete a file, carefully. </div><div class="ttdef"><b>Definition:</b> <a href="file_8c_source.html#l00195">file.c:195</a></div></div>
<div class="ttc" id="buffer_8c_html_a0242aaa9a400d0722a99828776c0403b"><div class="ttname"><a href="buffer_8c.html#a0242aaa9a400d0722a99828776c0403b">mutt_buffer_make</a></div><div class="ttdeci">struct Buffer mutt_buffer_make(size_t size)</div><div class="ttdoc">Make a new buffer on the stack. </div><div class="ttdef"><b>Definition:</b> <a href="buffer_8c_source.html#l00061">buffer.c:61</a></div></div>
<div class="ttc" id="structBuffer_html"><div class="ttname"><a href="structBuffer.html">Buffer</a></div><div class="ttdoc">String manipulation buffer. </div><div class="ttdef"><b>Definition:</b> <a href="buffer_8h_source.html#l00033">buffer.h:33</a></div></div>
<div class="ttc" id="structBody_html_a1969dfeb0a155ccb16153fe777a103b0"><div class="ttname"><a href="structBody.html#a1969dfeb0a155ccb16153fe777a103b0">Body::offset</a></div><div class="ttdeci">LOFF_T offset</div><div class="ttdoc">offset where the actual data begins </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00044">body.h:44</a></div></div>
<div class="ttc" id="mutt_2message_8h_html_a479d658dfd60fe8d9709ec67a58b34ca"><div class="ttname"><a href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a></div><div class="ttdeci">#define _(a)</div><div class="ttdef"><b>Definition:</b> <a href="mutt_2message_8h_source.html#l00028">message.h:28</a></div></div>
<div class="ttc" id="group__logging__api_html_gafaa521ab22db877ccf1b87e679e1b43e"><div class="ttname"><a href="group__logging__api.html#gafaa521ab22db877ccf1b87e679e1b43e">mutt_perror</a></div><div class="ttdeci">#define mutt_perror(...)</div><div class="ttdef"><b>Definition:</b> <a href="logging_8h_source.html#l00089">logging.h:89</a></div></div>
<div class="ttc" id="buffer_8h_html_a4aca040fb75bc1dfc086cbfbf14ac8cd"><div class="ttname"><a href="buffer_8h.html#a4aca040fb75bc1dfc086cbfbf14ac8cd">mutt_buffer_string</a></div><div class="ttdeci">static const char * mutt_buffer_string(const struct Buffer *buf)</div><div class="ttdoc">Convert a buffer to a const char * &quot;string&quot;. </div><div class="ttdef"><b>Definition:</b> <a href="buffer_8h_source.html#l00077">buffer.h:77</a></div></div>
<div class="ttc" id="parse_8c_html_ad06e310e34e4b864ba64ee9301c57664"><div class="ttname"><a href="parse_8c.html#ad06e310e34e4b864ba64ee9301c57664">mutt_rfc822_parse_message</a></div><div class="ttdeci">struct Body * mutt_rfc822_parse_message(FILE *fp, struct Body *parent)</div><div class="ttdoc">parse a Message/RFC822 body </div><div class="ttdef"><b>Definition:</b> <a href="parse_8c_source.html#l01693">parse.c:1693</a></div></div>
<div class="ttc" id="file_8c_html_a31f49795ff5b9558db5476e5777e63b6"><div class="ttname"><a href="file_8c.html#a31f49795ff5b9558db5476e5777e63b6">mutt_file_fclose</a></div><div class="ttdeci">int mutt_file_fclose(FILE **fp)</div><div class="ttdoc">Close a FILE handle (and NULL the pointer) </div><div class="ttdef"><b>Definition:</b> <a href="file_8c_source.html#l00153">file.c:153</a></div></div>
<div class="ttc" id="buffer_8c_html_a59b13bca38b1b314e2bc5ad142d2df49"><div class="ttname"><a href="buffer_8c.html#a59b13bca38b1b314e2bc5ad142d2df49">mutt_buffer_dealloc</a></div><div class="ttdeci">void mutt_buffer_dealloc(struct Buffer *buf)</div><div class="ttdoc">Release the memory allocated by a buffer. </div><div class="ttdef"><b>Definition:</b> <a href="buffer_8c_source.html#l00294">buffer.c:294</a></div></div>
<div class="ttc" id="header_8c_html_a8508813ef9f3b0de339ee10b1f788b32"><div class="ttname"><a href="header_8c.html#a8508813ef9f3b0de339ee10b1f788b32">mutt_write_mime_header</a></div><div class="ttdeci">int mutt_write_mime_header(struct Body *a, FILE *fp, struct ConfigSubset *sub)</div><div class="ttdoc">Create a MIME header. </div><div class="ttdef"><b>Definition:</b> <a href="header_8c_source.html#l00764">header.c:764</a></div></div>
<div class="ttc" id="structBody_html_ad2f05b8ff24813de41988e63de5d6a31"><div class="ttname"><a href="structBody.html#ad2f05b8ff24813de41988e63de5d6a31">Body::encoding</a></div><div class="ttdeci">unsigned int encoding</div><div class="ttdoc">content-transfer-encoding, ContentEncoding </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00066">body.h:66</a></div></div>
<div class="ttc" id="structBody_html_a6f92d7ec8568ca04ae07931c56dd0790"><div class="ttname"><a href="structBody.html#a6f92d7ec8568ca04ae07931c56dd0790">Body::length</a></div><div class="ttdeci">LOFF_T length</div><div class="ttdoc">length (in bytes) of attachment </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00045">body.h:45</a></div></div>
<div class="ttc" id="copy_8h_html_a2a289d0d9f4ec7e2b2e29a483a9f9759"><div class="ttname"><a href="copy_8h.html#a2a289d0d9f4ec7e2b2e29a483a9f9759">CH_XMIT</a></div><div class="ttdeci">#define CH_XMIT</div><div class="ttdoc">Transmitting this message? (Ignore Lines: and Content-Length:) </div><div class="ttdef"><b>Definition:</b> <a href="copy_8h_source.html#l00055">copy.h:55</a></div></div>
<div class="ttc" id="structBody_html_a0b87b7bdb6faef44d9aac4854975f805"><div class="ttname"><a href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">Body::parts</a></div><div class="ttdeci">struct Body * parts</div><div class="ttdoc">parts of a multipart or message/rfc822 </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00054">body.h:54</a></div></div>
<div class="ttc" id="email_2body_8c_html_a129af1c316fcbc26b55fb48957bab2cb"><div class="ttname"><a href="email_2body_8c.html#a129af1c316fcbc26b55fb48957bab2cb">mutt_body_free</a></div><div class="ttdeci">void mutt_body_free(struct Body **ptr)</div><div class="ttdoc">Free a Body. </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8c_source.html#l00057">body.c:57</a></div></div>
<div class="ttc" id="sendlib_8c_html_aca446833041a05b67ddc60b40d558bea"><div class="ttname"><a href="sendlib_8c.html#aca446833041a05b67ddc60b40d558bea">transform_to_7bit</a></div><div class="ttdeci">static void transform_to_7bit(struct Body *a, FILE *fp_in, struct ConfigSubset *sub)</div><div class="ttdoc">Convert MIME parts to 7-bit. </div><div class="ttdef"><b>Definition:</b> <a href="sendlib_8c_source.html#l00684">sendlib.c:684</a></div></div>
<div class="ttc" id="structBody_html_a47191eabf16d34d0deb412c898ed629b"><div class="ttname"><a href="structBody.html#a47191eabf16d34d0deb412c898ed629b">Body::unlink</a></div><div class="ttdeci">bool unlink</div><div class="ttdoc">If true, filename should be unlink()ed before free()ing this structure. </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00069">body.h:69</a></div></div>
<div class="ttc" id="copy_8c_html_a52e9f9a52a91efbaeca673868cfc8b93"><div class="ttname"><a href="copy_8c.html#a52e9f9a52a91efbaeca673868cfc8b93">mutt_copy_hdr</a></div><div class="ttdeci">int mutt_copy_hdr(FILE *fp_in, FILE *fp_out, LOFF_T off_start, LOFF_T off_end, CopyHeaderFlags chflags, const char *prefix, int wraplen)</div><div class="ttdoc">Copy header from one file to another. </div><div class="ttdef"><b>Definition:</b> <a href="copy_8c_source.html#l00104">copy.c:104</a></div></div>
<div class="ttc" id="memory_8h_html_a25875003b43b81a4302256caa4a13599"><div class="ttname"><a href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a></div><div class="ttdeci">#define FREE(x)</div><div class="ttdef"><b>Definition:</b> <a href="memory_8h_source.html#l00040">memory.h:40</a></div></div>
<div class="ttc" id="structBody_html_a0a77f105609a64f37c359b9c81d1f263"><div class="ttname"><a href="structBody.html#a0a77f105609a64f37c359b9c81d1f263">Body::d_filename</a></div><div class="ttdeci">char * d_filename</div><div class="ttdoc">filename to be used for the content-disposition header. </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00047">body.h:47</a></div></div>
<div class="ttc" id="file_8c_html_ae1c0c19fec03274220b3ca065ad1e2e5"><div class="ttname"><a href="file_8c.html#ae1c0c19fec03274220b3ca065ad1e2e5">mutt_file_fopen</a></div><div class="ttdeci">FILE * mutt_file_fopen(const char *path, const char *mode)</div><div class="ttdoc">Call fopen() safely. </div><div class="ttdef"><b>Definition:</b> <a href="file_8c_source.html#l00589">file.c:589</a></div></div>
<div class="ttc" id="structBody_html_a8e10ba22522218bd12bd3cb38dd3fcc9"><div class="ttname"><a href="structBody.html#a8e10ba22522218bd12bd3cb38dd3fcc9">Body::email</a></div><div class="ttdeci">struct Email * email</div><div class="ttdoc">header information for message/rfc822 </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00055">body.h:55</a></div></div>
<div class="ttc" id="copy_8h_html_a5456d9b0419ab775a33967dcdb978a3d"><div class="ttname"><a href="copy_8h.html#a5456d9b0419ab775a33967dcdb978a3d">CH_NONEWLINE</a></div><div class="ttdeci">#define CH_NONEWLINE</div><div class="ttdoc">Don&amp;#39;t output terminating newline after the header. </div><div class="ttdef"><b>Definition:</b> <a href="copy_8h_source.html#l00060">copy.h:60</a></div></div>
</div><!-- fragment --><div id="dynsection-14" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-14-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-14-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-14-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="sendlib_8h_a8a303061e1e0c0ea966b224a5c1d3b64_cgraph.svg" width="679" height="694"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div id="dynsection-15" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-15-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-15-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-15-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="sendlib_8h_a8a303061e1e0c0ea966b224a5c1d3b64_icgraph.svg" width="392" height="163"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="ac35da3d19eb0d95d4f6260adab57b4c9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac35da3d19eb0d95d4f6260adab57b4c9">&#9670;&nbsp;</a></span>mutt_prepare_envelope()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mutt_prepare_envelope </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structEnvelope.html">Envelope</a> *&#160;</td>
          <td class="paramname"><em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>final</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structConfigSubset.html">ConfigSubset</a> *&#160;</td>
          <td class="paramname"><em>sub</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Prepare an email header. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">env</td><td><a class="el" href="structEnvelope.html" title="The header of an Email. ">Envelope</a> to prepare </td></tr>
    <tr><td class="paramname">final</td><td>true if this email is going to be sent (not postponed) </td></tr>
    <tr><td class="paramname">sub</td><td>Config Subset</td></tr>
  </table>
  </dd>
</dl>
<p>Encode all the headers prior to sending the email.</p>
<p>For postponing (!final) do the necessary encodings only </p>

<p class="definition">Definition at line <a class="el" href="sendlib_8c_source.html#l01243">1243</a> of file <a class="el" href="sendlib_8c_source.html">sendlib.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;{</div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">final</span>)</div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;  {</div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="queue_8h.html#ac3c9da7ac712eacbbad5cc54d7a3477e">TAILQ_EMPTY</a>(&amp;env-&gt;<a class="code" href="structEnvelope.html#aad427832f4ae422f1b16d0896c1d3af6">bcc</a>) &amp;&amp; <a class="code" href="queue_8h.html#ac3c9da7ac712eacbbad5cc54d7a3477e">TAILQ_EMPTY</a>(&amp;env-&gt;<a class="code" href="structEnvelope.html#a2d927371b3b80e025d6f7522b7361fe7">to</a>) &amp;&amp; <a class="code" href="queue_8h.html#ac3c9da7ac712eacbbad5cc54d7a3477e">TAILQ_EMPTY</a>(&amp;env-&gt;<a class="code" href="structEnvelope.html#a6b00837b3cb4b41898b42307135be8b6">cc</a>))</div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;    {</div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;      <span class="comment">/* some MTA&#39;s will put an Apparently-To: header field showing the Bcc:</span></div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;<span class="comment">       * recipients if there is no To: or Cc: field, so attempt to suppress</span></div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;<span class="comment">       * it by using an empty To: field.  */</span></div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;      <span class="keyword">struct </span><a class="code" href="structAddress.html">Address</a> *to = <a class="code" href="address_2address_8c.html#ac9b323dadeb2a55ce6e9cd4763b9d832">mutt_addr_new</a>();</div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;      to-&gt;<a class="code" href="structAddress.html#a12bd44ccc016e50c674ec3a902ba1c28">group</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;      <a class="code" href="address_2address_8c.html#a68385b174baad74a9aecf3dec61432a0">mutt_addrlist_append</a>(&amp;env-&gt;<a class="code" href="structEnvelope.html#a2d927371b3b80e025d6f7522b7361fe7">to</a>, to);</div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;      <a class="code" href="address_2address_8c.html#a68385b174baad74a9aecf3dec61432a0">mutt_addrlist_append</a>(&amp;env-&gt;<a class="code" href="structEnvelope.html#a2d927371b3b80e025d6f7522b7361fe7">to</a>, <a class="code" href="address_2address_8c.html#ac9b323dadeb2a55ce6e9cd4763b9d832">mutt_addr_new</a>());</div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;</div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;      <span class="keywordtype">char</span> buf[1024];</div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;      buf[0] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;      <a class="code" href="address_2address_8c.html#a5fc8a0b1e781c6e88f43f86d0ede02d2">mutt_addr_cat</a>(buf, <span class="keyword">sizeof</span>(buf), <span class="stringliteral">&quot;undisclosed-recipients&quot;</span>, <a class="code" href="address_2address_8c.html#a930029e50328c7a0b48e302ef87fe023">AddressSpecials</a>);</div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;</div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;      to-&gt;<a class="code" href="structAddress.html#a8ea3ae93a2550c76c392a9001dbbaefd">mailbox</a> = <a class="code" href="mutt_2string_8c.html#a4c2560f787bd1226b977992c16860c98">mutt_str_dup</a>(buf);</div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;    }</div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;</div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;    <a class="code" href="send_8c.html#afa20b4cc93fe3d7cbc02675afeddcad4">mutt_set_followup_to</a>(env, sub);</div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;</div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;    <span class="keywordflow">if</span> (!env-&gt;<a class="code" href="structEnvelope.html#a50418c13a849bf27b22922bd5867e5e1">message_id</a>)</div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;      env-&gt;<a class="code" href="structEnvelope.html#a50418c13a849bf27b22922bd5867e5e1">message_id</a> = <a class="code" href="sendlib_8c.html#a73d572ce5f64fd507832a9eec3bcaa77">gen_msgid</a>(sub);</div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;  }</div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;</div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;  <span class="comment">/* Take care of 8-bit =&gt; 7-bit conversion. */</span></div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;  <a class="code" href="rfc2047_8c.html#aceeb3a044de1c06a649af033af856486">rfc2047_encode_envelope</a>(env);</div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;  <a class="code" href="sendlib_8c.html#aa1af343d35a3c9f6c0db18928db0ff6d">encode_headers</a>(&amp;env-&gt;<a class="code" href="structEnvelope.html#a005f4bd665ae1ae362add27948753fe1">userhdrs</a>, sub);</div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;}</div><div class="ttc" id="rfc2047_8c_html_aceeb3a044de1c06a649af033af856486"><div class="ttname"><a href="rfc2047_8c.html#aceeb3a044de1c06a649af033af856486">rfc2047_encode_envelope</a></div><div class="ttdeci">void rfc2047_encode_envelope(struct Envelope *env)</div><div class="ttdoc">Encode the fields of an Envelope. </div><div class="ttdef"><b>Definition:</b> <a href="rfc2047_8c_source.html#l00807">rfc2047.c:807</a></div></div>
<div class="ttc" id="address_2address_8c_html_a930029e50328c7a0b48e302ef87fe023"><div class="ttname"><a href="address_2address_8c.html#a930029e50328c7a0b48e302ef87fe023">AddressSpecials</a></div><div class="ttdeci">const char AddressSpecials[]</div><div class="ttdoc">Characters with special meaning for email addresses. </div><div class="ttdef"><b>Definition:</b> <a href="address_2address_8c_source.html#l00042">address.c:42</a></div></div>
<div class="ttc" id="structEnvelope_html_aad427832f4ae422f1b16d0896c1d3af6"><div class="ttname"><a href="structEnvelope.html#aad427832f4ae422f1b16d0896c1d3af6">Envelope::bcc</a></div><div class="ttdeci">struct AddressList bcc</div><div class="ttdoc">Email&amp;#39;s &amp;#39;Bcc&amp;#39; list. </div><div class="ttdef"><b>Definition:</b> <a href="envelope_8h_source.html#l00060">envelope.h:60</a></div></div>
<div class="ttc" id="sendlib_8c_html_aa1af343d35a3c9f6c0db18928db0ff6d"><div class="ttname"><a href="sendlib_8c.html#aa1af343d35a3c9f6c0db18928db0ff6d">encode_headers</a></div><div class="ttdeci">static void encode_headers(struct ListHead *h, struct ConfigSubset *sub)</div><div class="ttdoc">RFC2047-encode a list of headers. </div><div class="ttdef"><b>Definition:</b> <a href="sendlib_8c_source.html#l01147">sendlib.c:1147</a></div></div>
<div class="ttc" id="mutt_2string_8c_html_a4c2560f787bd1226b977992c16860c98"><div class="ttname"><a href="mutt_2string_8c.html#a4c2560f787bd1226b977992c16860c98">mutt_str_dup</a></div><div class="ttdeci">char * mutt_str_dup(const char *str)</div><div class="ttdoc">Copy a string, safely. </div><div class="ttdef"><b>Definition:</b> <a href="mutt_2string_8c_source.html#l00370">string.c:370</a></div></div>
<div class="ttc" id="structEnvelope_html_a005f4bd665ae1ae362add27948753fe1"><div class="ttname"><a href="structEnvelope.html#a005f4bd665ae1ae362add27948753fe1">Envelope::userhdrs</a></div><div class="ttdeci">struct ListHead userhdrs</div><div class="ttdoc">user defined headers </div><div class="ttdef"><b>Definition:</b> <a href="envelope_8h_source.html#l00083">envelope.h:83</a></div></div>
<div class="ttc" id="address_2address_8c_html_ac9b323dadeb2a55ce6e9cd4763b9d832"><div class="ttname"><a href="address_2address_8c.html#ac9b323dadeb2a55ce6e9cd4763b9d832">mutt_addr_new</a></div><div class="ttdeci">struct Address * mutt_addr_new(void)</div><div class="ttdoc">Create a new Address. </div><div class="ttdef"><b>Definition:</b> <a href="address_2address_8c_source.html#l00385">address.c:385</a></div></div>
<div class="ttc" id="structAddress_html"><div class="ttname"><a href="structAddress.html">Address</a></div><div class="ttdoc">An email address. </div><div class="ttdef"><b>Definition:</b> <a href="address_2address_8h_source.html#l00035">address.h:35</a></div></div>
<div class="ttc" id="structAddress_html_a8ea3ae93a2550c76c392a9001dbbaefd"><div class="ttname"><a href="structAddress.html#a8ea3ae93a2550c76c392a9001dbbaefd">Address::mailbox</a></div><div class="ttdeci">char * mailbox</div><div class="ttdoc">Mailbox and host address. </div><div class="ttdef"><b>Definition:</b> <a href="address_2address_8h_source.html#l00038">address.h:38</a></div></div>
<div class="ttc" id="structEnvelope_html_a50418c13a849bf27b22922bd5867e5e1"><div class="ttname"><a href="structEnvelope.html#a50418c13a849bf27b22922bd5867e5e1">Envelope::message_id</a></div><div class="ttdeci">char * message_id</div><div class="ttdoc">Message ID. </div><div class="ttdef"><b>Definition:</b> <a href="envelope_8h_source.html#l00069">envelope.h:69</a></div></div>
<div class="ttc" id="sendlib_8c_html_a73d572ce5f64fd507832a9eec3bcaa77"><div class="ttname"><a href="sendlib_8c.html#a73d572ce5f64fd507832a9eec3bcaa77">gen_msgid</a></div><div class="ttdeci">static char * gen_msgid(struct ConfigSubset *sub)</div><div class="ttdoc">Generate a unique Message ID. </div><div class="ttdef"><b>Definition:</b> <a href="sendlib_8c_source.html#l01216">sendlib.c:1216</a></div></div>
<div class="ttc" id="structEnvelope_html_a6b00837b3cb4b41898b42307135be8b6"><div class="ttname"><a href="structEnvelope.html#a6b00837b3cb4b41898b42307135be8b6">Envelope::cc</a></div><div class="ttdeci">struct AddressList cc</div><div class="ttdoc">Email&amp;#39;s &amp;#39;Cc&amp;#39; list. </div><div class="ttdef"><b>Definition:</b> <a href="envelope_8h_source.html#l00059">envelope.h:59</a></div></div>
<div class="ttc" id="send_8c_html_afa20b4cc93fe3d7cbc02675afeddcad4"><div class="ttname"><a href="send_8c.html#afa20b4cc93fe3d7cbc02675afeddcad4">mutt_set_followup_to</a></div><div class="ttdeci">void mutt_set_followup_to(struct Envelope *env, struct ConfigSubset *sub)</div><div class="ttdoc">Set followup-to field. </div><div class="ttdef"><b>Definition:</b> <a href="send_8c_source.html#l01329">send.c:1329</a></div></div>
<div class="ttc" id="structAddress_html_a12bd44ccc016e50c674ec3a902ba1c28"><div class="ttname"><a href="structAddress.html#a12bd44ccc016e50c674ec3a902ba1c28">Address::group</a></div><div class="ttdeci">bool group</div><div class="ttdoc">Group mailbox? </div><div class="ttdef"><b>Definition:</b> <a href="address_2address_8h_source.html#l00039">address.h:39</a></div></div>
<div class="ttc" id="structEnvelope_html_a2d927371b3b80e025d6f7522b7361fe7"><div class="ttname"><a href="structEnvelope.html#a2d927371b3b80e025d6f7522b7361fe7">Envelope::to</a></div><div class="ttdeci">struct AddressList to</div><div class="ttdoc">Email&amp;#39;s &amp;#39;To&amp;#39; list. </div><div class="ttdef"><b>Definition:</b> <a href="envelope_8h_source.html#l00058">envelope.h:58</a></div></div>
<div class="ttc" id="queue_8h_html_ac3c9da7ac712eacbbad5cc54d7a3477e"><div class="ttname"><a href="queue_8h.html#ac3c9da7ac712eacbbad5cc54d7a3477e">TAILQ_EMPTY</a></div><div class="ttdeci">#define TAILQ_EMPTY(head)</div><div class="ttdef"><b>Definition:</b> <a href="queue_8h_source.html#l00721">queue.h:721</a></div></div>
<div class="ttc" id="address_2address_8c_html_a5fc8a0b1e781c6e88f43f86d0ede02d2"><div class="ttname"><a href="address_2address_8c.html#a5fc8a0b1e781c6e88f43f86d0ede02d2">mutt_addr_cat</a></div><div class="ttdeci">void mutt_addr_cat(char *buf, size_t buflen, const char *value, const char *specials)</div><div class="ttdoc">Copy a string and wrap it in quotes if it contains special characters. </div><div class="ttdef"><b>Definition:</b> <a href="address_2address_8c_source.html#l00681">address.c:681</a></div></div>
<div class="ttc" id="address_2address_8c_html_a68385b174baad74a9aecf3dec61432a0"><div class="ttname"><a href="address_2address_8c.html#a68385b174baad74a9aecf3dec61432a0">mutt_addrlist_append</a></div><div class="ttdeci">void mutt_addrlist_append(struct AddressList *al, struct Address *a)</div><div class="ttdoc">Append an Address to an AddressList. </div><div class="ttdef"><b>Definition:</b> <a href="address_2address_8c_source.html#l01490">address.c:1490</a></div></div>
</div><!-- fragment --><div id="dynsection-16" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-16-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-16-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-16-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="sendlib_8h_ac35da3d19eb0d95d4f6260adab57b4c9_cgraph.svg" width="584" height="392"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div id="dynsection-17" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-17-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-17-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-17-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="sendlib_8h_ac35da3d19eb0d95d4f6260adab57b4c9_icgraph.svg" width="847" height="123"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a0ee1ea636faabfacf94efbd968b0bea9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ee1ea636faabfacf94efbd968b0bea9">&#9670;&nbsp;</a></span>mutt_stamp_attachment()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mutt_stamp_attachment </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structBody.html">Body</a> *&#160;</td>
          <td class="paramname"><em>a</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Timestamp an Attachment. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">a</td><td>Attachment </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="sendlib_8c_source.html#l00892">892</a> of file <a class="el" href="sendlib_8c_source.html">sendlib.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;{</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;  a-&gt;<a class="code" href="structBody.html#a4fb2c1a3bc453c5451720c0ddcc99c5b">stamp</a> = <a class="code" href="date_8c.html#a97bacb1574ec0b1c69b6236fbacceccf">mutt_date_epoch</a>();</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;}</div><div class="ttc" id="date_8c_html_a97bacb1574ec0b1c69b6236fbacceccf"><div class="ttname"><a href="date_8c.html#a97bacb1574ec0b1c69b6236fbacceccf">mutt_date_epoch</a></div><div class="ttdeci">time_t mutt_date_epoch(void)</div><div class="ttdoc">Return the number of seconds since the Unix epoch. </div><div class="ttdef"><b>Definition:</b> <a href="date_8c_source.html#l00427">date.c:427</a></div></div>
<div class="ttc" id="structBody_html_a4fb2c1a3bc453c5451720c0ddcc99c5b"><div class="ttname"><a href="structBody.html#a4fb2c1a3bc453c5451720c0ddcc99c5b">Body::stamp</a></div><div class="ttdeci">time_t stamp</div><div class="ttdoc">Time stamp of last encoding update. </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00061">body.h:61</a></div></div>
</div><!-- fragment --><div id="dynsection-18" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-18-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-18-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-18-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="sendlib_8h_a0ee1ea636faabfacf94efbd968b0bea9_cgraph.svg" width="376" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div id="dynsection-19" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-19-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-19-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-19-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="sendlib_8h_a0ee1ea636faabfacf94efbd968b0bea9_icgraph.svg" width="648" height="214"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a99b5cff5076c9e25bce367f0bae45f4c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a99b5cff5076c9e25bce367f0bae45f4c">&#9670;&nbsp;</a></span>mutt_unprepare_envelope()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mutt_unprepare_envelope </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structEnvelope.html">Envelope</a> *&#160;</td>
          <td class="paramname"><em>env</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Undo the encodings of <a class="el" href="sendlib_8c.html#ac35da3d19eb0d95d4f6260adab57b4c9" title="Prepare an email header. ">mutt_prepare_envelope()</a> </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">env</td><td><a class="el" href="structEnvelope.html" title="The header of an Email. ">Envelope</a> to unprepare</td></tr>
  </table>
  </dd>
</dl>
<p>Decode all the headers of an email, e.g. when the sending failed or was aborted. </p>

<p class="definition">Definition at line <a class="el" href="sendlib_8c_source.html#l01282">1282</a> of file <a class="el" href="sendlib_8c_source.html">sendlib.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;{</div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;  <span class="keyword">struct </span><a class="code" href="structListNode.html">ListNode</a> *item = NULL;</div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;  <a class="code" href="queue_8h.html#a77999ebdf5aaf7af8b8ea22bf208c432">STAILQ_FOREACH</a>(item, &amp;env-&gt;<a class="code" href="structEnvelope.html#a005f4bd665ae1ae362add27948753fe1">userhdrs</a>, entries)</div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;  {</div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;    <a class="code" href="rfc2047_8c.html#a89c57c82465740567f73641c9397d760">rfc2047_decode</a>(&amp;item-&gt;<a class="code" href="structListNode.html#aafe688d670318196766392d8235d00a7">data</a>);</div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;  }</div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;</div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;  <a class="code" href="address_2address_8c.html#a396bcf6adfff6663096fa6ae99c31c9a">mutt_addrlist_clear</a>(&amp;env-&gt;<a class="code" href="structEnvelope.html#a6044b60220b8029a6a505e5b61f1cadc">mail_followup_to</a>);</div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;</div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;  <span class="comment">/* back conversions */</span></div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;  <a class="code" href="rfc2047_8c.html#a79026f5cfec0b561058f7021e19b9601">rfc2047_decode_envelope</a>(env);</div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;}</div><div class="ttc" id="structEnvelope_html_a6044b60220b8029a6a505e5b61f1cadc"><div class="ttname"><a href="structEnvelope.html#a6044b60220b8029a6a505e5b61f1cadc">Envelope::mail_followup_to</a></div><div class="ttdeci">struct AddressList mail_followup_to</div><div class="ttdoc">Email&amp;#39;s &amp;#39;mail-followup-to&amp;#39;. </div><div class="ttdef"><b>Definition:</b> <a href="envelope_8h_source.html#l00063">envelope.h:63</a></div></div>
<div class="ttc" id="address_2address_8c_html_a396bcf6adfff6663096fa6ae99c31c9a"><div class="ttname"><a href="address_2address_8c.html#a396bcf6adfff6663096fa6ae99c31c9a">mutt_addrlist_clear</a></div><div class="ttdeci">void mutt_addrlist_clear(struct AddressList *al)</div><div class="ttdoc">Unlink and free all Address in an AddressList. </div><div class="ttdef"><b>Definition:</b> <a href="address_2address_8c_source.html#l01470">address.c:1470</a></div></div>
<div class="ttc" id="structEnvelope_html_a005f4bd665ae1ae362add27948753fe1"><div class="ttname"><a href="structEnvelope.html#a005f4bd665ae1ae362add27948753fe1">Envelope::userhdrs</a></div><div class="ttdeci">struct ListHead userhdrs</div><div class="ttdoc">user defined headers </div><div class="ttdef"><b>Definition:</b> <a href="envelope_8h_source.html#l00083">envelope.h:83</a></div></div>
<div class="ttc" id="rfc2047_8c_html_a79026f5cfec0b561058f7021e19b9601"><div class="ttname"><a href="rfc2047_8c.html#a79026f5cfec0b561058f7021e19b9601">rfc2047_decode_envelope</a></div><div class="ttdeci">void rfc2047_decode_envelope(struct Envelope *env)</div><div class="ttdoc">Decode the fields of an Envelope. </div><div class="ttdef"><b>Definition:</b> <a href="rfc2047_8c_source.html#l00787">rfc2047.c:787</a></div></div>
<div class="ttc" id="rfc2047_8c_html_a89c57c82465740567f73641c9397d760"><div class="ttname"><a href="rfc2047_8c.html#a89c57c82465740567f73641c9397d760">rfc2047_decode</a></div><div class="ttdeci">void rfc2047_decode(char **pd)</div><div class="ttdoc">Decode any RFC2047-encoded header fields. </div><div class="ttdef"><b>Definition:</b> <a href="rfc2047_8c_source.html#l00641">rfc2047.c:641</a></div></div>
<div class="ttc" id="queue_8h_html_a77999ebdf5aaf7af8b8ea22bf208c432"><div class="ttname"><a href="queue_8h.html#a77999ebdf5aaf7af8b8ea22bf208c432">STAILQ_FOREACH</a></div><div class="ttdeci">#define STAILQ_FOREACH(var, head, field)</div><div class="ttdef"><b>Definition:</b> <a href="queue_8h_source.html#l00352">queue.h:352</a></div></div>
<div class="ttc" id="structListNode_html_aafe688d670318196766392d8235d00a7"><div class="ttname"><a href="structListNode.html#aafe688d670318196766392d8235d00a7">ListNode::data</a></div><div class="ttdeci">char * data</div><div class="ttdoc">String. </div><div class="ttdef"><b>Definition:</b> <a href="list_8h_source.html#l00036">list.h:36</a></div></div>
<div class="ttc" id="structListNode_html"><div class="ttname"><a href="structListNode.html">ListNode</a></div><div class="ttdoc">A List node for strings. </div><div class="ttdef"><b>Definition:</b> <a href="list_8h_source.html#l00034">list.h:34</a></div></div>
</div><!-- fragment --><div id="dynsection-20" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-20-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-20-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-20-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="sendlib_8h_a99b5cff5076c9e25bce367f0bae45f4c_cgraph.svg" width="618" height="107"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div id="dynsection-21" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-21-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-21-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-21-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="sendlib_8h_a99b5cff5076c9e25bce367f0bae45f4c_icgraph.svg" width="606" height="63"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="ae4f3b3ef1863d9821af9f82d8963e5b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae4f3b3ef1863d9821af9f82d8963e5b8">&#9670;&nbsp;</a></span>mutt_update_encoding()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mutt_update_encoding </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structBody.html">Body</a> *&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structConfigSubset.html">ConfigSubset</a> *&#160;</td>
          <td class="paramname"><em>sub</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Update the encoding type. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">a</td><td><a class="el" href="structBody.html" title="The body of an email. ">Body</a> to update </td></tr>
    <tr><td class="paramname">sub</td><td>Config Subset</td></tr>
  </table>
  </dd>
</dl>
<p>Assumes called from send mode where Body-&gt;filename points to actual file </p>

<p class="definition">Definition at line <a class="el" href="sendlib_8c_source.html#l00904">904</a> of file <a class="el" href="sendlib_8c_source.html">sendlib.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;{</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;  <span class="keyword">struct </span><a class="code" href="structContent.html">Content</a> *info = NULL;</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;  <span class="keywordtype">char</span> chsbuf[256];</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;  <span class="comment">/* override noconv when it&#39;s us-ascii */</span></div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="mutt_2charset_8h.html#a3ef43eece2b49fd708887669f556a15b">mutt_ch_is_us_ascii</a>(<a class="code" href="email_2body_8c.html#a8465f41e6b0f0256527ca2404edfb762">mutt_body_get_charset</a>(a, chsbuf, <span class="keyword">sizeof</span>(chsbuf))))</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;    a-&gt;<a class="code" href="structBody.html#a2f795dc4337b500fbf2ae6682dc5360b">noconv</a> = <span class="keyword">false</span>;</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;  <span class="keywordflow">if</span> (!a-&gt;<a class="code" href="structBody.html#ac64b7e1868a8d7115b9067e34c8e7aa8">force_charset</a> &amp;&amp; !a-&gt;<a class="code" href="structBody.html#a2f795dc4337b500fbf2ae6682dc5360b">noconv</a>)</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;    <a class="code" href="parameter_8c.html#a34454ee6af9d43eeabf80898dc7270b8">mutt_param_delete</a>(&amp;a-&gt;<a class="code" href="structBody.html#a782cee95e0064e3895b88248bdfc781a">parameter</a>, <span class="stringliteral">&quot;charset&quot;</span>);</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;  info = <a class="code" href="sendlib_8c.html#a8621a45f0aa4aea9e2613207be4fa717">mutt_get_content_info</a>(a-&gt;<a class="code" href="structBody.html#afe3cd2c4b1070e3d0edbf1fed939ac5a">filename</a>, a, sub);</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;  <span class="keywordflow">if</span> (!info)</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;  <a class="code" href="sendlib_8c.html#aa3effe7741654e6914738bb006a44def">set_encoding</a>(a, info, sub);</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;  <a class="code" href="sendlib_8c.html#a0ee1ea636faabfacf94efbd968b0bea9">mutt_stamp_attachment</a>(a);</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;  <a class="code" href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;a-&gt;<a class="code" href="structBody.html#aa1d39136ca054e465e875b8ab9b99565">content</a>);</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;  a-&gt;<a class="code" href="structBody.html#aa1d39136ca054e465e875b8ab9b99565">content</a> = info;</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;}</div><div class="ttc" id="sendlib_8c_html_a8621a45f0aa4aea9e2613207be4fa717"><div class="ttname"><a href="sendlib_8c.html#a8621a45f0aa4aea9e2613207be4fa717">mutt_get_content_info</a></div><div class="ttdeci">struct Content * mutt_get_content_info(const char *fname, struct Body *b, struct ConfigSubset *sub)</div><div class="ttdoc">Analyze file to determine MIME encoding to use. </div><div class="ttdef"><b>Definition:</b> <a href="sendlib_8c_source.html#l00465">sendlib.c:465</a></div></div>
<div class="ttc" id="sendlib_8c_html_a0ee1ea636faabfacf94efbd968b0bea9"><div class="ttname"><a href="sendlib_8c.html#a0ee1ea636faabfacf94efbd968b0bea9">mutt_stamp_attachment</a></div><div class="ttdeci">void mutt_stamp_attachment(struct Body *a)</div><div class="ttdoc">Timestamp an Attachment. </div><div class="ttdef"><b>Definition:</b> <a href="sendlib_8c_source.html#l00892">sendlib.c:892</a></div></div>
<div class="ttc" id="structBody_html_afe3cd2c4b1070e3d0edbf1fed939ac5a"><div class="ttname"><a href="structBody.html#afe3cd2c4b1070e3d0edbf1fed939ac5a">Body::filename</a></div><div class="ttdeci">char * filename</div><div class="ttdoc">when sending a message, this is the file to which this structure refers </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00046">body.h:46</a></div></div>
<div class="ttc" id="structBody_html_aa1d39136ca054e465e875b8ab9b99565"><div class="ttname"><a href="structBody.html#aa1d39136ca054e465e875b8ab9b99565">Body::content</a></div><div class="ttdeci">struct Content * content</div><div class="ttdoc">Detailed info about the content of the attachment. </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00051">body.h:51</a></div></div>
<div class="ttc" id="structBody_html_a2f795dc4337b500fbf2ae6682dc5360b"><div class="ttname"><a href="structBody.html#a2f795dc4337b500fbf2ae6682dc5360b">Body::noconv</a></div><div class="ttdeci">bool noconv</div><div class="ttdoc">Don&amp;#39;t do character set conversion. </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00073">body.h:73</a></div></div>
<div class="ttc" id="structBody_html_ac64b7e1868a8d7115b9067e34c8e7aa8"><div class="ttname"><a href="structBody.html#ac64b7e1868a8d7115b9067e34c8e7aa8">Body::force_charset</a></div><div class="ttdeci">bool force_charset</div><div class="ttdoc">Send mode: don&amp;#39;t adjust the character set when in send-mode. </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00075">body.h:75</a></div></div>
<div class="ttc" id="email_2body_8c_html_a8465f41e6b0f0256527ca2404edfb762"><div class="ttname"><a href="email_2body_8c.html#a8465f41e6b0f0256527ca2404edfb762">mutt_body_get_charset</a></div><div class="ttdeci">char * mutt_body_get_charset(struct Body *b, char *buf, size_t buflen)</div><div class="ttdoc">Get a body&amp;#39;s character set. </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8c_source.html#l00131">body.c:131</a></div></div>
<div class="ttc" id="structContent_html"><div class="ttname"><a href="structContent.html">Content</a></div><div class="ttdoc">Info about an attachment. </div><div class="ttdef"><b>Definition:</b> <a href="content_8h_source.html#l00033">content.h:33</a></div></div>
<div class="ttc" id="parameter_8c_html_a34454ee6af9d43eeabf80898dc7270b8"><div class="ttname"><a href="parameter_8c.html#a34454ee6af9d43eeabf80898dc7270b8">mutt_param_delete</a></div><div class="ttdeci">void mutt_param_delete(struct ParameterList *pl, const char *attribute)</div><div class="ttdoc">Delete a matching Parameter. </div><div class="ttdef"><b>Definition:</b> <a href="parameter_8c_source.html#l00142">parameter.c:142</a></div></div>
<div class="ttc" id="mutt_2charset_8h_html_a3ef43eece2b49fd708887669f556a15b"><div class="ttname"><a href="mutt_2charset_8h.html#a3ef43eece2b49fd708887669f556a15b">mutt_ch_is_us_ascii</a></div><div class="ttdeci">#define mutt_ch_is_us_ascii(str)</div><div class="ttdef"><b>Definition:</b> <a href="mutt_2charset_8h_source.html#l00096">charset.h:96</a></div></div>
<div class="ttc" id="memory_8h_html_a25875003b43b81a4302256caa4a13599"><div class="ttname"><a href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a></div><div class="ttdeci">#define FREE(x)</div><div class="ttdef"><b>Definition:</b> <a href="memory_8h_source.html#l00040">memory.h:40</a></div></div>
<div class="ttc" id="structBody_html_a782cee95e0064e3895b88248bdfc781a"><div class="ttname"><a href="structBody.html#a782cee95e0064e3895b88248bdfc781a">Body::parameter</a></div><div class="ttdeci">struct ParameterList parameter</div><div class="ttdoc">parameters of the content-type </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00039">body.h:39</a></div></div>
<div class="ttc" id="sendlib_8c_html_aa3effe7741654e6914738bb006a44def"><div class="ttname"><a href="sendlib_8c.html#aa3effe7741654e6914738bb006a44def">set_encoding</a></div><div class="ttdeci">static void set_encoding(struct Body *b, struct Content *info, struct ConfigSubset *sub)</div><div class="ttdoc">determine which Content-Transfer-Encoding to use </div><div class="ttdef"><b>Definition:</b> <a href="sendlib_8c_source.html#l00834">sendlib.c:834</a></div></div>
</div><!-- fragment --><div id="dynsection-22" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-22-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-22-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-22-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="sendlib_8h_ae4f3b3ef1863d9821af9f82d8963e5b8_cgraph.svg" width="635" height="215"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div id="dynsection-23" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-23-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-23-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-23-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="sendlib_8h_ae4f3b3ef1863d9821af9f82d8963e5b8_icgraph.svg" width="856" height="480"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="acd4f22db21ca81a6a845ffe6888d141f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acd4f22db21ca81a6a845ffe6888d141f">&#9670;&nbsp;</a></span>mutt_write_fcc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mutt_write_fcc </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structEmail.html">Email</a> *&#160;</td>
          <td class="paramname"><em>e</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>msgid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>post</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>fcc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>finalpath</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structConfigSubset.html">ConfigSubset</a> *&#160;</td>
          <td class="paramname"><em>sub</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write email to FCC mailbox. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">path</td><td>Path to mailbox </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">e</td><td><a class="el" href="structEmail.html" title="The envelope/body of an email. ">Email</a> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">msgid</td><td><a class="el" href="structMessage.html" title="A local copy of an email. ">Message</a> id </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">post</td><td>If true, postpone message, else fcc mode </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fcc</td><td>fcc setting to save (postpone only) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">finalpath</td><td>Final path of email </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sub</td><td>Config Subset </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Success </td></tr>
    <tr><td class="paramname">-1</td><td>Failure </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="sendlib_8c_source.html#l01515">1515</a> of file <a class="el" href="sendlib_8c_source.html">sendlib.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;{</div><div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;  <span class="keyword">struct </span><a class="code" href="structMessage.html">Message</a> *msg = NULL;</div><div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;  <span class="keyword">struct </span><a class="code" href="structBuffer.html">Buffer</a> *tempfile = NULL;</div><div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;  FILE *fp_tmp = NULL;</div><div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;  <span class="keywordtype">int</span> rc = -1;</div><div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;  <span class="keywordtype">bool</span> need_mailbox_cleanup = <span class="keyword">false</span>;</div><div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;  <span class="keyword">struct </span>stat st;</div><div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;  <a class="code" href="mx_8h.html#a3c2b592b42c4c70ba32b8fb9ce869750">MsgOpenFlags</a> onm_flags;</div><div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;</div><div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;  <span class="keywordflow">if</span> (post)</div><div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;    <a class="code" href="sendlib_8c.html#a31fd83b30e072d8a49049390853704f7">set_noconv_flags</a>(e-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>, <span class="keyword">true</span>);</div><div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;</div><div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;<span class="preprocessor">#ifdef RECORD_FOLDER_HOOK</span></div><div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;  <a class="code" href="hook_8c.html#a6c1eb72c5e9a39b354d9c394f9116f50">mutt_folder_hook</a>(path, NULL);</div><div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;  <span class="keyword">struct </span><a class="code" href="structMailbox.html">Mailbox</a> *m_fcc = <a class="code" href="mx_8c.html#ab437d031227dc741c63cf2791c6b4562">mx_path_resolve</a>(path);</div><div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;  <span class="keywordtype">bool</span> old_append = m_fcc-&gt;<a class="code" href="structMailbox.html#a2481e68c768eb0cb6e17cfcd0f255f79">append</a>;</div><div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="mx_8c.html#a6c4f4c51fa0b086d86a8638197c40578">mx_mbox_open</a>(m_fcc, <a class="code" href="mxapi_8h.html#a6168431d3be24912b33a6c486fa11366">MUTT_APPEND</a> | <a class="code" href="mxapi_8h.html#a75f314042a266df29efcc524d35c4b2d">MUTT_QUIET</a>))</div><div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;  {</div><div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;    <a class="code" href="group__logging__api.html#gae6c5fd73af3410b2d5e8099f8774c8da">mutt_debug</a>(<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab2c99902c587a013b358149516cceeb5">LL_DEBUG1</a>, <span class="stringliteral">&quot;unable to open mailbox %s in append-mode, aborting\n&quot;</span>, path);</div><div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;    <a class="code" href="mailbox_8c.html#aba915aae97477d1ecc6428a06f92dac9">mailbox_free</a>(&amp;m_fcc);</div><div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;    <span class="keywordflow">goto</span> done;</div><div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;  }</div><div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;</div><div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;  <span class="comment">/* We need to add a Content-Length field to avoid problems where a line in</span></div><div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;<span class="comment">   * the message body begins with &quot;From &quot; */</span></div><div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;  <span class="keywordflow">if</span> ((m_fcc-&gt;<a class="code" href="structMailbox.html#a5638329fb2ebd4bbe1f4a949ec8de174">type</a> == <a class="code" href="mailbox_8h.html#af65addf714c28dd5d483cb426100921da09cef4c4e3dc42c9137860413dcdb374">MUTT_MMDF</a>) || (m_fcc-&gt;<a class="code" href="structMailbox.html#a5638329fb2ebd4bbe1f4a949ec8de174">type</a> == <a class="code" href="mailbox_8h.html#af65addf714c28dd5d483cb426100921da817ef3cf5f529965875400b412678525">MUTT_MBOX</a>))</div><div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;  {</div><div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;    tempfile = <a class="code" href="pool_8c.html#a2129d5ea0085753afdd37cf62161845d">mutt_buffer_pool_get</a>();</div><div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;    <a class="code" href="muttlib_8h.html#a7f1db9db6f710a84cace77248096e2ac">mutt_buffer_mktemp</a>(tempfile);</div><div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;    fp_tmp = <a class="code" href="file_8c.html#ae1c0c19fec03274220b3ca065ad1e2e5">mutt_file_fopen</a>(<a class="code" href="buffer_8h.html#a4aca040fb75bc1dfc086cbfbf14ac8cd">mutt_buffer_string</a>(tempfile), <span class="stringliteral">&quot;w+&quot;</span>);</div><div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;    <span class="keywordflow">if</span> (!fp_tmp)</div><div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;    {</div><div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;      <a class="code" href="group__logging__api.html#gafaa521ab22db877ccf1b87e679e1b43e">mutt_perror</a>(<a class="code" href="buffer_8h.html#a4aca040fb75bc1dfc086cbfbf14ac8cd">mutt_buffer_string</a>(tempfile));</div><div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;      <a class="code" href="mx_8c.html#af9e949965d56e69eb9a6a9aa640614bb">mx_mbox_close</a>(m_fcc);</div><div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;      <span class="keywordflow">goto</span> done;</div><div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;    }</div><div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;    <span class="comment">/* remember new mail status before appending message */</span></div><div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;    need_mailbox_cleanup = <span class="keyword">true</span>;</div><div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;    stat(path, &amp;st);</div><div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;  }</div><div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;</div><div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;  e-&gt;<a class="code" href="structEmail.html#a0bd79550be901d44e50953fb43614e10">read</a> = !post; <span class="comment">/* make sure to put it in the &#39;cur&#39; directory (maildir) */</span></div><div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;  onm_flags = <a class="code" href="mx_8h.html#a49087f3940d59f9624011017e42d9444">MUTT_ADD_FROM</a>;</div><div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;  <span class="keywordflow">if</span> (post)</div><div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;    onm_flags |= <a class="code" href="mx_8h.html#ae766b38813f1364775c5160cc3802b9b">MUTT_SET_DRAFT</a>;</div><div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;  msg = <a class="code" href="mx_8c.html#aebf47a6cd2a8bc442aaf347124d2e18a">mx_msg_open_new</a>(m_fcc, e, onm_flags);</div><div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;  <span class="keywordflow">if</span> (!msg)</div><div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;  {</div><div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;    <a class="code" href="file_8c.html#a31f49795ff5b9558db5476e5777e63b6">mutt_file_fclose</a>(&amp;fp_tmp);</div><div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;    <a class="code" href="mx_8c.html#af9e949965d56e69eb9a6a9aa640614bb">mx_mbox_close</a>(m_fcc);</div><div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;    <span class="keywordflow">goto</span> done;</div><div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;  }</div><div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;</div><div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> c_crypt_protected_headers_read =</div><div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;      <a class="code" href="helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(sub, <span class="stringliteral">&quot;crypt_protected_headers_read&quot;</span>);</div><div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;</div><div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;  <span class="comment">/* post == 1 =&gt; postpone message.</span></div><div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;<span class="comment">   * post == 0 =&gt; Normal mode.  */</span></div><div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;  <a class="code" href="header_8c.html#a400e83b7e5612f974ef543ff3cd237d8">mutt_rfc822_write_header</a>(</div><div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;      msg-&gt;<a class="code" href="structMessage.html#a11d53ee4319e8735c1677d8780a7b517">fp</a>, e-&gt;<a class="code" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>, e-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>,</div><div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;      post ? <a class="code" href="header_8h.html#a610db600447893b501a944c8e5dbb9f7acc9c373684aed9be7171f4de9f893566">MUTT_WRITE_HEADER_POSTPONE</a> : <a class="code" href="header_8h.html#a610db600447893b501a944c8e5dbb9f7a0a28c77e0af5e5563e7493b4265b58e8">MUTT_WRITE_HEADER_FCC</a>, <span class="keyword">false</span>,</div><div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;      c_crypt_protected_headers_read &amp;&amp; <a class="code" href="crypt_8c.html#a52c65477f5b80ad3dc8028663653771d">mutt_should_hide_protected_subject</a>(e), sub);</div><div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;</div><div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;  <span class="comment">/* (postponement) if this was a reply of some sort, &lt;msgid&gt; contains the</span></div><div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;<span class="comment">   * Message-ID: of message replied to.  Save it using a special X-Mutt-</span></div><div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;<span class="comment">   * header so it can be picked up if the message is recalled at a later</span></div><div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;<span class="comment">   * point in time.  This will allow the message to be marked as replied if</span></div><div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;<span class="comment">   * the same mailbox is still open.  */</span></div><div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;  <span class="keywordflow">if</span> (post &amp;&amp; msgid)</div><div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;    fprintf(msg-&gt;<a class="code" href="structMessage.html#a11d53ee4319e8735c1677d8780a7b517">fp</a>, <span class="stringliteral">&quot;X-Mutt-References: %s\n&quot;</span>, msgid);</div><div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;</div><div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;  <span class="comment">/* (postponement) save the Fcc: using a special X-Mutt- header so that</span></div><div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;<span class="comment">   * it can be picked up when the message is recalled */</span></div><div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;  <span class="keywordflow">if</span> (post &amp;&amp; fcc)</div><div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;    fprintf(msg-&gt;<a class="code" href="structMessage.html#a11d53ee4319e8735c1677d8780a7b517">fp</a>, <span class="stringliteral">&quot;X-Mutt-Fcc: %s\n&quot;</span>, fcc);</div><div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;</div><div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;  <span class="keywordflow">if</span> ((m_fcc-&gt;<a class="code" href="structMailbox.html#a5638329fb2ebd4bbe1f4a949ec8de174">type</a> == <a class="code" href="mailbox_8h.html#af65addf714c28dd5d483cb426100921da09cef4c4e3dc42c9137860413dcdb374">MUTT_MMDF</a>) || (m_fcc-&gt;<a class="code" href="structMailbox.html#a5638329fb2ebd4bbe1f4a949ec8de174">type</a> == <a class="code" href="mailbox_8h.html#af65addf714c28dd5d483cb426100921da817ef3cf5f529965875400b412678525">MUTT_MBOX</a>))</div><div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;    fprintf(msg-&gt;<a class="code" href="structMessage.html#a11d53ee4319e8735c1677d8780a7b517">fp</a>, <span class="stringliteral">&quot;Status: RO\n&quot;</span>);</div><div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;</div><div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;  <span class="comment">/* (postponement) if the mail is to be signed or encrypted, save this info */</span></div><div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;  <span class="keywordflow">if</span> (((<a class="code" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a>) != 0) &amp;&amp; post &amp;&amp; (e-&gt;<a class="code" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> &amp; APPLICATION_PGP))</div><div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;  {</div><div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;    fputs(<span class="stringliteral">&quot;X-Mutt-PGP: &quot;</span>, msg-&gt;<a class="code" href="structMessage.html#a11d53ee4319e8735c1677d8780a7b517">fp</a>);</div><div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;    <span class="keywordflow">if</span> (e-&gt;<a class="code" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> &amp; <a class="code" href="ncrypt_2lib_8h.html#aacaa4abd4c0696e260b7a0f1d466360a">SEC_ENCRYPT</a>)</div><div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;      fputc(<span class="charliteral">&#39;E&#39;</span>, msg-&gt;<a class="code" href="structMessage.html#a11d53ee4319e8735c1677d8780a7b517">fp</a>);</div><div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;    <span class="keywordflow">if</span> (e-&gt;<a class="code" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> &amp; <a class="code" href="ncrypt_2lib_8h.html#a2fb0b0aa796d8d79a746001d09c2a2c7">SEC_OPPENCRYPT</a>)</div><div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;      fputc(<span class="charliteral">&#39;O&#39;</span>, msg-&gt;<a class="code" href="structMessage.html#a11d53ee4319e8735c1677d8780a7b517">fp</a>);</div><div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;    <span class="keywordflow">if</span> (e-&gt;<a class="code" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> &amp; <a class="code" href="ncrypt_2lib_8h.html#ae12c003463c99d28f65f1d6b8b053b2c">SEC_SIGN</a>)</div><div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;    {</div><div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;      fputc(<span class="charliteral">&#39;S&#39;</span>, msg-&gt;<a class="code" href="structMessage.html#a11d53ee4319e8735c1677d8780a7b517">fp</a>);</div><div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;</div><div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keyword">const</span> c_pgp_sign_as = <a class="code" href="helpers_8c.html#ac477c591155aa4ae0452bbabc0affffe">cs_subset_string</a>(sub, <span class="stringliteral">&quot;pgp_sign_as&quot;</span>);</div><div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;      <span class="keywordflow">if</span> (c_pgp_sign_as)</div><div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;        fprintf(msg-&gt;<a class="code" href="structMessage.html#a11d53ee4319e8735c1677d8780a7b517">fp</a>, <span class="stringliteral">&quot;&lt;%s&gt;&quot;</span>, c_pgp_sign_as);</div><div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;    }</div><div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;    <span class="keywordflow">if</span> (e-&gt;<a class="code" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> &amp; <a class="code" href="ncrypt_2lib_8h.html#a074f827472ad45f11ec1132cdfed2daf">SEC_INLINE</a>)</div><div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;      fputc(<span class="charliteral">&#39;I&#39;</span>, msg-&gt;<a class="code" href="structMessage.html#a11d53ee4319e8735c1677d8780a7b517">fp</a>);</div><div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;<span class="preprocessor">#ifdef USE_AUTOCRYPT</span></div><div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;    <span class="keywordflow">if</span> (e-&gt;<a class="code" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> &amp; <a class="code" href="ncrypt_2lib_8h.html#a0b36be5c32ca90d8f2caef9ea9d627fc">SEC_AUTOCRYPT</a>)</div><div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;      fputc(<span class="charliteral">&#39;A&#39;</span>, msg-&gt;<a class="code" href="structMessage.html#a11d53ee4319e8735c1677d8780a7b517">fp</a>);</div><div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;    <span class="keywordflow">if</span> (e-&gt;<a class="code" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> &amp; <a class="code" href="ncrypt_2lib_8h.html#ae0ce4a742538f3ee3e1bfbf143c794fb">SEC_AUTOCRYPT_OVERRIDE</a>)</div><div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;      fputc(<span class="charliteral">&#39;Z&#39;</span>, msg-&gt;<a class="code" href="structMessage.html#a11d53ee4319e8735c1677d8780a7b517">fp</a>);</div><div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;    fputc(<span class="charliteral">&#39;\n&#39;</span>, msg-&gt;<a class="code" href="structMessage.html#a11d53ee4319e8735c1677d8780a7b517">fp</a>);</div><div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;  }</div><div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;</div><div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;  <span class="comment">/* (postponement) if the mail is to be signed or encrypted, save this info */</span></div><div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;  <span class="keywordflow">if</span> (((<a class="code" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code" href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a>) != 0) &amp;&amp; post &amp;&amp; (e-&gt;<a class="code" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> &amp; APPLICATION_SMIME))</div><div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;  {</div><div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;    fputs(<span class="stringliteral">&quot;X-Mutt-SMIME: &quot;</span>, msg-&gt;<a class="code" href="structMessage.html#a11d53ee4319e8735c1677d8780a7b517">fp</a>);</div><div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;    <span class="keywordflow">if</span> (e-&gt;<a class="code" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> &amp; <a class="code" href="ncrypt_2lib_8h.html#aacaa4abd4c0696e260b7a0f1d466360a">SEC_ENCRYPT</a>)</div><div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;    {</div><div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;      fputc(<span class="charliteral">&#39;E&#39;</span>, msg-&gt;<a class="code" href="structMessage.html#a11d53ee4319e8735c1677d8780a7b517">fp</a>);</div><div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;</div><div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keyword">const</span> c_smime_encrypt_with =</div><div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;          <a class="code" href="helpers_8c.html#ac477c591155aa4ae0452bbabc0affffe">cs_subset_string</a>(sub, <span class="stringliteral">&quot;smime_encrypt_with&quot;</span>);</div><div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;      <span class="keywordflow">if</span> (c_smime_encrypt_with)</div><div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;        fprintf(msg-&gt;<a class="code" href="structMessage.html#a11d53ee4319e8735c1677d8780a7b517">fp</a>, <span class="stringliteral">&quot;C&lt;%s&gt;&quot;</span>, c_smime_encrypt_with);</div><div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;    }</div><div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;    <span class="keywordflow">if</span> (e-&gt;<a class="code" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> &amp; <a class="code" href="ncrypt_2lib_8h.html#a2fb0b0aa796d8d79a746001d09c2a2c7">SEC_OPPENCRYPT</a>)</div><div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;      fputc(<span class="charliteral">&#39;O&#39;</span>, msg-&gt;<a class="code" href="structMessage.html#a11d53ee4319e8735c1677d8780a7b517">fp</a>);</div><div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;    <span class="keywordflow">if</span> (e-&gt;<a class="code" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> &amp; <a class="code" href="ncrypt_2lib_8h.html#ae12c003463c99d28f65f1d6b8b053b2c">SEC_SIGN</a>)</div><div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;    {</div><div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;      fputc(<span class="charliteral">&#39;S&#39;</span>, msg-&gt;<a class="code" href="structMessage.html#a11d53ee4319e8735c1677d8780a7b517">fp</a>);</div><div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;</div><div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keyword">const</span> c_smime_sign_as =</div><div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;          <a class="code" href="helpers_8c.html#ac477c591155aa4ae0452bbabc0affffe">cs_subset_string</a>(sub, <span class="stringliteral">&quot;smime_sign_as&quot;</span>);</div><div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;      <span class="keywordflow">if</span> (c_smime_sign_as)</div><div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;        fprintf(msg-&gt;<a class="code" href="structMessage.html#a11d53ee4319e8735c1677d8780a7b517">fp</a>, <span class="stringliteral">&quot;&lt;%s&gt;&quot;</span>, c_smime_sign_as);</div><div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;    }</div><div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;    <span class="keywordflow">if</span> (e-&gt;<a class="code" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> &amp; <a class="code" href="ncrypt_2lib_8h.html#a074f827472ad45f11ec1132cdfed2daf">SEC_INLINE</a>)</div><div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;      fputc(<span class="charliteral">&#39;I&#39;</span>, msg-&gt;<a class="code" href="structMessage.html#a11d53ee4319e8735c1677d8780a7b517">fp</a>);</div><div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;    fputc(<span class="charliteral">&#39;\n&#39;</span>, msg-&gt;<a class="code" href="structMessage.html#a11d53ee4319e8735c1677d8780a7b517">fp</a>);</div><div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;  }</div><div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;</div><div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;<span class="preprocessor">#ifdef MIXMASTER</span></div><div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;  <span class="comment">/* (postponement) if the mail is to be sent through a mixmaster</span></div><div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;<span class="comment">   * chain, save that information */</span></div><div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;</div><div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;  <span class="keywordflow">if</span> (post &amp;&amp; !<a class="code" href="queue_8h.html#a8427c8f43d09d73062cf6b37f303aff5">STAILQ_EMPTY</a>(&amp;e-&gt;<a class="code" href="structEmail.html#a9a3c73dc042313773159d921a711c830">chain</a>))</div><div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;  {</div><div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;    fputs(<span class="stringliteral">&quot;X-Mutt-Mix:&quot;</span>, msg-&gt;<a class="code" href="structMessage.html#a11d53ee4319e8735c1677d8780a7b517">fp</a>);</div><div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;    <span class="keyword">struct </span><a class="code" href="structListNode.html">ListNode</a> *p = NULL;</div><div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;    <a class="code" href="queue_8h.html#a77999ebdf5aaf7af8b8ea22bf208c432">STAILQ_FOREACH</a>(p, &amp;e-&gt;<a class="code" href="structEmail.html#a9a3c73dc042313773159d921a711c830">chain</a>, entries)</div><div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;    {</div><div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;      fprintf(msg-&gt;<a class="code" href="structMessage.html#a11d53ee4319e8735c1677d8780a7b517">fp</a>, <span class="stringliteral">&quot; %s&quot;</span>, (<span class="keywordtype">char</span> *) p-&gt;<a class="code" href="structListNode.html#aafe688d670318196766392d8235d00a7">data</a>);</div><div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;    }</div><div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;</div><div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;    fputc(<span class="charliteral">&#39;\n&#39;</span>, msg-&gt;<a class="code" href="structMessage.html#a11d53ee4319e8735c1677d8780a7b517">fp</a>);</div><div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;  }</div><div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;</div><div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;  <span class="keywordflow">if</span> (fp_tmp)</div><div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;  {</div><div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;    <a class="code" href="send_2body_8c.html#a7ed09e9904a3693633204577be91f413">mutt_write_mime_body</a>(e-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>, fp_tmp, sub);</div><div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;</div><div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;    <span class="comment">/* make sure the last line ends with a newline.  Emacs doesn&#39;t ensure this</span></div><div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;<span class="comment">     * will happen, and it can cause problems parsing the mailbox later.  */</span></div><div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;    fseek(fp_tmp, -1, SEEK_END);</div><div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;    <span class="keywordflow">if</span> (fgetc(fp_tmp) != <span class="charliteral">&#39;\n&#39;</span>)</div><div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;    {</div><div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;      fseek(fp_tmp, 0, SEEK_END);</div><div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;      fputc(<span class="charliteral">&#39;\n&#39;</span>, fp_tmp);</div><div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;    }</div><div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;</div><div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;    fflush(fp_tmp);</div><div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;    <span class="keywordflow">if</span> (ferror(fp_tmp))</div><div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;    {</div><div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;      <a class="code" href="group__logging__api.html#gae6c5fd73af3410b2d5e8099f8774c8da">mutt_debug</a>(<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab2c99902c587a013b358149516cceeb5">LL_DEBUG1</a>, <span class="stringliteral">&quot;%s: write failed\n&quot;</span>, <a class="code" href="buffer_8h.html#a4aca040fb75bc1dfc086cbfbf14ac8cd">mutt_buffer_string</a>(tempfile));</div><div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;      <a class="code" href="file_8c.html#a31f49795ff5b9558db5476e5777e63b6">mutt_file_fclose</a>(&amp;fp_tmp);</div><div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;      unlink(<a class="code" href="buffer_8h.html#a4aca040fb75bc1dfc086cbfbf14ac8cd">mutt_buffer_string</a>(tempfile));</div><div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;      <a class="code" href="mx_8c.html#add0e192c5f27bf6bd096ae2eb7c0b67b">mx_msg_commit</a>(m_fcc, msg); <span class="comment">/* XXX really? */</span></div><div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;      <a class="code" href="mx_8c.html#a2172d90c08b5a2b293d22ed13ee0e7a8">mx_msg_close</a>(m_fcc, &amp;msg);</div><div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;      <a class="code" href="mx_8c.html#af9e949965d56e69eb9a6a9aa640614bb">mx_mbox_close</a>(m_fcc);</div><div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;      <span class="keywordflow">goto</span> done;</div><div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;    }</div><div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;</div><div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;    <span class="comment">/* count the number of lines */</span></div><div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;    <span class="keywordtype">int</span> lines = 0;</div><div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;    <span class="keywordtype">char</span> line_buf[1024];</div><div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;    rewind(fp_tmp);</div><div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;    <span class="keywordflow">while</span> (fgets(line_buf, <span class="keyword">sizeof</span>(line_buf), fp_tmp))</div><div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;      lines++;</div><div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;    fprintf(msg-&gt;<a class="code" href="structMessage.html#a11d53ee4319e8735c1677d8780a7b517">fp</a>, <span class="stringliteral">&quot;Content-Length: &quot;</span> OFF_T_FMT <span class="stringliteral">&quot;\n&quot;</span>, (LOFF_T) ftello(fp_tmp));</div><div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;    fprintf(msg-&gt;<a class="code" href="structMessage.html#a11d53ee4319e8735c1677d8780a7b517">fp</a>, <span class="stringliteral">&quot;Lines: %d\n\n&quot;</span>, lines);</div><div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;</div><div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;    <span class="comment">/* copy the body and clean up */</span></div><div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;    rewind(fp_tmp);</div><div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;    rc = <a class="code" href="file_8c.html#a0a6ff09a685fb6fa1120a582a5a6ef4a">mutt_file_copy_stream</a>(fp_tmp, msg-&gt;<a class="code" href="structMessage.html#a11d53ee4319e8735c1677d8780a7b517">fp</a>);</div><div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="file_8c.html#a31f49795ff5b9558db5476e5777e63b6">mutt_file_fclose</a>(&amp;fp_tmp) != 0)</div><div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;      rc = -1;</div><div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;    <span class="comment">/* if there was an error, leave the temp version */</span></div><div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;    <span class="keywordflow">if</span> (rc &gt;= 0)</div><div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;    {</div><div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;      unlink(<a class="code" href="buffer_8h.html#a4aca040fb75bc1dfc086cbfbf14ac8cd">mutt_buffer_string</a>(tempfile));</div><div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;      rc = 0;</div><div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;    }</div><div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;  }</div><div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;  {</div><div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;    fputc(<span class="charliteral">&#39;\n&#39;</span>, msg-&gt;<a class="code" href="structMessage.html#a11d53ee4319e8735c1677d8780a7b517">fp</a>); <span class="comment">/* finish off the header */</span></div><div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;    rc = <a class="code" href="send_2body_8c.html#a7ed09e9904a3693633204577be91f413">mutt_write_mime_body</a>(e-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>, msg-&gt;<a class="code" href="structMessage.html#a11d53ee4319e8735c1677d8780a7b517">fp</a>, sub);</div><div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;  }</div><div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;</div><div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="mx_8c.html#add0e192c5f27bf6bd096ae2eb7c0b67b">mx_msg_commit</a>(m_fcc, msg) != 0)</div><div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;    rc = -1;</div><div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (finalpath)</div><div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;    *finalpath = <a class="code" href="mutt_2string_8c.html#a4c2560f787bd1226b977992c16860c98">mutt_str_dup</a>(msg-&gt;<a class="code" href="structMessage.html#a817c2e03ff60bae58f117fc3391d3d62">committed_path</a>);</div><div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;  <a class="code" href="mx_8c.html#a2172d90c08b5a2b293d22ed13ee0e7a8">mx_msg_close</a>(m_fcc, &amp;msg);</div><div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;  <a class="code" href="mx_8c.html#af9e949965d56e69eb9a6a9aa640614bb">mx_mbox_close</a>(m_fcc);</div><div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;</div><div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;  <span class="keywordflow">if</span> (!post &amp;&amp; need_mailbox_cleanup)</div><div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;    <a class="code" href="mutt__mailbox_8c.html#abf8c2a3fe001e431c5f0dd76e7e4e114">mutt_mailbox_cleanup</a>(path, &amp;st);</div><div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;</div><div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;  <span class="keywordflow">if</span> (post)</div><div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;    <a class="code" href="sendlib_8c.html#a31fd83b30e072d8a49049390853704f7">set_noconv_flags</a>(e-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>, <span class="keyword">false</span>);</div><div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;</div><div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;done:</div><div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;  <span class="keywordflow">if</span> (m_fcc)</div><div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;    m_fcc-&gt;<a class="code" href="structMailbox.html#a2481e68c768eb0cb6e17cfcd0f255f79">append</a> = old_append;</div><div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;<span class="preprocessor">#ifdef RECORD_FOLDER_HOOK</span></div><div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;  <span class="comment">/* We ran a folder hook for the destination mailbox,</span></div><div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;<span class="comment">   * now we run it for the user&#39;s current mailbox */</span></div><div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;  <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structMailbox.html">Mailbox</a> *m = <a class="code" href="context_8c.html#a3d99ae9e3203ce327227f9ab3f711427">ctx_mailbox</a>(<a class="code" href="structContext.html">Context</a>);</div><div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;  <span class="keywordflow">if</span> (m)</div><div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;    <a class="code" href="hook_8c.html#a6c1eb72c5e9a39b354d9c394f9116f50">mutt_folder_hook</a>(m-&gt;path, m-&gt;desc);</div><div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;</div><div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;  <span class="keywordflow">if</span> (fp_tmp)</div><div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;  {</div><div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;    <a class="code" href="file_8c.html#a31f49795ff5b9558db5476e5777e63b6">mutt_file_fclose</a>(&amp;fp_tmp);</div><div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;    unlink(<a class="code" href="buffer_8h.html#a4aca040fb75bc1dfc086cbfbf14ac8cd">mutt_buffer_string</a>(tempfile));</div><div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;  }</div><div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;  <a class="code" href="pool_8c.html#a08b48e2ac8849341888ee7429cc5093c">mutt_buffer_pool_release</a>(&amp;tempfile);</div><div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;</div><div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;  <span class="keywordflow">return</span> rc;</div><div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;}</div><div class="ttc" id="structContext_html"><div class="ttname"><a href="structContext.html">Context</a></div><div class="ttdoc">The &quot;current&quot; mailbox. </div><div class="ttdef"><b>Definition:</b> <a href="context_8h_source.html#l00037">context.h:37</a></div></div>
<div class="ttc" id="muttlib_8h_html_a7f1db9db6f710a84cace77248096e2ac"><div class="ttname"><a href="muttlib_8h.html#a7f1db9db6f710a84cace77248096e2ac">mutt_buffer_mktemp</a></div><div class="ttdeci">#define mutt_buffer_mktemp(buf)</div><div class="ttdef"><b>Definition:</b> <a href="muttlib_8h_source.html#l00074">muttlib.h:74</a></div></div>
<div class="ttc" id="structMailbox_html_a5638329fb2ebd4bbe1f4a949ec8de174"><div class="ttname"><a href="structMailbox.html#a5638329fb2ebd4bbe1f4a949ec8de174">Mailbox::type</a></div><div class="ttdeci">enum MailboxType type</div><div class="ttdoc">Mailbox type. </div><div class="ttdef"><b>Definition:</b> <a href="mailbox_8h_source.html#l00105">mailbox.h:105</a></div></div>
<div class="ttc" id="helpers_8c_html_ae50f679dd6c5bd1ba820884c8602f038"><div class="ttname"><a href="helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a></div><div class="ttdeci">bool cs_subset_bool(const struct ConfigSubset *sub, const char *name)</div><div class="ttdoc">Get a boolean config item by name. </div><div class="ttdef"><b>Definition:</b> <a href="helpers_8c_source.html#l00073">helpers.c:73</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_ad980bff69bb614893ad8e7e1c28a5023"><div class="ttname"><a href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a></div><div class="ttdeci">#define WithCrypto</div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00113">lib.h:113</a></div></div>
<div class="ttc" id="mx_8c_html_a6c4f4c51fa0b086d86a8638197c40578"><div class="ttname"><a href="mx_8c.html#a6c4f4c51fa0b086d86a8638197c40578">mx_mbox_open</a></div><div class="ttdeci">bool mx_mbox_open(struct Mailbox *m, OpenMailboxFlags flags)</div><div class="ttdoc">Open a mailbox and parse it. </div><div class="ttdef"><b>Definition:</b> <a href="mx_8c_source.html#l00304">mx.c:304</a></div></div>
<div class="ttc" id="pool_8c_html_a2129d5ea0085753afdd37cf62161845d"><div class="ttname"><a href="pool_8c.html#a2129d5ea0085753afdd37cf62161845d">mutt_buffer_pool_get</a></div><div class="ttdeci">struct Buffer * mutt_buffer_pool_get(void)</div><div class="ttdoc">Get a Buffer from the pool. </div><div class="ttdef"><b>Definition:</b> <a href="pool_8c_source.html#l00101">pool.c:101</a></div></div>
<div class="ttc" id="header_8h_html_a610db600447893b501a944c8e5dbb9f7acc9c373684aed9be7171f4de9f893566"><div class="ttname"><a href="header_8h.html#a610db600447893b501a944c8e5dbb9f7acc9c373684aed9be7171f4de9f893566">MUTT_WRITE_HEADER_POSTPONE</a></div><div class="ttdoc">A postponed Email, just the envelope info. </div><div class="ttdef"><b>Definition:</b> <a href="header_8h_source.html#l00042">header.h:42</a></div></div>
<div class="ttc" id="structEmail_html_a57ad6ac618c0f685804f6f5bb390b3a6"><div class="ttname"><a href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">Email::body</a></div><div class="ttdeci">struct Body * body</div><div class="ttdoc">List of MIME parts. </div><div class="ttdef"><b>Definition:</b> <a href="email_8h_source.html#l00091">email.h:91</a></div></div>
<div class="ttc" id="context_8c_html_a3d99ae9e3203ce327227f9ab3f711427"><div class="ttname"><a href="context_8c.html#a3d99ae9e3203ce327227f9ab3f711427">ctx_mailbox</a></div><div class="ttdeci">struct Mailbox * ctx_mailbox(struct Context *ctx)</div><div class="ttdoc">wrapper to get the mailbox in a Context, or NULL </div><div class="ttdef"><b>Definition:</b> <a href="context_8c_source.html#l00444">context.c:444</a></div></div>
<div class="ttc" id="mutt__mailbox_8c_html_abf8c2a3fe001e431c5f0dd76e7e4e114"><div class="ttname"><a href="mutt__mailbox_8c.html#abf8c2a3fe001e431c5f0dd76e7e4e114">mutt_mailbox_cleanup</a></div><div class="ttdeci">void mutt_mailbox_cleanup(const char *path, struct stat *st)</div><div class="ttdoc">Restore the timestamp of a mailbox. </div><div class="ttdef"><b>Definition:</b> <a href="mutt__mailbox_8c_source.html#l00360">mutt_mailbox.c:360</a></div></div>
<div class="ttc" id="send_2body_8c_html_a7ed09e9904a3693633204577be91f413"><div class="ttname"><a href="send_2body_8c.html#a7ed09e9904a3693633204577be91f413">mutt_write_mime_body</a></div><div class="ttdeci">int mutt_write_mime_body(struct Body *a, FILE *fp, struct ConfigSubset *sub)</div><div class="ttdoc">Write a MIME part. </div><div class="ttdef"><b>Definition:</b> <a href="send_2body_8c_source.html#l00314">body.c:314</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_aacaa4abd4c0696e260b7a0f1d466360a"><div class="ttname"><a href="ncrypt_2lib_8h.html#aacaa4abd4c0696e260b7a0f1d466360a">SEC_ENCRYPT</a></div><div class="ttdeci">#define SEC_ENCRYPT</div><div class="ttdoc">Email is encrypted. </div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00075">lib.h:75</a></div></div>
<div class="ttc" id="crypt_8c_html_a52c65477f5b80ad3dc8028663653771d"><div class="ttname"><a href="crypt_8c.html#a52c65477f5b80ad3dc8028663653771d">mutt_should_hide_protected_subject</a></div><div class="ttdeci">bool mutt_should_hide_protected_subject(struct Email *e)</div><div class="ttdoc">Should NeoMutt hide the protected subject? </div><div class="ttdef"><b>Definition:</b> <a href="crypt_8c_source.html#l01108">crypt.c:1108</a></div></div>
<div class="ttc" id="pool_8c_html_a08b48e2ac8849341888ee7429cc5093c"><div class="ttname"><a href="pool_8c.html#a08b48e2ac8849341888ee7429cc5093c">mutt_buffer_pool_release</a></div><div class="ttdeci">void mutt_buffer_pool_release(struct Buffer **pbuf)</div><div class="ttdoc">Free a Buffer from the pool. </div><div class="ttdef"><b>Definition:</b> <a href="pool_8c_source.html#l00112">pool.c:112</a></div></div>
<div class="ttc" id="structBuffer_html"><div class="ttname"><a href="structBuffer.html">Buffer</a></div><div class="ttdoc">String manipulation buffer. </div><div class="ttdef"><b>Definition:</b> <a href="buffer_8h_source.html#l00033">buffer.h:33</a></div></div>
<div class="ttc" id="mutt_2string_8c_html_a4c2560f787bd1226b977992c16860c98"><div class="ttname"><a href="mutt_2string_8c.html#a4c2560f787bd1226b977992c16860c98">mutt_str_dup</a></div><div class="ttdeci">char * mutt_str_dup(const char *str)</div><div class="ttdoc">Copy a string, safely. </div><div class="ttdef"><b>Definition:</b> <a href="mutt_2string_8c_source.html#l00370">string.c:370</a></div></div>
<div class="ttc" id="mxapi_8h_html_a6168431d3be24912b33a6c486fa11366"><div class="ttname"><a href="mxapi_8h.html#a6168431d3be24912b33a6c486fa11366">MUTT_APPEND</a></div><div class="ttdeci">#define MUTT_APPEND</div><div class="ttdoc">Open mailbox for appending messages. </div><div class="ttdef"><b>Definition:</b> <a href="mxapi_8h_source.html#l00062">mxapi.h:62</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a0b36be5c32ca90d8f2caef9ea9d627fc"><div class="ttname"><a href="ncrypt_2lib_8h.html#a0b36be5c32ca90d8f2caef9ea9d627fc">SEC_AUTOCRYPT</a></div><div class="ttdeci">#define SEC_AUTOCRYPT</div><div class="ttdoc">(Autocrypt) Message will be, or was Autocrypt encrypt+signed </div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00084">lib.h:84</a></div></div>
<div class="ttc" id="mx_8c_html_af9e949965d56e69eb9a6a9aa640614bb"><div class="ttname"><a href="mx_8c.html#af9e949965d56e69eb9a6a9aa640614bb">mx_mbox_close</a></div><div class="ttdeci">enum MxStatus mx_mbox_close(struct Mailbox *m)</div><div class="ttdoc">Save changes and close mailbox. </div><div class="ttdef"><b>Definition:</b> <a href="mx_8c_source.html#l00610">mx.c:610</a></div></div>
<div class="ttc" id="group__logging__api_html_gafaa521ab22db877ccf1b87e679e1b43e"><div class="ttname"><a href="group__logging__api.html#gafaa521ab22db877ccf1b87e679e1b43e">mutt_perror</a></div><div class="ttdeci">#define mutt_perror(...)</div><div class="ttdef"><b>Definition:</b> <a href="logging_8h_source.html#l00089">logging.h:89</a></div></div>
<div class="ttc" id="mx_8h_html_ae766b38813f1364775c5160cc3802b9b"><div class="ttname"><a href="mx_8h.html#ae766b38813f1364775c5160cc3802b9b">MUTT_SET_DRAFT</a></div><div class="ttdeci">#define MUTT_SET_DRAFT</div><div class="ttdoc">set the message draft flag </div><div class="ttdef"><b>Definition:</b> <a href="mx_8h_source.html#l00043">mx.h:43</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a074f827472ad45f11ec1132cdfed2daf"><div class="ttname"><a href="ncrypt_2lib_8h.html#a074f827472ad45f11ec1132cdfed2daf">SEC_INLINE</a></div><div class="ttdeci">#define SEC_INLINE</div><div class="ttdoc">Email has an inline signature. </div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00082">lib.h:82</a></div></div>
<div class="ttc" id="buffer_8h_html_a4aca040fb75bc1dfc086cbfbf14ac8cd"><div class="ttname"><a href="buffer_8h.html#a4aca040fb75bc1dfc086cbfbf14ac8cd">mutt_buffer_string</a></div><div class="ttdeci">static const char * mutt_buffer_string(const struct Buffer *buf)</div><div class="ttdoc">Convert a buffer to a const char * &quot;string&quot;. </div><div class="ttdef"><b>Definition:</b> <a href="buffer_8h_source.html#l00077">buffer.h:77</a></div></div>
<div class="ttc" id="mx_8c_html_a2172d90c08b5a2b293d22ed13ee0e7a8"><div class="ttname"><a href="mx_8c.html#a2172d90c08b5a2b293d22ed13ee0e7a8">mx_msg_close</a></div><div class="ttdeci">int mx_msg_close(struct Mailbox *m, struct Message **msg)</div><div class="ttdoc">Close a message. </div><div class="ttdef"><b>Definition:</b> <a href="mx_8c_source.html#l01186">mx.c:1186</a></div></div>
<div class="ttc" id="hook_8c_html_a6c1eb72c5e9a39b354d9c394f9116f50"><div class="ttname"><a href="hook_8c.html#a6c1eb72c5e9a39b354d9c394f9116f50">mutt_folder_hook</a></div><div class="ttdeci">void mutt_folder_hook(const char *path, const char *desc)</div><div class="ttdoc">Perform a folder hook. </div><div class="ttdef"><b>Definition:</b> <a href="hook_8c_source.html#l00529">hook.c:529</a></div></div>
<div class="ttc" id="header_8h_html_a610db600447893b501a944c8e5dbb9f7a0a28c77e0af5e5563e7493b4265b58e8"><div class="ttname"><a href="header_8h.html#a610db600447893b501a944c8e5dbb9f7a0a28c77e0af5e5563e7493b4265b58e8">MUTT_WRITE_HEADER_FCC</a></div><div class="ttdoc">fcc mode, like normal mode but for Bcc header </div><div class="ttdef"><b>Definition:</b> <a href="header_8h_source.html#l00041">header.h:41</a></div></div>
<div class="ttc" id="structEmail_html_a0bd79550be901d44e50953fb43614e10"><div class="ttname"><a href="structEmail.html#a0bd79550be901d44e50953fb43614e10">Email::read</a></div><div class="ttdeci">bool read</div><div class="ttdoc">Email is read. </div><div class="ttdef"><b>Definition:</b> <a href="email_8h_source.html#l00051">email.h:51</a></div></div>
<div class="ttc" id="mx_8c_html_aebf47a6cd2a8bc442aaf347124d2e18a"><div class="ttname"><a href="mx_8c.html#aebf47a6cd2a8bc442aaf347124d2e18a">mx_msg_open_new</a></div><div class="ttdeci">struct Message * mx_msg_open_new(struct Mailbox *m, const struct Email *e, MsgOpenFlags flags)</div><div class="ttdoc">Open a new message. </div><div class="ttdef"><b>Definition:</b> <a href="mx_8c_source.html#l01054">mx.c:1054</a></div></div>
<div class="ttc" id="mailbox_8c_html_aba915aae97477d1ecc6428a06f92dac9"><div class="ttname"><a href="mailbox_8c.html#aba915aae97477d1ecc6428a06f92dac9">mailbox_free</a></div><div class="ttdeci">void mailbox_free(struct Mailbox **ptr)</div><div class="ttdoc">Free a Mailbox. </div><div class="ttdef"><b>Definition:</b> <a href="mailbox_8c_source.html#l00087">mailbox.c:87</a></div></div>
<div class="ttc" id="file_8c_html_a31f49795ff5b9558db5476e5777e63b6"><div class="ttname"><a href="file_8c.html#a31f49795ff5b9558db5476e5777e63b6">mutt_file_fclose</a></div><div class="ttdeci">int mutt_file_fclose(FILE **fp)</div><div class="ttdoc">Close a FILE handle (and NULL the pointer) </div><div class="ttdef"><b>Definition:</b> <a href="file_8c_source.html#l00153">file.c:153</a></div></div>
<div class="ttc" id="structEmail_html_a34cc4493729d7a3b1f4ed783e739a9ec"><div class="ttname"><a href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">Email::env</a></div><div class="ttdeci">struct Envelope * env</div><div class="ttdoc">Envelope information. </div><div class="ttdef"><b>Definition:</b> <a href="email_8h_source.html#l00090">email.h:90</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a798dfac1e8839ca89375b4ec62b3eff2"><div class="ttname"><a href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a></div><div class="ttdeci">#define APPLICATION_SMIME</div><div class="ttdoc">Use SMIME to encrypt/sign. </div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00088">lib.h:88</a></div></div>
<div class="ttc" id="structEmail_html_a9a3c73dc042313773159d921a711c830"><div class="ttname"><a href="structEmail.html#a9a3c73dc042313773159d921a711c830">Email::chain</a></div><div class="ttdeci">struct ListHead chain</div><div class="ttdoc">Mixmaster chain. </div><div class="ttdef"><b>Definition:</b> <a href="email_8h_source.html#l00102">email.h:102</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a587e679a4c9cc44f11f0c467bb22b0af"><div class="ttname"><a href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a></div><div class="ttdeci">#define APPLICATION_PGP</div><div class="ttdoc">Use PGP to encrypt/sign. </div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00087">lib.h:87</a></div></div>
<div class="ttc" id="structMessage_html"><div class="ttname"><a href="structMessage.html">Message</a></div><div class="ttdoc">A local copy of an email. </div><div class="ttdef"><b>Definition:</b> <a href="mxapi_8h_source.html#l00041">mxapi.h:41</a></div></div>
<div class="ttc" id="structMailbox_html"><div class="ttname"><a href="structMailbox.html">Mailbox</a></div><div class="ttdoc">A mailbox. </div><div class="ttdef"><b>Definition:</b> <a href="mailbox_8h_source.html#l00081">mailbox.h:81</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_ae0ce4a742538f3ee3e1bfbf143c794fb"><div class="ttname"><a href="ncrypt_2lib_8h.html#ae0ce4a742538f3ee3e1bfbf143c794fb">SEC_AUTOCRYPT_OVERRIDE</a></div><div class="ttdeci">#define SEC_AUTOCRYPT_OVERRIDE</div><div class="ttdoc">(Autocrypt) Indicates manual set/unset of encryption </div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00085">lib.h:85</a></div></div>
<div class="ttc" id="mailbox_8h_html_af65addf714c28dd5d483cb426100921da09cef4c4e3dc42c9137860413dcdb374"><div class="ttname"><a href="mailbox_8h.html#af65addf714c28dd5d483cb426100921da09cef4c4e3dc42c9137860413dcdb374">MUTT_MMDF</a></div><div class="ttdoc">&amp;#39;mmdf&amp;#39; Mailbox type </div><div class="ttdef"><b>Definition:</b> <a href="mailbox_8h_source.html#l00049">mailbox.h:49</a></div></div>
<div class="ttc" id="helpers_8c_html_ac477c591155aa4ae0452bbabc0affffe"><div class="ttname"><a href="helpers_8c.html#ac477c591155aa4ae0452bbabc0affffe">cs_subset_string</a></div><div class="ttdeci">const char * cs_subset_string(const struct ConfigSubset *sub, const char *name)</div><div class="ttdoc">Get a string config item by name. </div><div class="ttdef"><b>Definition:</b> <a href="helpers_8c_source.html#l00317">helpers.c:317</a></div></div>
<div class="ttc" id="structMailbox_html_a2481e68c768eb0cb6e17cfcd0f255f79"><div class="ttname"><a href="structMailbox.html#a2481e68c768eb0cb6e17cfcd0f255f79">Mailbox::append</a></div><div class="ttdeci">bool append</div><div class="ttdoc">Mailbox is opened in append mode. </div><div class="ttdef"><b>Definition:</b> <a href="mailbox_8h_source.html#l00113">mailbox.h:113</a></div></div>
<div class="ttc" id="mxapi_8h_html_a75f314042a266df29efcc524d35c4b2d"><div class="ttname"><a href="mxapi_8h.html#a75f314042a266df29efcc524d35c4b2d">MUTT_QUIET</a></div><div class="ttdeci">#define MUTT_QUIET</div><div class="ttdoc">Do not print any messages. </div><div class="ttdef"><b>Definition:</b> <a href="mxapi_8h_source.html#l00064">mxapi.h:64</a></div></div>
<div class="ttc" id="queue_8h_html_a77999ebdf5aaf7af8b8ea22bf208c432"><div class="ttname"><a href="queue_8h.html#a77999ebdf5aaf7af8b8ea22bf208c432">STAILQ_FOREACH</a></div><div class="ttdeci">#define STAILQ_FOREACH(var, head, field)</div><div class="ttdef"><b>Definition:</b> <a href="queue_8h_source.html#l00352">queue.h:352</a></div></div>
<div class="ttc" id="group__logging__api_html_gae6c5fd73af3410b2d5e8099f8774c8da"><div class="ttname"><a href="group__logging__api.html#gae6c5fd73af3410b2d5e8099f8774c8da">mutt_debug</a></div><div class="ttdeci">#define mutt_debug(LEVEL,...)</div><div class="ttdef"><b>Definition:</b> <a href="logging_8h_source.html#l00085">logging.h:85</a></div></div>
<div class="ttc" id="structEmail_html_a570a81cd747437c9ea4357947731ae10"><div class="ttname"><a href="structEmail.html#a570a81cd747437c9ea4357947731ae10">Email::security</a></div><div class="ttdeci">SecurityFlags security</div><div class="ttdoc">bit 0-10: flags, bit 11,12: application, bit 13: traditional pgp See: ncrypt/lib.h pgplib...</div><div class="ttdef"><b>Definition:</b> <a href="email_8h_source.html#l00039">email.h:39</a></div></div>
<div class="ttc" id="mx_8h_html_a3c2b592b42c4c70ba32b8fb9ce869750"><div class="ttname"><a href="mx_8h.html#a3c2b592b42c4c70ba32b8fb9ce869750">MsgOpenFlags</a></div><div class="ttdeci">uint8_t MsgOpenFlags</div><div class="ttdoc">Flags for mx_msg_open_new(), e.g. MUTT_ADD_FROM. </div><div class="ttdef"><b>Definition:</b> <a href="mx_8h_source.html#l00040">mx.h:40</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a2fb0b0aa796d8d79a746001d09c2a2c7"><div class="ttname"><a href="ncrypt_2lib_8h.html#a2fb0b0aa796d8d79a746001d09c2a2c7">SEC_OPPENCRYPT</a></div><div class="ttdeci">#define SEC_OPPENCRYPT</div><div class="ttdoc">Opportunistic encrypt mode. </div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00083">lib.h:83</a></div></div>
<div class="ttc" id="mailbox_8h_html_af65addf714c28dd5d483cb426100921da817ef3cf5f529965875400b412678525"><div class="ttname"><a href="mailbox_8h.html#af65addf714c28dd5d483cb426100921da817ef3cf5f529965875400b412678525">MUTT_MBOX</a></div><div class="ttdoc">&amp;#39;mbox&amp;#39; Mailbox type </div><div class="ttdef"><b>Definition:</b> <a href="mailbox_8h_source.html#l00048">mailbox.h:48</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_ae12c003463c99d28f65f1d6b8b053b2c"><div class="ttname"><a href="ncrypt_2lib_8h.html#ae12c003463c99d28f65f1d6b8b053b2c">SEC_SIGN</a></div><div class="ttdeci">#define SEC_SIGN</div><div class="ttdoc">Email is signed. </div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00076">lib.h:76</a></div></div>
<div class="ttc" id="structMessage_html_a817c2e03ff60bae58f117fc3391d3d62"><div class="ttname"><a href="structMessage.html#a817c2e03ff60bae58f117fc3391d3d62">Message::committed_path</a></div><div class="ttdeci">char * committed_path</div><div class="ttdoc">the final path generated by mx_msg_commit() </div><div class="ttdef"><b>Definition:</b> <a href="mxapi_8h_source.html#l00045">mxapi.h:45</a></div></div>
<div class="ttc" id="structListNode_html_aafe688d670318196766392d8235d00a7"><div class="ttname"><a href="structListNode.html#aafe688d670318196766392d8235d00a7">ListNode::data</a></div><div class="ttdeci">char * data</div><div class="ttdoc">String. </div><div class="ttdef"><b>Definition:</b> <a href="list_8h_source.html#l00036">list.h:36</a></div></div>
<div class="ttc" id="logging_8h_html_aca1fd1d8935433e6ba2e3918214e07f9ab2c99902c587a013b358149516cceeb5"><div class="ttname"><a href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab2c99902c587a013b358149516cceeb5">LL_DEBUG1</a></div><div class="ttdoc">Log at debug level 1. </div><div class="ttdef"><b>Definition:</b> <a href="logging_8h_source.html#l00040">logging.h:40</a></div></div>
<div class="ttc" id="file_8c_html_a0a6ff09a685fb6fa1120a582a5a6ef4a"><div class="ttname"><a href="file_8c.html#a0a6ff09a685fb6fa1120a582a5a6ef4a">mutt_file_copy_stream</a></div><div class="ttdeci">int mutt_file_copy_stream(FILE *fp_in, FILE *fp_out)</div><div class="ttdoc">Copy the contents of one file into another. </div><div class="ttdef"><b>Definition:</b> <a href="file_8c_source.html#l00271">file.c:271</a></div></div>
<div class="ttc" id="mx_8c_html_add0e192c5f27bf6bd096ae2eb7c0b67b"><div class="ttname"><a href="mx_8c.html#add0e192c5f27bf6bd096ae2eb7c0b67b">mx_msg_commit</a></div><div class="ttdeci">int mx_msg_commit(struct Mailbox *m, struct Message *msg)</div><div class="ttdoc">Commit a message to a folder - Wrapper for MxOps::msg_commit() </div><div class="ttdef"><b>Definition:</b> <a href="mx_8c_source.html#l01165">mx.c:1165</a></div></div>
<div class="ttc" id="structMessage_html_a11d53ee4319e8735c1677d8780a7b517"><div class="ttname"><a href="structMessage.html#a11d53ee4319e8735c1677d8780a7b517">Message::fp</a></div><div class="ttdeci">FILE * fp</div><div class="ttdoc">pointer to the message data </div><div class="ttdef"><b>Definition:</b> <a href="mxapi_8h_source.html#l00043">mxapi.h:43</a></div></div>
<div class="ttc" id="mx_8c_html_ab437d031227dc741c63cf2791c6b4562"><div class="ttname"><a href="mx_8c.html#ab437d031227dc741c63cf2791c6b4562">mx_path_resolve</a></div><div class="ttdeci">struct Mailbox * mx_path_resolve(const char *path)</div><div class="ttdoc">Get a Mailbox for a path. </div><div class="ttdef"><b>Definition:</b> <a href="mx_8c_source.html#l01668">mx.c:1668</a></div></div>
<div class="ttc" id="sendlib_8c_html_a31fd83b30e072d8a49049390853704f7"><div class="ttname"><a href="sendlib_8c.html#a31fd83b30e072d8a49049390853704f7">set_noconv_flags</a></div><div class="ttdeci">static void set_noconv_flags(struct Body *b, bool flag)</div><div class="ttdoc">Set/reset the &quot;x-mutt-noconv&quot; flag. </div><div class="ttdef"><b>Definition:</b> <a href="sendlib_8c_source.html#l01439">sendlib.c:1439</a></div></div>
<div class="ttc" id="queue_8h_html_a8427c8f43d09d73062cf6b37f303aff5"><div class="ttname"><a href="queue_8h.html#a8427c8f43d09d73062cf6b37f303aff5">STAILQ_EMPTY</a></div><div class="ttdeci">#define STAILQ_EMPTY(head)</div><div class="ttdef"><b>Definition:</b> <a href="queue_8h_source.html#l00348">queue.h:348</a></div></div>
<div class="ttc" id="file_8c_html_ae1c0c19fec03274220b3ca065ad1e2e5"><div class="ttname"><a href="file_8c.html#ae1c0c19fec03274220b3ca065ad1e2e5">mutt_file_fopen</a></div><div class="ttdeci">FILE * mutt_file_fopen(const char *path, const char *mode)</div><div class="ttdoc">Call fopen() safely. </div><div class="ttdef"><b>Definition:</b> <a href="file_8c_source.html#l00589">file.c:589</a></div></div>
<div class="ttc" id="structListNode_html"><div class="ttname"><a href="structListNode.html">ListNode</a></div><div class="ttdoc">A List node for strings. </div><div class="ttdef"><b>Definition:</b> <a href="list_8h_source.html#l00034">list.h:34</a></div></div>
<div class="ttc" id="mx_8h_html_a49087f3940d59f9624011017e42d9444"><div class="ttname"><a href="mx_8h.html#a49087f3940d59f9624011017e42d9444">MUTT_ADD_FROM</a></div><div class="ttdeci">#define MUTT_ADD_FROM</div><div class="ttdoc">add a From_ line </div><div class="ttdef"><b>Definition:</b> <a href="mx_8h_source.html#l00042">mx.h:42</a></div></div>
<div class="ttc" id="header_8c_html_a400e83b7e5612f974ef543ff3cd237d8"><div class="ttname"><a href="header_8c.html#a400e83b7e5612f974ef543ff3cd237d8">mutt_rfc822_write_header</a></div><div class="ttdeci">int mutt_rfc822_write_header(FILE *fp, struct Envelope *env, struct Body *attach, enum MuttWriteHeaderMode mode, bool privacy, bool hide_protected_subject, struct ConfigSubset *sub)</div><div class="ttdoc">Write out one RFC822 header line. </div><div class="ttdef"><b>Definition:</b> <a href="header_8c_source.html#l00574">header.c:574</a></div></div>
</div><!-- fragment --><div id="dynsection-24" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-24-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-24-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-24-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="sendlib_8h_acd4f22db21ca81a6a845ffe6888d141f_cgraph.svg" width="799" height="1216"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div id="dynsection-25" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-25-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-25-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-25-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="sendlib_8h_acd4f22db21ca81a6a845ffe6888d141f_icgraph.svg" width="358" height="139"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a8957ce367f6683e839e4ddb7245d466c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8957ce367f6683e839e4ddb7245d466c">&#9670;&nbsp;</a></span>mutt_write_multiple_fcc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mutt_write_multiple_fcc </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structEmail.html">Email</a> *&#160;</td>
          <td class="paramname"><em>e</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>msgid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>post</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>fcc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>finalpath</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structConfigSubset.html">ConfigSubset</a> *&#160;</td>
          <td class="paramname"><em>sub</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handle FCC with multiple, comma separated entries. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">path</td><td>Path to mailboxes (comma separated) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">e</td><td><a class="el" href="structEmail.html" title="The envelope/body of an email. ">Email</a> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">msgid</td><td><a class="el" href="structMessage.html" title="A local copy of an email. ">Message</a> id </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">post</td><td>If true, postpone message </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fcc</td><td>fcc setting to save (postpone only) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">finalpath</td><td>Final path of email </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sub</td><td>Config Subset </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Success </td></tr>
    <tr><td class="paramname">-1</td><td>Failure </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="sendlib_8c_source.html#l01467">1467</a> of file <a class="el" href="sendlib_8c_source.html">sendlib.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;{</div><div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;  <span class="keywordtype">char</span> fcc_tok[<a class="code" href="mutt_8h.html#ae688d728e1acdfe5988c7db45d6f0166">PATH_MAX</a>];</div><div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;  <span class="keywordtype">char</span> fcc_expanded[<a class="code" href="mutt_8h.html#ae688d728e1acdfe5988c7db45d6f0166">PATH_MAX</a>];</div><div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;</div><div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;  <a class="code" href="mutt_2string_8c.html#ad20e00309de897a1e882fc7400335b83">mutt_str_copy</a>(fcc_tok, path, <span class="keyword">sizeof</span>(fcc_tok));</div><div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;</div><div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;  <span class="keywordtype">char</span> *tok = strtok(fcc_tok, <span class="stringliteral">&quot;,&quot;</span>);</div><div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;  <span class="keywordflow">if</span> (!tok)</div><div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;</div><div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;  <a class="code" href="group__logging__api.html#gae6c5fd73af3410b2d5e8099f8774c8da">mutt_debug</a>(<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab2c99902c587a013b358149516cceeb5">LL_DEBUG1</a>, <span class="stringliteral">&quot;Fcc: initial mailbox = &#39;%s&#39;\n&quot;</span>, tok);</div><div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;  <span class="comment">/* mutt_expand_path already called above for the first token */</span></div><div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;  <span class="keywordtype">int</span> status = <a class="code" href="sendlib_8c.html#acd4f22db21ca81a6a845ffe6888d141f">mutt_write_fcc</a>(tok, e, msgid, post, fcc, finalpath, sub);</div><div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;  <span class="keywordflow">if</span> (status != 0)</div><div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;    <span class="keywordflow">return</span> status;</div><div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;</div><div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;  <span class="keywordflow">while</span> ((tok = strtok(NULL, <span class="stringliteral">&quot;,&quot;</span>)))</div><div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;  {</div><div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;    <span class="keywordflow">if</span> (*tok == <span class="charliteral">&#39;\0&#39;</span>)</div><div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;</div><div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;    <span class="comment">/* Only call mutt_expand_path if tok has some data */</span></div><div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;    <a class="code" href="group__logging__api.html#gae6c5fd73af3410b2d5e8099f8774c8da">mutt_debug</a>(<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab2c99902c587a013b358149516cceeb5">LL_DEBUG1</a>, <span class="stringliteral">&quot;Fcc: additional mailbox token = &#39;%s&#39;\n&quot;</span>, tok);</div><div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;    <a class="code" href="mutt_2string_8c.html#ad20e00309de897a1e882fc7400335b83">mutt_str_copy</a>(fcc_expanded, tok, <span class="keyword">sizeof</span>(fcc_expanded));</div><div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;    <a class="code" href="muttlib_8c.html#a483f037de523c624d449b4296a3ddfb2">mutt_expand_path</a>(fcc_expanded, <span class="keyword">sizeof</span>(fcc_expanded));</div><div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;    <a class="code" href="group__logging__api.html#gae6c5fd73af3410b2d5e8099f8774c8da">mutt_debug</a>(<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab2c99902c587a013b358149516cceeb5">LL_DEBUG1</a>, <span class="stringliteral">&quot;     Additional mailbox expanded = &#39;%s&#39;\n&quot;</span>, fcc_expanded);</div><div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;    status = <a class="code" href="sendlib_8c.html#acd4f22db21ca81a6a845ffe6888d141f">mutt_write_fcc</a>(fcc_expanded, e, msgid, post, fcc, finalpath, sub);</div><div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;    <span class="keywordflow">if</span> (status != 0)</div><div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;      <span class="keywordflow">return</span> status;</div><div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;  }</div><div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;</div><div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;}</div><div class="ttc" id="sendlib_8c_html_acd4f22db21ca81a6a845ffe6888d141f"><div class="ttname"><a href="sendlib_8c.html#acd4f22db21ca81a6a845ffe6888d141f">mutt_write_fcc</a></div><div class="ttdeci">int mutt_write_fcc(const char *path, struct Email *e, const char *msgid, bool post, const char *fcc, char **finalpath, struct ConfigSubset *sub)</div><div class="ttdoc">Write email to FCC mailbox. </div><div class="ttdef"><b>Definition:</b> <a href="sendlib_8c_source.html#l01515">sendlib.c:1515</a></div></div>
<div class="ttc" id="muttlib_8c_html_a483f037de523c624d449b4296a3ddfb2"><div class="ttname"><a href="muttlib_8c.html#a483f037de523c624d449b4296a3ddfb2">mutt_expand_path</a></div><div class="ttdeci">char * mutt_expand_path(char *buf, size_t buflen)</div><div class="ttdoc">Create the canonical path. </div><div class="ttdef"><b>Definition:</b> <a href="muttlib_8c_source.html#l00122">muttlib.c:122</a></div></div>
<div class="ttc" id="mutt_8h_html_ae688d728e1acdfe5988c7db45d6f0166"><div class="ttname"><a href="mutt_8h.html#ae688d728e1acdfe5988c7db45d6f0166">PATH_MAX</a></div><div class="ttdeci">#define PATH_MAX</div><div class="ttdef"><b>Definition:</b> <a href="mutt_8h_source.html#l00040">mutt.h:40</a></div></div>
<div class="ttc" id="group__logging__api_html_gae6c5fd73af3410b2d5e8099f8774c8da"><div class="ttname"><a href="group__logging__api.html#gae6c5fd73af3410b2d5e8099f8774c8da">mutt_debug</a></div><div class="ttdeci">#define mutt_debug(LEVEL,...)</div><div class="ttdef"><b>Definition:</b> <a href="logging_8h_source.html#l00085">logging.h:85</a></div></div>
<div class="ttc" id="logging_8h_html_aca1fd1d8935433e6ba2e3918214e07f9ab2c99902c587a013b358149516cceeb5"><div class="ttname"><a href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab2c99902c587a013b358149516cceeb5">LL_DEBUG1</a></div><div class="ttdoc">Log at debug level 1. </div><div class="ttdef"><b>Definition:</b> <a href="logging_8h_source.html#l00040">logging.h:40</a></div></div>
<div class="ttc" id="mutt_2string_8c_html_ad20e00309de897a1e882fc7400335b83"><div class="ttname"><a href="mutt_2string_8c.html#ad20e00309de897a1e882fc7400335b83">mutt_str_copy</a></div><div class="ttdeci">size_t mutt_str_copy(char *dest, const char *src, size_t dsize)</div><div class="ttdoc">Copy a string into a buffer (guaranteeing NUL-termination) </div><div class="ttdef"><b>Definition:</b> <a href="mutt_2string_8c_source.html#l00749">string.c:749</a></div></div>
</div><!-- fragment --><div id="dynsection-26" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-26-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-26-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-26-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="sendlib_8h_a8957ce367f6683e839e4ddb7245d466c_cgraph.svg" width="383" height="139"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div id="dynsection-27" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-27-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-27-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-27-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="sendlib_8h_a8957ce367f6683e839e4ddb7245d466c_icgraph.svg" width="318" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
</body>
</html>
