<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NeoMutt: ncrypt/lib.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><a href="https://neomutt.org"><img alt="Logo" src="neomutt-64.png"/></a></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <a style="color: black; text-decoration: none;" href="https://neomutt.org">
   <div id="projectname">NeoMutt
   &#160;<span id="projectnumber">2021-02-05-647-g5d4e00</span>
   </div>
   <div id="projectbrief">Teaching an old dog new tricks</div>
   </a>
   <a href="https://github.com/neomutt/neomutt" class="github-corner" aria-label="View source on Github"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#000000; color:#fff; position: fixed; top: 0; border: 0; right: 0; z-index: 9999;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
  </td>
   <td><a style="text-decoration: none; position: absolute; right: 0; top: 25px; margin-right: 100px; color: #66d866; font-size: 400%;" href="http://www.doxygen.org/index.html">DOXYGEN</a></td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('ncrypt_2lib_8h_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">lib.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="ncrypt_2lib_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="preprocessor">#ifndef MUTT_NCRYPT_LIB_H</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="preprocessor">#define MUTT_NCRYPT_LIB_H</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="preprocessor">#include &lt;stdbool.h&gt;</span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="preprocessor">#include &lt;stdint.h&gt;</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="preprocessor">#include &lt;stdio.h&gt;</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="keyword">struct </span><a class="code" href="structAddress.html">Address</a>;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="keyword">struct </span><a class="code" href="structBody.html">Body</a>;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="preprocessor">#ifdef USE_AUTOCRYPT</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="keyword">struct </span><a class="code" href="structBuffer.html">Buffer</a>;</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="keyword">struct </span><a class="code" href="structEmail.html">Email</a>;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="keyword">struct </span>EmailList;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="keyword">struct </span><a class="code" href="structEnvelope.html">Envelope</a>;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="keyword">struct </span><a class="code" href="structMailbox.html">Mailbox</a>;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="keyword">struct </span><a class="code" href="structMessage.html">Message</a>;</div><div class="line"><a name="l00071"></a><span class="lineno"><a class="line" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">   71</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structState.html">State</a>;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="keyword">typedef</span> uint16_t <a class="code" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a>;           </div><div class="line"><a name="l00074"></a><span class="lineno"><a class="line" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">   74</a></span>&#160;<span class="preprocessor">#define SEC_NO_FLAGS                  0   </span></div><div class="line"><a name="l00075"></a><span class="lineno"><a class="line" href="ncrypt_2lib_8h.html#aacaa4abd4c0696e260b7a0f1d466360a">   75</a></span>&#160;<span class="preprocessor">#define SEC_ENCRYPT             (1 &lt;&lt; 0)  </span></div><div class="line"><a name="l00076"></a><span class="lineno"><a class="line" href="ncrypt_2lib_8h.html#ae12c003463c99d28f65f1d6b8b053b2c">   76</a></span>&#160;<span class="preprocessor">#define SEC_SIGN                (1 &lt;&lt; 1)  </span></div><div class="line"><a name="l00077"></a><span class="lineno"><a class="line" href="ncrypt_2lib_8h.html#a427cda1ba4b173fa708e124afe7b907a">   77</a></span>&#160;<span class="preprocessor">#define SEC_GOODSIGN            (1 &lt;&lt; 2)  </span></div><div class="line"><a name="l00078"></a><span class="lineno"><a class="line" href="ncrypt_2lib_8h.html#a70ffca3c8f9bc49498e3352294c5b8fd">   78</a></span>&#160;<span class="preprocessor">#define SEC_BADSIGN             (1 &lt;&lt; 3)  </span></div><div class="line"><a name="l00079"></a><span class="lineno"><a class="line" href="ncrypt_2lib_8h.html#a9b0f8af6da383f08d29eb97fac836e3f">   79</a></span>&#160;<span class="preprocessor">#define SEC_PARTSIGN            (1 &lt;&lt; 4)  </span></div><div class="line"><a name="l00080"></a><span class="lineno"><a class="line" href="ncrypt_2lib_8h.html#a6522a5e7af7f8624b8a3bbc94d8efb1e">   80</a></span>&#160;<span class="preprocessor">#define SEC_SIGNOPAQUE          (1 &lt;&lt; 5)  </span></div><div class="line"><a name="l00081"></a><span class="lineno"><a class="line" href="ncrypt_2lib_8h.html#affb64fdb57b996638ce5b783ccb48810">   81</a></span>&#160;<span class="preprocessor">#define SEC_KEYBLOCK            (1 &lt;&lt; 6)  </span></div><div class="line"><a name="l00082"></a><span class="lineno"><a class="line" href="ncrypt_2lib_8h.html#a074f827472ad45f11ec1132cdfed2daf">   82</a></span>&#160;<span class="preprocessor">#define SEC_INLINE              (1 &lt;&lt; 7)  </span></div><div class="line"><a name="l00083"></a><span class="lineno"><a class="line" href="ncrypt_2lib_8h.html#a2fb0b0aa796d8d79a746001d09c2a2c7">   83</a></span>&#160;<span class="preprocessor">#define SEC_OPPENCRYPT          (1 &lt;&lt; 8)  </span></div><div class="line"><a name="l00084"></a><span class="lineno"><a class="line" href="ncrypt_2lib_8h.html#a0b36be5c32ca90d8f2caef9ea9d627fc">   84</a></span>&#160;<span class="preprocessor">#define SEC_AUTOCRYPT           (1 &lt;&lt; 9)  </span></div><div class="line"><a name="l00085"></a><span class="lineno"><a class="line" href="ncrypt_2lib_8h.html#ae0ce4a742538f3ee3e1bfbf143c794fb">   85</a></span>&#160;<span class="preprocessor">#define SEC_AUTOCRYPT_OVERRIDE  (1 &lt;&lt; 10) </span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="preprocessor"></span></div><div class="line"><a name="l00087"></a><span class="lineno"><a class="line" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">   87</a></span>&#160;<span class="preprocessor">#define APPLICATION_PGP         (1 &lt;&lt; 11) </span></div><div class="line"><a name="l00088"></a><span class="lineno"><a class="line" href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">   88</a></span>&#160;<span class="preprocessor">#define APPLICATION_SMIME       (1 &lt;&lt; 12) </span></div><div class="line"><a name="l00089"></a><span class="lineno"><a class="line" href="ncrypt_2lib_8h.html#a3c4cec129dc84794f15f44382c25fc36">   89</a></span>&#160;<span class="preprocessor">#define PGP_TRADITIONAL_CHECKED (1 &lt;&lt; 13) </span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="preprocessor"></span></div><div class="line"><a name="l00091"></a><span class="lineno"><a class="line" href="ncrypt_2lib_8h.html#a3eec0b09486fe4bfe7613f808f768747">   91</a></span>&#160;<span class="preprocessor">#define SEC_ALL_FLAGS          ((1 &lt;&lt; 14) - 1)</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;</div><div class="line"><a name="l00093"></a><span class="lineno"><a class="line" href="ncrypt_2lib_8h.html#a6694d25dff1ee1958351160a84bb2dc0">   93</a></span>&#160;<span class="preprocessor">#define PGP_ENCRYPT  (APPLICATION_PGP | SEC_ENCRYPT)</span></div><div class="line"><a name="l00094"></a><span class="lineno"><a class="line" href="ncrypt_2lib_8h.html#a14f75a650c49341776276f44881d54b2">   94</a></span>&#160;<span class="preprocessor">#define PGP_SIGN     (APPLICATION_PGP | SEC_SIGN)</span></div><div class="line"><a name="l00095"></a><span class="lineno"><a class="line" href="ncrypt_2lib_8h.html#ae480697fdeb3d6b2c127e0ae36c52e8e">   95</a></span>&#160;<span class="preprocessor">#define PGP_GOODSIGN (APPLICATION_PGP | SEC_GOODSIGN)</span></div><div class="line"><a name="l00096"></a><span class="lineno"><a class="line" href="ncrypt_2lib_8h.html#abd2087cae2885c199218f5530ce7945b">   96</a></span>&#160;<span class="preprocessor">#define PGP_KEY      (APPLICATION_PGP | SEC_KEYBLOCK)</span></div><div class="line"><a name="l00097"></a><span class="lineno"><a class="line" href="ncrypt_2lib_8h.html#a68503f0e36de213094c8546b4f74eef1">   97</a></span>&#160;<span class="preprocessor">#define PGP_INLINE   (APPLICATION_PGP | SEC_INLINE)</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div><div class="line"><a name="l00099"></a><span class="lineno"><a class="line" href="ncrypt_2lib_8h.html#ac25eb5415ebf34da68c39a3d4e3bc9ad">   99</a></span>&#160;<span class="preprocessor">#define SMIME_ENCRYPT  (APPLICATION_SMIME | SEC_ENCRYPT)</span></div><div class="line"><a name="l00100"></a><span class="lineno"><a class="line" href="ncrypt_2lib_8h.html#a67114d960e61fc36c467f4bf08d37335">  100</a></span>&#160;<span class="preprocessor">#define SMIME_SIGN     (APPLICATION_SMIME | SEC_SIGN)</span></div><div class="line"><a name="l00101"></a><span class="lineno"><a class="line" href="ncrypt_2lib_8h.html#a3e7bff0627202fd91790855e1300ec99">  101</a></span>&#160;<span class="preprocessor">#define SMIME_GOODSIGN (APPLICATION_SMIME | SEC_GOODSIGN)</span></div><div class="line"><a name="l00102"></a><span class="lineno"><a class="line" href="ncrypt_2lib_8h.html#a79c49cef9301420920c8c673f06a1be1">  102</a></span>&#160;<span class="preprocessor">#define SMIME_BADSIGN  (APPLICATION_SMIME | SEC_BADSIGN)</span></div><div class="line"><a name="l00103"></a><span class="lineno"><a class="line" href="ncrypt_2lib_8h.html#a9c811504abf735623a6dd3ac20287f30">  103</a></span>&#160;<span class="preprocessor">#define SMIME_OPAQUE   (APPLICATION_SMIME | SEC_SIGNOPAQUE)</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment">/* WITHCRYPTO actually replaces ifdefs to make the code more readable.</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment"> * Because it is defined as a constant and known at compile time, the</span></div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment"> * compiler can do dead code elimination and thus it behaves</span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment"> * effectively as a conditional compile directive. It is set to false</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment"> * if no crypto backend is configured or to a bit vector denoting the</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment"> * configured backends. */</span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="preprocessor">#if (defined(CRYPT_BACKEND_CLASSIC_PGP) &amp;&amp; defined(CRYPT_BACKEND_CLASSIC_SMIME)) || \</span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="preprocessor">    defined(CRYPT_BACKEND_GPGME)</span></div><div class="line"><a name="l00113"></a><span class="lineno"><a class="line" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">  113</a></span>&#160;<span class="preprocessor">#define WithCrypto (APPLICATION_PGP | APPLICATION_SMIME)</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="preprocessor">#elif defined(CRYPT_BACKEND_CLASSIC_PGP)</span></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="preprocessor">#define WithCrypto APPLICATION_PGP</span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="preprocessor">#elif defined(CRYPT_BACKEND_CLASSIC_SMIME)</span></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="preprocessor">#define WithCrypto APPLICATION_SMIME</span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="preprocessor">#define WithCrypto 0</span></div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;</div><div class="line"><a name="l00122"></a><span class="lineno"><a class="line" href="ncrypt_2lib_8h.html#a530487c28aacc2c2d50f12eefb8c5506">  122</a></span>&#160;<span class="keyword">typedef</span> uint16_t <a class="code" href="ncrypt_2lib_8h.html#a530487c28aacc2c2d50f12eefb8c5506">KeyFlags</a>;                  </div><div class="line"><a name="l00123"></a><span class="lineno"><a class="line" href="ncrypt_2lib_8h.html#a827146354c736ec416508944692e52b2">  123</a></span>&#160;<span class="preprocessor">#define KEYFLAG_NO_FLAGS                0   </span></div><div class="line"><a name="l00124"></a><span class="lineno"><a class="line" href="ncrypt_2lib_8h.html#aee8e2da44282ca27f6a786cef781334f">  124</a></span>&#160;<span class="preprocessor">#define KEYFLAG_CANSIGN           (1 &lt;&lt; 0)  </span></div><div class="line"><a name="l00125"></a><span class="lineno"><a class="line" href="ncrypt_2lib_8h.html#a7254adf21a76d4ceea08bd931df4310f">  125</a></span>&#160;<span class="preprocessor">#define KEYFLAG_CANENCRYPT        (1 &lt;&lt; 1)  </span></div><div class="line"><a name="l00126"></a><span class="lineno"><a class="line" href="ncrypt_2lib_8h.html#a52372a26134009ebc0f946abc8a6075c">  126</a></span>&#160;<span class="preprocessor">#define KEYFLAG_ISX509            (1 &lt;&lt; 2)  </span></div><div class="line"><a name="l00127"></a><span class="lineno"><a class="line" href="ncrypt_2lib_8h.html#aacc955f91dd3fdc8b82246c140f023fa">  127</a></span>&#160;<span class="preprocessor">#define KEYFLAG_SECRET            (1 &lt;&lt; 7)  </span></div><div class="line"><a name="l00128"></a><span class="lineno"><a class="line" href="ncrypt_2lib_8h.html#a20472f13517d60d40aa75287afc81c5d">  128</a></span>&#160;<span class="preprocessor">#define KEYFLAG_EXPIRED           (1 &lt;&lt; 8)  </span></div><div class="line"><a name="l00129"></a><span class="lineno"><a class="line" href="ncrypt_2lib_8h.html#acb95b48318487d9eb8f9709e933d749e">  129</a></span>&#160;<span class="preprocessor">#define KEYFLAG_REVOKED           (1 &lt;&lt; 9)  </span></div><div class="line"><a name="l00130"></a><span class="lineno"><a class="line" href="ncrypt_2lib_8h.html#a989f3449b764c6a8f5f5e0481569884a">  130</a></span>&#160;<span class="preprocessor">#define KEYFLAG_DISABLED          (1 &lt;&lt; 10) </span></div><div class="line"><a name="l00131"></a><span class="lineno"><a class="line" href="ncrypt_2lib_8h.html#a73a1ead56127b7fac407296e153c0967">  131</a></span>&#160;<span class="preprocessor">#define KEYFLAG_SUBKEY            (1 &lt;&lt; 11) </span></div><div class="line"><a name="l00132"></a><span class="lineno"><a class="line" href="ncrypt_2lib_8h.html#a8ffaa1a95f918db325d8d770f76a7f79">  132</a></span>&#160;<span class="preprocessor">#define KEYFLAG_CRITICAL          (1 &lt;&lt; 12) </span></div><div class="line"><a name="l00133"></a><span class="lineno"><a class="line" href="ncrypt_2lib_8h.html#ae4067c9bae1c276c505b42265b70529e">  133</a></span>&#160;<span class="preprocessor">#define KEYFLAG_PREFER_ENCRYPTION (1 &lt;&lt; 13) </span></div><div class="line"><a name="l00134"></a><span class="lineno"><a class="line" href="ncrypt_2lib_8h.html#a88a54f7be16fc36441fafe14ee14ac0b">  134</a></span>&#160;<span class="preprocessor">#define KEYFLAG_PREFER_SIGNING    (1 &lt;&lt; 14) </span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="preprocessor"></span></div><div class="line"><a name="l00136"></a><span class="lineno"><a class="line" href="ncrypt_2lib_8h.html#a74b325469393092ed6d402f1ba78d7ba">  136</a></span>&#160;<span class="preprocessor">#define KEYFLAG_CANTUSE (KEYFLAG_DISABLED | KEYFLAG_REVOKED | KEYFLAG_EXPIRED)</span></div><div class="line"><a name="l00137"></a><span class="lineno"><a class="line" href="ncrypt_2lib_8h.html#a5b5753c8babedca24c31e8d2dbad8130">  137</a></span>&#160;<span class="preprocessor">#define KEYFLAG_RESTRICTIONS (KEYFLAG_CANTUSE | KEYFLAG_CRITICAL)</span></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;</div><div class="line"><a name="l00139"></a><span class="lineno"><a class="line" href="ncrypt_2lib_8h.html#a71ddb5e69f239d16bdf6a6cc266072e4">  139</a></span>&#160;<span class="preprocessor">#define KEYFLAG_ABILITIES (KEYFLAG_CANSIGN | KEYFLAG_CANENCRYPT | KEYFLAG_PREFER_ENCRYPTION | KEYFLAG_PREFER_SIGNING)</span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">/* crypt.c */</span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="keywordtype">void</span>         <a class="code" href="ncrypt_2lib_8h.html#adffb5a3014f93e3f82de3964911041d0">crypt_extract_keys_from_messages</a>(<span class="keyword">struct</span> <a class="code" href="structMailbox.html">Mailbox</a> *m, <span class="keyword">struct</span> EmailList *el);</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="keywordtype">void</span>         <a class="code" href="ncrypt_2lib_8h.html#a8a09719065d14c27701c998b48883ac4">crypt_forget_passphrase</a>(<span class="keywordtype">void</span>);</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="keywordtype">int</span>          <a class="code" href="ncrypt_2lib_8h.html#a35eba8f2cd36c286f2226ff748ee63e6">crypt_get_keys</a>(<span class="keyword">struct</span> <a class="code" href="structMailbox.html">Mailbox</a> *m, <span class="keyword">struct</span> <a class="code" href="structEmail.html">Email</a> *e, <span class="keywordtype">char</span> **keylist, <span class="keywordtype">bool</span> oppenc_mode);</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="keywordtype">void</span>         <a class="code" href="ncrypt_2lib_8h.html#a8ebc13a33b0dd650151d5b1b37cb99e4">crypt_opportunistic_encrypt</a>(<span class="keyword">struct</span> <a class="code" href="structMailbox.html">Mailbox</a> *m, <span class="keyword">struct</span> <a class="code" href="structEmail.html">Email</a> *e);</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<a class="code" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a> <a class="code" href="ncrypt_2lib_8h.html#af4ab2e337a2477fba687b1f710aa7a61">crypt_query</a>(<span class="keyword">struct</span> <a class="code" href="structBody.html">Body</a> *b);</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="keywordtype">bool</span>         <a class="code" href="ncrypt_2lib_8h.html#a4ee7f1419a7e39b0e9f1f9d550f4de43">crypt_valid_passphrase</a>(<a class="code" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a> <a class="code" href="structState.html#a5d855f7d518fde2ac4e8e409cbb24ad3">flags</a>);</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<a class="code" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a> <a class="code" href="ncrypt_2lib_8h.html#a159d0d34a10b662acb2cc80099e5ecc7">mutt_is_application_pgp</a>(<span class="keyword">struct</span> <a class="code" href="structBody.html">Body</a> *b);</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<a class="code" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a> <a class="code" href="ncrypt_2lib_8h.html#a4073ce5b5fcec6e245dbfa9369016b8e">mutt_is_application_smime</a>(<span class="keyword">struct</span> <a class="code" href="structBody.html">Body</a> *b);</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<a class="code" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a> <a class="code" href="ncrypt_2lib_8h.html#a9edb0262eaed7c522977a75b76c15770">mutt_is_malformed_multipart_pgp_encrypted</a>(<span class="keyword">struct</span> <a class="code" href="structBody.html">Body</a> *b);</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<a class="code" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a> <a class="code" href="ncrypt_2lib_8h.html#a832e4b9f5a0e463876a3d8cfe852f12d">mutt_is_multipart_encrypted</a>(<span class="keyword">struct</span> <a class="code" href="structBody.html">Body</a> *b);</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<a class="code" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a> <a class="code" href="ncrypt_2lib_8h.html#a345fb1ff241b3fc778632947c2b08d37">mutt_is_multipart_signed</a>(<span class="keyword">struct</span> <a class="code" href="structBody.html">Body</a> *b);</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="keywordtype">int</span>          <a class="code" href="ncrypt_2lib_8h.html#a51806f872069460bb7f4fa16d1d92710">mutt_is_valid_multipart_pgp_encrypted</a>(<span class="keyword">struct</span> <a class="code" href="structBody.html">Body</a> *b);</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="keywordtype">int</span>          <a class="code" href="ncrypt_2lib_8h.html#afb7fbdc0157b9f7fd68b378232d554fc">mutt_protect</a>(<span class="keyword">struct</span> <a class="code" href="structMailbox.html">Mailbox</a> *m, <span class="keyword">struct</span> <a class="code" href="structEmail.html">Email</a> *e, <span class="keywordtype">char</span> *keylist, <span class="keywordtype">bool</span> postpone);</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="keywordtype">int</span>          <a class="code" href="ncrypt_2lib_8h.html#aced59da2579d14e9b136b372ce683bc5">mutt_protected_headers_handler</a>(<span class="keyword">struct</span> <a class="code" href="structBody.html">Body</a> *b, <span class="keyword">struct</span> <a class="code" href="structState.html">State</a> *s);</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="keywordtype">bool</span>         <a class="code" href="ncrypt_2lib_8h.html#a52c65477f5b80ad3dc8028663653771d">mutt_should_hide_protected_subject</a>(<span class="keyword">struct</span> <a class="code" href="structEmail.html">Email</a> *e);</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="keywordtype">int</span>          <a class="code" href="ncrypt_2lib_8h.html#a3e7ec2b5bc58891704d4c49159cbef9a">mutt_signed_handler</a>(<span class="keyword">struct</span> <a class="code" href="structBody.html">Body</a> *b, <span class="keyword">struct</span> <a class="code" href="structState.html">State</a> *s);</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment">/* cryptglue.c */</span></div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="keywordtype">void</span>         <a class="code" href="ncrypt_2lib_8h.html#a397940a79b0c75800fed7d264f7fd6b4">crypt_cleanup</a>(<span class="keywordtype">void</span>);</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="keywordtype">bool</span>         <a class="code" href="ncrypt_2lib_8h.html#a07a6c891658dd90ef8333a1e5bbcc285">crypt_has_module_backend</a>(<a class="code" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a> type);</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="keywordtype">void</span>         <a class="code" href="ncrypt_2lib_8h.html#aaecf706c319966f9eafd582b58ba531f">crypt_init</a>(<span class="keywordtype">void</span>);</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="keywordtype">void</span>         <a class="code" href="ncrypt_2lib_8h.html#a166ec08d102f4330fdd0cc44a32bdf96">crypt_invoke_message</a>(<a class="code" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a> type);</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="keywordtype">int</span>          <a class="code" href="ncrypt_2lib_8h.html#aaf94d2bf9e0c58d5d8e436397611be27">crypt_pgp_application_handler</a>(<span class="keyword">struct</span> <a class="code" href="structBody.html">Body</a> *m, <span class="keyword">struct</span> <a class="code" href="structState.html">State</a> *s);</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="keywordtype">bool</span>         <a class="code" href="ncrypt_2lib_8h.html#a5959b6797c94b22a7d391cbb5fd2fa33">crypt_pgp_check_traditional</a>(FILE *fp, <span class="keyword">struct</span> <a class="code" href="structBody.html">Body</a> *b, <span class="keywordtype">bool</span> just_one);</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="keywordtype">int</span>          <a class="code" href="ncrypt_2lib_8h.html#aa8e21077ffe83ed3b10dc22acdd6c2e2">crypt_pgp_decrypt_mime</a>(FILE *<a class="code" href="structState.html#a9cf7e1f0c5c12399def5ca38b13054ae">fp_in</a>, FILE **<a class="code" href="structState.html#a88fc722d3012ebf69d3a061cbf6bc296">fp_out</a>, <span class="keyword">struct</span> <a class="code" href="structBody.html">Body</a> *b, <span class="keyword">struct</span> <a class="code" href="structBody.html">Body</a> **cur);</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="keywordtype">int</span>          <a class="code" href="ncrypt_2lib_8h.html#ab8e4063aa85a986a6879cbd45e14096c">crypt_pgp_encrypted_handler</a>(<span class="keyword">struct</span> <a class="code" href="structBody.html">Body</a> *a, <span class="keyword">struct</span> <a class="code" href="structState.html">State</a> *s);</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="keywordtype">void</span>         <a class="code" href="ncrypt_2lib_8h.html#afa26cebcc0c8d8866129fc2eabdbe874">crypt_pgp_extract_key_from_attachment</a>(FILE *fp, <span class="keyword">struct</span> <a class="code" href="structBody.html">Body</a> *top);</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="keywordtype">void</span>         <a class="code" href="ncrypt_2lib_8h.html#a7d989caa27c6539e55662007a6cf2cc5">crypt_pgp_invoke_getkeys</a>(<span class="keyword">struct</span> <a class="code" href="structAddress.html">Address</a> *addr);</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="keyword">struct </span><a class="code" href="structBody.html">Body</a> *<a class="code" href="ncrypt_2lib_8h.html#ac671b1b0cd5df34d49ea749d29df8d3f">crypt_pgp_make_key_attachment</a>(<span class="keywordtype">void</span>);</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<a class="code" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a> <a class="code" href="ncrypt_2lib_8h.html#abebf8caf41c84183ebacca4e7d7afe8c">crypt_pgp_send_menu</a>(<span class="keyword">struct</span> <a class="code" href="structMailbox.html">Mailbox</a> *m, <span class="keyword">struct</span> <a class="code" href="structEmail.html">Email</a> *e);</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="keywordtype">int</span>          <a class="code" href="ncrypt_2lib_8h.html#a449d34e46ef8984a0a435909e1c0d7ab">crypt_smime_application_handler</a>(<span class="keyword">struct</span> <a class="code" href="structBody.html">Body</a> *m, <span class="keyword">struct</span> <a class="code" href="structState.html">State</a> *s);</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="keywordtype">int</span>          <a class="code" href="ncrypt_2lib_8h.html#a34e8cf4a9f68adbcd30d41a242ede1e7">crypt_smime_decrypt_mime</a>(FILE *fp_in, FILE **fp_out, <span class="keyword">struct</span> <a class="code" href="structBody.html">Body</a> *b, <span class="keyword">struct</span> <a class="code" href="structBody.html">Body</a> **cur);</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="keywordtype">void</span>         <a class="code" href="ncrypt_2lib_8h.html#a3f60f47f4d4dee7f43f502b7244af35f">crypt_smime_getkeys</a>(<span class="keyword">struct</span> <a class="code" href="structEnvelope.html">Envelope</a> *env);</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<a class="code" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a> <a class="code" href="ncrypt_2lib_8h.html#a352931faf3dbfb2f6d2d6c0a32ad830e">crypt_smime_send_menu</a>(<span class="keyword">struct</span> <a class="code" href="structMailbox.html">Mailbox</a> *m, <span class="keyword">struct</span> <a class="code" href="structEmail.html">Email</a> *e);</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="keywordtype">int</span>          <a class="code" href="ncrypt_2lib_8h.html#aa05d4e0d23b75f9074f47ff55d7b724b">crypt_smime_verify_sender</a>(<span class="keyword">struct</span> <a class="code" href="structMailbox.html">Mailbox</a> *m, <span class="keyword">struct</span> <a class="code" href="structEmail.html">Email</a> *e, <span class="keyword">struct</span> <a class="code" href="structMessage.html">Message</a> *msg);</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment">/* crypt_mod.c */</span></div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="keywordtype">void</span> <a class="code" href="ncrypt_2lib_8h.html#a6f815761abc33bf614605b9a39b3002b">crypto_module_free</a>(<span class="keywordtype">void</span>);</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="preprocessor">#ifdef CRYPT_BACKEND_GPGME</span></div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment">/* crypt_gpgme.c */</span></div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="keywordtype">void</span>         <a class="code" href="ncrypt_2lib_8h.html#a7061521ecb51237cbbc557440353af39">pgp_gpgme_init</a>(<span class="keywordtype">void</span>);</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="preprocessor">#ifdef USE_AUTOCRYPT</span></div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="keywordtype">int</span>          <a class="code" href="ncrypt_2lib_8h.html#a2e8df329d00791c453eb6b3f60eabfdf">mutt_gpgme_select_secret_key</a> (<span class="keyword">struct</span> <a class="code" href="structBuffer.html">Buffer</a> *keyid);</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="keyword">const</span> <span class="keywordtype">char</span>  *<a class="code" href="ncrypt_2lib_8h.html#a6d2692bdc72ffa198bb8ca2a28cfa395">mutt_gpgme_print_version</a>(<span class="keywordtype">void</span>);</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* MUTT_NCRYPT_LIB_H */</span><span class="preprocessor"></span></div><div class="ttc" id="ncrypt_2lib_8h_html_a9edb0262eaed7c522977a75b76c15770"><div class="ttname"><a href="ncrypt_2lib_8h.html#a9edb0262eaed7c522977a75b76c15770">mutt_is_malformed_multipart_pgp_encrypted</a></div><div class="ttdeci">SecurityFlags mutt_is_malformed_multipart_pgp_encrypted(struct Body *b)</div><div class="ttdoc">Check for malformed layout. </div><div class="ttdef"><b>Definition:</b> <a href="crypt_8c_source.html#l00521">crypt.c:521</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a4073ce5b5fcec6e245dbfa9369016b8e"><div class="ttname"><a href="ncrypt_2lib_8h.html#a4073ce5b5fcec6e245dbfa9369016b8e">mutt_is_application_smime</a></div><div class="ttdeci">SecurityFlags mutt_is_application_smime(struct Body *b)</div><div class="ttdoc">Does the message use S/MIME? </div><div class="ttdef"><b>Definition:</b> <a href="crypt_8c_source.html#l00623">crypt.c:623</a></div></div>
<div class="ttc" id="structEmail_html"><div class="ttname"><a href="structEmail.html">Email</a></div><div class="ttdoc">The envelope/body of an email. </div><div class="ttdef"><b>Definition:</b> <a href="email_8h_source.html#l00037">email.h:37</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_ac671b1b0cd5df34d49ea749d29df8d3f"><div class="ttname"><a href="ncrypt_2lib_8h.html#ac671b1b0cd5df34d49ea749d29df8d3f">crypt_pgp_make_key_attachment</a></div><div class="ttdeci">struct Body * crypt_pgp_make_key_attachment(void)</div><div class="ttdoc">Wrapper for CryptModuleSpecs::pgp_make_key_attachment() </div><div class="ttdef"><b>Definition:</b> <a href="cryptglue_8c_source.html#l00310">cryptglue.c:310</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a6f815761abc33bf614605b9a39b3002b"><div class="ttname"><a href="ncrypt_2lib_8h.html#a6f815761abc33bf614605b9a39b3002b">crypto_module_free</a></div><div class="ttdeci">void crypto_module_free(void)</div><div class="ttdoc">Clean up the crypto modules. </div><div class="ttdef"><b>Definition:</b> <a href="crypt__mod_8c_source.html#l00081">crypt_mod.c:81</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_afb7fbdc0157b9f7fd68b378232d554fc"><div class="ttname"><a href="ncrypt_2lib_8h.html#afb7fbdc0157b9f7fd68b378232d554fc">mutt_protect</a></div><div class="ttdeci">int mutt_protect(struct Mailbox *m, struct Email *e, char *keylist, bool postpone)</div><div class="ttdoc">Encrypt and/or sign a message. </div><div class="ttdef"><b>Definition:</b> <a href="crypt_8c_source.html#l00161">crypt.c:161</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a4ee7f1419a7e39b0e9f1f9d550f4de43"><div class="ttname"><a href="ncrypt_2lib_8h.html#a4ee7f1419a7e39b0e9f1f9d550f4de43">crypt_valid_passphrase</a></div><div class="ttdeci">bool crypt_valid_passphrase(SecurityFlags flags)</div><div class="ttdoc">Check that we have a usable passphrase, ask if not. </div><div class="ttdef"><b>Definition:</b> <a href="crypt_8c_source.html#l00135">crypt.c:135</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_aced59da2579d14e9b136b372ce683bc5"><div class="ttname"><a href="ncrypt_2lib_8h.html#aced59da2579d14e9b136b372ce683bc5">mutt_protected_headers_handler</a></div><div class="ttdeci">int mutt_protected_headers_handler(struct Body *b, struct State *s)</div><div class="ttdoc">Process a protected header - Implements handler_t. </div><div class="ttdef"><b>Definition:</b> <a href="crypt_8c_source.html#l01126">crypt.c:1126</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a449d34e46ef8984a0a435909e1c0d7ab"><div class="ttname"><a href="ncrypt_2lib_8h.html#a449d34e46ef8984a0a435909e1c0d7ab">crypt_smime_application_handler</a></div><div class="ttdeci">int crypt_smime_application_handler(struct Body *m, struct State *s)</div><div class="ttdoc">Wrapper for CryptModuleSpecs::application_handler() </div><div class="ttdef"><b>Definition:</b> <a href="cryptglue_8c_source.html#l00452">cryptglue.c:452</a></div></div>
<div class="ttc" id="structBuffer_html"><div class="ttname"><a href="structBuffer.html">Buffer</a></div><div class="ttdoc">String manipulation buffer. </div><div class="ttdef"><b>Definition:</b> <a href="buffer_8h_source.html#l00033">buffer.h:33</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a5959b6797c94b22a7d391cbb5fd2fa33"><div class="ttname"><a href="ncrypt_2lib_8h.html#a5959b6797c94b22a7d391cbb5fd2fa33">crypt_pgp_check_traditional</a></div><div class="ttdeci">bool crypt_pgp_check_traditional(FILE *fp, struct Body *b, bool just_one)</div><div class="ttdoc">Wrapper for CryptModuleSpecs::pgp_check_traditional() </div><div class="ttdef"><b>Definition:</b> <a href="cryptglue_8c_source.html#l00288">cryptglue.c:288</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a35eba8f2cd36c286f2226ff748ee63e6"><div class="ttname"><a href="ncrypt_2lib_8h.html#a35eba8f2cd36c286f2226ff748ee63e6">crypt_get_keys</a></div><div class="ttdeci">int crypt_get_keys(struct Mailbox *m, struct Email *e, char **keylist, bool oppenc_mode)</div><div class="ttdoc">Check we have all the keys we need. </div><div class="ttdef"><b>Definition:</b> <a href="crypt_8c_source.html#l00963">crypt.c:963</a></div></div>
<div class="ttc" id="structAddress_html"><div class="ttname"><a href="structAddress.html">Address</a></div><div class="ttdoc">An email address. </div><div class="ttdef"><b>Definition:</b> <a href="address_2address_8h_source.html#l00035">address.h:35</a></div></div>
<div class="ttc" id="structState_html_a88fc722d3012ebf69d3a061cbf6bc296"><div class="ttname"><a href="structState.html#a88fc722d3012ebf69d3a061cbf6bc296">State::fp_out</a></div><div class="ttdeci">FILE * fp_out</div><div class="ttdoc">File to write to. </div><div class="ttdef"><b>Definition:</b> <a href="state_8h_source.html#l00047">state.h:47</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a2073a168ca3a64c3c30d13fa4917a05d"><div class="ttname"><a href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a></div><div class="ttdeci">uint16_t SecurityFlags</div><div class="ttdoc">Flags, e.g. SEC_ENCRYPT. </div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00071">lib.h:71</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a6d2692bdc72ffa198bb8ca2a28cfa395"><div class="ttname"><a href="ncrypt_2lib_8h.html#a6d2692bdc72ffa198bb8ca2a28cfa395">mutt_gpgme_print_version</a></div><div class="ttdeci">const char * mutt_gpgme_print_version(void)</div><div class="ttdoc">Get version of GPGME. </div><div class="ttdef"><b>Definition:</b> <a href="crypt__gpgme_8c_source.html#l04467">crypt_gpgme.c:4467</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a832e4b9f5a0e463876a3d8cfe852f12d"><div class="ttname"><a href="ncrypt_2lib_8h.html#a832e4b9f5a0e463876a3d8cfe852f12d">mutt_is_multipart_encrypted</a></div><div class="ttdeci">SecurityFlags mutt_is_multipart_encrypted(struct Body *b)</div><div class="ttdoc">Does the message have encrypted parts? </div><div class="ttdef"><b>Definition:</b> <a href="crypt_8c_source.html#l00460">crypt.c:460</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a3f60f47f4d4dee7f43f502b7244af35f"><div class="ttname"><a href="ncrypt_2lib_8h.html#a3f60f47f4d4dee7f43f502b7244af35f">crypt_smime_getkeys</a></div><div class="ttdeci">void crypt_smime_getkeys(struct Envelope *env)</div><div class="ttdoc">Wrapper for CryptModuleSpecs::smime_getkeys() </div><div class="ttdef"><b>Definition:</b> <a href="cryptglue_8c_source.html#l00463">cryptglue.c:463</a></div></div>
<div class="ttc" id="structState_html_a9cf7e1f0c5c12399def5ca38b13054ae"><div class="ttname"><a href="structState.html#a9cf7e1f0c5c12399def5ca38b13054ae">State::fp_in</a></div><div class="ttdeci">FILE * fp_in</div><div class="ttdoc">File to read from. </div><div class="ttdef"><b>Definition:</b> <a href="state_8h_source.html#l00046">state.h:46</a></div></div>
<div class="ttc" id="structBody_html"><div class="ttname"><a href="structBody.html">Body</a></div><div class="ttdoc">The body of an email. </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00034">body.h:34</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a7d989caa27c6539e55662007a6cf2cc5"><div class="ttname"><a href="ncrypt_2lib_8h.html#a7d989caa27c6539e55662007a6cf2cc5">crypt_pgp_invoke_getkeys</a></div><div class="ttdeci">void crypt_pgp_invoke_getkeys(struct Address *addr)</div><div class="ttdoc">Wrapper for CryptModuleSpecs::pgp_invoke_getkeys() </div><div class="ttdef"><b>Definition:</b> <a href="cryptglue_8c_source.html#l00279">cryptglue.c:279</a></div></div>
<div class="ttc" id="structState_html_a5d855f7d518fde2ac4e8e409cbb24ad3"><div class="ttname"><a href="structState.html#a5d855f7d518fde2ac4e8e409cbb24ad3">State::flags</a></div><div class="ttdeci">StateFlags flags</div><div class="ttdoc">Flags, e.g. MUTT_DISPLAY. </div><div class="ttdef"><b>Definition:</b> <a href="state_8h_source.html#l00049">state.h:49</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a52c65477f5b80ad3dc8028663653771d"><div class="ttname"><a href="ncrypt_2lib_8h.html#a52c65477f5b80ad3dc8028663653771d">mutt_should_hide_protected_subject</a></div><div class="ttdeci">bool mutt_should_hide_protected_subject(struct Email *e)</div><div class="ttdoc">Should NeoMutt hide the protected subject? </div><div class="ttdef"><b>Definition:</b> <a href="crypt_8c_source.html#l01108">crypt.c:1108</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a159d0d34a10b662acb2cc80099e5ecc7"><div class="ttname"><a href="ncrypt_2lib_8h.html#a159d0d34a10b662acb2cc80099e5ecc7">mutt_is_application_pgp</a></div><div class="ttdeci">SecurityFlags mutt_is_application_pgp(struct Body *b)</div><div class="ttdoc">Does the message use PGP? </div><div class="ttdef"><b>Definition:</b> <a href="crypt_8c_source.html#l00565">crypt.c:565</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a345fb1ff241b3fc778632947c2b08d37"><div class="ttname"><a href="ncrypt_2lib_8h.html#a345fb1ff241b3fc778632947c2b08d37">mutt_is_multipart_signed</a></div><div class="ttdeci">SecurityFlags mutt_is_multipart_signed(struct Body *b)</div><div class="ttdoc">Is a message signed? </div><div class="ttdef"><b>Definition:</b> <a href="crypt_8c_source.html#l00420">crypt.c:420</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_adffb5a3014f93e3f82de3964911041d0"><div class="ttname"><a href="ncrypt_2lib_8h.html#adffb5a3014f93e3f82de3964911041d0">crypt_extract_keys_from_messages</a></div><div class="ttdeci">void crypt_extract_keys_from_messages(struct Mailbox *m, struct EmailList *el)</div><div class="ttdoc">Extract keys from a message. </div><div class="ttdef"><b>Definition:</b> <a href="crypt_8c_source.html#l00858">crypt.c:858</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a3e7ec2b5bc58891704d4c49159cbef9a"><div class="ttname"><a href="ncrypt_2lib_8h.html#a3e7ec2b5bc58891704d4c49159cbef9a">mutt_signed_handler</a></div><div class="ttdeci">int mutt_signed_handler(struct Body *b, struct State *s)</div><div class="ttdoc">Verify a &quot;multipart/signed&quot; body - Implements handler_t. </div><div class="ttdef"><b>Definition:</b> <a href="crypt_8c_source.html#l01156">crypt.c:1156</a></div></div>
<div class="ttc" id="structMessage_html"><div class="ttname"><a href="structMessage.html">Message</a></div><div class="ttdoc">A local copy of an email. </div><div class="ttdef"><b>Definition:</b> <a href="mxapi_8h_source.html#l00041">mxapi.h:41</a></div></div>
<div class="ttc" id="structMailbox_html"><div class="ttname"><a href="structMailbox.html">Mailbox</a></div><div class="ttdoc">A mailbox. </div><div class="ttdef"><b>Definition:</b> <a href="mailbox_8h_source.html#l00081">mailbox.h:81</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a397940a79b0c75800fed7d264f7fd6b4"><div class="ttname"><a href="ncrypt_2lib_8h.html#a397940a79b0c75800fed7d264f7fd6b4">crypt_cleanup</a></div><div class="ttdeci">void crypt_cleanup(void)</div><div class="ttdoc">Clean up backend. </div><div class="ttdef"><b>Definition:</b> <a href="cryptglue_8c_source.html#l00143">cryptglue.c:143</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a530487c28aacc2c2d50f12eefb8c5506"><div class="ttname"><a href="ncrypt_2lib_8h.html#a530487c28aacc2c2d50f12eefb8c5506">KeyFlags</a></div><div class="ttdeci">uint16_t KeyFlags</div><div class="ttdoc">Flags describing PGP/SMIME keys, e.g. KEYFLAG_CANSIGN. </div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00122">lib.h:122</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_aa8e21077ffe83ed3b10dc22acdd6c2e2"><div class="ttname"><a href="ncrypt_2lib_8h.html#aa8e21077ffe83ed3b10dc22acdd6c2e2">crypt_pgp_decrypt_mime</a></div><div class="ttdeci">int crypt_pgp_decrypt_mime(FILE *fp_in, FILE **fp_out, struct Body *b, struct Body **cur)</div><div class="ttdoc">Wrapper for CryptModuleSpecs::decrypt_mime() </div><div class="ttdef"><b>Definition:</b> <a href="cryptglue_8c_source.html#l00212">cryptglue.c:212</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a07a6c891658dd90ef8333a1e5bbcc285"><div class="ttname"><a href="ncrypt_2lib_8h.html#a07a6c891658dd90ef8333a1e5bbcc285">crypt_has_module_backend</a></div><div class="ttdeci">bool crypt_has_module_backend(SecurityFlags type)</div><div class="ttdoc">Is there a crypto backend for a given type? </div><div class="ttdef"><b>Definition:</b> <a href="cryptglue_8c_source.html#l00172">cryptglue.c:172</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_aa05d4e0d23b75f9074f47ff55d7b724b"><div class="ttname"><a href="ncrypt_2lib_8h.html#aa05d4e0d23b75f9074f47ff55d7b724b">crypt_smime_verify_sender</a></div><div class="ttdeci">int crypt_smime_verify_sender(struct Mailbox *m, struct Email *e, struct Message *msg)</div><div class="ttdoc">Wrapper for CryptModuleSpecs::smime_verify_sender() </div><div class="ttdef"><b>Definition:</b> <a href="cryptglue_8c_source.html#l00472">cryptglue.c:472</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a352931faf3dbfb2f6d2d6c0a32ad830e"><div class="ttname"><a href="ncrypt_2lib_8h.html#a352931faf3dbfb2f6d2d6c0a32ad830e">crypt_smime_send_menu</a></div><div class="ttdeci">SecurityFlags crypt_smime_send_menu(struct Mailbox *m, struct Email *e)</div><div class="ttdoc">Wrapper for CryptModuleSpecs::send_menu() </div><div class="ttdef"><b>Definition:</b> <a href="cryptglue_8c_source.html#l00536">cryptglue.c:536</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a8ebc13a33b0dd650151d5b1b37cb99e4"><div class="ttname"><a href="ncrypt_2lib_8h.html#a8ebc13a33b0dd650151d5b1b37cb99e4">crypt_opportunistic_encrypt</a></div><div class="ttdeci">void crypt_opportunistic_encrypt(struct Mailbox *m, struct Email *e)</div><div class="ttdoc">Can all recipients be determined. </div><div class="ttdef"><b>Definition:</b> <a href="crypt_8c_source.html#l01054">crypt.c:1054</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_abebf8caf41c84183ebacca4e7d7afe8c"><div class="ttname"><a href="ncrypt_2lib_8h.html#abebf8caf41c84183ebacca4e7d7afe8c">crypt_pgp_send_menu</a></div><div class="ttdeci">SecurityFlags crypt_pgp_send_menu(struct Mailbox *m, struct Email *e)</div><div class="ttdoc">Wrapper for CryptModuleSpecs::send_menu() </div><div class="ttdef"><b>Definition:</b> <a href="cryptglue_8c_source.html#l00390">cryptglue.c:390</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a8a09719065d14c27701c998b48883ac4"><div class="ttname"><a href="ncrypt_2lib_8h.html#a8a09719065d14c27701c998b48883ac4">crypt_forget_passphrase</a></div><div class="ttdeci">void crypt_forget_passphrase(void)</div><div class="ttdoc">Forget a passphrase and display a message. </div><div class="ttdef"><b>Definition:</b> <a href="crypt_8c_source.html#l00093">crypt.c:93</a></div></div>
<div class="ttc" id="structState_html"><div class="ttname"><a href="structState.html">State</a></div><div class="ttdoc">Keep track when processing files. </div><div class="ttdef"><b>Definition:</b> <a href="state_8h_source.html#l00044">state.h:44</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_af4ab2e337a2477fba687b1f710aa7a61"><div class="ttname"><a href="ncrypt_2lib_8h.html#af4ab2e337a2477fba687b1f710aa7a61">crypt_query</a></div><div class="ttdeci">SecurityFlags crypt_query(struct Body *b)</div><div class="ttdoc">Check out the type of encryption used. </div><div class="ttdef"><b>Definition:</b> <a href="crypt_8c_source.html#l00698">crypt.c:698</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a34e8cf4a9f68adbcd30d41a242ede1e7"><div class="ttname"><a href="ncrypt_2lib_8h.html#a34e8cf4a9f68adbcd30d41a242ede1e7">crypt_smime_decrypt_mime</a></div><div class="ttdeci">int crypt_smime_decrypt_mime(FILE *fp_in, FILE **fp_out, struct Body *b, struct Body **cur)</div><div class="ttdoc">Wrapper for CryptModuleSpecs::decrypt_mime() </div><div class="ttdef"><b>Definition:</b> <a href="cryptglue_8c_source.html#l00439">cryptglue.c:439</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a7061521ecb51237cbbc557440353af39"><div class="ttname"><a href="ncrypt_2lib_8h.html#a7061521ecb51237cbbc557440353af39">pgp_gpgme_init</a></div><div class="ttdeci">void pgp_gpgme_init(void)</div><div class="ttdoc">Implements CryptModuleSpecs::init() </div><div class="ttdef"><b>Definition:</b> <a href="crypt__gpgme_8c_source.html#l04164">crypt_gpgme.c:4164</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a51806f872069460bb7f4fa16d1d92710"><div class="ttname"><a href="ncrypt_2lib_8h.html#a51806f872069460bb7f4fa16d1d92710">mutt_is_valid_multipart_pgp_encrypted</a></div><div class="ttdeci">int mutt_is_valid_multipart_pgp_encrypted(struct Body *b)</div><div class="ttdoc">Is this a valid multi-part encrypted message? </div><div class="ttdef"><b>Definition:</b> <a href="crypt_8c_source.html#l00484">crypt.c:484</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a2e8df329d00791c453eb6b3f60eabfdf"><div class="ttname"><a href="ncrypt_2lib_8h.html#a2e8df329d00791c453eb6b3f60eabfdf">mutt_gpgme_select_secret_key</a></div><div class="ttdeci">int mutt_gpgme_select_secret_key(struct Buffer *keyid)</div><div class="ttdoc">Select a private Autocrypt key for a new account. </div><div class="ttdef"><b>Definition:</b> <a href="crypt__gpgme_8c_source.html#l03976">crypt_gpgme.c:3976</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_aaf94d2bf9e0c58d5d8e436397611be27"><div class="ttname"><a href="ncrypt_2lib_8h.html#aaf94d2bf9e0c58d5d8e436397611be27">crypt_pgp_application_handler</a></div><div class="ttdeci">int crypt_pgp_application_handler(struct Body *m, struct State *s)</div><div class="ttdoc">Wrapper for CryptModuleSpecs::application_handler() </div><div class="ttdef"><b>Definition:</b> <a href="cryptglue_8c_source.html#l00240">cryptglue.c:240</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_afa26cebcc0c8d8866129fc2eabdbe874"><div class="ttname"><a href="ncrypt_2lib_8h.html#afa26cebcc0c8d8866129fc2eabdbe874">crypt_pgp_extract_key_from_attachment</a></div><div class="ttdeci">void crypt_pgp_extract_key_from_attachment(FILE *fp, struct Body *top)</div><div class="ttdoc">Wrapper for CryptModuleSpecs::pgp_extract_key_from_attachment() </div><div class="ttdef"><b>Definition:</b> <a href="cryptglue_8c_source.html#l00401">cryptglue.c:401</a></div></div>
<div class="ttc" id="structEnvelope_html"><div class="ttname"><a href="structEnvelope.html">Envelope</a></div><div class="ttdoc">The header of an Email. </div><div class="ttdef"><b>Definition:</b> <a href="envelope_8h_source.html#l00054">envelope.h:54</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_ab8e4063aa85a986a6879cbd45e14096c"><div class="ttname"><a href="ncrypt_2lib_8h.html#ab8e4063aa85a986a6879cbd45e14096c">crypt_pgp_encrypted_handler</a></div><div class="ttdeci">int crypt_pgp_encrypted_handler(struct Body *a, struct State *s)</div><div class="ttdoc">Wrapper for CryptModuleSpecs::encrypted_handler() </div><div class="ttdef"><b>Definition:</b> <a href="cryptglue_8c_source.html#l00253">cryptglue.c:253</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_aaecf706c319966f9eafd582b58ba531f"><div class="ttname"><a href="ncrypt_2lib_8h.html#aaecf706c319966f9eafd582b58ba531f">crypt_init</a></div><div class="ttdeci">void crypt_init(void)</div><div class="ttdoc">Initialise the crypto backends. </div><div class="ttdef"><b>Definition:</b> <a href="cryptglue_8c_source.html#l00094">cryptglue.c:94</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a166ec08d102f4330fdd0cc44a32bdf96"><div class="ttname"><a href="ncrypt_2lib_8h.html#a166ec08d102f4330fdd0cc44a32bdf96">crypt_invoke_message</a></div><div class="ttdeci">void crypt_invoke_message(SecurityFlags type)</div><div class="ttdoc">Display an informative message. </div><div class="ttdef"><b>Definition:</b> <a href="cryptglue_8c_source.html#l00158">cryptglue.c:158</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
</body>
</html>
