<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NeoMutt: ncrypt/lib.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><a href="https://neomutt.org"><img alt="Logo" src="neomutt-64.png"/></a></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <a style="color: black; text-decoration: none;" href="https://neomutt.org">
   <div id="projectname">NeoMutt
   &#160;<span id="projectnumber">2021-02-05-584-gb5c7a7</span>
   </div>
   <div id="projectbrief">Teaching an old dog new tricks</div>
   </a>
   <a href="https://github.com/neomutt/neomutt" class="github-corner" aria-label="View source on Github"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#000000; color:#fff; position: fixed; top: 0; border: 0; right: 0; z-index: 9999;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
  </td>
   <td><a style="text-decoration: none; position: absolute; right: 0; top: 25px; margin-right: 100px; color: #66d866; font-size: 400%;" href="http://www.doxygen.org/index.html">DOXYGEN</a></td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('ncrypt_2lib_8h.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">lib.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>API for encryption/signing of emails.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdbool.h&gt;</code><br />
<code>#include &lt;stdint.h&gt;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
</div><div class="textblock"><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Include dependency graph for lib.h:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h__incl.svg" width="280" height="112"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</div>
<p><a href="ncrypt_2lib_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a95845954210adfc850d5602843f858d4"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a>&#160;&#160;&#160;0</td></tr>
<tr class="memdesc:a95845954210adfc850d5602843f858d4"><td class="mdescLeft">&#160;</td><td class="mdescRight">No flags are set.  <a href="#a95845954210adfc850d5602843f858d4">More...</a><br /></td></tr>
<tr class="separator:a95845954210adfc850d5602843f858d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aacaa4abd4c0696e260b7a0f1d466360a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#aacaa4abd4c0696e260b7a0f1d466360a">SEC_ENCRYPT</a>&#160;&#160;&#160;(1 &lt;&lt; 0)</td></tr>
<tr class="memdesc:aacaa4abd4c0696e260b7a0f1d466360a"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="structEmail.html" title="The envelope/body of an email. ">Email</a> is encrypted.  <a href="#aacaa4abd4c0696e260b7a0f1d466360a">More...</a><br /></td></tr>
<tr class="separator:aacaa4abd4c0696e260b7a0f1d466360a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae12c003463c99d28f65f1d6b8b053b2c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#ae12c003463c99d28f65f1d6b8b053b2c">SEC_SIGN</a>&#160;&#160;&#160;(1 &lt;&lt; 1)</td></tr>
<tr class="memdesc:ae12c003463c99d28f65f1d6b8b053b2c"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="structEmail.html" title="The envelope/body of an email. ">Email</a> is signed.  <a href="#ae12c003463c99d28f65f1d6b8b053b2c">More...</a><br /></td></tr>
<tr class="separator:ae12c003463c99d28f65f1d6b8b053b2c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a427cda1ba4b173fa708e124afe7b907a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a427cda1ba4b173fa708e124afe7b907a">SEC_GOODSIGN</a>&#160;&#160;&#160;(1 &lt;&lt; 2)</td></tr>
<tr class="memdesc:a427cda1ba4b173fa708e124afe7b907a"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="structEmail.html" title="The envelope/body of an email. ">Email</a> has a valid signature.  <a href="#a427cda1ba4b173fa708e124afe7b907a">More...</a><br /></td></tr>
<tr class="separator:a427cda1ba4b173fa708e124afe7b907a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a70ffca3c8f9bc49498e3352294c5b8fd"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a70ffca3c8f9bc49498e3352294c5b8fd">SEC_BADSIGN</a>&#160;&#160;&#160;(1 &lt;&lt; 3)</td></tr>
<tr class="memdesc:a70ffca3c8f9bc49498e3352294c5b8fd"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="structEmail.html" title="The envelope/body of an email. ">Email</a> has a bad signature.  <a href="#a70ffca3c8f9bc49498e3352294c5b8fd">More...</a><br /></td></tr>
<tr class="separator:a70ffca3c8f9bc49498e3352294c5b8fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b0f8af6da383f08d29eb97fac836e3f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a9b0f8af6da383f08d29eb97fac836e3f">SEC_PARTSIGN</a>&#160;&#160;&#160;(1 &lt;&lt; 4)</td></tr>
<tr class="memdesc:a9b0f8af6da383f08d29eb97fac836e3f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Not all parts of the email is signed.  <a href="#a9b0f8af6da383f08d29eb97fac836e3f">More...</a><br /></td></tr>
<tr class="separator:a9b0f8af6da383f08d29eb97fac836e3f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6522a5e7af7f8624b8a3bbc94d8efb1e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a6522a5e7af7f8624b8a3bbc94d8efb1e">SEC_SIGNOPAQUE</a>&#160;&#160;&#160;(1 &lt;&lt; 5)</td></tr>
<tr class="memdesc:a6522a5e7af7f8624b8a3bbc94d8efb1e"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="structEmail.html" title="The envelope/body of an email. ">Email</a> has an opaque signature (encrypted)  <a href="#a6522a5e7af7f8624b8a3bbc94d8efb1e">More...</a><br /></td></tr>
<tr class="separator:a6522a5e7af7f8624b8a3bbc94d8efb1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:affb64fdb57b996638ce5b783ccb48810"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#affb64fdb57b996638ce5b783ccb48810">SEC_KEYBLOCK</a>&#160;&#160;&#160;(1 &lt;&lt; 6)</td></tr>
<tr class="memdesc:affb64fdb57b996638ce5b783ccb48810"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="structEmail.html" title="The envelope/body of an email. ">Email</a> has a key attached.  <a href="#affb64fdb57b996638ce5b783ccb48810">More...</a><br /></td></tr>
<tr class="separator:affb64fdb57b996638ce5b783ccb48810"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a074f827472ad45f11ec1132cdfed2daf"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a074f827472ad45f11ec1132cdfed2daf">SEC_INLINE</a>&#160;&#160;&#160;(1 &lt;&lt; 7)</td></tr>
<tr class="memdesc:a074f827472ad45f11ec1132cdfed2daf"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="structEmail.html" title="The envelope/body of an email. ">Email</a> has an inline signature.  <a href="#a074f827472ad45f11ec1132cdfed2daf">More...</a><br /></td></tr>
<tr class="separator:a074f827472ad45f11ec1132cdfed2daf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2fb0b0aa796d8d79a746001d09c2a2c7"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a2fb0b0aa796d8d79a746001d09c2a2c7">SEC_OPPENCRYPT</a>&#160;&#160;&#160;(1 &lt;&lt; 8)</td></tr>
<tr class="memdesc:a2fb0b0aa796d8d79a746001d09c2a2c7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Opportunistic encrypt mode.  <a href="#a2fb0b0aa796d8d79a746001d09c2a2c7">More...</a><br /></td></tr>
<tr class="separator:a2fb0b0aa796d8d79a746001d09c2a2c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b36be5c32ca90d8f2caef9ea9d627fc"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a0b36be5c32ca90d8f2caef9ea9d627fc">SEC_AUTOCRYPT</a>&#160;&#160;&#160;(1 &lt;&lt; 9)</td></tr>
<tr class="memdesc:a0b36be5c32ca90d8f2caef9ea9d627fc"><td class="mdescLeft">&#160;</td><td class="mdescRight">(Autocrypt) <a class="el" href="structMessage.html" title="A local copy of an email. ">Message</a> will be, or was Autocrypt encrypt+signed  <a href="#a0b36be5c32ca90d8f2caef9ea9d627fc">More...</a><br /></td></tr>
<tr class="separator:a0b36be5c32ca90d8f2caef9ea9d627fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0ce4a742538f3ee3e1bfbf143c794fb"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#ae0ce4a742538f3ee3e1bfbf143c794fb">SEC_AUTOCRYPT_OVERRIDE</a>&#160;&#160;&#160;(1 &lt;&lt; 10)</td></tr>
<tr class="memdesc:ae0ce4a742538f3ee3e1bfbf143c794fb"><td class="mdescLeft">&#160;</td><td class="mdescRight">(Autocrypt) Indicates manual set/unset of encryption  <a href="#ae0ce4a742538f3ee3e1bfbf143c794fb">More...</a><br /></td></tr>
<tr class="separator:ae0ce4a742538f3ee3e1bfbf143c794fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a587e679a4c9cc44f11f0c467bb22b0af"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a>&#160;&#160;&#160;(1 &lt;&lt; 11)</td></tr>
<tr class="memdesc:a587e679a4c9cc44f11f0c467bb22b0af"><td class="mdescLeft">&#160;</td><td class="mdescRight">Use PGP to encrypt/sign.  <a href="#a587e679a4c9cc44f11f0c467bb22b0af">More...</a><br /></td></tr>
<tr class="separator:a587e679a4c9cc44f11f0c467bb22b0af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a798dfac1e8839ca89375b4ec62b3eff2"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a>&#160;&#160;&#160;(1 &lt;&lt; 12)</td></tr>
<tr class="memdesc:a798dfac1e8839ca89375b4ec62b3eff2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Use SMIME to encrypt/sign.  <a href="#a798dfac1e8839ca89375b4ec62b3eff2">More...</a><br /></td></tr>
<tr class="separator:a798dfac1e8839ca89375b4ec62b3eff2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c4cec129dc84794f15f44382c25fc36"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a3c4cec129dc84794f15f44382c25fc36">PGP_TRADITIONAL_CHECKED</a>&#160;&#160;&#160;(1 &lt;&lt; 13)</td></tr>
<tr class="memdesc:a3c4cec129dc84794f15f44382c25fc36"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="structEmail.html" title="The envelope/body of an email. ">Email</a> has a traditional (inline) signature.  <a href="#a3c4cec129dc84794f15f44382c25fc36">More...</a><br /></td></tr>
<tr class="separator:a3c4cec129dc84794f15f44382c25fc36"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3eec0b09486fe4bfe7613f808f768747"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a3eec0b09486fe4bfe7613f808f768747">SEC_ALL_FLAGS</a>&#160;&#160;&#160;((1 &lt;&lt; 14) - 1)</td></tr>
<tr class="separator:a3eec0b09486fe4bfe7613f808f768747"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6694d25dff1ee1958351160a84bb2dc0"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a6694d25dff1ee1958351160a84bb2dc0">PGP_ENCRYPT</a>&#160;&#160;&#160;(<a class="el" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a> | <a class="el" href="ncrypt_2lib_8h.html#aacaa4abd4c0696e260b7a0f1d466360a">SEC_ENCRYPT</a>)</td></tr>
<tr class="separator:a6694d25dff1ee1958351160a84bb2dc0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14f75a650c49341776276f44881d54b2"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a14f75a650c49341776276f44881d54b2">PGP_SIGN</a>&#160;&#160;&#160;(<a class="el" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a> | <a class="el" href="ncrypt_2lib_8h.html#ae12c003463c99d28f65f1d6b8b053b2c">SEC_SIGN</a>)</td></tr>
<tr class="separator:a14f75a650c49341776276f44881d54b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae480697fdeb3d6b2c127e0ae36c52e8e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#ae480697fdeb3d6b2c127e0ae36c52e8e">PGP_GOODSIGN</a>&#160;&#160;&#160;(<a class="el" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a> | <a class="el" href="ncrypt_2lib_8h.html#a427cda1ba4b173fa708e124afe7b907a">SEC_GOODSIGN</a>)</td></tr>
<tr class="separator:ae480697fdeb3d6b2c127e0ae36c52e8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd2087cae2885c199218f5530ce7945b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#abd2087cae2885c199218f5530ce7945b">PGP_KEY</a>&#160;&#160;&#160;(<a class="el" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a> | <a class="el" href="ncrypt_2lib_8h.html#affb64fdb57b996638ce5b783ccb48810">SEC_KEYBLOCK</a>)</td></tr>
<tr class="separator:abd2087cae2885c199218f5530ce7945b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a68503f0e36de213094c8546b4f74eef1"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a68503f0e36de213094c8546b4f74eef1">PGP_INLINE</a>&#160;&#160;&#160;(<a class="el" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a> | <a class="el" href="ncrypt_2lib_8h.html#a074f827472ad45f11ec1132cdfed2daf">SEC_INLINE</a>)</td></tr>
<tr class="separator:a68503f0e36de213094c8546b4f74eef1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac25eb5415ebf34da68c39a3d4e3bc9ad"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#ac25eb5415ebf34da68c39a3d4e3bc9ad">SMIME_ENCRYPT</a>&#160;&#160;&#160;(<a class="el" href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a> | <a class="el" href="ncrypt_2lib_8h.html#aacaa4abd4c0696e260b7a0f1d466360a">SEC_ENCRYPT</a>)</td></tr>
<tr class="separator:ac25eb5415ebf34da68c39a3d4e3bc9ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67114d960e61fc36c467f4bf08d37335"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a67114d960e61fc36c467f4bf08d37335">SMIME_SIGN</a>&#160;&#160;&#160;(<a class="el" href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a> | <a class="el" href="ncrypt_2lib_8h.html#ae12c003463c99d28f65f1d6b8b053b2c">SEC_SIGN</a>)</td></tr>
<tr class="separator:a67114d960e61fc36c467f4bf08d37335"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e7bff0627202fd91790855e1300ec99"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a3e7bff0627202fd91790855e1300ec99">SMIME_GOODSIGN</a>&#160;&#160;&#160;(<a class="el" href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a> | <a class="el" href="ncrypt_2lib_8h.html#a427cda1ba4b173fa708e124afe7b907a">SEC_GOODSIGN</a>)</td></tr>
<tr class="separator:a3e7bff0627202fd91790855e1300ec99"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a79c49cef9301420920c8c673f06a1be1"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a79c49cef9301420920c8c673f06a1be1">SMIME_BADSIGN</a>&#160;&#160;&#160;(<a class="el" href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a> | <a class="el" href="ncrypt_2lib_8h.html#a70ffca3c8f9bc49498e3352294c5b8fd">SEC_BADSIGN</a>)</td></tr>
<tr class="separator:a79c49cef9301420920c8c673f06a1be1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c811504abf735623a6dd3ac20287f30"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a9c811504abf735623a6dd3ac20287f30">SMIME_OPAQUE</a>&#160;&#160;&#160;(<a class="el" href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a> | <a class="el" href="ncrypt_2lib_8h.html#a6522a5e7af7f8624b8a3bbc94d8efb1e">SEC_SIGNOPAQUE</a>)</td></tr>
<tr class="separator:a9c811504abf735623a6dd3ac20287f30"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad980bff69bb614893ad8e7e1c28a5023"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a>&#160;&#160;&#160;(<a class="el" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a> | <a class="el" href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a>)</td></tr>
<tr class="separator:ad980bff69bb614893ad8e7e1c28a5023"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a827146354c736ec416508944692e52b2"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a827146354c736ec416508944692e52b2">KEYFLAG_NO_FLAGS</a>&#160;&#160;&#160;0</td></tr>
<tr class="memdesc:a827146354c736ec416508944692e52b2"><td class="mdescLeft">&#160;</td><td class="mdescRight">No flags are set.  <a href="#a827146354c736ec416508944692e52b2">More...</a><br /></td></tr>
<tr class="separator:a827146354c736ec416508944692e52b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee8e2da44282ca27f6a786cef781334f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#aee8e2da44282ca27f6a786cef781334f">KEYFLAG_CANSIGN</a>&#160;&#160;&#160;(1 &lt;&lt; 0)</td></tr>
<tr class="memdesc:aee8e2da44282ca27f6a786cef781334f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Key is suitable for signing.  <a href="#aee8e2da44282ca27f6a786cef781334f">More...</a><br /></td></tr>
<tr class="separator:aee8e2da44282ca27f6a786cef781334f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7254adf21a76d4ceea08bd931df4310f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a7254adf21a76d4ceea08bd931df4310f">KEYFLAG_CANENCRYPT</a>&#160;&#160;&#160;(1 &lt;&lt; 1)</td></tr>
<tr class="memdesc:a7254adf21a76d4ceea08bd931df4310f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Key is suitable for encryption.  <a href="#a7254adf21a76d4ceea08bd931df4310f">More...</a><br /></td></tr>
<tr class="separator:a7254adf21a76d4ceea08bd931df4310f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52372a26134009ebc0f946abc8a6075c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a52372a26134009ebc0f946abc8a6075c">KEYFLAG_ISX509</a>&#160;&#160;&#160;(1 &lt;&lt; 2)</td></tr>
<tr class="memdesc:a52372a26134009ebc0f946abc8a6075c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Key is an X.509 key.  <a href="#a52372a26134009ebc0f946abc8a6075c">More...</a><br /></td></tr>
<tr class="separator:a52372a26134009ebc0f946abc8a6075c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aacc955f91dd3fdc8b82246c140f023fa"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#aacc955f91dd3fdc8b82246c140f023fa">KEYFLAG_SECRET</a>&#160;&#160;&#160;(1 &lt;&lt; 7)</td></tr>
<tr class="memdesc:aacc955f91dd3fdc8b82246c140f023fa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Key is a secret key.  <a href="#aacc955f91dd3fdc8b82246c140f023fa">More...</a><br /></td></tr>
<tr class="separator:aacc955f91dd3fdc8b82246c140f023fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20472f13517d60d40aa75287afc81c5d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a20472f13517d60d40aa75287afc81c5d">KEYFLAG_EXPIRED</a>&#160;&#160;&#160;(1 &lt;&lt; 8)</td></tr>
<tr class="memdesc:a20472f13517d60d40aa75287afc81c5d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Key is expired.  <a href="#a20472f13517d60d40aa75287afc81c5d">More...</a><br /></td></tr>
<tr class="separator:a20472f13517d60d40aa75287afc81c5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb95b48318487d9eb8f9709e933d749e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#acb95b48318487d9eb8f9709e933d749e">KEYFLAG_REVOKED</a>&#160;&#160;&#160;(1 &lt;&lt; 9)</td></tr>
<tr class="memdesc:acb95b48318487d9eb8f9709e933d749e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Key is revoked.  <a href="#acb95b48318487d9eb8f9709e933d749e">More...</a><br /></td></tr>
<tr class="separator:acb95b48318487d9eb8f9709e933d749e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a989f3449b764c6a8f5f5e0481569884a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a989f3449b764c6a8f5f5e0481569884a">KEYFLAG_DISABLED</a>&#160;&#160;&#160;(1 &lt;&lt; 10)</td></tr>
<tr class="memdesc:a989f3449b764c6a8f5f5e0481569884a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Key is marked disabled.  <a href="#a989f3449b764c6a8f5f5e0481569884a">More...</a><br /></td></tr>
<tr class="separator:a989f3449b764c6a8f5f5e0481569884a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a73a1ead56127b7fac407296e153c0967"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a73a1ead56127b7fac407296e153c0967">KEYFLAG_SUBKEY</a>&#160;&#160;&#160;(1 &lt;&lt; 11)</td></tr>
<tr class="memdesc:a73a1ead56127b7fac407296e153c0967"><td class="mdescLeft">&#160;</td><td class="mdescRight">Key is a subkey.  <a href="#a73a1ead56127b7fac407296e153c0967">More...</a><br /></td></tr>
<tr class="separator:a73a1ead56127b7fac407296e153c0967"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ffaa1a95f918db325d8d770f76a7f79"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a8ffaa1a95f918db325d8d770f76a7f79">KEYFLAG_CRITICAL</a>&#160;&#160;&#160;(1 &lt;&lt; 12)</td></tr>
<tr class="memdesc:a8ffaa1a95f918db325d8d770f76a7f79"><td class="mdescLeft">&#160;</td><td class="mdescRight">Key is marked critical.  <a href="#a8ffaa1a95f918db325d8d770f76a7f79">More...</a><br /></td></tr>
<tr class="separator:a8ffaa1a95f918db325d8d770f76a7f79"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4067c9bae1c276c505b42265b70529e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#ae4067c9bae1c276c505b42265b70529e">KEYFLAG_PREFER_ENCRYPTION</a>&#160;&#160;&#160;(1 &lt;&lt; 13)</td></tr>
<tr class="memdesc:ae4067c9bae1c276c505b42265b70529e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Key's owner prefers encryption.  <a href="#ae4067c9bae1c276c505b42265b70529e">More...</a><br /></td></tr>
<tr class="separator:ae4067c9bae1c276c505b42265b70529e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a88a54f7be16fc36441fafe14ee14ac0b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a88a54f7be16fc36441fafe14ee14ac0b">KEYFLAG_PREFER_SIGNING</a>&#160;&#160;&#160;(1 &lt;&lt; 14)</td></tr>
<tr class="memdesc:a88a54f7be16fc36441fafe14ee14ac0b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Key's owner prefers signing.  <a href="#a88a54f7be16fc36441fafe14ee14ac0b">More...</a><br /></td></tr>
<tr class="separator:a88a54f7be16fc36441fafe14ee14ac0b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74b325469393092ed6d402f1ba78d7ba"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a74b325469393092ed6d402f1ba78d7ba">KEYFLAG_CANTUSE</a>&#160;&#160;&#160;(<a class="el" href="ncrypt_2lib_8h.html#a989f3449b764c6a8f5f5e0481569884a">KEYFLAG_DISABLED</a> | <a class="el" href="ncrypt_2lib_8h.html#acb95b48318487d9eb8f9709e933d749e">KEYFLAG_REVOKED</a> | <a class="el" href="ncrypt_2lib_8h.html#a20472f13517d60d40aa75287afc81c5d">KEYFLAG_EXPIRED</a>)</td></tr>
<tr class="separator:a74b325469393092ed6d402f1ba78d7ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b5753c8babedca24c31e8d2dbad8130"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a5b5753c8babedca24c31e8d2dbad8130">KEYFLAG_RESTRICTIONS</a>&#160;&#160;&#160;(<a class="el" href="ncrypt_2lib_8h.html#a74b325469393092ed6d402f1ba78d7ba">KEYFLAG_CANTUSE</a> | <a class="el" href="ncrypt_2lib_8h.html#a8ffaa1a95f918db325d8d770f76a7f79">KEYFLAG_CRITICAL</a>)</td></tr>
<tr class="separator:a5b5753c8babedca24c31e8d2dbad8130"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a71ddb5e69f239d16bdf6a6cc266072e4"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a71ddb5e69f239d16bdf6a6cc266072e4">KEYFLAG_ABILITIES</a>&#160;&#160;&#160;(<a class="el" href="ncrypt_2lib_8h.html#aee8e2da44282ca27f6a786cef781334f">KEYFLAG_CANSIGN</a> | <a class="el" href="ncrypt_2lib_8h.html#a7254adf21a76d4ceea08bd931df4310f">KEYFLAG_CANENCRYPT</a> | <a class="el" href="ncrypt_2lib_8h.html#ae4067c9bae1c276c505b42265b70529e">KEYFLAG_PREFER_ENCRYPTION</a> | <a class="el" href="ncrypt_2lib_8h.html#a88a54f7be16fc36441fafe14ee14ac0b">KEYFLAG_PREFER_SIGNING</a>)</td></tr>
<tr class="separator:a71ddb5e69f239d16bdf6a6cc266072e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a2073a168ca3a64c3c30d13fa4917a05d"><td class="memItemLeft" align="right" valign="top">typedef uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a></td></tr>
<tr class="memdesc:a2073a168ca3a64c3c30d13fa4917a05d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flags, e.g. <a class="el" href="ncrypt_2lib_8h.html#aacaa4abd4c0696e260b7a0f1d466360a" title="Email is encrypted. ">SEC_ENCRYPT</a>.  <a href="#a2073a168ca3a64c3c30d13fa4917a05d">More...</a><br /></td></tr>
<tr class="separator:a2073a168ca3a64c3c30d13fa4917a05d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a530487c28aacc2c2d50f12eefb8c5506"><td class="memItemLeft" align="right" valign="top">typedef uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a530487c28aacc2c2d50f12eefb8c5506">KeyFlags</a></td></tr>
<tr class="memdesc:a530487c28aacc2c2d50f12eefb8c5506"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flags describing PGP/SMIME keys, e.g. <a class="el" href="ncrypt_2lib_8h.html#aee8e2da44282ca27f6a786cef781334f" title="Key is suitable for signing. ">KEYFLAG_CANSIGN</a>.  <a href="#a530487c28aacc2c2d50f12eefb8c5506">More...</a><br /></td></tr>
<tr class="separator:a530487c28aacc2c2d50f12eefb8c5506"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:adffb5a3014f93e3f82de3964911041d0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#adffb5a3014f93e3f82de3964911041d0">crypt_extract_keys_from_messages</a> (struct <a class="el" href="structMailbox.html">Mailbox</a> *m, struct EmailList *el)</td></tr>
<tr class="memdesc:adffb5a3014f93e3f82de3964911041d0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extract keys from a message.  <a href="#adffb5a3014f93e3f82de3964911041d0">More...</a><br /></td></tr>
<tr class="separator:adffb5a3014f93e3f82de3964911041d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a09719065d14c27701c998b48883ac4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a8a09719065d14c27701c998b48883ac4">crypt_forget_passphrase</a> (void)</td></tr>
<tr class="memdesc:a8a09719065d14c27701c998b48883ac4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Forget a passphrase and display a message.  <a href="#a8a09719065d14c27701c998b48883ac4">More...</a><br /></td></tr>
<tr class="separator:a8a09719065d14c27701c998b48883ac4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a35eba8f2cd36c286f2226ff748ee63e6"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a35eba8f2cd36c286f2226ff748ee63e6">crypt_get_keys</a> (struct <a class="el" href="structMailbox.html">Mailbox</a> *m, struct <a class="el" href="structEmail.html">Email</a> *e, char **keylist, bool oppenc_mode)</td></tr>
<tr class="memdesc:a35eba8f2cd36c286f2226ff748ee63e6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check we have all the keys we need.  <a href="#a35eba8f2cd36c286f2226ff748ee63e6">More...</a><br /></td></tr>
<tr class="separator:a35eba8f2cd36c286f2226ff748ee63e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ebc13a33b0dd650151d5b1b37cb99e4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a8ebc13a33b0dd650151d5b1b37cb99e4">crypt_opportunistic_encrypt</a> (struct <a class="el" href="structMailbox.html">Mailbox</a> *m, struct <a class="el" href="structEmail.html">Email</a> *e)</td></tr>
<tr class="memdesc:a8ebc13a33b0dd650151d5b1b37cb99e4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Can all recipients be determined.  <a href="#a8ebc13a33b0dd650151d5b1b37cb99e4">More...</a><br /></td></tr>
<tr class="separator:a8ebc13a33b0dd650151d5b1b37cb99e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4ab2e337a2477fba687b1f710aa7a61"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#af4ab2e337a2477fba687b1f710aa7a61">crypt_query</a> (struct <a class="el" href="structBody.html">Body</a> *b)</td></tr>
<tr class="memdesc:af4ab2e337a2477fba687b1f710aa7a61"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check out the type of encryption used.  <a href="#af4ab2e337a2477fba687b1f710aa7a61">More...</a><br /></td></tr>
<tr class="separator:af4ab2e337a2477fba687b1f710aa7a61"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ee7f1419a7e39b0e9f1f9d550f4de43"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a4ee7f1419a7e39b0e9f1f9d550f4de43">crypt_valid_passphrase</a> (<a class="el" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a> flags)</td></tr>
<tr class="memdesc:a4ee7f1419a7e39b0e9f1f9d550f4de43"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check that we have a usable passphrase, ask if not.  <a href="#a4ee7f1419a7e39b0e9f1f9d550f4de43">More...</a><br /></td></tr>
<tr class="separator:a4ee7f1419a7e39b0e9f1f9d550f4de43"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a159d0d34a10b662acb2cc80099e5ecc7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a159d0d34a10b662acb2cc80099e5ecc7">mutt_is_application_pgp</a> (struct <a class="el" href="structBody.html">Body</a> *b)</td></tr>
<tr class="memdesc:a159d0d34a10b662acb2cc80099e5ecc7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Does the message use PGP?  <a href="#a159d0d34a10b662acb2cc80099e5ecc7">More...</a><br /></td></tr>
<tr class="separator:a159d0d34a10b662acb2cc80099e5ecc7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4073ce5b5fcec6e245dbfa9369016b8e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a4073ce5b5fcec6e245dbfa9369016b8e">mutt_is_application_smime</a> (struct <a class="el" href="structBody.html">Body</a> *b)</td></tr>
<tr class="memdesc:a4073ce5b5fcec6e245dbfa9369016b8e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Does the message use S/MIME?  <a href="#a4073ce5b5fcec6e245dbfa9369016b8e">More...</a><br /></td></tr>
<tr class="separator:a4073ce5b5fcec6e245dbfa9369016b8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9edb0262eaed7c522977a75b76c15770"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a9edb0262eaed7c522977a75b76c15770">mutt_is_malformed_multipart_pgp_encrypted</a> (struct <a class="el" href="structBody.html">Body</a> *b)</td></tr>
<tr class="memdesc:a9edb0262eaed7c522977a75b76c15770"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check for malformed layout.  <a href="#a9edb0262eaed7c522977a75b76c15770">More...</a><br /></td></tr>
<tr class="separator:a9edb0262eaed7c522977a75b76c15770"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a832e4b9f5a0e463876a3d8cfe852f12d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a832e4b9f5a0e463876a3d8cfe852f12d">mutt_is_multipart_encrypted</a> (struct <a class="el" href="structBody.html">Body</a> *b)</td></tr>
<tr class="memdesc:a832e4b9f5a0e463876a3d8cfe852f12d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Does the message have encrypted parts?  <a href="#a832e4b9f5a0e463876a3d8cfe852f12d">More...</a><br /></td></tr>
<tr class="separator:a832e4b9f5a0e463876a3d8cfe852f12d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a345fb1ff241b3fc778632947c2b08d37"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a345fb1ff241b3fc778632947c2b08d37">mutt_is_multipart_signed</a> (struct <a class="el" href="structBody.html">Body</a> *b)</td></tr>
<tr class="memdesc:a345fb1ff241b3fc778632947c2b08d37"><td class="mdescLeft">&#160;</td><td class="mdescRight">Is a message signed?  <a href="#a345fb1ff241b3fc778632947c2b08d37">More...</a><br /></td></tr>
<tr class="separator:a345fb1ff241b3fc778632947c2b08d37"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51806f872069460bb7f4fa16d1d92710"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a51806f872069460bb7f4fa16d1d92710">mutt_is_valid_multipart_pgp_encrypted</a> (struct <a class="el" href="structBody.html">Body</a> *b)</td></tr>
<tr class="memdesc:a51806f872069460bb7f4fa16d1d92710"><td class="mdescLeft">&#160;</td><td class="mdescRight">Is this a valid multi-part encrypted message?  <a href="#a51806f872069460bb7f4fa16d1d92710">More...</a><br /></td></tr>
<tr class="separator:a51806f872069460bb7f4fa16d1d92710"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb7fbdc0157b9f7fd68b378232d554fc"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#afb7fbdc0157b9f7fd68b378232d554fc">mutt_protect</a> (struct <a class="el" href="structMailbox.html">Mailbox</a> *m, struct <a class="el" href="structEmail.html">Email</a> *e, char *keylist, bool postpone)</td></tr>
<tr class="memdesc:afb7fbdc0157b9f7fd68b378232d554fc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Encrypt and/or sign a message.  <a href="#afb7fbdc0157b9f7fd68b378232d554fc">More...</a><br /></td></tr>
<tr class="separator:afb7fbdc0157b9f7fd68b378232d554fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aced59da2579d14e9b136b372ce683bc5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#aced59da2579d14e9b136b372ce683bc5">mutt_protected_headers_handler</a> (struct <a class="el" href="structBody.html">Body</a> *b, struct <a class="el" href="structState.html">State</a> *s)</td></tr>
<tr class="memdesc:aced59da2579d14e9b136b372ce683bc5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Process a protected header - Implements <a class="el" href="handler_8c.html#a05af946c0d51f30e6b10e75510d79458" title="Manage a PGP or S/MIME encrypted MIME part. ">handler_t</a>.  <a href="#aced59da2579d14e9b136b372ce683bc5">More...</a><br /></td></tr>
<tr class="separator:aced59da2579d14e9b136b372ce683bc5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52c65477f5b80ad3dc8028663653771d"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a52c65477f5b80ad3dc8028663653771d">mutt_should_hide_protected_subject</a> (struct <a class="el" href="structEmail.html">Email</a> *e)</td></tr>
<tr class="memdesc:a52c65477f5b80ad3dc8028663653771d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Should <a class="el" href="structNeoMutt.html" title="Container for Accounts, Notifications. ">NeoMutt</a> hide the protected subject?  <a href="#a52c65477f5b80ad3dc8028663653771d">More...</a><br /></td></tr>
<tr class="separator:a52c65477f5b80ad3dc8028663653771d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e7ec2b5bc58891704d4c49159cbef9a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a3e7ec2b5bc58891704d4c49159cbef9a">mutt_signed_handler</a> (struct <a class="el" href="structBody.html">Body</a> *b, struct <a class="el" href="structState.html">State</a> *s)</td></tr>
<tr class="memdesc:a3e7ec2b5bc58891704d4c49159cbef9a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Verify a "multipart/signed" body - Implements <a class="el" href="handler_8c.html#a05af946c0d51f30e6b10e75510d79458" title="Manage a PGP or S/MIME encrypted MIME part. ">handler_t</a>.  <a href="#a3e7ec2b5bc58891704d4c49159cbef9a">More...</a><br /></td></tr>
<tr class="separator:a3e7ec2b5bc58891704d4c49159cbef9a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a397940a79b0c75800fed7d264f7fd6b4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a397940a79b0c75800fed7d264f7fd6b4">crypt_cleanup</a> (void)</td></tr>
<tr class="memdesc:a397940a79b0c75800fed7d264f7fd6b4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clean up backend.  <a href="#a397940a79b0c75800fed7d264f7fd6b4">More...</a><br /></td></tr>
<tr class="separator:a397940a79b0c75800fed7d264f7fd6b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07a6c891658dd90ef8333a1e5bbcc285"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a07a6c891658dd90ef8333a1e5bbcc285">crypt_has_module_backend</a> (<a class="el" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a> type)</td></tr>
<tr class="memdesc:a07a6c891658dd90ef8333a1e5bbcc285"><td class="mdescLeft">&#160;</td><td class="mdescRight">Is there a crypto backend for a given type?  <a href="#a07a6c891658dd90ef8333a1e5bbcc285">More...</a><br /></td></tr>
<tr class="separator:a07a6c891658dd90ef8333a1e5bbcc285"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaecf706c319966f9eafd582b58ba531f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#aaecf706c319966f9eafd582b58ba531f">crypt_init</a> (void)</td></tr>
<tr class="memdesc:aaecf706c319966f9eafd582b58ba531f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialise the crypto backends.  <a href="#aaecf706c319966f9eafd582b58ba531f">More...</a><br /></td></tr>
<tr class="separator:aaecf706c319966f9eafd582b58ba531f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a166ec08d102f4330fdd0cc44a32bdf96"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a166ec08d102f4330fdd0cc44a32bdf96">crypt_invoke_message</a> (<a class="el" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a> type)</td></tr>
<tr class="memdesc:a166ec08d102f4330fdd0cc44a32bdf96"><td class="mdescLeft">&#160;</td><td class="mdescRight">Display an informative message.  <a href="#a166ec08d102f4330fdd0cc44a32bdf96">More...</a><br /></td></tr>
<tr class="separator:a166ec08d102f4330fdd0cc44a32bdf96"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf94d2bf9e0c58d5d8e436397611be27"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#aaf94d2bf9e0c58d5d8e436397611be27">crypt_pgp_application_handler</a> (struct <a class="el" href="structBody.html">Body</a> *m, struct <a class="el" href="structState.html">State</a> *s)</td></tr>
<tr class="memdesc:aaf94d2bf9e0c58d5d8e436397611be27"><td class="mdescLeft">&#160;</td><td class="mdescRight">Wrapper for <a class="el" href="structCryptModuleSpecs.html#ab422f00f242155c816f7b4a16af52d60" title="Manage the MIME type &quot;application/pgp&quot; or &quot;application/smime&quot;. ">CryptModuleSpecs::application_handler()</a>  <a href="#aaf94d2bf9e0c58d5d8e436397611be27">More...</a><br /></td></tr>
<tr class="separator:aaf94d2bf9e0c58d5d8e436397611be27"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5959b6797c94b22a7d391cbb5fd2fa33"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a5959b6797c94b22a7d391cbb5fd2fa33">crypt_pgp_check_traditional</a> (FILE *fp, struct <a class="el" href="structBody.html">Body</a> *b, bool just_one)</td></tr>
<tr class="memdesc:a5959b6797c94b22a7d391cbb5fd2fa33"><td class="mdescLeft">&#160;</td><td class="mdescRight">Wrapper for <a class="el" href="structCryptModuleSpecs.html#abbb74e663273948a7e2ad35a1135e6a2" title="Look for inline (non-MIME) PGP content. ">CryptModuleSpecs::pgp_check_traditional()</a>  <a href="#a5959b6797c94b22a7d391cbb5fd2fa33">More...</a><br /></td></tr>
<tr class="separator:a5959b6797c94b22a7d391cbb5fd2fa33"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8e21077ffe83ed3b10dc22acdd6c2e2"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#aa8e21077ffe83ed3b10dc22acdd6c2e2">crypt_pgp_decrypt_mime</a> (FILE *fp_in, FILE **fp_out, struct <a class="el" href="structBody.html">Body</a> *b, struct <a class="el" href="structBody.html">Body</a> **cur)</td></tr>
<tr class="memdesc:aa8e21077ffe83ed3b10dc22acdd6c2e2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Wrapper for <a class="el" href="structCryptModuleSpecs.html#a4cba06c7d0dfb0e4d1fba7c9ded25c0d" title="Decrypt an encrypted MIME part. ">CryptModuleSpecs::decrypt_mime()</a>  <a href="#aa8e21077ffe83ed3b10dc22acdd6c2e2">More...</a><br /></td></tr>
<tr class="separator:aa8e21077ffe83ed3b10dc22acdd6c2e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8e4063aa85a986a6879cbd45e14096c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#ab8e4063aa85a986a6879cbd45e14096c">crypt_pgp_encrypted_handler</a> (struct <a class="el" href="structBody.html">Body</a> *a, struct <a class="el" href="structState.html">State</a> *s)</td></tr>
<tr class="memdesc:ab8e4063aa85a986a6879cbd45e14096c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Wrapper for <a class="el" href="structCryptModuleSpecs.html#a356c4135c3412cfae7dad038630aa9bf" title="Manage a PGP or S/MIME encrypted MIME part. ">CryptModuleSpecs::encrypted_handler()</a>  <a href="#ab8e4063aa85a986a6879cbd45e14096c">More...</a><br /></td></tr>
<tr class="separator:ab8e4063aa85a986a6879cbd45e14096c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa26cebcc0c8d8866129fc2eabdbe874"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#afa26cebcc0c8d8866129fc2eabdbe874">crypt_pgp_extract_key_from_attachment</a> (FILE *fp, struct <a class="el" href="structBody.html">Body</a> *top)</td></tr>
<tr class="memdesc:afa26cebcc0c8d8866129fc2eabdbe874"><td class="mdescLeft">&#160;</td><td class="mdescRight">Wrapper for <a class="el" href="structCryptModuleSpecs.html#a7c197e2213c950245ad7bde7f0c51256" title="Extract PGP key from an attachment. ">CryptModuleSpecs::pgp_extract_key_from_attachment()</a>  <a href="#afa26cebcc0c8d8866129fc2eabdbe874">More...</a><br /></td></tr>
<tr class="separator:afa26cebcc0c8d8866129fc2eabdbe874"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d989caa27c6539e55662007a6cf2cc5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a7d989caa27c6539e55662007a6cf2cc5">crypt_pgp_invoke_getkeys</a> (struct <a class="el" href="structAddress.html">Address</a> *addr)</td></tr>
<tr class="memdesc:a7d989caa27c6539e55662007a6cf2cc5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Wrapper for <a class="el" href="structCryptModuleSpecs.html#acd2b13751354a0ea6dc82ee6bbdf3724" title="Run a command to download a PGP key. ">CryptModuleSpecs::pgp_invoke_getkeys()</a>  <a href="#a7d989caa27c6539e55662007a6cf2cc5">More...</a><br /></td></tr>
<tr class="separator:a7d989caa27c6539e55662007a6cf2cc5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac671b1b0cd5df34d49ea749d29df8d3f"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structBody.html">Body</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#ac671b1b0cd5df34d49ea749d29df8d3f">crypt_pgp_make_key_attachment</a> (void)</td></tr>
<tr class="memdesc:ac671b1b0cd5df34d49ea749d29df8d3f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Wrapper for <a class="el" href="structCryptModuleSpecs.html#a505fa888b6994755f055d202c339dbef" title="Generate a public key attachment. ">CryptModuleSpecs::pgp_make_key_attachment()</a>  <a href="#ac671b1b0cd5df34d49ea749d29df8d3f">More...</a><br /></td></tr>
<tr class="separator:ac671b1b0cd5df34d49ea749d29df8d3f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abebf8caf41c84183ebacca4e7d7afe8c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#abebf8caf41c84183ebacca4e7d7afe8c">crypt_pgp_send_menu</a> (struct <a class="el" href="structMailbox.html">Mailbox</a> *m, struct <a class="el" href="structEmail.html">Email</a> *e)</td></tr>
<tr class="memdesc:abebf8caf41c84183ebacca4e7d7afe8c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Wrapper for <a class="el" href="structCryptModuleSpecs.html#a276f84536aedc54559c57018a76ff89d" title="Ask the user whether to sign and/or encrypt the email. ">CryptModuleSpecs::send_menu()</a>  <a href="#abebf8caf41c84183ebacca4e7d7afe8c">More...</a><br /></td></tr>
<tr class="separator:abebf8caf41c84183ebacca4e7d7afe8c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a449d34e46ef8984a0a435909e1c0d7ab"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a449d34e46ef8984a0a435909e1c0d7ab">crypt_smime_application_handler</a> (struct <a class="el" href="structBody.html">Body</a> *m, struct <a class="el" href="structState.html">State</a> *s)</td></tr>
<tr class="memdesc:a449d34e46ef8984a0a435909e1c0d7ab"><td class="mdescLeft">&#160;</td><td class="mdescRight">Wrapper for <a class="el" href="structCryptModuleSpecs.html#ab422f00f242155c816f7b4a16af52d60" title="Manage the MIME type &quot;application/pgp&quot; or &quot;application/smime&quot;. ">CryptModuleSpecs::application_handler()</a>  <a href="#a449d34e46ef8984a0a435909e1c0d7ab">More...</a><br /></td></tr>
<tr class="separator:a449d34e46ef8984a0a435909e1c0d7ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34e8cf4a9f68adbcd30d41a242ede1e7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a34e8cf4a9f68adbcd30d41a242ede1e7">crypt_smime_decrypt_mime</a> (FILE *fp_in, FILE **fp_out, struct <a class="el" href="structBody.html">Body</a> *b, struct <a class="el" href="structBody.html">Body</a> **cur)</td></tr>
<tr class="memdesc:a34e8cf4a9f68adbcd30d41a242ede1e7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Wrapper for <a class="el" href="structCryptModuleSpecs.html#a4cba06c7d0dfb0e4d1fba7c9ded25c0d" title="Decrypt an encrypted MIME part. ">CryptModuleSpecs::decrypt_mime()</a>  <a href="#a34e8cf4a9f68adbcd30d41a242ede1e7">More...</a><br /></td></tr>
<tr class="separator:a34e8cf4a9f68adbcd30d41a242ede1e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f60f47f4d4dee7f43f502b7244af35f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a3f60f47f4d4dee7f43f502b7244af35f">crypt_smime_getkeys</a> (struct <a class="el" href="structEnvelope.html">Envelope</a> *env)</td></tr>
<tr class="memdesc:a3f60f47f4d4dee7f43f502b7244af35f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Wrapper for <a class="el" href="structCryptModuleSpecs.html#a555d3da530f7c25207fcbae9efa8ab03" title="Get the S/MIME keys required to encrypt this email. ">CryptModuleSpecs::smime_getkeys()</a>  <a href="#a3f60f47f4d4dee7f43f502b7244af35f">More...</a><br /></td></tr>
<tr class="separator:a3f60f47f4d4dee7f43f502b7244af35f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a352931faf3dbfb2f6d2d6c0a32ad830e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a352931faf3dbfb2f6d2d6c0a32ad830e">crypt_smime_send_menu</a> (struct <a class="el" href="structMailbox.html">Mailbox</a> *m, struct <a class="el" href="structEmail.html">Email</a> *e)</td></tr>
<tr class="memdesc:a352931faf3dbfb2f6d2d6c0a32ad830e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Wrapper for <a class="el" href="structCryptModuleSpecs.html#a276f84536aedc54559c57018a76ff89d" title="Ask the user whether to sign and/or encrypt the email. ">CryptModuleSpecs::send_menu()</a>  <a href="#a352931faf3dbfb2f6d2d6c0a32ad830e">More...</a><br /></td></tr>
<tr class="separator:a352931faf3dbfb2f6d2d6c0a32ad830e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa05d4e0d23b75f9074f47ff55d7b724b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#aa05d4e0d23b75f9074f47ff55d7b724b">crypt_smime_verify_sender</a> (struct <a class="el" href="structMailbox.html">Mailbox</a> *m, struct <a class="el" href="structEmail.html">Email</a> *e, struct <a class="el" href="structMessage.html">Message</a> *msg)</td></tr>
<tr class="memdesc:aa05d4e0d23b75f9074f47ff55d7b724b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Wrapper for <a class="el" href="structCryptModuleSpecs.html#a9257536042f1c581c2d8e142e94ae660" title="Does the sender match the certificate? ">CryptModuleSpecs::smime_verify_sender()</a>  <a href="#aa05d4e0d23b75f9074f47ff55d7b724b">More...</a><br /></td></tr>
<tr class="separator:aa05d4e0d23b75f9074f47ff55d7b724b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f815761abc33bf614605b9a39b3002b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a6f815761abc33bf614605b9a39b3002b">crypto_module_free</a> (void)</td></tr>
<tr class="memdesc:a6f815761abc33bf614605b9a39b3002b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clean up the crypto modules.  <a href="#a6f815761abc33bf614605b9a39b3002b">More...</a><br /></td></tr>
<tr class="separator:a6f815761abc33bf614605b9a39b3002b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7061521ecb51237cbbc557440353af39"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a7061521ecb51237cbbc557440353af39">pgp_gpgme_init</a> (void)</td></tr>
<tr class="memdesc:a7061521ecb51237cbbc557440353af39"><td class="mdescLeft">&#160;</td><td class="mdescRight">Implements <a class="el" href="structCryptModuleSpecs.html#a819c87369b2dc3806d846c3a7e9fb7b6" title="Initialise the crypto module. ">CryptModuleSpecs::init()</a>  <a href="#a7061521ecb51237cbbc557440353af39">More...</a><br /></td></tr>
<tr class="separator:a7061521ecb51237cbbc557440353af39"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e8df329d00791c453eb6b3f60eabfdf"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a2e8df329d00791c453eb6b3f60eabfdf">mutt_gpgme_select_secret_key</a> (struct <a class="el" href="structBuffer.html">Buffer</a> *keyid)</td></tr>
<tr class="memdesc:a2e8df329d00791c453eb6b3f60eabfdf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Select a private Autocrypt key for a new account.  <a href="#a2e8df329d00791c453eb6b3f60eabfdf">More...</a><br /></td></tr>
<tr class="separator:a2e8df329d00791c453eb6b3f60eabfdf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d2692bdc72ffa198bb8ca2a28cfa395"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a6d2692bdc72ffa198bb8ca2a28cfa395">mutt_gpgme_print_version</a> (void)</td></tr>
<tr class="memdesc:a6d2692bdc72ffa198bb8ca2a28cfa395"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get version of GPGME.  <a href="#a6d2692bdc72ffa198bb8ca2a28cfa395">More...</a><br /></td></tr>
<tr class="separator:a6d2692bdc72ffa198bb8ca2a28cfa395"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>API for encryption/signing of emails. </p>
<dl class="section author"><dt>Authors</dt><dd><ul>
<li>Werner Koch</li>
<li>g10code GmbH</li>
<li>Pietro Cerutti</li>
</ul>
</dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>This program is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 2 of the License, or (at your option) any later version.</dd></dl>
<p>This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.</p>
<p>You should have received a copy of the GNU General Public License along with this program. If not, see <a href="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</a>. </p>

<p class="definition">Definition in file <a class="el" href="ncrypt_2lib_8h_source.html">lib.h</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a95845954210adfc850d5602843f858d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a95845954210adfc850d5602843f858d4">&#9670;&nbsp;</a></span>SEC_NO_FLAGS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SEC_NO_FLAGS&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>No flags are set. </p>

<p class="definition">Definition at line <a class="el" href="ncrypt_2lib_8h_source.html#l00074">74</a> of file <a class="el" href="ncrypt_2lib_8h_source.html">lib.h</a>.</p>

</div>
</div>
<a id="aacaa4abd4c0696e260b7a0f1d466360a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aacaa4abd4c0696e260b7a0f1d466360a">&#9670;&nbsp;</a></span>SEC_ENCRYPT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SEC_ENCRYPT&#160;&#160;&#160;(1 &lt;&lt; 0)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p><a class="el" href="structEmail.html" title="The envelope/body of an email. ">Email</a> is encrypted. </p>

<p class="definition">Definition at line <a class="el" href="ncrypt_2lib_8h_source.html#l00075">75</a> of file <a class="el" href="ncrypt_2lib_8h_source.html">lib.h</a>.</p>

</div>
</div>
<a id="ae12c003463c99d28f65f1d6b8b053b2c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae12c003463c99d28f65f1d6b8b053b2c">&#9670;&nbsp;</a></span>SEC_SIGN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SEC_SIGN&#160;&#160;&#160;(1 &lt;&lt; 1)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p><a class="el" href="structEmail.html" title="The envelope/body of an email. ">Email</a> is signed. </p>

<p class="definition">Definition at line <a class="el" href="ncrypt_2lib_8h_source.html#l00076">76</a> of file <a class="el" href="ncrypt_2lib_8h_source.html">lib.h</a>.</p>

</div>
</div>
<a id="a427cda1ba4b173fa708e124afe7b907a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a427cda1ba4b173fa708e124afe7b907a">&#9670;&nbsp;</a></span>SEC_GOODSIGN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SEC_GOODSIGN&#160;&#160;&#160;(1 &lt;&lt; 2)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p><a class="el" href="structEmail.html" title="The envelope/body of an email. ">Email</a> has a valid signature. </p>

<p class="definition">Definition at line <a class="el" href="ncrypt_2lib_8h_source.html#l00077">77</a> of file <a class="el" href="ncrypt_2lib_8h_source.html">lib.h</a>.</p>

</div>
</div>
<a id="a70ffca3c8f9bc49498e3352294c5b8fd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a70ffca3c8f9bc49498e3352294c5b8fd">&#9670;&nbsp;</a></span>SEC_BADSIGN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SEC_BADSIGN&#160;&#160;&#160;(1 &lt;&lt; 3)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p><a class="el" href="structEmail.html" title="The envelope/body of an email. ">Email</a> has a bad signature. </p>

<p class="definition">Definition at line <a class="el" href="ncrypt_2lib_8h_source.html#l00078">78</a> of file <a class="el" href="ncrypt_2lib_8h_source.html">lib.h</a>.</p>

</div>
</div>
<a id="a9b0f8af6da383f08d29eb97fac836e3f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9b0f8af6da383f08d29eb97fac836e3f">&#9670;&nbsp;</a></span>SEC_PARTSIGN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SEC_PARTSIGN&#160;&#160;&#160;(1 &lt;&lt; 4)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Not all parts of the email is signed. </p>

<p class="definition">Definition at line <a class="el" href="ncrypt_2lib_8h_source.html#l00079">79</a> of file <a class="el" href="ncrypt_2lib_8h_source.html">lib.h</a>.</p>

</div>
</div>
<a id="a6522a5e7af7f8624b8a3bbc94d8efb1e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6522a5e7af7f8624b8a3bbc94d8efb1e">&#9670;&nbsp;</a></span>SEC_SIGNOPAQUE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SEC_SIGNOPAQUE&#160;&#160;&#160;(1 &lt;&lt; 5)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p><a class="el" href="structEmail.html" title="The envelope/body of an email. ">Email</a> has an opaque signature (encrypted) </p>

<p class="definition">Definition at line <a class="el" href="ncrypt_2lib_8h_source.html#l00080">80</a> of file <a class="el" href="ncrypt_2lib_8h_source.html">lib.h</a>.</p>

</div>
</div>
<a id="affb64fdb57b996638ce5b783ccb48810"></a>
<h2 class="memtitle"><span class="permalink"><a href="#affb64fdb57b996638ce5b783ccb48810">&#9670;&nbsp;</a></span>SEC_KEYBLOCK</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SEC_KEYBLOCK&#160;&#160;&#160;(1 &lt;&lt; 6)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p><a class="el" href="structEmail.html" title="The envelope/body of an email. ">Email</a> has a key attached. </p>

<p class="definition">Definition at line <a class="el" href="ncrypt_2lib_8h_source.html#l00081">81</a> of file <a class="el" href="ncrypt_2lib_8h_source.html">lib.h</a>.</p>

</div>
</div>
<a id="a074f827472ad45f11ec1132cdfed2daf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a074f827472ad45f11ec1132cdfed2daf">&#9670;&nbsp;</a></span>SEC_INLINE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SEC_INLINE&#160;&#160;&#160;(1 &lt;&lt; 7)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p><a class="el" href="structEmail.html" title="The envelope/body of an email. ">Email</a> has an inline signature. </p>

<p class="definition">Definition at line <a class="el" href="ncrypt_2lib_8h_source.html#l00082">82</a> of file <a class="el" href="ncrypt_2lib_8h_source.html">lib.h</a>.</p>

</div>
</div>
<a id="a2fb0b0aa796d8d79a746001d09c2a2c7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2fb0b0aa796d8d79a746001d09c2a2c7">&#9670;&nbsp;</a></span>SEC_OPPENCRYPT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SEC_OPPENCRYPT&#160;&#160;&#160;(1 &lt;&lt; 8)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Opportunistic encrypt mode. </p>

<p class="definition">Definition at line <a class="el" href="ncrypt_2lib_8h_source.html#l00083">83</a> of file <a class="el" href="ncrypt_2lib_8h_source.html">lib.h</a>.</p>

</div>
</div>
<a id="a0b36be5c32ca90d8f2caef9ea9d627fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b36be5c32ca90d8f2caef9ea9d627fc">&#9670;&nbsp;</a></span>SEC_AUTOCRYPT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SEC_AUTOCRYPT&#160;&#160;&#160;(1 &lt;&lt; 9)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>(Autocrypt) <a class="el" href="structMessage.html" title="A local copy of an email. ">Message</a> will be, or was Autocrypt encrypt+signed </p>

<p class="definition">Definition at line <a class="el" href="ncrypt_2lib_8h_source.html#l00084">84</a> of file <a class="el" href="ncrypt_2lib_8h_source.html">lib.h</a>.</p>

</div>
</div>
<a id="ae0ce4a742538f3ee3e1bfbf143c794fb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae0ce4a742538f3ee3e1bfbf143c794fb">&#9670;&nbsp;</a></span>SEC_AUTOCRYPT_OVERRIDE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SEC_AUTOCRYPT_OVERRIDE&#160;&#160;&#160;(1 &lt;&lt; 10)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>(Autocrypt) Indicates manual set/unset of encryption </p>

<p class="definition">Definition at line <a class="el" href="ncrypt_2lib_8h_source.html#l00085">85</a> of file <a class="el" href="ncrypt_2lib_8h_source.html">lib.h</a>.</p>

</div>
</div>
<a id="a587e679a4c9cc44f11f0c467bb22b0af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a587e679a4c9cc44f11f0c467bb22b0af">&#9670;&nbsp;</a></span>APPLICATION_PGP</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define APPLICATION_PGP&#160;&#160;&#160;(1 &lt;&lt; 11)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Use PGP to encrypt/sign. </p>

<p class="definition">Definition at line <a class="el" href="ncrypt_2lib_8h_source.html#l00087">87</a> of file <a class="el" href="ncrypt_2lib_8h_source.html">lib.h</a>.</p>

</div>
</div>
<a id="a798dfac1e8839ca89375b4ec62b3eff2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a798dfac1e8839ca89375b4ec62b3eff2">&#9670;&nbsp;</a></span>APPLICATION_SMIME</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define APPLICATION_SMIME&#160;&#160;&#160;(1 &lt;&lt; 12)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Use SMIME to encrypt/sign. </p>

<p class="definition">Definition at line <a class="el" href="ncrypt_2lib_8h_source.html#l00088">88</a> of file <a class="el" href="ncrypt_2lib_8h_source.html">lib.h</a>.</p>

</div>
</div>
<a id="a3c4cec129dc84794f15f44382c25fc36"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c4cec129dc84794f15f44382c25fc36">&#9670;&nbsp;</a></span>PGP_TRADITIONAL_CHECKED</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PGP_TRADITIONAL_CHECKED&#160;&#160;&#160;(1 &lt;&lt; 13)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p><a class="el" href="structEmail.html" title="The envelope/body of an email. ">Email</a> has a traditional (inline) signature. </p>

<p class="definition">Definition at line <a class="el" href="ncrypt_2lib_8h_source.html#l00089">89</a> of file <a class="el" href="ncrypt_2lib_8h_source.html">lib.h</a>.</p>

</div>
</div>
<a id="a3eec0b09486fe4bfe7613f808f768747"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3eec0b09486fe4bfe7613f808f768747">&#9670;&nbsp;</a></span>SEC_ALL_FLAGS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SEC_ALL_FLAGS&#160;&#160;&#160;((1 &lt;&lt; 14) - 1)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ncrypt_2lib_8h_source.html#l00091">91</a> of file <a class="el" href="ncrypt_2lib_8h_source.html">lib.h</a>.</p>

</div>
</div>
<a id="a6694d25dff1ee1958351160a84bb2dc0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6694d25dff1ee1958351160a84bb2dc0">&#9670;&nbsp;</a></span>PGP_ENCRYPT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PGP_ENCRYPT&#160;&#160;&#160;(<a class="el" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a> | <a class="el" href="ncrypt_2lib_8h.html#aacaa4abd4c0696e260b7a0f1d466360a">SEC_ENCRYPT</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ncrypt_2lib_8h_source.html#l00093">93</a> of file <a class="el" href="ncrypt_2lib_8h_source.html">lib.h</a>.</p>

</div>
</div>
<a id="a14f75a650c49341776276f44881d54b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a14f75a650c49341776276f44881d54b2">&#9670;&nbsp;</a></span>PGP_SIGN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PGP_SIGN&#160;&#160;&#160;(<a class="el" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a> | <a class="el" href="ncrypt_2lib_8h.html#ae12c003463c99d28f65f1d6b8b053b2c">SEC_SIGN</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ncrypt_2lib_8h_source.html#l00094">94</a> of file <a class="el" href="ncrypt_2lib_8h_source.html">lib.h</a>.</p>

</div>
</div>
<a id="ae480697fdeb3d6b2c127e0ae36c52e8e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae480697fdeb3d6b2c127e0ae36c52e8e">&#9670;&nbsp;</a></span>PGP_GOODSIGN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PGP_GOODSIGN&#160;&#160;&#160;(<a class="el" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a> | <a class="el" href="ncrypt_2lib_8h.html#a427cda1ba4b173fa708e124afe7b907a">SEC_GOODSIGN</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ncrypt_2lib_8h_source.html#l00095">95</a> of file <a class="el" href="ncrypt_2lib_8h_source.html">lib.h</a>.</p>

</div>
</div>
<a id="abd2087cae2885c199218f5530ce7945b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abd2087cae2885c199218f5530ce7945b">&#9670;&nbsp;</a></span>PGP_KEY</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PGP_KEY&#160;&#160;&#160;(<a class="el" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a> | <a class="el" href="ncrypt_2lib_8h.html#affb64fdb57b996638ce5b783ccb48810">SEC_KEYBLOCK</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ncrypt_2lib_8h_source.html#l00096">96</a> of file <a class="el" href="ncrypt_2lib_8h_source.html">lib.h</a>.</p>

</div>
</div>
<a id="a68503f0e36de213094c8546b4f74eef1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a68503f0e36de213094c8546b4f74eef1">&#9670;&nbsp;</a></span>PGP_INLINE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PGP_INLINE&#160;&#160;&#160;(<a class="el" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a> | <a class="el" href="ncrypt_2lib_8h.html#a074f827472ad45f11ec1132cdfed2daf">SEC_INLINE</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ncrypt_2lib_8h_source.html#l00097">97</a> of file <a class="el" href="ncrypt_2lib_8h_source.html">lib.h</a>.</p>

</div>
</div>
<a id="ac25eb5415ebf34da68c39a3d4e3bc9ad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac25eb5415ebf34da68c39a3d4e3bc9ad">&#9670;&nbsp;</a></span>SMIME_ENCRYPT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SMIME_ENCRYPT&#160;&#160;&#160;(<a class="el" href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a> | <a class="el" href="ncrypt_2lib_8h.html#aacaa4abd4c0696e260b7a0f1d466360a">SEC_ENCRYPT</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ncrypt_2lib_8h_source.html#l00099">99</a> of file <a class="el" href="ncrypt_2lib_8h_source.html">lib.h</a>.</p>

</div>
</div>
<a id="a67114d960e61fc36c467f4bf08d37335"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a67114d960e61fc36c467f4bf08d37335">&#9670;&nbsp;</a></span>SMIME_SIGN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SMIME_SIGN&#160;&#160;&#160;(<a class="el" href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a> | <a class="el" href="ncrypt_2lib_8h.html#ae12c003463c99d28f65f1d6b8b053b2c">SEC_SIGN</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ncrypt_2lib_8h_source.html#l00100">100</a> of file <a class="el" href="ncrypt_2lib_8h_source.html">lib.h</a>.</p>

</div>
</div>
<a id="a3e7bff0627202fd91790855e1300ec99"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3e7bff0627202fd91790855e1300ec99">&#9670;&nbsp;</a></span>SMIME_GOODSIGN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SMIME_GOODSIGN&#160;&#160;&#160;(<a class="el" href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a> | <a class="el" href="ncrypt_2lib_8h.html#a427cda1ba4b173fa708e124afe7b907a">SEC_GOODSIGN</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ncrypt_2lib_8h_source.html#l00101">101</a> of file <a class="el" href="ncrypt_2lib_8h_source.html">lib.h</a>.</p>

</div>
</div>
<a id="a79c49cef9301420920c8c673f06a1be1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a79c49cef9301420920c8c673f06a1be1">&#9670;&nbsp;</a></span>SMIME_BADSIGN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SMIME_BADSIGN&#160;&#160;&#160;(<a class="el" href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a> | <a class="el" href="ncrypt_2lib_8h.html#a70ffca3c8f9bc49498e3352294c5b8fd">SEC_BADSIGN</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ncrypt_2lib_8h_source.html#l00102">102</a> of file <a class="el" href="ncrypt_2lib_8h_source.html">lib.h</a>.</p>

</div>
</div>
<a id="a9c811504abf735623a6dd3ac20287f30"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9c811504abf735623a6dd3ac20287f30">&#9670;&nbsp;</a></span>SMIME_OPAQUE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SMIME_OPAQUE&#160;&#160;&#160;(<a class="el" href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a> | <a class="el" href="ncrypt_2lib_8h.html#a6522a5e7af7f8624b8a3bbc94d8efb1e">SEC_SIGNOPAQUE</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ncrypt_2lib_8h_source.html#l00103">103</a> of file <a class="el" href="ncrypt_2lib_8h_source.html">lib.h</a>.</p>

</div>
</div>
<a id="ad980bff69bb614893ad8e7e1c28a5023"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad980bff69bb614893ad8e7e1c28a5023">&#9670;&nbsp;</a></span>WithCrypto</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define WithCrypto&#160;&#160;&#160;(<a class="el" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a> | <a class="el" href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ncrypt_2lib_8h_source.html#l00113">113</a> of file <a class="el" href="ncrypt_2lib_8h_source.html">lib.h</a>.</p>

</div>
</div>
<a id="a827146354c736ec416508944692e52b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a827146354c736ec416508944692e52b2">&#9670;&nbsp;</a></span>KEYFLAG_NO_FLAGS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KEYFLAG_NO_FLAGS&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>No flags are set. </p>

<p class="definition">Definition at line <a class="el" href="ncrypt_2lib_8h_source.html#l00123">123</a> of file <a class="el" href="ncrypt_2lib_8h_source.html">lib.h</a>.</p>

</div>
</div>
<a id="aee8e2da44282ca27f6a786cef781334f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aee8e2da44282ca27f6a786cef781334f">&#9670;&nbsp;</a></span>KEYFLAG_CANSIGN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KEYFLAG_CANSIGN&#160;&#160;&#160;(1 &lt;&lt; 0)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Key is suitable for signing. </p>

<p class="definition">Definition at line <a class="el" href="ncrypt_2lib_8h_source.html#l00124">124</a> of file <a class="el" href="ncrypt_2lib_8h_source.html">lib.h</a>.</p>

</div>
</div>
<a id="a7254adf21a76d4ceea08bd931df4310f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7254adf21a76d4ceea08bd931df4310f">&#9670;&nbsp;</a></span>KEYFLAG_CANENCRYPT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KEYFLAG_CANENCRYPT&#160;&#160;&#160;(1 &lt;&lt; 1)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Key is suitable for encryption. </p>

<p class="definition">Definition at line <a class="el" href="ncrypt_2lib_8h_source.html#l00125">125</a> of file <a class="el" href="ncrypt_2lib_8h_source.html">lib.h</a>.</p>

</div>
</div>
<a id="a52372a26134009ebc0f946abc8a6075c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a52372a26134009ebc0f946abc8a6075c">&#9670;&nbsp;</a></span>KEYFLAG_ISX509</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KEYFLAG_ISX509&#160;&#160;&#160;(1 &lt;&lt; 2)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Key is an X.509 key. </p>

<p class="definition">Definition at line <a class="el" href="ncrypt_2lib_8h_source.html#l00126">126</a> of file <a class="el" href="ncrypt_2lib_8h_source.html">lib.h</a>.</p>

</div>
</div>
<a id="aacc955f91dd3fdc8b82246c140f023fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aacc955f91dd3fdc8b82246c140f023fa">&#9670;&nbsp;</a></span>KEYFLAG_SECRET</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KEYFLAG_SECRET&#160;&#160;&#160;(1 &lt;&lt; 7)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Key is a secret key. </p>

<p class="definition">Definition at line <a class="el" href="ncrypt_2lib_8h_source.html#l00127">127</a> of file <a class="el" href="ncrypt_2lib_8h_source.html">lib.h</a>.</p>

</div>
</div>
<a id="a20472f13517d60d40aa75287afc81c5d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a20472f13517d60d40aa75287afc81c5d">&#9670;&nbsp;</a></span>KEYFLAG_EXPIRED</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KEYFLAG_EXPIRED&#160;&#160;&#160;(1 &lt;&lt; 8)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Key is expired. </p>

<p class="definition">Definition at line <a class="el" href="ncrypt_2lib_8h_source.html#l00128">128</a> of file <a class="el" href="ncrypt_2lib_8h_source.html">lib.h</a>.</p>

</div>
</div>
<a id="acb95b48318487d9eb8f9709e933d749e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acb95b48318487d9eb8f9709e933d749e">&#9670;&nbsp;</a></span>KEYFLAG_REVOKED</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KEYFLAG_REVOKED&#160;&#160;&#160;(1 &lt;&lt; 9)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Key is revoked. </p>

<p class="definition">Definition at line <a class="el" href="ncrypt_2lib_8h_source.html#l00129">129</a> of file <a class="el" href="ncrypt_2lib_8h_source.html">lib.h</a>.</p>

</div>
</div>
<a id="a989f3449b764c6a8f5f5e0481569884a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a989f3449b764c6a8f5f5e0481569884a">&#9670;&nbsp;</a></span>KEYFLAG_DISABLED</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KEYFLAG_DISABLED&#160;&#160;&#160;(1 &lt;&lt; 10)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Key is marked disabled. </p>

<p class="definition">Definition at line <a class="el" href="ncrypt_2lib_8h_source.html#l00130">130</a> of file <a class="el" href="ncrypt_2lib_8h_source.html">lib.h</a>.</p>

</div>
</div>
<a id="a73a1ead56127b7fac407296e153c0967"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a73a1ead56127b7fac407296e153c0967">&#9670;&nbsp;</a></span>KEYFLAG_SUBKEY</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KEYFLAG_SUBKEY&#160;&#160;&#160;(1 &lt;&lt; 11)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Key is a subkey. </p>

<p class="definition">Definition at line <a class="el" href="ncrypt_2lib_8h_source.html#l00131">131</a> of file <a class="el" href="ncrypt_2lib_8h_source.html">lib.h</a>.</p>

</div>
</div>
<a id="a8ffaa1a95f918db325d8d770f76a7f79"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8ffaa1a95f918db325d8d770f76a7f79">&#9670;&nbsp;</a></span>KEYFLAG_CRITICAL</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KEYFLAG_CRITICAL&#160;&#160;&#160;(1 &lt;&lt; 12)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Key is marked critical. </p>

<p class="definition">Definition at line <a class="el" href="ncrypt_2lib_8h_source.html#l00132">132</a> of file <a class="el" href="ncrypt_2lib_8h_source.html">lib.h</a>.</p>

</div>
</div>
<a id="ae4067c9bae1c276c505b42265b70529e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae4067c9bae1c276c505b42265b70529e">&#9670;&nbsp;</a></span>KEYFLAG_PREFER_ENCRYPTION</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KEYFLAG_PREFER_ENCRYPTION&#160;&#160;&#160;(1 &lt;&lt; 13)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Key's owner prefers encryption. </p>

<p class="definition">Definition at line <a class="el" href="ncrypt_2lib_8h_source.html#l00133">133</a> of file <a class="el" href="ncrypt_2lib_8h_source.html">lib.h</a>.</p>

</div>
</div>
<a id="a88a54f7be16fc36441fafe14ee14ac0b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a88a54f7be16fc36441fafe14ee14ac0b">&#9670;&nbsp;</a></span>KEYFLAG_PREFER_SIGNING</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KEYFLAG_PREFER_SIGNING&#160;&#160;&#160;(1 &lt;&lt; 14)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Key's owner prefers signing. </p>

<p class="definition">Definition at line <a class="el" href="ncrypt_2lib_8h_source.html#l00134">134</a> of file <a class="el" href="ncrypt_2lib_8h_source.html">lib.h</a>.</p>

</div>
</div>
<a id="a74b325469393092ed6d402f1ba78d7ba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a74b325469393092ed6d402f1ba78d7ba">&#9670;&nbsp;</a></span>KEYFLAG_CANTUSE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KEYFLAG_CANTUSE&#160;&#160;&#160;(<a class="el" href="ncrypt_2lib_8h.html#a989f3449b764c6a8f5f5e0481569884a">KEYFLAG_DISABLED</a> | <a class="el" href="ncrypt_2lib_8h.html#acb95b48318487d9eb8f9709e933d749e">KEYFLAG_REVOKED</a> | <a class="el" href="ncrypt_2lib_8h.html#a20472f13517d60d40aa75287afc81c5d">KEYFLAG_EXPIRED</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ncrypt_2lib_8h_source.html#l00136">136</a> of file <a class="el" href="ncrypt_2lib_8h_source.html">lib.h</a>.</p>

</div>
</div>
<a id="a5b5753c8babedca24c31e8d2dbad8130"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5b5753c8babedca24c31e8d2dbad8130">&#9670;&nbsp;</a></span>KEYFLAG_RESTRICTIONS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KEYFLAG_RESTRICTIONS&#160;&#160;&#160;(<a class="el" href="ncrypt_2lib_8h.html#a74b325469393092ed6d402f1ba78d7ba">KEYFLAG_CANTUSE</a> | <a class="el" href="ncrypt_2lib_8h.html#a8ffaa1a95f918db325d8d770f76a7f79">KEYFLAG_CRITICAL</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ncrypt_2lib_8h_source.html#l00137">137</a> of file <a class="el" href="ncrypt_2lib_8h_source.html">lib.h</a>.</p>

</div>
</div>
<a id="a71ddb5e69f239d16bdf6a6cc266072e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a71ddb5e69f239d16bdf6a6cc266072e4">&#9670;&nbsp;</a></span>KEYFLAG_ABILITIES</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KEYFLAG_ABILITIES&#160;&#160;&#160;(<a class="el" href="ncrypt_2lib_8h.html#aee8e2da44282ca27f6a786cef781334f">KEYFLAG_CANSIGN</a> | <a class="el" href="ncrypt_2lib_8h.html#a7254adf21a76d4ceea08bd931df4310f">KEYFLAG_CANENCRYPT</a> | <a class="el" href="ncrypt_2lib_8h.html#ae4067c9bae1c276c505b42265b70529e">KEYFLAG_PREFER_ENCRYPTION</a> | <a class="el" href="ncrypt_2lib_8h.html#a88a54f7be16fc36441fafe14ee14ac0b">KEYFLAG_PREFER_SIGNING</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ncrypt_2lib_8h_source.html#l00139">139</a> of file <a class="el" href="ncrypt_2lib_8h_source.html">lib.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="a2073a168ca3a64c3c30d13fa4917a05d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2073a168ca3a64c3c30d13fa4917a05d">&#9670;&nbsp;</a></span>SecurityFlags</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef uint16_t <a class="el" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Flags, e.g. <a class="el" href="ncrypt_2lib_8h.html#aacaa4abd4c0696e260b7a0f1d466360a" title="Email is encrypted. ">SEC_ENCRYPT</a>. </p>

<p class="definition">Definition at line <a class="el" href="ncrypt_2lib_8h_source.html#l00071">71</a> of file <a class="el" href="ncrypt_2lib_8h_source.html">lib.h</a>.</p>

</div>
</div>
<a id="a530487c28aacc2c2d50f12eefb8c5506"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a530487c28aacc2c2d50f12eefb8c5506">&#9670;&nbsp;</a></span>KeyFlags</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef uint16_t <a class="el" href="ncrypt_2lib_8h.html#a530487c28aacc2c2d50f12eefb8c5506">KeyFlags</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Flags describing PGP/SMIME keys, e.g. <a class="el" href="ncrypt_2lib_8h.html#aee8e2da44282ca27f6a786cef781334f" title="Key is suitable for signing. ">KEYFLAG_CANSIGN</a>. </p>

<p class="definition">Definition at line <a class="el" href="ncrypt_2lib_8h_source.html#l00122">122</a> of file <a class="el" href="ncrypt_2lib_8h_source.html">lib.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="adffb5a3014f93e3f82de3964911041d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adffb5a3014f93e3f82de3964911041d0">&#9670;&nbsp;</a></span>crypt_extract_keys_from_messages()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void crypt_extract_keys_from_messages </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structMailbox.html">Mailbox</a> *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct EmailList *&#160;</td>
          <td class="paramname"><em>el</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Extract keys from a message. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">m</td><td><a class="el" href="structMailbox.html" title="A mailbox. ">Mailbox</a> </td></tr>
    <tr><td class="paramname">el</td><td>List of Emails to process</td></tr>
  </table>
  </dd>
</dl>
<p>The extracted keys will be added to the user's keyring. </p>

<p class="definition">Definition at line <a class="el" href="crypt_8c_source.html#l00858">858</a> of file <a class="el" href="crypt_8c_source.html">crypt.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;{</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a>)</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;  <span class="keyword">struct </span><a class="code" href="structBuffer.html">Buffer</a> *tempfname = <a class="code" href="pool_8c.html#a2129d5ea0085753afdd37cf62161845d">mutt_buffer_pool_get</a>();</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;  <a class="code" href="muttlib_8h.html#a7f1db9db6f710a84cace77248096e2ac">mutt_buffer_mktemp</a>(tempfname);</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;  FILE *fp_out = <a class="code" href="file_8c.html#ae1c0c19fec03274220b3ca065ad1e2e5">mutt_file_fopen</a>(<a class="code" href="buffer_8h.html#a4aca040fb75bc1dfc086cbfbf14ac8cd">mutt_buffer_string</a>(tempfname), <span class="stringliteral">&quot;w&quot;</span>);</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;  <span class="keywordflow">if</span> (!fp_out)</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;  {</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;    <a class="code" href="logging_8h.html#afaa521ab22db877ccf1b87e679e1b43e">mutt_perror</a>(<a class="code" href="buffer_8h.html#a4aca040fb75bc1dfc086cbfbf14ac8cd">mutt_buffer_string</a>(tempfname));</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;    <span class="keywordflow">goto</span> cleanup;</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;  }</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a>)</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;    <a class="code" href="options_8h.html#ac37333941e0b57abec75329a20feaba8">OptDontHandlePgpKeys</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;  <span class="keyword">struct </span><a class="code" href="structEmailNode.html">EmailNode</a> *en = NULL;</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;  <a class="code" href="queue_8h.html#a77999ebdf5aaf7af8b8ea22bf208c432">STAILQ_FOREACH</a>(en, el, entries)</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;  {</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;    <span class="keyword">struct </span><a class="code" href="structEmail.html">Email</a> *e = en-&gt;<a class="code" href="structEmailNode.html#a812e5a33b27b12a78daacbe246089abb">email</a>;</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;    <span class="keyword">struct </span><a class="code" href="structMessage.html">Message</a> *msg = <a class="code" href="mx_8c.html#a7df2f9d4d83ce9fca2cf48e08f8a4bc0">mx_msg_open</a>(m, e-&gt;<a class="code" href="structEmail.html#abd3d551204f4ea232a304c1c4c4c149d">msgno</a>);</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;    <span class="keywordflow">if</span> (!msg)</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;    {</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;    }</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;    <a class="code" href="attachments_8c.html#a9fb5dd768a13b9f083ca3a5e2e713db6">mutt_parse_mime_message</a>(m, e, msg-&gt;<a class="code" href="structMessage.html#a11d53ee4319e8735c1677d8780a7b517">fp</a>);</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;    <span class="keywordflow">if</span> (e-&gt;<a class="code" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> &amp; <a class="code" href="ncrypt_2lib_8h.html#aacaa4abd4c0696e260b7a0f1d466360a">SEC_ENCRYPT</a> &amp;&amp; !<a class="code" href="crypt_8c.html#a4ee7f1419a7e39b0e9f1f9d550f4de43">crypt_valid_passphrase</a>(e-&gt;<a class="code" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a>))</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;    {</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;      <a class="code" href="mx_8c.html#a2172d90c08b5a2b293d22ed13ee0e7a8">mx_msg_close</a>(m, &amp;msg);</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;      <a class="code" href="file_8c.html#a31f49795ff5b9558db5476e5777e63b6">mutt_file_fclose</a>(&amp;fp_out);</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;    }</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;    <span class="keywordflow">if</span> (((<a class="code" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; APPLICATION_PGP) != 0) &amp;&amp; (e-&gt;<a class="code" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> &amp; APPLICATION_PGP))</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;    {</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;      <a class="code" href="copy_8c.html#aa0dd608f4ed300454d97ac83ade160ac">mutt_copy_message</a>(fp_out, m, e, msg, <a class="code" href="copy_8h.html#a4898a6c2c88fdba8ce7decdb6c125a96">MUTT_CM_DECODE</a> | <a class="code" href="copy_8h.html#a648ee091378fa6c0f6f129f64fc7f22b">MUTT_CM_CHARCONV</a>,</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;                        <a class="code" href="copy_8h.html#af310a44d7c96b22de90934cb18634b58">CH_NO_FLAGS</a>, 0);</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;      fflush(fp_out);</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;      <a class="code" href="curs__lib_8c.html#acd14d074d8b9e6cb21e851dd573cdec2">mutt_endwin</a>();</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;      puts(<a class="code" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Trying to extract PGP keys...\n&quot;</span>));</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;      <a class="code" href="cryptglue_8c.html#a842ab48184b60e3b7b206536b7b78a61">crypt_pgp_invoke_import</a>(<a class="code" href="buffer_8h.html#a4aca040fb75bc1dfc086cbfbf14ac8cd">mutt_buffer_string</a>(tempfname));</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;    }</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;    <span class="keywordflow">if</span> (((<a class="code" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code" href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a>) != 0) &amp;&amp; (e-&gt;<a class="code" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> &amp; APPLICATION_SMIME))</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;    {</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">bool</span> encrypt = e-&gt;<a class="code" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> &amp; <a class="code" href="ncrypt_2lib_8h.html#aacaa4abd4c0696e260b7a0f1d466360a">SEC_ENCRYPT</a>;</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;      <a class="code" href="copy_8c.html#aa0dd608f4ed300454d97ac83ade160ac">mutt_copy_message</a>(fp_out, m, e, msg,</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;                        encrypt ? <a class="code" href="copy_8h.html#ad0d836342af33c74966ba719fd33c475">MUTT_CM_NOHEADER</a> | <a class="code" href="copy_8h.html#acb95a965dc299a0cd0b13bf4ade6fb26">MUTT_CM_DECODE_CRYPT</a> | <a class="code" href="copy_8h.html#a68c59ce93ab61f8d664fc94e60f61f3c">MUTT_CM_DECODE_SMIME</a> :</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;                                  <a class="code" href="copy_8h.html#ac778c083de78e4fb27889f345f242d13">MUTT_CM_NO_FLAGS</a>,</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;                        <a class="code" href="copy_8h.html#af310a44d7c96b22de90934cb18634b58">CH_NO_FLAGS</a>, 0);</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;      fflush(fp_out);</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;      <span class="keywordtype">char</span> *mbox = NULL;</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="queue_8h.html#ac3c9da7ac712eacbbad5cc54d7a3477e">TAILQ_EMPTY</a>(&amp;e-&gt;<a class="code" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code" href="structEnvelope.html#af1aa00aed4b8767cf98f08e45a432ad8">from</a>))</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;      {</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;        <a class="code" href="alias_8c.html#a7c57d5376e9a1cf5e1f504a452996b86">mutt_expand_aliases</a>(&amp;e-&gt;<a class="code" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code" href="structEnvelope.html#af1aa00aed4b8767cf98f08e45a432ad8">from</a>);</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;        mbox = <a class="code" href="queue_8h.html#a7d6894360bd1c41e0e6f6d84998c1362">TAILQ_FIRST</a>(&amp;e-&gt;<a class="code" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code" href="structEnvelope.html#af1aa00aed4b8767cf98f08e45a432ad8">from</a>)-&gt;mailbox;</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;      }</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code" href="queue_8h.html#ac3c9da7ac712eacbbad5cc54d7a3477e">TAILQ_EMPTY</a>(&amp;e-&gt;<a class="code" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code" href="structEnvelope.html#a72ee5c0af4f94f83aeb8d31183261611">sender</a>))</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;      {</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;        <a class="code" href="alias_8c.html#a7c57d5376e9a1cf5e1f504a452996b86">mutt_expand_aliases</a>(&amp;e-&gt;<a class="code" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code" href="structEnvelope.html#a72ee5c0af4f94f83aeb8d31183261611">sender</a>);</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;        mbox = <a class="code" href="queue_8h.html#a7d6894360bd1c41e0e6f6d84998c1362">TAILQ_FIRST</a>(&amp;e-&gt;<a class="code" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code" href="structEnvelope.html#a72ee5c0af4f94f83aeb8d31183261611">sender</a>)-&gt;mailbox;</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;      }</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;      <span class="keywordflow">if</span> (mbox)</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;      {</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;        <a class="code" href="curs__lib_8c.html#acd14d074d8b9e6cb21e851dd573cdec2">mutt_endwin</a>();</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;        puts(<a class="code" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Trying to extract S/MIME certificates...&quot;</span>));</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;        <a class="code" href="cryptglue_8c.html#a9a62b3e7470b9f9e899a63ebae53b4da">crypt_smime_invoke_import</a>(<a class="code" href="buffer_8h.html#a4aca040fb75bc1dfc086cbfbf14ac8cd">mutt_buffer_string</a>(tempfname), mbox);</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;      }</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;    }</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;    <a class="code" href="mx_8c.html#a2172d90c08b5a2b293d22ed13ee0e7a8">mx_msg_close</a>(m, &amp;msg);</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;    rewind(fp_out);</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;  }</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;  <a class="code" href="file_8c.html#a31f49795ff5b9558db5476e5777e63b6">mutt_file_fclose</a>(&amp;fp_out);</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;  <span class="keywordflow">if</span> (isendwin())</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;    <a class="code" href="curs__lib_8c.html#ab6a61cdfcf8c2c73ee59381c79c79774">mutt_any_key_to_continue</a>(NULL);</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;  <a class="code" href="file_8c.html#ae57463c2854c006a3c67b78736e9056e">mutt_file_unlink</a>(<a class="code" href="buffer_8h.html#a4aca040fb75bc1dfc086cbfbf14ac8cd">mutt_buffer_string</a>(tempfname));</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; APPLICATION_PGP)</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;    <a class="code" href="options_8h.html#ac37333941e0b57abec75329a20feaba8">OptDontHandlePgpKeys</a> = <span class="keyword">false</span>;</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;cleanup:</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;  <a class="code" href="pool_8c.html#a08b48e2ac8849341888ee7429cc5093c">mutt_buffer_pool_release</a>(&amp;tempfname);</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;}</div><div class="ttc" id="copy_8h_html_acb95a965dc299a0cd0b13bf4ade6fb26"><div class="ttname"><a href="copy_8h.html#acb95a965dc299a0cd0b13bf4ade6fb26">MUTT_CM_DECODE_CRYPT</a></div><div class="ttdeci">#define MUTT_CM_DECODE_CRYPT</div><div class="ttdef"><b>Definition:</b> <a href="copy_8h_source.html#l00048">copy.h:48</a></div></div>
<div class="ttc" id="attachments_8c_html_a9fb5dd768a13b9f083ca3a5e2e713db6"><div class="ttname"><a href="attachments_8c.html#a9fb5dd768a13b9f083ca3a5e2e713db6">mutt_parse_mime_message</a></div><div class="ttdeci">void mutt_parse_mime_message(struct Mailbox *m, struct Email *e, FILE *fp)</div><div class="ttdoc">Parse a MIME email. </div><div class="ttdef"><b>Definition:</b> <a href="attachments_8c_source.html#l00591">attachments.c:591</a></div></div>
<div class="ttc" id="muttlib_8h_html_a7f1db9db6f710a84cace77248096e2ac"><div class="ttname"><a href="muttlib_8h.html#a7f1db9db6f710a84cace77248096e2ac">mutt_buffer_mktemp</a></div><div class="ttdeci">#define mutt_buffer_mktemp(buf)</div><div class="ttdef"><b>Definition:</b> <a href="muttlib_8h_source.html#l00074">muttlib.h:74</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_ad980bff69bb614893ad8e7e1c28a5023"><div class="ttname"><a href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a></div><div class="ttdeci">#define WithCrypto</div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00113">lib.h:113</a></div></div>
<div class="ttc" id="alias_8c_html_a7c57d5376e9a1cf5e1f504a452996b86"><div class="ttname"><a href="alias_8c.html#a7c57d5376e9a1cf5e1f504a452996b86">mutt_expand_aliases</a></div><div class="ttdeci">void mutt_expand_aliases(struct AddressList *al)</div><div class="ttdoc">Expand aliases in a List of Addresses. </div><div class="ttdef"><b>Definition:</b> <a href="alias_8c_source.html#l00300">alias.c:300</a></div></div>
<div class="ttc" id="structEmail_html"><div class="ttname"><a href="structEmail.html">Email</a></div><div class="ttdoc">The envelope/body of an email. </div><div class="ttdef"><b>Definition:</b> <a href="email_8h_source.html#l00037">email.h:37</a></div></div>
<div class="ttc" id="pool_8c_html_a2129d5ea0085753afdd37cf62161845d"><div class="ttname"><a href="pool_8c.html#a2129d5ea0085753afdd37cf62161845d">mutt_buffer_pool_get</a></div><div class="ttdeci">struct Buffer * mutt_buffer_pool_get(void)</div><div class="ttdoc">Get a Buffer from the pool. </div><div class="ttdef"><b>Definition:</b> <a href="pool_8c_source.html#l00101">pool.c:101</a></div></div>
<div class="ttc" id="queue_8h_html_a7d6894360bd1c41e0e6f6d84998c1362"><div class="ttname"><a href="queue_8h.html#a7d6894360bd1c41e0e6f6d84998c1362">TAILQ_FIRST</a></div><div class="ttdeci">#define TAILQ_FIRST(head)</div><div class="ttdef"><b>Definition:</b> <a href="queue_8h_source.html#l00716">queue.h:716</a></div></div>
<div class="ttc" id="logging_8h_html_afaa521ab22db877ccf1b87e679e1b43e"><div class="ttname"><a href="logging_8h.html#afaa521ab22db877ccf1b87e679e1b43e">mutt_perror</a></div><div class="ttdeci">#define mutt_perror(...)</div><div class="ttdef"><b>Definition:</b> <a href="logging_8h_source.html#l00085">logging.h:85</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_aacaa4abd4c0696e260b7a0f1d466360a"><div class="ttname"><a href="ncrypt_2lib_8h.html#aacaa4abd4c0696e260b7a0f1d466360a">SEC_ENCRYPT</a></div><div class="ttdeci">#define SEC_ENCRYPT</div><div class="ttdoc">Email is encrypted. </div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00075">lib.h:75</a></div></div>
<div class="ttc" id="pool_8c_html_a08b48e2ac8849341888ee7429cc5093c"><div class="ttname"><a href="pool_8c.html#a08b48e2ac8849341888ee7429cc5093c">mutt_buffer_pool_release</a></div><div class="ttdeci">void mutt_buffer_pool_release(struct Buffer **pbuf)</div><div class="ttdoc">Free a Buffer from the pool. </div><div class="ttdef"><b>Definition:</b> <a href="pool_8c_source.html#l00112">pool.c:112</a></div></div>
<div class="ttc" id="file_8c_html_ae57463c2854c006a3c67b78736e9056e"><div class="ttname"><a href="file_8c.html#ae57463c2854c006a3c67b78736e9056e">mutt_file_unlink</a></div><div class="ttdeci">void mutt_file_unlink(const char *s)</div><div class="ttdoc">Delete a file, carefully. </div><div class="ttdef"><b>Definition:</b> <a href="file_8c_source.html#l00195">file.c:195</a></div></div>
<div class="ttc" id="structBuffer_html"><div class="ttname"><a href="structBuffer.html">Buffer</a></div><div class="ttdoc">String manipulation buffer. </div><div class="ttdef"><b>Definition:</b> <a href="buffer_8h_source.html#l00033">buffer.h:33</a></div></div>
<div class="ttc" id="mutt_2message_8h_html_a479d658dfd60fe8d9709ec67a58b34ca"><div class="ttname"><a href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a></div><div class="ttdeci">#define _(a)</div><div class="ttdef"><b>Definition:</b> <a href="mutt_2message_8h_source.html#l00028">message.h:28</a></div></div>
<div class="ttc" id="copy_8h_html_ac778c083de78e4fb27889f345f242d13"><div class="ttname"><a href="copy_8h.html#ac778c083de78e4fb27889f345f242d13">MUTT_CM_NO_FLAGS</a></div><div class="ttdeci">#define MUTT_CM_NO_FLAGS</div><div class="ttdoc">No flags are set. </div><div class="ttdef"><b>Definition:</b> <a href="copy_8h_source.html#l00035">copy.h:35</a></div></div>
<div class="ttc" id="buffer_8h_html_a4aca040fb75bc1dfc086cbfbf14ac8cd"><div class="ttname"><a href="buffer_8h.html#a4aca040fb75bc1dfc086cbfbf14ac8cd">mutt_buffer_string</a></div><div class="ttdeci">static const char * mutt_buffer_string(const struct Buffer *buf)</div><div class="ttdoc">Convert a buffer to a const char * &quot;string&quot;. </div><div class="ttdef"><b>Definition:</b> <a href="buffer_8h_source.html#l00077">buffer.h:77</a></div></div>
<div class="ttc" id="mx_8c_html_a2172d90c08b5a2b293d22ed13ee0e7a8"><div class="ttname"><a href="mx_8c.html#a2172d90c08b5a2b293d22ed13ee0e7a8">mx_msg_close</a></div><div class="ttdeci">int mx_msg_close(struct Mailbox *m, struct Message **msg)</div><div class="ttdoc">Close a message. </div><div class="ttdef"><b>Definition:</b> <a href="mx_8c_source.html#l01186">mx.c:1186</a></div></div>
<div class="ttc" id="crypt_8c_html_a4ee7f1419a7e39b0e9f1f9d550f4de43"><div class="ttname"><a href="crypt_8c.html#a4ee7f1419a7e39b0e9f1f9d550f4de43">crypt_valid_passphrase</a></div><div class="ttdeci">bool crypt_valid_passphrase(SecurityFlags flags)</div><div class="ttdoc">Check that we have a usable passphrase, ask if not. </div><div class="ttdef"><b>Definition:</b> <a href="crypt_8c_source.html#l00135">crypt.c:135</a></div></div>
<div class="ttc" id="structEnvelope_html_af1aa00aed4b8767cf98f08e45a432ad8"><div class="ttname"><a href="structEnvelope.html#af1aa00aed4b8767cf98f08e45a432ad8">Envelope::from</a></div><div class="ttdeci">struct AddressList from</div><div class="ttdoc">Email&amp;#39;s &amp;#39;From&amp;#39; list. </div><div class="ttdef"><b>Definition:</b> <a href="envelope_8h_source.html#l00057">envelope.h:57</a></div></div>
<div class="ttc" id="file_8c_html_a31f49795ff5b9558db5476e5777e63b6"><div class="ttname"><a href="file_8c.html#a31f49795ff5b9558db5476e5777e63b6">mutt_file_fclose</a></div><div class="ttdeci">int mutt_file_fclose(FILE **fp)</div><div class="ttdoc">Close a FILE handle (and NULL the pointer) </div><div class="ttdef"><b>Definition:</b> <a href="file_8c_source.html#l00153">file.c:153</a></div></div>
<div class="ttc" id="structEmail_html_a34cc4493729d7a3b1f4ed783e739a9ec"><div class="ttname"><a href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">Email::env</a></div><div class="ttdeci">struct Envelope * env</div><div class="ttdoc">Envelope information. </div><div class="ttdef"><b>Definition:</b> <a href="email_8h_source.html#l00090">email.h:90</a></div></div>
<div class="ttc" id="options_8h_html_ac37333941e0b57abec75329a20feaba8"><div class="ttname"><a href="options_8h.html#ac37333941e0b57abec75329a20feaba8">OptDontHandlePgpKeys</a></div><div class="ttdeci">WHERE bool OptDontHandlePgpKeys</div><div class="ttdoc">(pseudo) used to extract PGP keys </div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00035">options.h:35</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a798dfac1e8839ca89375b4ec62b3eff2"><div class="ttname"><a href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a></div><div class="ttdeci">#define APPLICATION_SMIME</div><div class="ttdoc">Use SMIME to encrypt/sign. </div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00088">lib.h:88</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a587e679a4c9cc44f11f0c467bb22b0af"><div class="ttname"><a href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a></div><div class="ttdeci">#define APPLICATION_PGP</div><div class="ttdoc">Use PGP to encrypt/sign. </div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00087">lib.h:87</a></div></div>
<div class="ttc" id="structMessage_html"><div class="ttname"><a href="structMessage.html">Message</a></div><div class="ttdoc">A local copy of an email. </div><div class="ttdef"><b>Definition:</b> <a href="mxapi_8h_source.html#l00041">mxapi.h:41</a></div></div>
<div class="ttc" id="curs__lib_8c_html_acd14d074d8b9e6cb21e851dd573cdec2"><div class="ttname"><a href="curs__lib_8c.html#acd14d074d8b9e6cb21e851dd573cdec2">mutt_endwin</a></div><div class="ttdeci">void mutt_endwin(void)</div><div class="ttdoc">Shutdown curses/slang. </div><div class="ttdef"><b>Definition:</b> <a href="curs__lib_8c_source.html#l00422">curs_lib.c:422</a></div></div>
<div class="ttc" id="cryptglue_8c_html_a842ab48184b60e3b7b206536b7b78a61"><div class="ttname"><a href="cryptglue_8c.html#a842ab48184b60e3b7b206536b7b78a61">crypt_pgp_invoke_import</a></div><div class="ttdeci">void crypt_pgp_invoke_import(const char *fname)</div><div class="ttdoc">Wrapper for CryptModuleSpecs::pgp_invoke_import() </div><div class="ttdef"><b>Definition:</b> <a href="cryptglue_8c_source.html#l00370">cryptglue.c:370</a></div></div>
<div class="ttc" id="copy_8h_html_af310a44d7c96b22de90934cb18634b58"><div class="ttname"><a href="copy_8h.html#af310a44d7c96b22de90934cb18634b58">CH_NO_FLAGS</a></div><div class="ttdeci">#define CH_NO_FLAGS</div><div class="ttdoc">No flags are set. </div><div class="ttdef"><b>Definition:</b> <a href="copy_8h_source.html#l00051">copy.h:51</a></div></div>
<div class="ttc" id="copy_8h_html_a4898a6c2c88fdba8ce7decdb6c125a96"><div class="ttname"><a href="copy_8h.html#a4898a6c2c88fdba8ce7decdb6c125a96">MUTT_CM_DECODE</a></div><div class="ttdeci">#define MUTT_CM_DECODE</div><div class="ttdoc">Decode the message body into text/plain. </div><div class="ttdef"><b>Definition:</b> <a href="copy_8h_source.html#l00038">copy.h:38</a></div></div>
<div class="ttc" id="copy_8h_html_a648ee091378fa6c0f6f129f64fc7f22b"><div class="ttname"><a href="copy_8h.html#a648ee091378fa6c0f6f129f64fc7f22b">MUTT_CM_CHARCONV</a></div><div class="ttdeci">#define MUTT_CM_CHARCONV</div><div class="ttdoc">Perform character set conversions. </div><div class="ttdef"><b>Definition:</b> <a href="copy_8h_source.html#l00042">copy.h:42</a></div></div>
<div class="ttc" id="queue_8h_html_a77999ebdf5aaf7af8b8ea22bf208c432"><div class="ttname"><a href="queue_8h.html#a77999ebdf5aaf7af8b8ea22bf208c432">STAILQ_FOREACH</a></div><div class="ttdeci">#define STAILQ_FOREACH(var, head, field)</div><div class="ttdef"><b>Definition:</b> <a href="queue_8h_source.html#l00349">queue.h:349</a></div></div>
<div class="ttc" id="structEmail_html_a570a81cd747437c9ea4357947731ae10"><div class="ttname"><a href="structEmail.html#a570a81cd747437c9ea4357947731ae10">Email::security</a></div><div class="ttdeci">SecurityFlags security</div><div class="ttdoc">bit 0-10: flags, bit 11,12: application, bit 13: traditional pgp See: ncrypt/lib.h pgplib...</div><div class="ttdef"><b>Definition:</b> <a href="email_8h_source.html#l00039">email.h:39</a></div></div>
<div class="ttc" id="copy_8h_html_a68c59ce93ab61f8d664fc94e60f61f3c"><div class="ttname"><a href="copy_8h.html#a68c59ce93ab61f8d664fc94e60f61f3c">MUTT_CM_DECODE_SMIME</a></div><div class="ttdeci">#define MUTT_CM_DECODE_SMIME</div><div class="ttdoc">Used for decoding S/MIME messages. </div><div class="ttdef"><b>Definition:</b> <a href="copy_8h_source.html#l00046">copy.h:46</a></div></div>
<div class="ttc" id="curs__lib_8c_html_ab6a61cdfcf8c2c73ee59381c79c79774"><div class="ttname"><a href="curs__lib_8c.html#ab6a61cdfcf8c2c73ee59381c79c79774">mutt_any_key_to_continue</a></div><div class="ttdeci">int mutt_any_key_to_continue(const char *s)</div><div class="ttdoc">Prompt the user to &amp;#39;press any key&amp;#39; and wait. </div><div class="ttdef"><b>Definition:</b> <a href="curs__lib_8c_source.html#l00455">curs_lib.c:455</a></div></div>
<div class="ttc" id="cryptglue_8c_html_a9a62b3e7470b9f9e899a63ebae53b4da"><div class="ttname"><a href="cryptglue_8c.html#a9a62b3e7470b9f9e899a63ebae53b4da">crypt_smime_invoke_import</a></div><div class="ttdeci">void crypt_smime_invoke_import(const char *infile, const char *mailbox)</div><div class="ttdoc">Wrapper for CryptModuleSpecs::smime_invoke_import() </div><div class="ttdef"><b>Definition:</b> <a href="cryptglue_8c_source.html#l00516">cryptglue.c:516</a></div></div>
<div class="ttc" id="structEmailNode_html_a812e5a33b27b12a78daacbe246089abb"><div class="ttname"><a href="structEmailNode.html#a812e5a33b27b12a78daacbe246089abb">EmailNode::email</a></div><div class="ttdeci">struct Email * email</div><div class="ttdoc">Email in the list. </div><div class="ttdef"><b>Definition:</b> <a href="email_8h_source.html#l00131">email.h:131</a></div></div>
<div class="ttc" id="structMessage_html_a11d53ee4319e8735c1677d8780a7b517"><div class="ttname"><a href="structMessage.html#a11d53ee4319e8735c1677d8780a7b517">Message::fp</a></div><div class="ttdeci">FILE * fp</div><div class="ttdoc">pointer to the message data </div><div class="ttdef"><b>Definition:</b> <a href="mxapi_8h_source.html#l00043">mxapi.h:43</a></div></div>
<div class="ttc" id="copy_8c_html_aa0dd608f4ed300454d97ac83ade160ac"><div class="ttname"><a href="copy_8c.html#aa0dd608f4ed300454d97ac83ade160ac">mutt_copy_message</a></div><div class="ttdeci">int mutt_copy_message(FILE *fp_out, struct Mailbox *m, struct Email *e, struct Message *msg, CopyMessageFlags cmflags, CopyHeaderFlags chflags, int wraplen)</div><div class="ttdoc">Copy a message from a Mailbox. </div><div class="ttdef"><b>Definition:</b> <a href="copy_8c_source.html#l00853">copy.c:853</a></div></div>
<div class="ttc" id="structEnvelope_html_a72ee5c0af4f94f83aeb8d31183261611"><div class="ttname"><a href="structEnvelope.html#a72ee5c0af4f94f83aeb8d31183261611">Envelope::sender</a></div><div class="ttdeci">struct AddressList sender</div><div class="ttdoc">Email&amp;#39;s sender. </div><div class="ttdef"><b>Definition:</b> <a href="envelope_8h_source.html#l00061">envelope.h:61</a></div></div>
<div class="ttc" id="structEmailNode_html"><div class="ttname"><a href="structEmailNode.html">EmailNode</a></div><div class="ttdoc">List of Emails. </div><div class="ttdef"><b>Definition:</b> <a href="email_8h_source.html#l00129">email.h:129</a></div></div>
<div class="ttc" id="queue_8h_html_ac3c9da7ac712eacbbad5cc54d7a3477e"><div class="ttname"><a href="queue_8h.html#ac3c9da7ac712eacbbad5cc54d7a3477e">TAILQ_EMPTY</a></div><div class="ttdeci">#define TAILQ_EMPTY(head)</div><div class="ttdef"><b>Definition:</b> <a href="queue_8h_source.html#l00714">queue.h:714</a></div></div>
<div class="ttc" id="copy_8h_html_ad0d836342af33c74966ba719fd33c475"><div class="ttname"><a href="copy_8h.html#ad0d836342af33c74966ba719fd33c475">MUTT_CM_NOHEADER</a></div><div class="ttdeci">#define MUTT_CM_NOHEADER</div><div class="ttdoc">Don&amp;#39;t copy the message header. </div><div class="ttdef"><b>Definition:</b> <a href="copy_8h_source.html#l00036">copy.h:36</a></div></div>
<div class="ttc" id="file_8c_html_ae1c0c19fec03274220b3ca065ad1e2e5"><div class="ttname"><a href="file_8c.html#ae1c0c19fec03274220b3ca065ad1e2e5">mutt_file_fopen</a></div><div class="ttdeci">FILE * mutt_file_fopen(const char *path, const char *mode)</div><div class="ttdoc">Call fopen() safely. </div><div class="ttdef"><b>Definition:</b> <a href="file_8c_source.html#l00589">file.c:589</a></div></div>
<div class="ttc" id="mx_8c_html_a7df2f9d4d83ce9fca2cf48e08f8a4bc0"><div class="ttname"><a href="mx_8c.html#a7df2f9d4d83ce9fca2cf48e08f8a4bc0">mx_msg_open</a></div><div class="ttdeci">struct Message * mx_msg_open(struct Mailbox *m, int msgno)</div><div class="ttdoc">return a stream pointer for a message </div><div class="ttdef"><b>Definition:</b> <a href="mx_8c_source.html#l01140">mx.c:1140</a></div></div>
<div class="ttc" id="structEmail_html_abd3d551204f4ea232a304c1c4c4c149d"><div class="ttname"><a href="structEmail.html#abd3d551204f4ea232a304c1c4c4c149d">Email::msgno</a></div><div class="ttdeci">int msgno</div><div class="ttdoc">Number displayed to the user. </div><div class="ttdef"><b>Definition:</b> <a href="email_8h_source.html#l00087">email.h:87</a></div></div>
</div><!-- fragment --><div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_adffb5a3014f93e3f82de3964911041d0_cgraph.svg" width="587" height="814"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div id="dynsection-2" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-2-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-2-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-2-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_adffb5a3014f93e3f82de3964911041d0_icgraph.svg" width="346" height="88"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a8a09719065d14c27701c998b48883ac4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a09719065d14c27701c998b48883ac4">&#9670;&nbsp;</a></span>crypt_forget_passphrase()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void crypt_forget_passphrase </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Forget a passphrase and display a message. </p>

<p class="definition">Definition at line <a class="el" href="crypt_8c_source.html#l00093">93</a> of file <a class="el" href="crypt_8c_source.html">crypt.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;{</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a>)</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <a class="code" href="cryptglue_8c.html#ab11bb907cc90bcd3aadecfd0000b5350">crypt_pgp_void_passphrase</a>();</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code" href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a>)</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <a class="code" href="cryptglue_8c.html#a84e2b083debe6ba85cf3deca3e0fe99a">crypt_smime_void_passphrase</a>();</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a>)</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  {</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="comment">/* L10N: Due to the implementation details (e.g. some passwords are managed</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">       by gpg-agent) we can&#39;t know whether we forgot zero, 1, 12, ...</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment">       passwords. So in English we use &quot;Passphrases&quot;. Your language might</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">       have other means to express this. */</span></div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <a class="code" href="logging_8h.html#ae108f891125caafa9250cf0959c40c04">mutt_message</a>(<a class="code" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Passphrases forgotten&quot;</span>));</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  }</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;}</div><div class="ttc" id="ncrypt_2lib_8h_html_ad980bff69bb614893ad8e7e1c28a5023"><div class="ttname"><a href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a></div><div class="ttdeci">#define WithCrypto</div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00113">lib.h:113</a></div></div>
<div class="ttc" id="logging_8h_html_ae108f891125caafa9250cf0959c40c04"><div class="ttname"><a href="logging_8h.html#ae108f891125caafa9250cf0959c40c04">mutt_message</a></div><div class="ttdeci">#define mutt_message(...)</div><div class="ttdef"><b>Definition:</b> <a href="logging_8h_source.html#l00083">logging.h:83</a></div></div>
<div class="ttc" id="cryptglue_8c_html_ab11bb907cc90bcd3aadecfd0000b5350"><div class="ttname"><a href="cryptglue_8c.html#ab11bb907cc90bcd3aadecfd0000b5350">crypt_pgp_void_passphrase</a></div><div class="ttdeci">void crypt_pgp_void_passphrase(void)</div><div class="ttdoc">Wrapper for CryptModuleSpecs::void_passphrase() </div><div class="ttdef"><b>Definition:</b> <a href="cryptglue_8c_source.html#l00192">cryptglue.c:192</a></div></div>
<div class="ttc" id="mutt_2message_8h_html_a479d658dfd60fe8d9709ec67a58b34ca"><div class="ttname"><a href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a></div><div class="ttdeci">#define _(a)</div><div class="ttdef"><b>Definition:</b> <a href="mutt_2message_8h_source.html#l00028">message.h:28</a></div></div>
<div class="ttc" id="cryptglue_8c_html_a84e2b083debe6ba85cf3deca3e0fe99a"><div class="ttname"><a href="cryptglue_8c.html#a84e2b083debe6ba85cf3deca3e0fe99a">crypt_smime_void_passphrase</a></div><div class="ttdeci">void crypt_smime_void_passphrase(void)</div><div class="ttdoc">Wrapper for CryptModuleSpecs::void_passphrase() </div><div class="ttdef"><b>Definition:</b> <a href="cryptglue_8c_source.html#l00419">cryptglue.c:419</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a798dfac1e8839ca89375b4ec62b3eff2"><div class="ttname"><a href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a></div><div class="ttdeci">#define APPLICATION_SMIME</div><div class="ttdoc">Use SMIME to encrypt/sign. </div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00088">lib.h:88</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a587e679a4c9cc44f11f0c467bb22b0af"><div class="ttname"><a href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a></div><div class="ttdeci">#define APPLICATION_PGP</div><div class="ttdoc">Use PGP to encrypt/sign. </div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00087">lib.h:87</a></div></div>
</div><!-- fragment --><div id="dynsection-3" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-3-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-3-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-3-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_a8a09719065d14c27701c998b48883ac4_cgraph.svg" width="464" height="88"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div id="dynsection-4" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-4-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-4-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-4-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_a8a09719065d14c27701c998b48883ac4_icgraph.svg" width="811" height="139"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a35eba8f2cd36c286f2226ff748ee63e6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a35eba8f2cd36c286f2226ff748ee63e6">&#9670;&nbsp;</a></span>crypt_get_keys()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int crypt_get_keys </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structMailbox.html">Mailbox</a> *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structEmail.html">Email</a> *&#160;</td>
          <td class="paramname"><em>e</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>keylist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>oppenc_mode</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check we have all the keys we need. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">m</td><td>Current <a class="el" href="structMailbox.html" title="A mailbox. ">Mailbox</a> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">e</td><td><a class="el" href="structEmail.html" title="The envelope/body of an email. ">Email</a> with addresses to match </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">keylist</td><td>Keys needed </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">oppenc_mode</td><td>If true, use opportunistic encryption </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Success </td></tr>
    <tr><td class="paramname">-1</td><td>Error</td></tr>
  </table>
  </dd>
</dl>
<p>Do a quick check to make sure that we can find all of the encryption keys if the user has requested this service. Return the list of keys in KEYLIST. If oppenc_mode is true, only keys that can be determined without prompting will be used. </p>

<p class="definition">Definition at line <a class="el" href="crypt_8c_source.html#l00963">963</a> of file <a class="el" href="crypt_8c_source.html">crypt.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;{</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a>)</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;  <span class="keyword">struct </span>AddressList addrlist = <a class="code" href="queue_8h.html#ac269df7d4126ed9885156cbad2cbf8af">TAILQ_HEAD_INITIALIZER</a>(addrlist);</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *fqdn = <a class="code" href="sendlib_8c.html#a3214a4d6985ca1a64f72d21f6f8c252f">mutt_fqdn</a>(<span class="keyword">true</span>, <a class="code" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>);</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *self_encrypt = NULL;</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;  <span class="comment">/* Do a quick check to make sure that we can find all of the encryption</span></div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;<span class="comment">   * keys if the user has requested this service.  */</span></div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;  *keylist = NULL;</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;<span class="preprocessor">#ifdef USE_AUTOCRYPT</span></div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;  <span class="keywordflow">if</span> (!oppenc_mode &amp;&amp; (e-&gt;<a class="code" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> &amp; <a class="code" href="ncrypt_2lib_8h.html#a0b36be5c32ca90d8f2caef9ea9d627fc">SEC_AUTOCRYPT</a>))</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;  {</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="autocrypt_8c.html#a9e2b5f120aee58fbaf78cae0c315d827">mutt_autocrypt_ui_recommendation</a>(m, e, keylist) &lt;= <a class="code" href="autocrypt_2lib_8h.html#aed237ffa27e23d83cb0acc07586ffbdaa5243c176ca12aa8812707f39781ebec3">AUTOCRYPT_REC_NO</a>)</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;  }</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a>)</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;    <a class="code" href="options_8h.html#ae844d8651bdf868ec0e6ef6d4e387d8b">OptPgpCheckTrust</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;  <a class="code" href="address_2address_8c.html#a16764dc80c9b3f6ad2897c8b7e59bd10">mutt_addrlist_copy</a>(&amp;addrlist, &amp;e-&gt;<a class="code" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code" href="structEnvelope.html#a2d927371b3b80e025d6f7522b7361fe7">to</a>, <span class="keyword">false</span>);</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;  <a class="code" href="address_2address_8c.html#a16764dc80c9b3f6ad2897c8b7e59bd10">mutt_addrlist_copy</a>(&amp;addrlist, &amp;e-&gt;<a class="code" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code" href="structEnvelope.html#a6b00837b3cb4b41898b42307135be8b6">cc</a>, <span class="keyword">false</span>);</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;  <a class="code" href="address_2address_8c.html#a16764dc80c9b3f6ad2897c8b7e59bd10">mutt_addrlist_copy</a>(&amp;addrlist, &amp;e-&gt;<a class="code" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code" href="structEnvelope.html#aad427832f4ae422f1b16d0896c1d3af6">bcc</a>, <span class="keyword">false</span>);</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;  <a class="code" href="address_2address_8c.html#a1de5e467c74e205ff465fd601c275b88">mutt_addrlist_qualify</a>(&amp;addrlist, fqdn);</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;  <a class="code" href="address_2address_8c.html#aee5d40d84136d3a7adba727e2908ad66">mutt_addrlist_dedupe</a>(&amp;addrlist);</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;  <span class="keywordflow">if</span> (oppenc_mode || (e-&gt;<a class="code" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> &amp; <a class="code" href="ncrypt_2lib_8h.html#aacaa4abd4c0696e260b7a0f1d466360a">SEC_ENCRYPT</a>))</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;  {</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;    <span class="keywordflow">if</span> (((<a class="code" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; APPLICATION_PGP) != 0) &amp;&amp; (e-&gt;<a class="code" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> &amp; APPLICATION_PGP))</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;    {</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;      *keylist = <a class="code" href="cryptglue_8c.html#acc0b640120a1e7459ff7ee4081031848">crypt_pgp_find_keys</a>(&amp;addrlist, oppenc_mode);</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;      <span class="keywordflow">if</span> (!*keylist)</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;      {</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;        <a class="code" href="address_2address_8c.html#a396bcf6adfff6663096fa6ae99c31c9a">mutt_addrlist_clear</a>(&amp;addrlist);</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;        <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;      }</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;      <a class="code" href="options_8h.html#ae844d8651bdf868ec0e6ef6d4e387d8b">OptPgpCheckTrust</a> = <span class="keyword">false</span>;</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">bool</span> c_pgp_self_encrypt =</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;          <a class="code" href="helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(<a class="code" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;pgp_self_encrypt&quot;</span>);</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keyword">const</span> c_pgp_default_key =</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;          <a class="code" href="helpers_8c.html#ac477c591155aa4ae0452bbabc0affffe">cs_subset_string</a>(<a class="code" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;pgp_default_key&quot;</span>);</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;      <span class="keyword">const</span> <span class="keyword">enum</span> <a class="code" href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35db">QuadOption</a> c_pgp_encrypt_self =</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;          <a class="code" href="helpers_8c.html#a9154ba713ce99b0937f475eec7c61af9">cs_subset_quad</a>(<a class="code" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;pgp_encrypt_self&quot;</span>);</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;      <span class="keywordflow">if</span> (c_pgp_self_encrypt || (c_pgp_encrypt_self == <a class="code" href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35dbafee7088606c4724651c799a6a0b182b7">MUTT_YES</a>))</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;        self_encrypt = c_pgp_default_key;</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;    }</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;    <span class="keywordflow">if</span> (((<a class="code" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code" href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a>) != 0) &amp;&amp; (e-&gt;<a class="code" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> &amp; APPLICATION_SMIME))</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;    {</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;      *keylist = <a class="code" href="cryptglue_8c.html#a57c1bc28957ade858546c243dad15173">crypt_smime_find_keys</a>(&amp;addrlist, oppenc_mode);</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;      <span class="keywordflow">if</span> (!*keylist)</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;      {</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;        <a class="code" href="address_2address_8c.html#a396bcf6adfff6663096fa6ae99c31c9a">mutt_addrlist_clear</a>(&amp;addrlist);</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;        <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;      }</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">bool</span> c_smime_self_encrypt =</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;          <a class="code" href="helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(<a class="code" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;smime_self_encrypt&quot;</span>);</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keyword">const</span> c_smime_default_key =</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;          <a class="code" href="helpers_8c.html#ac477c591155aa4ae0452bbabc0affffe">cs_subset_string</a>(<a class="code" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;smime_default_key&quot;</span>);</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;      <span class="keyword">const</span> <span class="keyword">enum</span> <a class="code" href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35db">QuadOption</a> c_smime_encrypt_self =</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;          <a class="code" href="helpers_8c.html#a9154ba713ce99b0937f475eec7c61af9">cs_subset_quad</a>(<a class="code" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;smime_encrypt_self&quot;</span>);</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;      <span class="keywordflow">if</span> (c_smime_self_encrypt || (c_smime_encrypt_self == <a class="code" href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35dbafee7088606c4724651c799a6a0b182b7">MUTT_YES</a>))</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;        self_encrypt = c_smime_default_key;</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;    }</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;  }</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;  <span class="keywordflow">if</span> (!oppenc_mode &amp;&amp; self_encrypt)</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;  {</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">size_t</span> keylist_size = <a class="code" href="mutt_2string_8c.html#acca6786b903b22a5924219f9db96e10d">mutt_str_len</a>(*keylist);</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;    <a class="code" href="memory_8c.html#af778eb8166966fc0666c64849f6c7c5b">mutt_mem_realloc</a>(keylist, keylist_size + <a class="code" href="mutt_2string_8c.html#acca6786b903b22a5924219f9db96e10d">mutt_str_len</a>(self_encrypt) + 2);</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;    sprintf(*keylist + keylist_size, <span class="stringliteral">&quot; %s&quot;</span>, self_encrypt);</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;  }</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;  <a class="code" href="address_2address_8c.html#a396bcf6adfff6663096fa6ae99c31c9a">mutt_addrlist_clear</a>(&amp;addrlist);</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;}</div><div class="ttc" id="autocrypt_8c_html_a9e2b5f120aee58fbaf78cae0c315d827"><div class="ttname"><a href="autocrypt_8c.html#a9e2b5f120aee58fbaf78cae0c315d827">mutt_autocrypt_ui_recommendation</a></div><div class="ttdeci">enum AutocryptRec mutt_autocrypt_ui_recommendation(struct Mailbox *m, struct Email *e, char **keylist)</div><div class="ttdoc">Get the recommended action for an Email. </div><div class="ttdef"><b>Definition:</b> <a href="autocrypt_8c_source.html#l00575">autocrypt.c:575</a></div></div>
<div class="ttc" id="helpers_8c_html_ae50f679dd6c5bd1ba820884c8602f038"><div class="ttname"><a href="helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a></div><div class="ttdeci">bool cs_subset_bool(const struct ConfigSubset *sub, const char *name)</div><div class="ttdoc">Get a boolean config item by name. </div><div class="ttdef"><b>Definition:</b> <a href="helpers_8c_source.html#l00071">helpers.c:71</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_ad980bff69bb614893ad8e7e1c28a5023"><div class="ttname"><a href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a></div><div class="ttdeci">#define WithCrypto</div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00113">lib.h:113</a></div></div>
<div class="ttc" id="cryptglue_8c_html_a57c1bc28957ade858546c243dad15173"><div class="ttname"><a href="cryptglue_8c.html#a57c1bc28957ade858546c243dad15173">crypt_smime_find_keys</a></div><div class="ttdeci">char * crypt_smime_find_keys(struct AddressList *addrlist, bool oppenc_mode)</div><div class="ttdoc">Wrapper for CryptModuleSpecs::find_keys() </div><div class="ttdef"><b>Definition:</b> <a href="cryptglue_8c_source.html#l00483">cryptglue.c:483</a></div></div>
<div class="ttc" id="structEnvelope_html_aad427832f4ae422f1b16d0896c1d3af6"><div class="ttname"><a href="structEnvelope.html#aad427832f4ae422f1b16d0896c1d3af6">Envelope::bcc</a></div><div class="ttdeci">struct AddressList bcc</div><div class="ttdoc">Email&amp;#39;s &amp;#39;Bcc&amp;#39; list. </div><div class="ttdef"><b>Definition:</b> <a href="envelope_8h_source.html#l00060">envelope.h:60</a></div></div>
<div class="ttc" id="address_2address_8c_html_a396bcf6adfff6663096fa6ae99c31c9a"><div class="ttname"><a href="address_2address_8c.html#a396bcf6adfff6663096fa6ae99c31c9a">mutt_addrlist_clear</a></div><div class="ttdeci">void mutt_addrlist_clear(struct AddressList *al)</div><div class="ttdoc">Unlink and free all Address in an AddressList. </div><div class="ttdef"><b>Definition:</b> <a href="address_2address_8c_source.html#l01470">address.c:1470</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_aacaa4abd4c0696e260b7a0f1d466360a"><div class="ttname"><a href="ncrypt_2lib_8h.html#aacaa4abd4c0696e260b7a0f1d466360a">SEC_ENCRYPT</a></div><div class="ttdeci">#define SEC_ENCRYPT</div><div class="ttdoc">Email is encrypted. </div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00075">lib.h:75</a></div></div>
<div class="ttc" id="address_2address_8c_html_a16764dc80c9b3f6ad2897c8b7e59bd10"><div class="ttname"><a href="address_2address_8c.html#a16764dc80c9b3f6ad2897c8b7e59bd10">mutt_addrlist_copy</a></div><div class="ttdeci">void mutt_addrlist_copy(struct AddressList *dst, const struct AddressList *src, bool prune)</div><div class="ttdoc">Copy a list of addresses into another list. </div><div class="ttdef"><b>Definition:</b> <a href="address_2address_8c_source.html#l00737">address.c:737</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a0b36be5c32ca90d8f2caef9ea9d627fc"><div class="ttname"><a href="ncrypt_2lib_8h.html#a0b36be5c32ca90d8f2caef9ea9d627fc">SEC_AUTOCRYPT</a></div><div class="ttdeci">#define SEC_AUTOCRYPT</div><div class="ttdoc">(Autocrypt) Message will be, or was Autocrypt encrypt+signed </div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00084">lib.h:84</a></div></div>
<div class="ttc" id="structNeoMutt_html"><div class="ttname"><a href="structNeoMutt.html">NeoMutt</a></div><div class="ttdoc">Container for Accounts, Notifications. </div><div class="ttdef"><b>Definition:</b> <a href="neomutt_8h_source.html#l00036">neomutt.h:36</a></div></div>
<div class="ttc" id="quad_8h_html_a738f558a271fe5035e0ee3b700ee35db"><div class="ttname"><a href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35db">QuadOption</a></div><div class="ttdeci">QuadOption</div><div class="ttdoc">Possible values for a quad-option. </div><div class="ttdef"><b>Definition:</b> <a href="quad_8h_source.html#l00035">quad.h:35</a></div></div>
<div class="ttc" id="autocrypt_2lib_8h_html_aed237ffa27e23d83cb0acc07586ffbdaa5243c176ca12aa8812707f39781ebec3"><div class="ttname"><a href="autocrypt_2lib_8h.html#aed237ffa27e23d83cb0acc07586ffbdaa5243c176ca12aa8812707f39781ebec3">AUTOCRYPT_REC_NO</a></div><div class="ttdoc">Do no use Autocrypt. </div><div class="ttdef"><b>Definition:</b> <a href="autocrypt_2lib_8h_source.html#l00157">lib.h:157</a></div></div>
<div class="ttc" id="address_2address_8c_html_aee5d40d84136d3a7adba727e2908ad66"><div class="ttname"><a href="address_2address_8c.html#aee5d40d84136d3a7adba727e2908ad66">mutt_addrlist_dedupe</a></div><div class="ttdeci">void mutt_addrlist_dedupe(struct AddressList *al)</div><div class="ttdoc">Remove duplicate addresses. </div><div class="ttdef"><b>Definition:</b> <a href="address_2address_8c_source.html#l01407">address.c:1407</a></div></div>
<div class="ttc" id="structEmail_html_a34cc4493729d7a3b1f4ed783e739a9ec"><div class="ttname"><a href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">Email::env</a></div><div class="ttdeci">struct Envelope * env</div><div class="ttdoc">Envelope information. </div><div class="ttdef"><b>Definition:</b> <a href="email_8h_source.html#l00090">email.h:90</a></div></div>
<div class="ttc" id="structEnvelope_html_a6b00837b3cb4b41898b42307135be8b6"><div class="ttname"><a href="structEnvelope.html#a6b00837b3cb4b41898b42307135be8b6">Envelope::cc</a></div><div class="ttdeci">struct AddressList cc</div><div class="ttdoc">Email&amp;#39;s &amp;#39;Cc&amp;#39; list. </div><div class="ttdef"><b>Definition:</b> <a href="envelope_8h_source.html#l00059">envelope.h:59</a></div></div>
<div class="ttc" id="memory_8c_html_af778eb8166966fc0666c64849f6c7c5b"><div class="ttname"><a href="memory_8c.html#af778eb8166966fc0666c64849f6c7c5b">mutt_mem_realloc</a></div><div class="ttdeci">void mutt_mem_realloc(void *ptr, size_t size)</div><div class="ttdoc">Resize a block of memory on the heap. </div><div class="ttdef"><b>Definition:</b> <a href="memory_8c_source.html#l00114">memory.c:114</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a798dfac1e8839ca89375b4ec62b3eff2"><div class="ttname"><a href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a></div><div class="ttdeci">#define APPLICATION_SMIME</div><div class="ttdoc">Use SMIME to encrypt/sign. </div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00088">lib.h:88</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a587e679a4c9cc44f11f0c467bb22b0af"><div class="ttname"><a href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a></div><div class="ttdeci">#define APPLICATION_PGP</div><div class="ttdoc">Use PGP to encrypt/sign. </div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00087">lib.h:87</a></div></div>
<div class="ttc" id="helpers_8c_html_ac477c591155aa4ae0452bbabc0affffe"><div class="ttname"><a href="helpers_8c.html#ac477c591155aa4ae0452bbabc0affffe">cs_subset_string</a></div><div class="ttdeci">const char * cs_subset_string(const struct ConfigSubset *sub, const char *name)</div><div class="ttdoc">Get a string config item by name. </div><div class="ttdef"><b>Definition:</b> <a href="helpers_8c_source.html#l00295">helpers.c:295</a></div></div>
<div class="ttc" id="options_8h_html_ae844d8651bdf868ec0e6ef6d4e387d8b"><div class="ttname"><a href="options_8h.html#ae844d8651bdf868ec0e6ef6d4e387d8b">OptPgpCheckTrust</a></div><div class="ttdeci">WHERE bool OptPgpCheckTrust</div><div class="ttdoc">(pseudo) used by dlg_select_pgp_key() </div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00048">options.h:48</a></div></div>
<div class="ttc" id="structEmail_html_a570a81cd747437c9ea4357947731ae10"><div class="ttname"><a href="structEmail.html#a570a81cd747437c9ea4357947731ae10">Email::security</a></div><div class="ttdeci">SecurityFlags security</div><div class="ttdoc">bit 0-10: flags, bit 11,12: application, bit 13: traditional pgp See: ncrypt/lib.h pgplib...</div><div class="ttdef"><b>Definition:</b> <a href="email_8h_source.html#l00039">email.h:39</a></div></div>
<div class="ttc" id="helpers_8c_html_a9154ba713ce99b0937f475eec7c61af9"><div class="ttname"><a href="helpers_8c.html#a9154ba713ce99b0937f475eec7c61af9">cs_subset_quad</a></div><div class="ttdeci">enum QuadOption cs_subset_quad(const struct ConfigSubset *sub, const char *name)</div><div class="ttdoc">Get a quad-value config item by name. </div><div class="ttdef"><b>Definition:</b> <a href="helpers_8c_source.html#l00204">helpers.c:204</a></div></div>
<div class="ttc" id="mutt_2string_8c_html_acca6786b903b22a5924219f9db96e10d"><div class="ttname"><a href="mutt_2string_8c.html#acca6786b903b22a5924219f9db96e10d">mutt_str_len</a></div><div class="ttdeci">size_t mutt_str_len(const char *a)</div><div class="ttdoc">Calculate the length of a string, safely. </div><div class="ttdef"><b>Definition:</b> <a href="mutt_2string_8c_source.html#l00664">string.c:664</a></div></div>
<div class="ttc" id="address_2address_8c_html_a1de5e467c74e205ff465fd601c275b88"><div class="ttname"><a href="address_2address_8c.html#a1de5e467c74e205ff465fd601c275b88">mutt_addrlist_qualify</a></div><div class="ttdeci">void mutt_addrlist_qualify(struct AddressList *al, const char *host)</div><div class="ttdoc">Expand local names in an Address list using a hostname. </div><div class="ttdef"><b>Definition:</b> <a href="address_2address_8c_source.html#l00650">address.c:650</a></div></div>
<div class="ttc" id="cryptglue_8c_html_acc0b640120a1e7459ff7ee4081031848"><div class="ttname"><a href="cryptglue_8c.html#acc0b640120a1e7459ff7ee4081031848">crypt_pgp_find_keys</a></div><div class="ttdeci">char * crypt_pgp_find_keys(struct AddressList *addrlist, bool oppenc_mode)</div><div class="ttdoc">Wrapper for CryptModuleSpecs::find_keys() </div><div class="ttdef"><b>Definition:</b> <a href="cryptglue_8c_source.html#l00321">cryptglue.c:321</a></div></div>
<div class="ttc" id="sendlib_8c_html_a3214a4d6985ca1a64f72d21f6f8c252f"><div class="ttname"><a href="sendlib_8c.html#a3214a4d6985ca1a64f72d21f6f8c252f">mutt_fqdn</a></div><div class="ttdeci">const char * mutt_fqdn(bool may_hide_host, const struct ConfigSubset *sub)</div><div class="ttdoc">Get the Fully-Qualified Domain Name. </div><div class="ttdef"><b>Definition:</b> <a href="sendlib_8c_source.html#l01187">sendlib.c:1187</a></div></div>
<div class="ttc" id="structEnvelope_html_a2d927371b3b80e025d6f7522b7361fe7"><div class="ttname"><a href="structEnvelope.html#a2d927371b3b80e025d6f7522b7361fe7">Envelope::to</a></div><div class="ttdeci">struct AddressList to</div><div class="ttdoc">Email&amp;#39;s &amp;#39;To&amp;#39; list. </div><div class="ttdef"><b>Definition:</b> <a href="envelope_8h_source.html#l00058">envelope.h:58</a></div></div>
<div class="ttc" id="structNeoMutt_html_af98065e32243ce9331f93b7f30247d47"><div class="ttname"><a href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">NeoMutt::sub</a></div><div class="ttdeci">struct ConfigSubset * sub</div><div class="ttdoc">Inherited config items. </div><div class="ttdef"><b>Definition:</b> <a href="neomutt_8h_source.html#l00039">neomutt.h:39</a></div></div>
<div class="ttc" id="queue_8h_html_ac269df7d4126ed9885156cbad2cbf8af"><div class="ttname"><a href="queue_8h.html#ac269df7d4126ed9885156cbad2cbf8af">TAILQ_HEAD_INITIALIZER</a></div><div class="ttdeci">#define TAILQ_HEAD_INITIALIZER(head)</div><div class="ttdef"><b>Definition:</b> <a href="queue_8h_source.html#l00630">queue.h:630</a></div></div>
<div class="ttc" id="quad_8h_html_a738f558a271fe5035e0ee3b700ee35dbafee7088606c4724651c799a6a0b182b7"><div class="ttname"><a href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35dbafee7088606c4724651c799a6a0b182b7">MUTT_YES</a></div><div class="ttdoc">User answered &amp;#39;Yes&amp;#39;, or assume &amp;#39;Yes&amp;#39;. </div><div class="ttdef"><b>Definition:</b> <a href="quad_8h_source.html#l00039">quad.h:39</a></div></div>
</div><!-- fragment --><div id="dynsection-5" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-5-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-5-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-5-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_a35eba8f2cd36c286f2226ff748ee63e6_cgraph.svg" width="635" height="650"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div id="dynsection-6" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-6-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-6-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-6-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_a35eba8f2cd36c286f2226ff748ee63e6_icgraph.svg" width="532" height="75"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a8ebc13a33b0dd650151d5b1b37cb99e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8ebc13a33b0dd650151d5b1b37cb99e4">&#9670;&nbsp;</a></span>crypt_opportunistic_encrypt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void crypt_opportunistic_encrypt </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structMailbox.html">Mailbox</a> *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structEmail.html">Email</a> *&#160;</td>
          <td class="paramname"><em>e</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Can all recipients be determined. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">m</td><td>Current <a class="el" href="structMailbox.html" title="A mailbox. ">Mailbox</a> </td></tr>
    <tr><td class="paramname">e</td><td><a class="el" href="structEmail.html" title="The envelope/body of an email. ">Email</a></td></tr>
  </table>
  </dd>
</dl>
<p>Check if all recipients keys can be automatically determined. Enable encryption if they can, otherwise disable encryption. </p>

<p class="definition">Definition at line <a class="el" href="crypt_8c_source.html#l01054">1054</a> of file <a class="el" href="crypt_8c_source.html">crypt.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;{</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a>)</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> c_crypt_opportunistic_encrypt =</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;      <a class="code" href="helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(<a class="code" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;crypt_opportunistic_encrypt&quot;</span>);</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;  <span class="keywordflow">if</span> (!(c_crypt_opportunistic_encrypt &amp;&amp; (e-&gt;<a class="code" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> &amp; <a class="code" href="ncrypt_2lib_8h.html#a2fb0b0aa796d8d79a746001d09c2a2c7">SEC_OPPENCRYPT</a>)))</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;</div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;  <span class="keywordtype">char</span> *pgpkeylist = NULL;</div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;</div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;  <a class="code" href="crypt_8c.html#a35eba8f2cd36c286f2226ff748ee63e6">crypt_get_keys</a>(m, e, &amp;pgpkeylist, 1);</div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;  <span class="keywordflow">if</span> (pgpkeylist)</div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;  {</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;    e-&gt;<a class="code" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> |= <a class="code" href="ncrypt_2lib_8h.html#aacaa4abd4c0696e260b7a0f1d466360a">SEC_ENCRYPT</a>;</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;    <a class="code" href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;pgpkeylist);</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;  }</div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;  {</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;    e-&gt;<a class="code" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> &amp;= ~<a class="code" href="ncrypt_2lib_8h.html#aacaa4abd4c0696e260b7a0f1d466360a">SEC_ENCRYPT</a>;</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;  }</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;}</div><div class="ttc" id="helpers_8c_html_ae50f679dd6c5bd1ba820884c8602f038"><div class="ttname"><a href="helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a></div><div class="ttdeci">bool cs_subset_bool(const struct ConfigSubset *sub, const char *name)</div><div class="ttdoc">Get a boolean config item by name. </div><div class="ttdef"><b>Definition:</b> <a href="helpers_8c_source.html#l00071">helpers.c:71</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_ad980bff69bb614893ad8e7e1c28a5023"><div class="ttname"><a href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a></div><div class="ttdeci">#define WithCrypto</div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00113">lib.h:113</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_aacaa4abd4c0696e260b7a0f1d466360a"><div class="ttname"><a href="ncrypt_2lib_8h.html#aacaa4abd4c0696e260b7a0f1d466360a">SEC_ENCRYPT</a></div><div class="ttdeci">#define SEC_ENCRYPT</div><div class="ttdoc">Email is encrypted. </div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00075">lib.h:75</a></div></div>
<div class="ttc" id="structNeoMutt_html"><div class="ttname"><a href="structNeoMutt.html">NeoMutt</a></div><div class="ttdoc">Container for Accounts, Notifications. </div><div class="ttdef"><b>Definition:</b> <a href="neomutt_8h_source.html#l00036">neomutt.h:36</a></div></div>
<div class="ttc" id="crypt_8c_html_a35eba8f2cd36c286f2226ff748ee63e6"><div class="ttname"><a href="crypt_8c.html#a35eba8f2cd36c286f2226ff748ee63e6">crypt_get_keys</a></div><div class="ttdeci">int crypt_get_keys(struct Mailbox *m, struct Email *e, char **keylist, bool oppenc_mode)</div><div class="ttdoc">Check we have all the keys we need. </div><div class="ttdef"><b>Definition:</b> <a href="crypt_8c_source.html#l00963">crypt.c:963</a></div></div>
<div class="ttc" id="structEmail_html_a570a81cd747437c9ea4357947731ae10"><div class="ttname"><a href="structEmail.html#a570a81cd747437c9ea4357947731ae10">Email::security</a></div><div class="ttdeci">SecurityFlags security</div><div class="ttdoc">bit 0-10: flags, bit 11,12: application, bit 13: traditional pgp See: ncrypt/lib.h pgplib...</div><div class="ttdef"><b>Definition:</b> <a href="email_8h_source.html#l00039">email.h:39</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a2fb0b0aa796d8d79a746001d09c2a2c7"><div class="ttname"><a href="ncrypt_2lib_8h.html#a2fb0b0aa796d8d79a746001d09c2a2c7">SEC_OPPENCRYPT</a></div><div class="ttdeci">#define SEC_OPPENCRYPT</div><div class="ttdoc">Opportunistic encrypt mode. </div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00083">lib.h:83</a></div></div>
<div class="ttc" id="memory_8h_html_a25875003b43b81a4302256caa4a13599"><div class="ttname"><a href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a></div><div class="ttdeci">#define FREE(x)</div><div class="ttdef"><b>Definition:</b> <a href="memory_8h_source.html#l00040">memory.h:40</a></div></div>
<div class="ttc" id="structNeoMutt_html_af98065e32243ce9331f93b7f30247d47"><div class="ttname"><a href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">NeoMutt::sub</a></div><div class="ttdeci">struct ConfigSubset * sub</div><div class="ttdoc">Inherited config items. </div><div class="ttdef"><b>Definition:</b> <a href="neomutt_8h_source.html#l00039">neomutt.h:39</a></div></div>
</div><!-- fragment --><div id="dynsection-7" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-7-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-7-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-7-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_a8ebc13a33b0dd650151d5b1b37cb99e4_cgraph.svg" width="496" height="71"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div id="dynsection-8" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-8-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-8-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-8-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_a8ebc13a33b0dd650151d5b1b37cb99e4_icgraph.svg" width="819" height="332"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="af4ab2e337a2477fba687b1f710aa7a61"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af4ab2e337a2477fba687b1f710aa7a61">&#9670;&nbsp;</a></span>crypt_query()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a> crypt_query </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structBody.html">Body</a> *&#160;</td>
          <td class="paramname"><em>b</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check out the type of encryption used. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">b</td><td><a class="el" href="structBody.html" title="The body of an email. ">Body</a> of email </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">num</td><td>Flags, see <a class="el" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d" title="Flags, e.g. SEC_ENCRYPT. ">SecurityFlags</a> </td></tr>
    <tr><td class="paramname">0</td><td>Error (<a class="el" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4" title="No flags are set. ">SEC_NO_FLAGS</a>)</td></tr>
  </table>
  </dd>
</dl>
<p>Set the cached status values if there are any. </p>

<p class="definition">Definition at line <a class="el" href="crypt_8c_source.html#l00698">698</a> of file <a class="el" href="crypt_8c_source.html">crypt.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;{</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> || !b)</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a>;</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;  <a class="code" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a> rc = <a class="code" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a>;</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;  <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a> == <a class="code" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79ac5074066199e3f540550ca0b1a38978e">TYPE_APPLICATION</a>)</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;  {</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a>)</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;      rc |= <a class="code" href="crypt_8c.html#a159d0d34a10b662acb2cc80099e5ecc7">mutt_is_application_pgp</a>(b);</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code" href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a>)</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    {</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;      rc |= <a class="code" href="crypt_8c.html#a4073ce5b5fcec6e245dbfa9369016b8e">mutt_is_application_smime</a>(b);</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;      <span class="keywordflow">if</span> (rc &amp;&amp; b-&gt;<a class="code" href="structBody.html#ae4b2706a5c4601ae1497a96e047d8f5e">goodsig</a>)</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;        rc |= <a class="code" href="ncrypt_2lib_8h.html#a427cda1ba4b173fa708e124afe7b907a">SEC_GOODSIGN</a>;</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;      <span class="keywordflow">if</span> (rc &amp;&amp; b-&gt;<a class="code" href="structBody.html#a4de063a5f09cb7376f9fde6bb0fe48bc">badsig</a>)</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;        rc |= <a class="code" href="ncrypt_2lib_8h.html#a70ffca3c8f9bc49498e3352294c5b8fd">SEC_BADSIGN</a>;</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    }</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;  }</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (((<a class="code" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; APPLICATION_PGP) != 0) &amp;&amp; (b-&gt;<a class="code" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a> == <a class="code" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79ad88e88afaec507209421bba20aeeb167">TYPE_TEXT</a>))</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;  {</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;    rc |= <a class="code" href="crypt_8c.html#a159d0d34a10b662acb2cc80099e5ecc7">mutt_is_application_pgp</a>(b);</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;    <span class="keywordflow">if</span> (rc &amp;&amp; b-&gt;<a class="code" href="structBody.html#ae4b2706a5c4601ae1497a96e047d8f5e">goodsig</a>)</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;      rc |= <a class="code" href="ncrypt_2lib_8h.html#a427cda1ba4b173fa708e124afe7b907a">SEC_GOODSIGN</a>;</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;  }</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;  <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a> == <a class="code" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79a877e24e62c85f20ff0e0f09ab983031e">TYPE_MULTIPART</a>)</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;  {</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    rc |= <a class="code" href="crypt_8c.html#a832e4b9f5a0e463876a3d8cfe852f12d">mutt_is_multipart_encrypted</a>(b);</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;    rc |= <a class="code" href="crypt_8c.html#a345fb1ff241b3fc778632947c2b08d37">mutt_is_multipart_signed</a>(b);</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;    rc |= <a class="code" href="crypt_8c.html#a9edb0262eaed7c522977a75b76c15770">mutt_is_malformed_multipart_pgp_encrypted</a>(b);</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;    <span class="keywordflow">if</span> (rc &amp;&amp; b-&gt;<a class="code" href="structBody.html#ae4b2706a5c4601ae1497a96e047d8f5e">goodsig</a>)</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;      rc |= <a class="code" href="ncrypt_2lib_8h.html#a427cda1ba4b173fa708e124afe7b907a">SEC_GOODSIGN</a>;</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;<span class="preprocessor">#ifdef USE_AUTOCRYPT</span></div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;    <span class="keywordflow">if</span> (rc &amp;&amp; b-&gt;<a class="code" href="structBody.html#a63e1a4c2a0bacf3d1d5869edfebed0dd">is_autocrypt</a>)</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;      rc |= <a class="code" href="ncrypt_2lib_8h.html#a0b36be5c32ca90d8f2caef9ea9d627fc">SEC_AUTOCRYPT</a>;</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;  }</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;  <span class="keywordflow">if</span> ((b-&gt;<a class="code" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a> == <a class="code" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79a877e24e62c85f20ff0e0f09ab983031e">TYPE_MULTIPART</a>) || (b-&gt;<a class="code" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a> == <a class="code" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79a2cbb8dddd761b8bfba754d933a979c1b">TYPE_MESSAGE</a>))</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;  {</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;    <a class="code" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a> u = b-&gt;<a class="code" href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">parts</a> ? <a class="code" href="ncrypt_2lib_8h.html#a3eec0b09486fe4bfe7613f808f768747">SEC_ALL_FLAGS</a> : <a class="code" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a>; <span class="comment">/* Bits set in all parts */</span></div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    <a class="code" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a> w = <a class="code" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a>; <span class="comment">/* Bits set in any part  */</span></div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;    <span class="keywordflow">for</span> (b = b-&gt;<a class="code" href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">parts</a>; b; b = b-&gt;<a class="code" href="structBody.html#ac55cdfce46eed13151dcfe9b329d254c">next</a>)</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;    {</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;      <span class="keyword">const</span> <a class="code" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a> v = <a class="code" href="crypt_8c.html#af4ab2e337a2477fba687b1f710aa7a61">crypt_query</a>(b);</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;      u &amp;= v;</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;      w |= v;</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;    }</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;    rc |= u | (w &amp; ~<a class="code" href="ncrypt_2lib_8h.html#a427cda1ba4b173fa708e124afe7b907a">SEC_GOODSIGN</a>);</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;    <span class="keywordflow">if</span> ((w &amp; <a class="code" href="ncrypt_2lib_8h.html#a427cda1ba4b173fa708e124afe7b907a">SEC_GOODSIGN</a>) &amp;&amp; !(u &amp; <a class="code" href="ncrypt_2lib_8h.html#a427cda1ba4b173fa708e124afe7b907a">SEC_GOODSIGN</a>))</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;      rc |= <a class="code" href="ncrypt_2lib_8h.html#a9b0f8af6da383f08d29eb97fac836e3f">SEC_PARTSIGN</a>;</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;  }</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;  <span class="keywordflow">return</span> rc;</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;}</div><div class="ttc" id="ncrypt_2lib_8h_html_ad980bff69bb614893ad8e7e1c28a5023"><div class="ttname"><a href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a></div><div class="ttdeci">#define WithCrypto</div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00113">lib.h:113</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a95845954210adfc850d5602843f858d4"><div class="ttname"><a href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a></div><div class="ttdeci">#define SEC_NO_FLAGS</div><div class="ttdoc">No flags are set. </div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00074">lib.h:74</a></div></div>
<div class="ttc" id="crypt_8c_html_a4073ce5b5fcec6e245dbfa9369016b8e"><div class="ttname"><a href="crypt_8c.html#a4073ce5b5fcec6e245dbfa9369016b8e">mutt_is_application_smime</a></div><div class="ttdeci">SecurityFlags mutt_is_application_smime(struct Body *b)</div><div class="ttdoc">Does the message use S/MIME? </div><div class="ttdef"><b>Definition:</b> <a href="crypt_8c_source.html#l00623">crypt.c:623</a></div></div>
<div class="ttc" id="structBody_html_a63e1a4c2a0bacf3d1d5869edfebed0dd"><div class="ttname"><a href="structBody.html#a63e1a4c2a0bacf3d1d5869edfebed0dd">Body::is_autocrypt</a></div><div class="ttdeci">bool is_autocrypt</div><div class="ttdoc">Flag autocrypt-decrypted messages for replying. </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00080">body.h:80</a></div></div>
<div class="ttc" id="structBody_html_ac55cdfce46eed13151dcfe9b329d254c"><div class="ttname"><a href="structBody.html#ac55cdfce46eed13151dcfe9b329d254c">Body::next</a></div><div class="ttdeci">struct Body * next</div><div class="ttdoc">next attachment in the list </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00053">body.h:53</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a0b36be5c32ca90d8f2caef9ea9d627fc"><div class="ttname"><a href="ncrypt_2lib_8h.html#a0b36be5c32ca90d8f2caef9ea9d627fc">SEC_AUTOCRYPT</a></div><div class="ttdeci">#define SEC_AUTOCRYPT</div><div class="ttdoc">(Autocrypt) Message will be, or was Autocrypt encrypt+signed </div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00084">lib.h:84</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a3eec0b09486fe4bfe7613f808f768747"><div class="ttname"><a href="ncrypt_2lib_8h.html#a3eec0b09486fe4bfe7613f808f768747">SEC_ALL_FLAGS</a></div><div class="ttdeci">#define SEC_ALL_FLAGS</div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00091">lib.h:91</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a2073a168ca3a64c3c30d13fa4917a05d"><div class="ttname"><a href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a></div><div class="ttdeci">uint16_t SecurityFlags</div><div class="ttdoc">Flags, e.g. SEC_ENCRYPT. </div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00071">lib.h:71</a></div></div>
<div class="ttc" id="crypt_8c_html_a832e4b9f5a0e463876a3d8cfe852f12d"><div class="ttname"><a href="crypt_8c.html#a832e4b9f5a0e463876a3d8cfe852f12d">mutt_is_multipart_encrypted</a></div><div class="ttdeci">SecurityFlags mutt_is_multipart_encrypted(struct Body *b)</div><div class="ttdoc">Does the message have encrypted parts? </div><div class="ttdef"><b>Definition:</b> <a href="crypt_8c_source.html#l00460">crypt.c:460</a></div></div>
<div class="ttc" id="structBody_html_a4de063a5f09cb7376f9fde6bb0fe48bc"><div class="ttname"><a href="structBody.html#a4de063a5f09cb7376f9fde6bb0fe48bc">Body::badsig</a></div><div class="ttdeci">bool badsig</div><div class="ttdoc">Bad cryptographic signature (needed to check encrypted s/mime-signatures) </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00078">body.h:78</a></div></div>
<div class="ttc" id="crypt_8c_html_a345fb1ff241b3fc778632947c2b08d37"><div class="ttname"><a href="crypt_8c.html#a345fb1ff241b3fc778632947c2b08d37">mutt_is_multipart_signed</a></div><div class="ttdeci">SecurityFlags mutt_is_multipart_signed(struct Body *b)</div><div class="ttdoc">Is a message signed? </div><div class="ttdef"><b>Definition:</b> <a href="crypt_8c_source.html#l00420">crypt.c:420</a></div></div>
<div class="ttc" id="structBody_html_ae4b2706a5c4601ae1497a96e047d8f5e"><div class="ttname"><a href="structBody.html#ae4b2706a5c4601ae1497a96e047d8f5e">Body::goodsig</a></div><div class="ttdeci">bool goodsig</div><div class="ttdoc">Good cryptographic signature. </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00076">body.h:76</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a798dfac1e8839ca89375b4ec62b3eff2"><div class="ttname"><a href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a></div><div class="ttdeci">#define APPLICATION_SMIME</div><div class="ttdoc">Use SMIME to encrypt/sign. </div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00088">lib.h:88</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a587e679a4c9cc44f11f0c467bb22b0af"><div class="ttname"><a href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a></div><div class="ttdeci">#define APPLICATION_PGP</div><div class="ttdoc">Use PGP to encrypt/sign. </div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00087">lib.h:87</a></div></div>
<div class="ttc" id="mime_8h_html_a3ccd048df649c335df5a7f82673bbc79ad88e88afaec507209421bba20aeeb167"><div class="ttname"><a href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79ad88e88afaec507209421bba20aeeb167">TYPE_TEXT</a></div><div class="ttdoc">Type: &amp;#39;text/*&amp;#39;. </div><div class="ttdef"><b>Definition:</b> <a href="mime_8h_source.html#l00038">mime.h:38</a></div></div>
<div class="ttc" id="structBody_html_a0b87b7bdb6faef44d9aac4854975f805"><div class="ttname"><a href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">Body::parts</a></div><div class="ttdeci">struct Body * parts</div><div class="ttdoc">parts of a multipart or message/rfc822 </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00054">body.h:54</a></div></div>
<div class="ttc" id="crypt_8c_html_a9edb0262eaed7c522977a75b76c15770"><div class="ttname"><a href="crypt_8c.html#a9edb0262eaed7c522977a75b76c15770">mutt_is_malformed_multipart_pgp_encrypted</a></div><div class="ttdeci">SecurityFlags mutt_is_malformed_multipart_pgp_encrypted(struct Body *b)</div><div class="ttdoc">Check for malformed layout. </div><div class="ttdef"><b>Definition:</b> <a href="crypt_8c_source.html#l00521">crypt.c:521</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a70ffca3c8f9bc49498e3352294c5b8fd"><div class="ttname"><a href="ncrypt_2lib_8h.html#a70ffca3c8f9bc49498e3352294c5b8fd">SEC_BADSIGN</a></div><div class="ttdeci">#define SEC_BADSIGN</div><div class="ttdoc">Email has a bad signature. </div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00078">lib.h:78</a></div></div>
<div class="ttc" id="structBody_html_af77d79aadb278bef8f2829c268f2486f"><div class="ttname"><a href="structBody.html#af77d79aadb278bef8f2829c268f2486f">Body::type</a></div><div class="ttdeci">unsigned int type</div><div class="ttdoc">content-type primary type, ContentType </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00065">body.h:65</a></div></div>
<div class="ttc" id="mime_8h_html_a3ccd048df649c335df5a7f82673bbc79a2cbb8dddd761b8bfba754d933a979c1b"><div class="ttname"><a href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79a2cbb8dddd761b8bfba754d933a979c1b">TYPE_MESSAGE</a></div><div class="ttdoc">Type: &amp;#39;message/*&amp;#39;. </div><div class="ttdef"><b>Definition:</b> <a href="mime_8h_source.html#l00035">mime.h:35</a></div></div>
<div class="ttc" id="mime_8h_html_a3ccd048df649c335df5a7f82673bbc79a877e24e62c85f20ff0e0f09ab983031e"><div class="ttname"><a href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79a877e24e62c85f20ff0e0f09ab983031e">TYPE_MULTIPART</a></div><div class="ttdoc">Type: &amp;#39;multipart/*&amp;#39;. </div><div class="ttdef"><b>Definition:</b> <a href="mime_8h_source.html#l00037">mime.h:37</a></div></div>
<div class="ttc" id="crypt_8c_html_a159d0d34a10b662acb2cc80099e5ecc7"><div class="ttname"><a href="crypt_8c.html#a159d0d34a10b662acb2cc80099e5ecc7">mutt_is_application_pgp</a></div><div class="ttdeci">SecurityFlags mutt_is_application_pgp(struct Body *b)</div><div class="ttdoc">Does the message use PGP? </div><div class="ttdef"><b>Definition:</b> <a href="crypt_8c_source.html#l00565">crypt.c:565</a></div></div>
<div class="ttc" id="crypt_8c_html_af4ab2e337a2477fba687b1f710aa7a61"><div class="ttname"><a href="crypt_8c.html#af4ab2e337a2477fba687b1f710aa7a61">crypt_query</a></div><div class="ttdeci">SecurityFlags crypt_query(struct Body *b)</div><div class="ttdoc">Check out the type of encryption used. </div><div class="ttdef"><b>Definition:</b> <a href="crypt_8c_source.html#l00698">crypt.c:698</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a427cda1ba4b173fa708e124afe7b907a"><div class="ttname"><a href="ncrypt_2lib_8h.html#a427cda1ba4b173fa708e124afe7b907a">SEC_GOODSIGN</a></div><div class="ttdeci">#define SEC_GOODSIGN</div><div class="ttdoc">Email has a valid signature. </div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00077">lib.h:77</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a9b0f8af6da383f08d29eb97fac836e3f"><div class="ttname"><a href="ncrypt_2lib_8h.html#a9b0f8af6da383f08d29eb97fac836e3f">SEC_PARTSIGN</a></div><div class="ttdeci">#define SEC_PARTSIGN</div><div class="ttdoc">Not all parts of the email is signed. </div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00079">lib.h:79</a></div></div>
<div class="ttc" id="mime_8h_html_a3ccd048df649c335df5a7f82673bbc79ac5074066199e3f540550ca0b1a38978e"><div class="ttname"><a href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79ac5074066199e3f540550ca0b1a38978e">TYPE_APPLICATION</a></div><div class="ttdoc">Type: &amp;#39;application/*&amp;#39;. </div><div class="ttdef"><b>Definition:</b> <a href="mime_8h_source.html#l00033">mime.h:33</a></div></div>
</div><!-- fragment --><div id="dynsection-9" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-9-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-9-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-9-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_af4ab2e337a2477fba687b1f710aa7a61_cgraph.svg" width="522" height="298"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div id="dynsection-10" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-10-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-10-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-10-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_af4ab2e337a2477fba687b1f710aa7a61_icgraph.svg" width="586" height="386"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a4ee7f1419a7e39b0e9f1f9d550f4de43"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4ee7f1419a7e39b0e9f1f9d550f4de43">&#9670;&nbsp;</a></span>crypt_valid_passphrase()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool crypt_valid_passphrase </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a>&#160;</td>
          <td class="paramname"><em>flags</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check that we have a usable passphrase, ask if not. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">flags</td><td>Flags, see <a class="el" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d" title="Flags, e.g. SEC_ENCRYPT. ">SecurityFlags</a> </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">true</td><td>Success </td></tr>
    <tr><td class="paramname">false</td><td>Failed </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="crypt_8c_source.html#l00135">135</a> of file <a class="el" href="crypt_8c_source.html">crypt.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;{</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  <span class="keywordtype">bool</span> rc = <span class="keyword">false</span>;</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="preprocessor">#ifndef DEBUG</span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  disable_coredumps();</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  <span class="keywordflow">if</span> (((<a class="code" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a>) != 0) &amp;&amp; (flags &amp; APPLICATION_PGP))</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    rc = <a class="code" href="cryptglue_8c.html#ad29ef155ee6ccc83b50614068bb5b597">crypt_pgp_valid_passphrase</a>();</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  <span class="keywordflow">if</span> (((<a class="code" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code" href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a>) != 0) &amp;&amp; (flags &amp; APPLICATION_SMIME))</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    rc = <a class="code" href="cryptglue_8c.html#a82c5ed5b55a8c04d810494995152f10d">crypt_smime_valid_passphrase</a>();</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  <span class="keywordflow">return</span> rc;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;}</div><div class="ttc" id="ncrypt_2lib_8h_html_ad980bff69bb614893ad8e7e1c28a5023"><div class="ttname"><a href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a></div><div class="ttdeci">#define WithCrypto</div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00113">lib.h:113</a></div></div>
<div class="ttc" id="cryptglue_8c_html_a82c5ed5b55a8c04d810494995152f10d"><div class="ttname"><a href="cryptglue_8c.html#a82c5ed5b55a8c04d810494995152f10d">crypt_smime_valid_passphrase</a></div><div class="ttdeci">bool crypt_smime_valid_passphrase(void)</div><div class="ttdoc">Wrapper for CryptModuleSpecs::valid_passphrase() </div><div class="ttdef"><b>Definition:</b> <a href="cryptglue_8c_source.html#l00428">cryptglue.c:428</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a798dfac1e8839ca89375b4ec62b3eff2"><div class="ttname"><a href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a></div><div class="ttdeci">#define APPLICATION_SMIME</div><div class="ttdoc">Use SMIME to encrypt/sign. </div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00088">lib.h:88</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a587e679a4c9cc44f11f0c467bb22b0af"><div class="ttname"><a href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a></div><div class="ttdeci">#define APPLICATION_PGP</div><div class="ttdoc">Use PGP to encrypt/sign. </div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00087">lib.h:87</a></div></div>
<div class="ttc" id="cryptglue_8c_html_ad29ef155ee6ccc83b50614068bb5b597"><div class="ttname"><a href="cryptglue_8c.html#ad29ef155ee6ccc83b50614068bb5b597">crypt_pgp_valid_passphrase</a></div><div class="ttdeci">bool crypt_pgp_valid_passphrase(void)</div><div class="ttdoc">Wrapper for CryptModuleSpecs::valid_passphrase() </div><div class="ttdef"><b>Definition:</b> <a href="cryptglue_8c_source.html#l00201">cryptglue.c:201</a></div></div>
</div><!-- fragment --><div id="dynsection-11" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-11-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-11-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-11-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_a4ee7f1419a7e39b0e9f1f9d550f4de43_cgraph.svg" width="460" height="88"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div id="dynsection-12" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-12-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-12-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-12-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_a4ee7f1419a7e39b0e9f1f9d550f4de43_icgraph.svg" width="619" height="686"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a159d0d34a10b662acb2cc80099e5ecc7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a159d0d34a10b662acb2cc80099e5ecc7">&#9670;&nbsp;</a></span>mutt_is_application_pgp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a> mutt_is_application_pgp </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structBody.html">Body</a> *&#160;</td>
          <td class="paramname"><em>b</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Does the message use PGP? </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">b</td><td><a class="el" href="structBody.html" title="The body of an email. ">Body</a> of email </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">&gt;0</td><td><a class="el" href="structMessage.html" title="A local copy of an email. ">Message</a> uses PGP, e.g. <a class="el" href="ncrypt_2lib_8h.html#a6694d25dff1ee1958351160a84bb2dc0">PGP_ENCRYPT</a> </td></tr>
    <tr><td class="paramname">0</td><td><a class="el" href="structMessage.html" title="A local copy of an email. ">Message</a> doesn't use PGP, (<a class="el" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4" title="No flags are set. ">SEC_NO_FLAGS</a>) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="crypt_8c_source.html#l00565">565</a> of file <a class="el" href="crypt_8c_source.html">crypt.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;{</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;  <a class="code" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a> t = <a class="code" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a>;</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;  <span class="keywordtype">char</span> *p = NULL;</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;  <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a> == <a class="code" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79ac5074066199e3f540550ca0b1a38978e">TYPE_APPLICATION</a>)</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;  {</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(b-&gt;<a class="code" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>, <span class="stringliteral">&quot;pgp&quot;</span>) ||</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;        <a class="code" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(b-&gt;<a class="code" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>, <span class="stringliteral">&quot;x-pgp-message&quot;</span>))</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    {</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;      p = <a class="code" href="parameter_8c.html#a0c6d54a87e015a496c8dbecfcd4002c9">mutt_param_get</a>(&amp;b-&gt;<a class="code" href="structBody.html#a782cee95e0064e3895b88248bdfc781a">parameter</a>, <span class="stringliteral">&quot;x-action&quot;</span>);</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;      <span class="keywordflow">if</span> (p &amp;&amp; (<a class="code" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(p, <span class="stringliteral">&quot;sign&quot;</span>) || <a class="code" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(p, <span class="stringliteral">&quot;signclear&quot;</span>)))</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;      {</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;        t |= <a class="code" href="ncrypt_2lib_8h.html#a14f75a650c49341776276f44881d54b2">PGP_SIGN</a>;</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;      }</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;      p = <a class="code" href="parameter_8c.html#a0c6d54a87e015a496c8dbecfcd4002c9">mutt_param_get</a>(&amp;b-&gt;<a class="code" href="structBody.html#a782cee95e0064e3895b88248bdfc781a">parameter</a>, <span class="stringliteral">&quot;format&quot;</span>);</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;      <span class="keywordflow">if</span> (p &amp;&amp; <a class="code" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(p, <span class="stringliteral">&quot;keys-only&quot;</span>))</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;      {</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;        t |= <a class="code" href="ncrypt_2lib_8h.html#abd2087cae2885c199218f5530ce7945b">PGP_KEY</a>;</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;      }</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;      <span class="keywordflow">if</span> (t == <a class="code" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a>)</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;        t |= <a class="code" href="ncrypt_2lib_8h.html#a6694d25dff1ee1958351160a84bb2dc0">PGP_ENCRYPT</a>; <span class="comment">/* not necessarily correct, but... */</span></div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    }</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(b-&gt;<a class="code" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>, <span class="stringliteral">&quot;pgp-signed&quot;</span>))</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;      t |= <a class="code" href="ncrypt_2lib_8h.html#a14f75a650c49341776276f44881d54b2">PGP_SIGN</a>;</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(b-&gt;<a class="code" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>, <span class="stringliteral">&quot;pgp-keys&quot;</span>))</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;      t |= <a class="code" href="ncrypt_2lib_8h.html#abd2087cae2885c199218f5530ce7945b">PGP_KEY</a>;</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;  }</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((b-&gt;<a class="code" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a> == <a class="code" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79ad88e88afaec507209421bba20aeeb167">TYPE_TEXT</a>) &amp;&amp; <a class="code" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(<span class="stringliteral">&quot;plain&quot;</span>, b-&gt;<a class="code" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>))</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;  {</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    <span class="keywordflow">if</span> (((p = <a class="code" href="parameter_8c.html#a0c6d54a87e015a496c8dbecfcd4002c9">mutt_param_get</a>(&amp;b-&gt;<a class="code" href="structBody.html#a782cee95e0064e3895b88248bdfc781a">parameter</a>, <span class="stringliteral">&quot;x-mutt-action&quot;</span>)) ||</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;         (p = <a class="code" href="parameter_8c.html#a0c6d54a87e015a496c8dbecfcd4002c9">mutt_param_get</a>(&amp;b-&gt;<a class="code" href="structBody.html#a782cee95e0064e3895b88248bdfc781a">parameter</a>, <span class="stringliteral">&quot;x-action&quot;</span>)) ||</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;         (p = <a class="code" href="parameter_8c.html#a0c6d54a87e015a496c8dbecfcd4002c9">mutt_param_get</a>(&amp;b-&gt;<a class="code" href="structBody.html#a782cee95e0064e3895b88248bdfc781a">parameter</a>, <span class="stringliteral">&quot;action&quot;</span>))) &amp;&amp;</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;        <a class="code" href="mutt_2string_8c.html#aebd2a8a3f8a30062c31fa1474d87cc41">mutt_istr_startswith</a>(p, <span class="stringliteral">&quot;pgp-sign&quot;</span>))</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    {</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;      t |= <a class="code" href="ncrypt_2lib_8h.html#a14f75a650c49341776276f44881d54b2">PGP_SIGN</a>;</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    }</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (p &amp;&amp; <a class="code" href="mutt_2string_8c.html#aebd2a8a3f8a30062c31fa1474d87cc41">mutt_istr_startswith</a>(p, <span class="stringliteral">&quot;pgp-encrypt&quot;</span>))</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;      t |= <a class="code" href="ncrypt_2lib_8h.html#a6694d25dff1ee1958351160a84bb2dc0">PGP_ENCRYPT</a>;</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (p &amp;&amp; <a class="code" href="mutt_2string_8c.html#aebd2a8a3f8a30062c31fa1474d87cc41">mutt_istr_startswith</a>(p, <span class="stringliteral">&quot;pgp-keys&quot;</span>))</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;      t |= <a class="code" href="ncrypt_2lib_8h.html#abd2087cae2885c199218f5530ce7945b">PGP_KEY</a>;</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;  }</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;  <span class="keywordflow">if</span> (t)</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;    t |= <a class="code" href="ncrypt_2lib_8h.html#a68503f0e36de213094c8546b4f74eef1">PGP_INLINE</a>;</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;  <span class="keywordflow">return</span> t;</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;}</div><div class="ttc" id="ncrypt_2lib_8h_html_a68503f0e36de213094c8546b4f74eef1"><div class="ttname"><a href="ncrypt_2lib_8h.html#a68503f0e36de213094c8546b4f74eef1">PGP_INLINE</a></div><div class="ttdeci">#define PGP_INLINE</div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00097">lib.h:97</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a95845954210adfc850d5602843f858d4"><div class="ttname"><a href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a></div><div class="ttdeci">#define SEC_NO_FLAGS</div><div class="ttdoc">No flags are set. </div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00074">lib.h:74</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a6694d25dff1ee1958351160a84bb2dc0"><div class="ttname"><a href="ncrypt_2lib_8h.html#a6694d25dff1ee1958351160a84bb2dc0">PGP_ENCRYPT</a></div><div class="ttdeci">#define PGP_ENCRYPT</div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00093">lib.h:93</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a2073a168ca3a64c3c30d13fa4917a05d"><div class="ttname"><a href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a></div><div class="ttdeci">uint16_t SecurityFlags</div><div class="ttdoc">Flags, e.g. SEC_ENCRYPT. </div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00071">lib.h:71</a></div></div>
<div class="ttc" id="mutt_2string_8c_html_a29db81d6f5a7dd216cbea75ecf8a5885"><div class="ttname"><a href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a></div><div class="ttdeci">bool mutt_istr_equal(const char *a, const char *b)</div><div class="ttdoc">Compare two strings, ignoring case. </div><div class="ttdef"><b>Definition:</b> <a href="mutt_2string_8c_source.html#l00916">string.c:916</a></div></div>
<div class="ttc" id="structBody_html_ace00f9cba9b46a2d434764335d2fa43a"><div class="ttname"><a href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">Body::subtype</a></div><div class="ttdeci">char * subtype</div><div class="ttdoc">content-type subtype </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00037">body.h:37</a></div></div>
<div class="ttc" id="mime_8h_html_a3ccd048df649c335df5a7f82673bbc79ad88e88afaec507209421bba20aeeb167"><div class="ttname"><a href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79ad88e88afaec507209421bba20aeeb167">TYPE_TEXT</a></div><div class="ttdoc">Type: &amp;#39;text/*&amp;#39;. </div><div class="ttdef"><b>Definition:</b> <a href="mime_8h_source.html#l00038">mime.h:38</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a14f75a650c49341776276f44881d54b2"><div class="ttname"><a href="ncrypt_2lib_8h.html#a14f75a650c49341776276f44881d54b2">PGP_SIGN</a></div><div class="ttdeci">#define PGP_SIGN</div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00094">lib.h:94</a></div></div>
<div class="ttc" id="mutt_2string_8c_html_aebd2a8a3f8a30062c31fa1474d87cc41"><div class="ttname"><a href="mutt_2string_8c.html#aebd2a8a3f8a30062c31fa1474d87cc41">mutt_istr_startswith</a></div><div class="ttdeci">size_t mutt_istr_startswith(const char *str, const char *prefix)</div><div class="ttdoc">Check whether a string starts with a prefix, ignoring case. </div><div class="ttdef"><b>Definition:</b> <a href="mutt_2string_8c_source.html#l00172">string.c:172</a></div></div>
<div class="ttc" id="structBody_html_af77d79aadb278bef8f2829c268f2486f"><div class="ttname"><a href="structBody.html#af77d79aadb278bef8f2829c268f2486f">Body::type</a></div><div class="ttdeci">unsigned int type</div><div class="ttdoc">content-type primary type, ContentType </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00065">body.h:65</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_abd2087cae2885c199218f5530ce7945b"><div class="ttname"><a href="ncrypt_2lib_8h.html#abd2087cae2885c199218f5530ce7945b">PGP_KEY</a></div><div class="ttdeci">#define PGP_KEY</div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00096">lib.h:96</a></div></div>
<div class="ttc" id="parameter_8c_html_a0c6d54a87e015a496c8dbecfcd4002c9"><div class="ttname"><a href="parameter_8c.html#a0c6d54a87e015a496c8dbecfcd4002c9">mutt_param_get</a></div><div class="ttdeci">char * mutt_param_get(const struct ParameterList *pl, const char *s)</div><div class="ttdoc">Find a matching Parameter. </div><div class="ttdef"><b>Definition:</b> <a href="parameter_8c_source.html#l00084">parameter.c:84</a></div></div>
<div class="ttc" id="structBody_html_a782cee95e0064e3895b88248bdfc781a"><div class="ttname"><a href="structBody.html#a782cee95e0064e3895b88248bdfc781a">Body::parameter</a></div><div class="ttdeci">struct ParameterList parameter</div><div class="ttdoc">parameters of the content-type </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00039">body.h:39</a></div></div>
<div class="ttc" id="mime_8h_html_a3ccd048df649c335df5a7f82673bbc79ac5074066199e3f540550ca0b1a38978e"><div class="ttname"><a href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79ac5074066199e3f540550ca0b1a38978e">TYPE_APPLICATION</a></div><div class="ttdoc">Type: &amp;#39;application/*&amp;#39;. </div><div class="ttdef"><b>Definition:</b> <a href="mime_8h_source.html#l00033">mime.h:33</a></div></div>
</div><!-- fragment --><div id="dynsection-13" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-13-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-13-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-13-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_a159d0d34a10b662acb2cc80099e5ecc7_cgraph.svg" width="566" height="114"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div id="dynsection-14" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-14-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-14-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-14-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_a159d0d34a10b662acb2cc80099e5ecc7_icgraph.svg" width="919" height="691"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a4073ce5b5fcec6e245dbfa9369016b8e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4073ce5b5fcec6e245dbfa9369016b8e">&#9670;&nbsp;</a></span>mutt_is_application_smime()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a> mutt_is_application_smime </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structBody.html">Body</a> *&#160;</td>
          <td class="paramname"><em>b</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Does the message use S/MIME? </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">b</td><td><a class="el" href="structBody.html" title="The body of an email. ">Body</a> of email </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">&gt;0</td><td><a class="el" href="structMessage.html" title="A local copy of an email. ">Message</a> uses S/MIME, e.g. <a class="el" href="ncrypt_2lib_8h.html#ac25eb5415ebf34da68c39a3d4e3bc9ad">SMIME_ENCRYPT</a> </td></tr>
    <tr><td class="paramname">0</td><td><a class="el" href="structMessage.html" title="A local copy of an email. ">Message</a> doesn't use S/MIME, (<a class="el" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4" title="No flags are set. ">SEC_NO_FLAGS</a>) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="crypt_8c_source.html#l00623">623</a> of file <a class="el" href="crypt_8c_source.html">crypt.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;{</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;  <span class="keywordflow">if</span> (!b)</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a>;</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;  <span class="keywordflow">if</span> (((b-&gt;<a class="code" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a> &amp; <a class="code" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79ac5074066199e3f540550ca0b1a38978e">TYPE_APPLICATION</a>) == 0) || !b-&gt;<a class="code" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>)</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a>;</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;  <span class="keywordtype">char</span> *t = NULL;</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;  <span class="keywordtype">bool</span> complain = <span class="keyword">false</span>;</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;  <span class="comment">/* S/MIME MIME types don&#39;t need x- anymore, see RFC2311 */</span></div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(b-&gt;<a class="code" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>, <span class="stringliteral">&quot;x-pkcs7-mime&quot;</span>) || <a class="code" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(b-&gt;<a class="code" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>, <span class="stringliteral">&quot;pkcs7-mime&quot;</span>))</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;  {</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    t = <a class="code" href="parameter_8c.html#a0c6d54a87e015a496c8dbecfcd4002c9">mutt_param_get</a>(&amp;b-&gt;<a class="code" href="structBody.html#a782cee95e0064e3895b88248bdfc781a">parameter</a>, <span class="stringliteral">&quot;smime-type&quot;</span>);</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    <span class="keywordflow">if</span> (t)</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    {</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(t, <span class="stringliteral">&quot;enveloped-data&quot;</span>))</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="ncrypt_2lib_8h.html#ac25eb5415ebf34da68c39a3d4e3bc9ad">SMIME_ENCRYPT</a>;</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(t, <span class="stringliteral">&quot;signed-data&quot;</span>))</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="ncrypt_2lib_8h.html#a67114d960e61fc36c467f4bf08d37335">SMIME_SIGN</a> | <a class="code" href="ncrypt_2lib_8h.html#a9c811504abf735623a6dd3ac20287f30">SMIME_OPAQUE</a>;</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a>;</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;    }</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    <span class="comment">/* Netscape 4.7 uses</span></div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;<span class="comment">     * Content-Description: S/MIME Encrypted Message</span></div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;<span class="comment">     * instead of Content-Type parameter */</span></div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(b-&gt;<a class="code" href="structBody.html#a90db5151872e23e56a8f31d68925c121">description</a>, <span class="stringliteral">&quot;S/MIME Encrypted Message&quot;</span>))</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="ncrypt_2lib_8h.html#ac25eb5415ebf34da68c39a3d4e3bc9ad">SMIME_ENCRYPT</a>;</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;    complain = <span class="keyword">true</span>;</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;  }</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(b-&gt;<a class="code" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>, <span class="stringliteral">&quot;octet-stream&quot;</span>))</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a>;</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;  t = <a class="code" href="parameter_8c.html#a0c6d54a87e015a496c8dbecfcd4002c9">mutt_param_get</a>(&amp;b-&gt;<a class="code" href="structBody.html#a782cee95e0064e3895b88248bdfc781a">parameter</a>, <span class="stringliteral">&quot;name&quot;</span>);</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;  <span class="keywordflow">if</span> (!t)</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;    t = b-&gt;<a class="code" href="structBody.html#a0a77f105609a64f37c359b9c81d1f263">d_filename</a>;</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;  <span class="keywordflow">if</span> (!t)</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    t = b-&gt;<a class="code" href="structBody.html#afe3cd2c4b1070e3d0edbf1fed939ac5a">filename</a>;</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;  <span class="keywordflow">if</span> (!t)</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;  {</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    <span class="keywordflow">if</span> (complain)</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    {</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;      <a class="code" href="logging_8h.html#ae108f891125caafa9250cf0959c40c04">mutt_message</a>(</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;          <a class="code" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;S/MIME messages with no hints on content are unsupported&quot;</span>));</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    }</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a>;</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;  }</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;  <span class="comment">/* no .p7c, .p10 support yet. */</span></div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;  <span class="keywordtype">int</span> len = <a class="code" href="mutt_2string_8c.html#acca6786b903b22a5924219f9db96e10d">mutt_str_len</a>(t) - 4;</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;  <span class="keywordflow">if</span> ((len &gt; 0) &amp;&amp; (*(t + len) == <span class="charliteral">&#39;.&#39;</span>))</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;  {</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    len++;</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>((t + len), <span class="stringliteral">&quot;p7m&quot;</span>))</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    {</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;      <span class="comment">/* Not sure if this is the correct thing to do, but</span></div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;<span class="comment">       * it&#39;s required for compatibility with Outlook */</span></div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="ncrypt_2lib_8h.html#a67114d960e61fc36c467f4bf08d37335">SMIME_SIGN</a> | <a class="code" href="ncrypt_2lib_8h.html#a9c811504abf735623a6dd3ac20287f30">SMIME_OPAQUE</a>;</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    }</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>((t + len), <span class="stringliteral">&quot;p7s&quot;</span>))</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="ncrypt_2lib_8h.html#a67114d960e61fc36c467f4bf08d37335">SMIME_SIGN</a> | <a class="code" href="ncrypt_2lib_8h.html#a9c811504abf735623a6dd3ac20287f30">SMIME_OPAQUE</a>;</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;  }</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a>;</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;}</div><div class="ttc" id="ncrypt_2lib_8h_html_a9c811504abf735623a6dd3ac20287f30"><div class="ttname"><a href="ncrypt_2lib_8h.html#a9c811504abf735623a6dd3ac20287f30">SMIME_OPAQUE</a></div><div class="ttdeci">#define SMIME_OPAQUE</div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00103">lib.h:103</a></div></div>
<div class="ttc" id="structBody_html_afe3cd2c4b1070e3d0edbf1fed939ac5a"><div class="ttname"><a href="structBody.html#afe3cd2c4b1070e3d0edbf1fed939ac5a">Body::filename</a></div><div class="ttdeci">char * filename</div><div class="ttdoc">when sending a message, this is the file to which this structure refers </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00046">body.h:46</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a67114d960e61fc36c467f4bf08d37335"><div class="ttname"><a href="ncrypt_2lib_8h.html#a67114d960e61fc36c467f4bf08d37335">SMIME_SIGN</a></div><div class="ttdeci">#define SMIME_SIGN</div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00100">lib.h:100</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a95845954210adfc850d5602843f858d4"><div class="ttname"><a href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a></div><div class="ttdeci">#define SEC_NO_FLAGS</div><div class="ttdoc">No flags are set. </div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00074">lib.h:74</a></div></div>
<div class="ttc" id="logging_8h_html_ae108f891125caafa9250cf0959c40c04"><div class="ttname"><a href="logging_8h.html#ae108f891125caafa9250cf0959c40c04">mutt_message</a></div><div class="ttdeci">#define mutt_message(...)</div><div class="ttdef"><b>Definition:</b> <a href="logging_8h_source.html#l00083">logging.h:83</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_ac25eb5415ebf34da68c39a3d4e3bc9ad"><div class="ttname"><a href="ncrypt_2lib_8h.html#ac25eb5415ebf34da68c39a3d4e3bc9ad">SMIME_ENCRYPT</a></div><div class="ttdeci">#define SMIME_ENCRYPT</div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00099">lib.h:99</a></div></div>
<div class="ttc" id="mutt_2message_8h_html_a479d658dfd60fe8d9709ec67a58b34ca"><div class="ttname"><a href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a></div><div class="ttdeci">#define _(a)</div><div class="ttdef"><b>Definition:</b> <a href="mutt_2message_8h_source.html#l00028">message.h:28</a></div></div>
<div class="ttc" id="mutt_2string_8c_html_a29db81d6f5a7dd216cbea75ecf8a5885"><div class="ttname"><a href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a></div><div class="ttdeci">bool mutt_istr_equal(const char *a, const char *b)</div><div class="ttdoc">Compare two strings, ignoring case. </div><div class="ttdef"><b>Definition:</b> <a href="mutt_2string_8c_source.html#l00916">string.c:916</a></div></div>
<div class="ttc" id="structBody_html_ace00f9cba9b46a2d434764335d2fa43a"><div class="ttname"><a href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">Body::subtype</a></div><div class="ttdeci">char * subtype</div><div class="ttdoc">content-type subtype </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00037">body.h:37</a></div></div>
<div class="ttc" id="structBody_html_a90db5151872e23e56a8f31d68925c121"><div class="ttname"><a href="structBody.html#a90db5151872e23e56a8f31d68925c121">Body::description</a></div><div class="ttdeci">char * description</div><div class="ttdoc">content-description </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00040">body.h:40</a></div></div>
<div class="ttc" id="structBody_html_af77d79aadb278bef8f2829c268f2486f"><div class="ttname"><a href="structBody.html#af77d79aadb278bef8f2829c268f2486f">Body::type</a></div><div class="ttdeci">unsigned int type</div><div class="ttdoc">content-type primary type, ContentType </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00065">body.h:65</a></div></div>
<div class="ttc" id="mutt_2string_8c_html_acca6786b903b22a5924219f9db96e10d"><div class="ttname"><a href="mutt_2string_8c.html#acca6786b903b22a5924219f9db96e10d">mutt_str_len</a></div><div class="ttdeci">size_t mutt_str_len(const char *a)</div><div class="ttdoc">Calculate the length of a string, safely. </div><div class="ttdef"><b>Definition:</b> <a href="mutt_2string_8c_source.html#l00664">string.c:664</a></div></div>
<div class="ttc" id="parameter_8c_html_a0c6d54a87e015a496c8dbecfcd4002c9"><div class="ttname"><a href="parameter_8c.html#a0c6d54a87e015a496c8dbecfcd4002c9">mutt_param_get</a></div><div class="ttdeci">char * mutt_param_get(const struct ParameterList *pl, const char *s)</div><div class="ttdoc">Find a matching Parameter. </div><div class="ttdef"><b>Definition:</b> <a href="parameter_8c_source.html#l00084">parameter.c:84</a></div></div>
<div class="ttc" id="structBody_html_a0a77f105609a64f37c359b9c81d1f263"><div class="ttname"><a href="structBody.html#a0a77f105609a64f37c359b9c81d1f263">Body::d_filename</a></div><div class="ttdeci">char * d_filename</div><div class="ttdoc">filename to be used for the content-disposition header. </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00047">body.h:47</a></div></div>
<div class="ttc" id="structBody_html_a782cee95e0064e3895b88248bdfc781a"><div class="ttname"><a href="structBody.html#a782cee95e0064e3895b88248bdfc781a">Body::parameter</a></div><div class="ttdeci">struct ParameterList parameter</div><div class="ttdoc">parameters of the content-type </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00039">body.h:39</a></div></div>
<div class="ttc" id="mime_8h_html_a3ccd048df649c335df5a7f82673bbc79ac5074066199e3f540550ca0b1a38978e"><div class="ttname"><a href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79ac5074066199e3f540550ca0b1a38978e">TYPE_APPLICATION</a></div><div class="ttdoc">Type: &amp;#39;application/*&amp;#39;. </div><div class="ttdef"><b>Definition:</b> <a href="mime_8h_source.html#l00033">mime.h:33</a></div></div>
</div><!-- fragment --><div id="dynsection-15" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-15-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-15-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-15-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_a4073ce5b5fcec6e245dbfa9369016b8e_cgraph.svg" width="512" height="114"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div id="dynsection-16" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-16-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-16-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-16-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_a4073ce5b5fcec6e245dbfa9369016b8e_icgraph.svg" width="911" height="667"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a9edb0262eaed7c522977a75b76c15770"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9edb0262eaed7c522977a75b76c15770">&#9670;&nbsp;</a></span>mutt_is_malformed_multipart_pgp_encrypted()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a> mutt_is_malformed_multipart_pgp_encrypted </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structBody.html">Body</a> *&#160;</td>
          <td class="paramname"><em>b</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check for malformed layout. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">b</td><td><a class="el" href="structBody.html" title="The body of an email. ">Body</a> of email </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">num</td><td>Success, see <a class="el" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d" title="Flags, e.g. SEC_ENCRYPT. ">SecurityFlags</a> </td></tr>
    <tr><td class="paramname">0</td><td>Error, (<a class="el" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4" title="No flags are set. ">SEC_NO_FLAGS</a>)</td></tr>
  </table>
  </dd>
</dl>
<p>This checks for the malformed layout caused by MS Exchange in some cases: </p><div class="fragment"><div class="line">&lt;multipart/mixed&gt;</div><div class="line">   &lt;text/plain&gt;</div><div class="line">   &lt;application/pgp-encrypted&gt; [BASE64-encoded]</div><div class="line">   &lt;application/octet-stream&gt; [BASE64-encoded]</div></div><!-- fragment --> 
<p class="definition">Definition at line <a class="el" href="crypt_8c_source.html#l00521">521</a> of file <a class="el" href="crypt_8c_source.html">crypt.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;{</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;  <span class="keywordflow">if</span> (!(<a class="code" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a>))</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a>;</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;  <span class="keywordflow">if</span> (!b || (b-&gt;<a class="code" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a> != <a class="code" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79a877e24e62c85f20ff0e0f09ab983031e">TYPE_MULTIPART</a>) || !b-&gt;<a class="code" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a> || !<a class="code" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(b-&gt;<a class="code" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>, <span class="stringliteral">&quot;mixed&quot;</span>))</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;  {</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a>;</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;  }</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;  b = b-&gt;<a class="code" href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">parts</a>;</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;  <span class="keywordflow">if</span> (!b || (b-&gt;<a class="code" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a> != <a class="code" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79ad88e88afaec507209421bba20aeeb167">TYPE_TEXT</a>) || !b-&gt;<a class="code" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a> ||</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;      !<a class="code" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(b-&gt;<a class="code" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>, <span class="stringliteral">&quot;plain&quot;</span>) || (b-&gt;<a class="code" href="structBody.html#a6f92d7ec8568ca04ae07931c56dd0790">length</a> != 0))</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;  {</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a>;</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;  }</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;  b = b-&gt;<a class="code" href="structBody.html#ac55cdfce46eed13151dcfe9b329d254c">next</a>;</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;  <span class="keywordflow">if</span> (!b || (b-&gt;<a class="code" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a> != <a class="code" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79ac5074066199e3f540550ca0b1a38978e">TYPE_APPLICATION</a>) || !b-&gt;<a class="code" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a> ||</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;      !<a class="code" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(b-&gt;<a class="code" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>, <span class="stringliteral">&quot;pgp-encrypted&quot;</span>))</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;  {</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a>;</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;  }</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;  b = b-&gt;<a class="code" href="structBody.html#ac55cdfce46eed13151dcfe9b329d254c">next</a>;</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;  <span class="keywordflow">if</span> (!b || (b-&gt;<a class="code" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a> != <a class="code" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79ac5074066199e3f540550ca0b1a38978e">TYPE_APPLICATION</a>) || !b-&gt;<a class="code" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a> ||</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;      !<a class="code" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(b-&gt;<a class="code" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>, <span class="stringliteral">&quot;octet-stream&quot;</span>))</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;  {</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a>;</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;  }</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;  b = b-&gt;<a class="code" href="structBody.html#ac55cdfce46eed13151dcfe9b329d254c">next</a>;</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;  <span class="keywordflow">if</span> (b)</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a>;</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="ncrypt_2lib_8h.html#a6694d25dff1ee1958351160a84bb2dc0">PGP_ENCRYPT</a>;</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;}</div><div class="ttc" id="ncrypt_2lib_8h_html_ad980bff69bb614893ad8e7e1c28a5023"><div class="ttname"><a href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a></div><div class="ttdeci">#define WithCrypto</div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00113">lib.h:113</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a95845954210adfc850d5602843f858d4"><div class="ttname"><a href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a></div><div class="ttdeci">#define SEC_NO_FLAGS</div><div class="ttdoc">No flags are set. </div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00074">lib.h:74</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a6694d25dff1ee1958351160a84bb2dc0"><div class="ttname"><a href="ncrypt_2lib_8h.html#a6694d25dff1ee1958351160a84bb2dc0">PGP_ENCRYPT</a></div><div class="ttdeci">#define PGP_ENCRYPT</div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00093">lib.h:93</a></div></div>
<div class="ttc" id="structBody_html_ac55cdfce46eed13151dcfe9b329d254c"><div class="ttname"><a href="structBody.html#ac55cdfce46eed13151dcfe9b329d254c">Body::next</a></div><div class="ttdeci">struct Body * next</div><div class="ttdoc">next attachment in the list </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00053">body.h:53</a></div></div>
<div class="ttc" id="mutt_2string_8c_html_a29db81d6f5a7dd216cbea75ecf8a5885"><div class="ttname"><a href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a></div><div class="ttdeci">bool mutt_istr_equal(const char *a, const char *b)</div><div class="ttdoc">Compare two strings, ignoring case. </div><div class="ttdef"><b>Definition:</b> <a href="mutt_2string_8c_source.html#l00916">string.c:916</a></div></div>
<div class="ttc" id="structBody_html_ace00f9cba9b46a2d434764335d2fa43a"><div class="ttname"><a href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">Body::subtype</a></div><div class="ttdeci">char * subtype</div><div class="ttdoc">content-type subtype </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00037">body.h:37</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a587e679a4c9cc44f11f0c467bb22b0af"><div class="ttname"><a href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a></div><div class="ttdeci">#define APPLICATION_PGP</div><div class="ttdoc">Use PGP to encrypt/sign. </div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00087">lib.h:87</a></div></div>
<div class="ttc" id="structBody_html_a6f92d7ec8568ca04ae07931c56dd0790"><div class="ttname"><a href="structBody.html#a6f92d7ec8568ca04ae07931c56dd0790">Body::length</a></div><div class="ttdeci">LOFF_T length</div><div class="ttdoc">length (in bytes) of attachment </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00045">body.h:45</a></div></div>
<div class="ttc" id="mime_8h_html_a3ccd048df649c335df5a7f82673bbc79ad88e88afaec507209421bba20aeeb167"><div class="ttname"><a href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79ad88e88afaec507209421bba20aeeb167">TYPE_TEXT</a></div><div class="ttdoc">Type: &amp;#39;text/*&amp;#39;. </div><div class="ttdef"><b>Definition:</b> <a href="mime_8h_source.html#l00038">mime.h:38</a></div></div>
<div class="ttc" id="structBody_html_a0b87b7bdb6faef44d9aac4854975f805"><div class="ttname"><a href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">Body::parts</a></div><div class="ttdeci">struct Body * parts</div><div class="ttdoc">parts of a multipart or message/rfc822 </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00054">body.h:54</a></div></div>
<div class="ttc" id="structBody_html_af77d79aadb278bef8f2829c268f2486f"><div class="ttname"><a href="structBody.html#af77d79aadb278bef8f2829c268f2486f">Body::type</a></div><div class="ttdeci">unsigned int type</div><div class="ttdoc">content-type primary type, ContentType </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00065">body.h:65</a></div></div>
<div class="ttc" id="mime_8h_html_a3ccd048df649c335df5a7f82673bbc79a877e24e62c85f20ff0e0f09ab983031e"><div class="ttname"><a href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79a877e24e62c85f20ff0e0f09ab983031e">TYPE_MULTIPART</a></div><div class="ttdoc">Type: &amp;#39;multipart/*&amp;#39;. </div><div class="ttdef"><b>Definition:</b> <a href="mime_8h_source.html#l00037">mime.h:37</a></div></div>
<div class="ttc" id="mime_8h_html_a3ccd048df649c335df5a7f82673bbc79ac5074066199e3f540550ca0b1a38978e"><div class="ttname"><a href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79ac5074066199e3f540550ca0b1a38978e">TYPE_APPLICATION</a></div><div class="ttdoc">Type: &amp;#39;application/*&amp;#39;. </div><div class="ttdef"><b>Definition:</b> <a href="mime_8h_source.html#l00033">mime.h:33</a></div></div>
</div><!-- fragment --><div id="dynsection-17" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-17-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-17-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-17-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_a9edb0262eaed7c522977a75b76c15770_cgraph.svg" width="400" height="52"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div id="dynsection-18" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-18-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-18-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-18-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_a9edb0262eaed7c522977a75b76c15770_icgraph.svg" width="498" height="339"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a832e4b9f5a0e463876a3d8cfe852f12d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a832e4b9f5a0e463876a3d8cfe852f12d">&#9670;&nbsp;</a></span>mutt_is_multipart_encrypted()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a> mutt_is_multipart_encrypted </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structBody.html">Body</a> *&#160;</td>
          <td class="paramname"><em>b</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Does the message have encrypted parts? </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">b</td><td><a class="el" href="structBody.html" title="The body of an email. ">Body</a> of email </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">num</td><td><a class="el" href="structMessage.html" title="A local copy of an email. ">Message</a> has got encrypted parts, see <a class="el" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d" title="Flags, e.g. SEC_ENCRYPT. ">SecurityFlags</a> </td></tr>
    <tr><td class="paramname">0</td><td><a class="el" href="structMessage.html" title="A local copy of an email. ">Message</a> hasn't got encrypted parts (<a class="el" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4" title="No flags are set. ">SEC_NO_FLAGS</a>) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="crypt_8c_source.html#l00460">460</a> of file <a class="el" href="crypt_8c_source.html">crypt.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;{</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;  <span class="keywordflow">if</span> ((<a class="code" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a>) == 0)</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a>;</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;  <span class="keywordtype">char</span> *p = NULL;</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;  <span class="keywordflow">if</span> (!b || (b-&gt;<a class="code" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a> != <a class="code" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79a877e24e62c85f20ff0e0f09ab983031e">TYPE_MULTIPART</a>) || !b-&gt;<a class="code" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a> ||</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;      !<a class="code" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(b-&gt;<a class="code" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>, <span class="stringliteral">&quot;encrypted&quot;</span>) ||</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;      !(p = <a class="code" href="parameter_8c.html#a0c6d54a87e015a496c8dbecfcd4002c9">mutt_param_get</a>(&amp;b-&gt;<a class="code" href="structBody.html#a782cee95e0064e3895b88248bdfc781a">parameter</a>, <span class="stringliteral">&quot;protocol&quot;</span>)) ||</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;      !<a class="code" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(p, <span class="stringliteral">&quot;application/pgp-encrypted&quot;</span>))</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;  {</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a>;</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;  }</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="ncrypt_2lib_8h.html#a6694d25dff1ee1958351160a84bb2dc0">PGP_ENCRYPT</a>;</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;}</div><div class="ttc" id="ncrypt_2lib_8h_html_ad980bff69bb614893ad8e7e1c28a5023"><div class="ttname"><a href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a></div><div class="ttdeci">#define WithCrypto</div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00113">lib.h:113</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a95845954210adfc850d5602843f858d4"><div class="ttname"><a href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a></div><div class="ttdeci">#define SEC_NO_FLAGS</div><div class="ttdoc">No flags are set. </div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00074">lib.h:74</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a6694d25dff1ee1958351160a84bb2dc0"><div class="ttname"><a href="ncrypt_2lib_8h.html#a6694d25dff1ee1958351160a84bb2dc0">PGP_ENCRYPT</a></div><div class="ttdeci">#define PGP_ENCRYPT</div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00093">lib.h:93</a></div></div>
<div class="ttc" id="mutt_2string_8c_html_a29db81d6f5a7dd216cbea75ecf8a5885"><div class="ttname"><a href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a></div><div class="ttdeci">bool mutt_istr_equal(const char *a, const char *b)</div><div class="ttdoc">Compare two strings, ignoring case. </div><div class="ttdef"><b>Definition:</b> <a href="mutt_2string_8c_source.html#l00916">string.c:916</a></div></div>
<div class="ttc" id="structBody_html_ace00f9cba9b46a2d434764335d2fa43a"><div class="ttname"><a href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">Body::subtype</a></div><div class="ttdeci">char * subtype</div><div class="ttdoc">content-type subtype </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00037">body.h:37</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a587e679a4c9cc44f11f0c467bb22b0af"><div class="ttname"><a href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a></div><div class="ttdeci">#define APPLICATION_PGP</div><div class="ttdoc">Use PGP to encrypt/sign. </div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00087">lib.h:87</a></div></div>
<div class="ttc" id="structBody_html_af77d79aadb278bef8f2829c268f2486f"><div class="ttname"><a href="structBody.html#af77d79aadb278bef8f2829c268f2486f">Body::type</a></div><div class="ttdeci">unsigned int type</div><div class="ttdoc">content-type primary type, ContentType </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00065">body.h:65</a></div></div>
<div class="ttc" id="mime_8h_html_a3ccd048df649c335df5a7f82673bbc79a877e24e62c85f20ff0e0f09ab983031e"><div class="ttname"><a href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79a877e24e62c85f20ff0e0f09ab983031e">TYPE_MULTIPART</a></div><div class="ttdoc">Type: &amp;#39;multipart/*&amp;#39;. </div><div class="ttdef"><b>Definition:</b> <a href="mime_8h_source.html#l00037">mime.h:37</a></div></div>
<div class="ttc" id="parameter_8c_html_a0c6d54a87e015a496c8dbecfcd4002c9"><div class="ttname"><a href="parameter_8c.html#a0c6d54a87e015a496c8dbecfcd4002c9">mutt_param_get</a></div><div class="ttdeci">char * mutt_param_get(const struct ParameterList *pl, const char *s)</div><div class="ttdoc">Find a matching Parameter. </div><div class="ttdef"><b>Definition:</b> <a href="parameter_8c_source.html#l00084">parameter.c:84</a></div></div>
<div class="ttc" id="structBody_html_a782cee95e0064e3895b88248bdfc781a"><div class="ttname"><a href="structBody.html#a782cee95e0064e3895b88248bdfc781a">Body::parameter</a></div><div class="ttdeci">struct ParameterList parameter</div><div class="ttdoc">parameters of the content-type </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00039">body.h:39</a></div></div>
</div><!-- fragment --><div id="dynsection-19" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-19-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-19-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-19-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_a832e4b9f5a0e463876a3d8cfe852f12d_cgraph.svg" width="572" height="63"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div id="dynsection-20" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-20-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-20-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-20-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_a832e4b9f5a0e463876a3d8cfe852f12d_icgraph.svg" width="491" height="406"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a345fb1ff241b3fc778632947c2b08d37"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a345fb1ff241b3fc778632947c2b08d37">&#9670;&nbsp;</a></span>mutt_is_multipart_signed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a> mutt_is_multipart_signed </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structBody.html">Body</a> *&#160;</td>
          <td class="paramname"><em>b</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Is a message signed? </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">b</td><td><a class="el" href="structBody.html" title="The body of an email. ">Body</a> of email </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">num</td><td><a class="el" href="structMessage.html" title="A local copy of an email. ">Message</a> is signed, see <a class="el" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d" title="Flags, e.g. SEC_ENCRYPT. ">SecurityFlags</a> </td></tr>
    <tr><td class="paramname">0</td><td><a class="el" href="structMessage.html" title="A local copy of an email. ">Message</a> is not signed (<a class="el" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4" title="No flags are set. ">SEC_NO_FLAGS</a>) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="crypt_8c_source.html#l00420">420</a> of file <a class="el" href="crypt_8c_source.html">crypt.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;{</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;  <span class="keywordflow">if</span> (!b || (b-&gt;<a class="code" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a> != <a class="code" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79a877e24e62c85f20ff0e0f09ab983031e">TYPE_MULTIPART</a>) || !b-&gt;<a class="code" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a> || !<a class="code" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(b-&gt;<a class="code" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>, <span class="stringliteral">&quot;signed&quot;</span>))</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;  {</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a>;</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;  }</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;  <span class="keywordtype">char</span> *p = <a class="code" href="parameter_8c.html#a0c6d54a87e015a496c8dbecfcd4002c9">mutt_param_get</a>(&amp;b-&gt;<a class="code" href="structBody.html#a782cee95e0064e3895b88248bdfc781a">parameter</a>, <span class="stringliteral">&quot;protocol&quot;</span>);</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;  <span class="keywordflow">if</span> (!p)</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a>;</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(p, <span class="stringliteral">&quot;multipart/mixed&quot;</span>))</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="ncrypt_2lib_8h.html#ae12c003463c99d28f65f1d6b8b053b2c">SEC_SIGN</a>;</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;  <span class="keywordflow">if</span> (((<a class="code" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a>) != 0) &amp;&amp;</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;      <a class="code" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(p, <span class="stringliteral">&quot;application/pgp-signature&quot;</span>))</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;  {</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="ncrypt_2lib_8h.html#a14f75a650c49341776276f44881d54b2">PGP_SIGN</a>;</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;  }</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;  <span class="keywordflow">if</span> (((<a class="code" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code" href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a>) != 0) &amp;&amp;</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;      <a class="code" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(p, <span class="stringliteral">&quot;application/x-pkcs7-signature&quot;</span>))</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;  {</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="ncrypt_2lib_8h.html#a67114d960e61fc36c467f4bf08d37335">SMIME_SIGN</a>;</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;  }</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;  <span class="keywordflow">if</span> (((<a class="code" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; APPLICATION_SMIME) != 0) &amp;&amp;</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;      <a class="code" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(p, <span class="stringliteral">&quot;application/pkcs7-signature&quot;</span>))</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;  {</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="ncrypt_2lib_8h.html#a67114d960e61fc36c467f4bf08d37335">SMIME_SIGN</a>;</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;  }</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a>;</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;}</div><div class="ttc" id="ncrypt_2lib_8h_html_a67114d960e61fc36c467f4bf08d37335"><div class="ttname"><a href="ncrypt_2lib_8h.html#a67114d960e61fc36c467f4bf08d37335">SMIME_SIGN</a></div><div class="ttdeci">#define SMIME_SIGN</div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00100">lib.h:100</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_ad980bff69bb614893ad8e7e1c28a5023"><div class="ttname"><a href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a></div><div class="ttdeci">#define WithCrypto</div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00113">lib.h:113</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a95845954210adfc850d5602843f858d4"><div class="ttname"><a href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a></div><div class="ttdeci">#define SEC_NO_FLAGS</div><div class="ttdoc">No flags are set. </div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00074">lib.h:74</a></div></div>
<div class="ttc" id="mutt_2string_8c_html_a29db81d6f5a7dd216cbea75ecf8a5885"><div class="ttname"><a href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a></div><div class="ttdeci">bool mutt_istr_equal(const char *a, const char *b)</div><div class="ttdoc">Compare two strings, ignoring case. </div><div class="ttdef"><b>Definition:</b> <a href="mutt_2string_8c_source.html#l00916">string.c:916</a></div></div>
<div class="ttc" id="structBody_html_ace00f9cba9b46a2d434764335d2fa43a"><div class="ttname"><a href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">Body::subtype</a></div><div class="ttdeci">char * subtype</div><div class="ttdoc">content-type subtype </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00037">body.h:37</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a798dfac1e8839ca89375b4ec62b3eff2"><div class="ttname"><a href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a></div><div class="ttdeci">#define APPLICATION_SMIME</div><div class="ttdoc">Use SMIME to encrypt/sign. </div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00088">lib.h:88</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a587e679a4c9cc44f11f0c467bb22b0af"><div class="ttname"><a href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a></div><div class="ttdeci">#define APPLICATION_PGP</div><div class="ttdoc">Use PGP to encrypt/sign. </div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00087">lib.h:87</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a14f75a650c49341776276f44881d54b2"><div class="ttname"><a href="ncrypt_2lib_8h.html#a14f75a650c49341776276f44881d54b2">PGP_SIGN</a></div><div class="ttdeci">#define PGP_SIGN</div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00094">lib.h:94</a></div></div>
<div class="ttc" id="structBody_html_af77d79aadb278bef8f2829c268f2486f"><div class="ttname"><a href="structBody.html#af77d79aadb278bef8f2829c268f2486f">Body::type</a></div><div class="ttdeci">unsigned int type</div><div class="ttdoc">content-type primary type, ContentType </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00065">body.h:65</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_ae12c003463c99d28f65f1d6b8b053b2c"><div class="ttname"><a href="ncrypt_2lib_8h.html#ae12c003463c99d28f65f1d6b8b053b2c">SEC_SIGN</a></div><div class="ttdeci">#define SEC_SIGN</div><div class="ttdoc">Email is signed. </div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00076">lib.h:76</a></div></div>
<div class="ttc" id="mime_8h_html_a3ccd048df649c335df5a7f82673bbc79a877e24e62c85f20ff0e0f09ab983031e"><div class="ttname"><a href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79a877e24e62c85f20ff0e0f09ab983031e">TYPE_MULTIPART</a></div><div class="ttdoc">Type: &amp;#39;multipart/*&amp;#39;. </div><div class="ttdef"><b>Definition:</b> <a href="mime_8h_source.html#l00037">mime.h:37</a></div></div>
<div class="ttc" id="parameter_8c_html_a0c6d54a87e015a496c8dbecfcd4002c9"><div class="ttname"><a href="parameter_8c.html#a0c6d54a87e015a496c8dbecfcd4002c9">mutt_param_get</a></div><div class="ttdeci">char * mutt_param_get(const struct ParameterList *pl, const char *s)</div><div class="ttdoc">Find a matching Parameter. </div><div class="ttdef"><b>Definition:</b> <a href="parameter_8c_source.html#l00084">parameter.c:84</a></div></div>
<div class="ttc" id="structBody_html_a782cee95e0064e3895b88248bdfc781a"><div class="ttname"><a href="structBody.html#a782cee95e0064e3895b88248bdfc781a">Body::parameter</a></div><div class="ttdeci">struct ParameterList parameter</div><div class="ttdoc">parameters of the content-type </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00039">body.h:39</a></div></div>
</div><!-- fragment --><div id="dynsection-21" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-21-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-21-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-21-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_a345fb1ff241b3fc778632947c2b08d37_cgraph.svg" width="550" height="63"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div id="dynsection-22" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-22-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-22-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-22-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_a345fb1ff241b3fc778632947c2b08d37_icgraph.svg" width="447" height="462"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a51806f872069460bb7f4fa16d1d92710"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a51806f872069460bb7f4fa16d1d92710">&#9670;&nbsp;</a></span>mutt_is_valid_multipart_pgp_encrypted()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mutt_is_valid_multipart_pgp_encrypted </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structBody.html">Body</a> *&#160;</td>
          <td class="paramname"><em>b</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Is this a valid multi-part encrypted message? </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">b</td><td><a class="el" href="structBody.html" title="The body of an email. ">Body</a> of email </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">&gt;0</td><td><a class="el" href="structMessage.html" title="A local copy of an email. ">Message</a> is valid, with encrypted parts, e.g. <a class="el" href="ncrypt_2lib_8h.html#a6694d25dff1ee1958351160a84bb2dc0">PGP_ENCRYPT</a> </td></tr>
    <tr><td class="paramname">0</td><td><a class="el" href="structMessage.html" title="A local copy of an email. ">Message</a> hasn't got encrypted parts </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="crypt_8c_source.html#l00484">484</a> of file <a class="el" href="crypt_8c_source.html">crypt.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;{</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="crypt_8c.html#a832e4b9f5a0e463876a3d8cfe852f12d">mutt_is_multipart_encrypted</a>(b) == <a class="code" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a>)</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;  b = b-&gt;<a class="code" href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">parts</a>;</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;  <span class="keywordflow">if</span> (!b || (b-&gt;<a class="code" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a> != <a class="code" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79ac5074066199e3f540550ca0b1a38978e">TYPE_APPLICATION</a>) || !b-&gt;<a class="code" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a> ||</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;      !<a class="code" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(b-&gt;<a class="code" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>, <span class="stringliteral">&quot;pgp-encrypted&quot;</span>))</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;  {</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;  }</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;  b = b-&gt;<a class="code" href="structBody.html#ac55cdfce46eed13151dcfe9b329d254c">next</a>;</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;  <span class="keywordflow">if</span> (!b || (b-&gt;<a class="code" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a> != <a class="code" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79ac5074066199e3f540550ca0b1a38978e">TYPE_APPLICATION</a>) || !b-&gt;<a class="code" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a> ||</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;      !<a class="code" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(b-&gt;<a class="code" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>, <span class="stringliteral">&quot;octet-stream&quot;</span>))</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;  {</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;  }</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="ncrypt_2lib_8h.html#a6694d25dff1ee1958351160a84bb2dc0">PGP_ENCRYPT</a>;</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;}</div><div class="ttc" id="ncrypt_2lib_8h_html_a95845954210adfc850d5602843f858d4"><div class="ttname"><a href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a></div><div class="ttdeci">#define SEC_NO_FLAGS</div><div class="ttdoc">No flags are set. </div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00074">lib.h:74</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a6694d25dff1ee1958351160a84bb2dc0"><div class="ttname"><a href="ncrypt_2lib_8h.html#a6694d25dff1ee1958351160a84bb2dc0">PGP_ENCRYPT</a></div><div class="ttdeci">#define PGP_ENCRYPT</div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00093">lib.h:93</a></div></div>
<div class="ttc" id="structBody_html_ac55cdfce46eed13151dcfe9b329d254c"><div class="ttname"><a href="structBody.html#ac55cdfce46eed13151dcfe9b329d254c">Body::next</a></div><div class="ttdeci">struct Body * next</div><div class="ttdoc">next attachment in the list </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00053">body.h:53</a></div></div>
<div class="ttc" id="crypt_8c_html_a832e4b9f5a0e463876a3d8cfe852f12d"><div class="ttname"><a href="crypt_8c.html#a832e4b9f5a0e463876a3d8cfe852f12d">mutt_is_multipart_encrypted</a></div><div class="ttdeci">SecurityFlags mutt_is_multipart_encrypted(struct Body *b)</div><div class="ttdoc">Does the message have encrypted parts? </div><div class="ttdef"><b>Definition:</b> <a href="crypt_8c_source.html#l00460">crypt.c:460</a></div></div>
<div class="ttc" id="mutt_2string_8c_html_a29db81d6f5a7dd216cbea75ecf8a5885"><div class="ttname"><a href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a></div><div class="ttdeci">bool mutt_istr_equal(const char *a, const char *b)</div><div class="ttdoc">Compare two strings, ignoring case. </div><div class="ttdef"><b>Definition:</b> <a href="mutt_2string_8c_source.html#l00916">string.c:916</a></div></div>
<div class="ttc" id="structBody_html_ace00f9cba9b46a2d434764335d2fa43a"><div class="ttname"><a href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">Body::subtype</a></div><div class="ttdeci">char * subtype</div><div class="ttdoc">content-type subtype </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00037">body.h:37</a></div></div>
<div class="ttc" id="structBody_html_a0b87b7bdb6faef44d9aac4854975f805"><div class="ttname"><a href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">Body::parts</a></div><div class="ttdeci">struct Body * parts</div><div class="ttdoc">parts of a multipart or message/rfc822 </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00054">body.h:54</a></div></div>
<div class="ttc" id="structBody_html_af77d79aadb278bef8f2829c268f2486f"><div class="ttname"><a href="structBody.html#af77d79aadb278bef8f2829c268f2486f">Body::type</a></div><div class="ttdeci">unsigned int type</div><div class="ttdoc">content-type primary type, ContentType </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00065">body.h:65</a></div></div>
<div class="ttc" id="mime_8h_html_a3ccd048df649c335df5a7f82673bbc79ac5074066199e3f540550ca0b1a38978e"><div class="ttname"><a href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79ac5074066199e3f540550ca0b1a38978e">TYPE_APPLICATION</a></div><div class="ttdoc">Type: &amp;#39;application/*&amp;#39;. </div><div class="ttdef"><b>Definition:</b> <a href="mime_8h_source.html#l00033">mime.h:33</a></div></div>
</div><!-- fragment --><div id="dynsection-23" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-23-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-23-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-23-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_a51806f872069460bb7f4fa16d1d92710_cgraph.svg" width="619" height="71"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div id="dynsection-24" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-24-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-24-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-24-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_a51806f872069460bb7f4fa16d1d92710_icgraph.svg" width="436" height="190"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="afb7fbdc0157b9f7fd68b378232d554fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afb7fbdc0157b9f7fd68b378232d554fc">&#9670;&nbsp;</a></span>mutt_protect()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mutt_protect </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structMailbox.html">Mailbox</a> *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structEmail.html">Email</a> *&#160;</td>
          <td class="paramname"><em>e</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>keylist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>postpone</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Encrypt and/or sign a message. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">m</td><td>Current <a class="el" href="structMailbox.html" title="A mailbox. ">Mailbox</a> </td></tr>
    <tr><td class="paramname">e</td><td><a class="el" href="structEmail.html" title="The envelope/body of an email. ">Email</a> </td></tr>
    <tr><td class="paramname">keylist</td><td>List of keys to encrypt to (space-separated) </td></tr>
    <tr><td class="paramname">postpone</td><td>When true, signing is automatically disabled </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Success </td></tr>
    <tr><td class="paramname">-1</td><td>Error </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="crypt_8c_source.html#l00161">161</a> of file <a class="el" href="crypt_8c_source.html">crypt.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;{</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  <span class="keyword">struct </span><a class="code" href="structBody.html">Body</a> *pbody = NULL, *tmp_pbody = NULL;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  <span class="keyword">struct </span><a class="code" href="structBody.html">Body</a> *tmp_smime_pbody = NULL;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  <span class="keyword">struct </span><a class="code" href="structBody.html">Body</a> *tmp_pgp_pbody = NULL;</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  <span class="keywordtype">bool</span> has_retainable_sig = <span class="keyword">false</span>;</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a>)</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  <a class="code" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a> security = e-&gt;<a class="code" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a>;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  <span class="keywordtype">int</span> sign = security &amp; (<a class="code" href="ncrypt_2lib_8h.html#a0b36be5c32ca90d8f2caef9ea9d627fc">SEC_AUTOCRYPT</a> | <a class="code" href="ncrypt_2lib_8h.html#ae12c003463c99d28f65f1d6b8b053b2c">SEC_SIGN</a>);</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  <span class="keywordflow">if</span> (postpone)</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  {</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    sign = <a class="code" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a>;</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    security &amp;= ~<a class="code" href="ncrypt_2lib_8h.html#ae12c003463c99d28f65f1d6b8b053b2c">SEC_SIGN</a>;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  }</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  <span class="keywordflow">if</span> (!(security &amp; (<a class="code" href="ncrypt_2lib_8h.html#aacaa4abd4c0696e260b7a0f1d466360a">SEC_ENCRYPT</a> | <a class="code" href="ncrypt_2lib_8h.html#a0b36be5c32ca90d8f2caef9ea9d627fc">SEC_AUTOCRYPT</a>)) &amp;&amp; !sign)</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  <span class="keywordflow">if</span> (sign &amp;&amp; !(security &amp; <a class="code" href="ncrypt_2lib_8h.html#a0b36be5c32ca90d8f2caef9ea9d627fc">SEC_AUTOCRYPT</a>) &amp;&amp; !<a class="code" href="crypt_8c.html#a4ee7f1419a7e39b0e9f1f9d550f4de43">crypt_valid_passphrase</a>(security))</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  <span class="keywordflow">if</span> (((<a class="code" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a>) != 0) &amp;&amp; !(security &amp; <a class="code" href="ncrypt_2lib_8h.html#a0b36be5c32ca90d8f2caef9ea9d627fc">SEC_AUTOCRYPT</a>) &amp;&amp;</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;      ((security &amp; <a class="code" href="ncrypt_2lib_8h.html#a68503f0e36de213094c8546b4f74eef1">PGP_INLINE</a>) == <a class="code" href="ncrypt_2lib_8h.html#a68503f0e36de213094c8546b4f74eef1">PGP_INLINE</a>))</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  {</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="keyword">const</span> <span class="keyword">enum</span> <a class="code" href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35db">QuadOption</a> c_pgp_mime_auto =</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        <a class="code" href="helpers_8c.html#a9154ba713ce99b0937f475eec7c61af9">cs_subset_quad</a>(<a class="code" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;pgp_mime_auto&quot;</span>);</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="keywordflow">if</span> ((e-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>-&gt;<a class="code" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a> != <a class="code" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79ad88e88afaec507209421bba20aeeb167">TYPE_TEXT</a>) ||</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        !<a class="code" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(e-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>-&gt;<a class="code" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>, <span class="stringliteral">&quot;plain&quot;</span>))</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    {</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="question_2lib_8h.html#ab02047769214ff014b9a8a1782babadc">query_quadoption</a>(c_pgp_mime_auto,</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                           <a class="code" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Inline PGP can&#39;t be used with attachments.  &quot;</span></div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                             <span class="stringliteral">&quot;Revert to PGP/MIME?&quot;</span>)) != <a class="code" href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35dbafee7088606c4724651c799a6a0b182b7">MUTT_YES</a>)</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;      {</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        <a class="code" href="logging_8h.html#acc1fd6d7ab1603e80e11e84e90d061e4">mutt_error</a>(</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;            <a class="code" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Mail not sent: inline PGP can&#39;t be used with attachments&quot;</span>));</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;      }</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    }</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(<span class="stringliteral">&quot;flowed&quot;</span>,</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;                             <a class="code" href="parameter_8c.html#a0c6d54a87e015a496c8dbecfcd4002c9">mutt_param_get</a>(&amp;e-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>-&gt;<a class="code" href="structBody.html#a782cee95e0064e3895b88248bdfc781a">parameter</a>, <span class="stringliteral">&quot;format&quot;</span>)))</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    {</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;      <span class="keywordflow">if</span> ((<a class="code" href="question_2lib_8h.html#ab02047769214ff014b9a8a1782babadc">query_quadoption</a>(c_pgp_mime_auto,</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;                            <a class="code" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Inline PGP can&#39;t be used with format=flowed.  &quot;</span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;                              <span class="stringliteral">&quot;Revert to PGP/MIME?&quot;</span>))) != <a class="code" href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35dbafee7088606c4724651c799a6a0b182b7">MUTT_YES</a>)</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;      {</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        <a class="code" href="logging_8h.html#acc1fd6d7ab1603e80e11e84e90d061e4">mutt_error</a>(</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;            <a class="code" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Mail not sent: inline PGP can&#39;t be used with format=flowed&quot;</span>));</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;      }</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    }</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    {</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;      <span class="comment">/* they really want to send it inline... go for it */</span></div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;      <span class="keywordflow">if</span> (!isendwin())</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;      {</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        <a class="code" href="curs__lib_8c.html#acd14d074d8b9e6cb21e851dd573cdec2">mutt_endwin</a>();</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        puts(<a class="code" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Invoking PGP...&quot;</span>));</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;      }</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;      pbody = <a class="code" href="cryptglue_8c.html#a18917d06dade2acda8b92af955f8663d">crypt_pgp_traditional_encryptsign</a>(e-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>, security, keylist);</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;      <span class="keywordflow">if</span> (pbody)</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;      {</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        e-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a> = pbody;</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;      }</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;      <span class="comment">/* otherwise inline won&#39;t work...ask for revert */</span></div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="question_2lib_8h.html#ab02047769214ff014b9a8a1782babadc">query_quadoption</a>(</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;              c_pgp_mime_auto,</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;              <a class="code" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Message can&#39;t be sent inline.  Revert to using PGP/MIME?&quot;</span>)) != <a class="code" href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35dbafee7088606c4724651c799a6a0b182b7">MUTT_YES</a>)</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;      {</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        <a class="code" href="logging_8h.html#acc1fd6d7ab1603e80e11e84e90d061e4">mutt_error</a>(<a class="code" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Mail not sent&quot;</span>));</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;      }</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    }</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="comment">/* go ahead with PGP/MIME */</span></div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  }</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  <span class="keywordflow">if</span> (!isendwin())</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <a class="code" href="curs__lib_8c.html#acd14d074d8b9e6cb21e851dd573cdec2">mutt_endwin</a>();</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code" href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a>)</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    tmp_smime_pbody = e-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; APPLICATION_PGP)</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    tmp_pgp_pbody = e-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="preprocessor">#ifdef CRYPT_BACKEND_GPGME</span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> c_crypt_use_pka = <a class="code" href="helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(<a class="code" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;crypt_use_pka&quot;</span>);</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  <span class="keywordflow">if</span> (sign &amp;&amp; c_crypt_use_pka)</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  <span class="keywordflow">if</span> (sign)</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  {</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <span class="comment">/* Set sender (necessary for e.g. PKA).  */</span></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *mailbox = NULL;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <span class="keyword">struct </span><a class="code" href="structAddress.html">Address</a> *from = <a class="code" href="queue_8h.html#a7d6894360bd1c41e0e6f6d84998c1362">TAILQ_FIRST</a>(&amp;e-&gt;<a class="code" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code" href="structEnvelope.html#af1aa00aed4b8767cf98f08e45a432ad8">from</a>);</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <span class="keywordtype">bool</span> free_from = <span class="keyword">false</span>;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="keywordflow">if</span> (!from)</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    {</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;      free_from = <span class="keyword">true</span>;</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;      from = <a class="code" href="send_8c.html#aa93b7a6bc9e26176ebf17bf37c7d2a87">mutt_default_from</a>(<a class="code" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>);</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    }</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    mailbox = from-&gt;<a class="code" href="structAddress.html#a8ea3ae93a2550c76c392a9001dbbaefd">mailbox</a>;</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structAddress.html">Address</a> *c_envelope_from_address =</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        <a class="code" href="helpers_8c.html#a1118361831f5c60ec14ce80ae37267d9">cs_subset_address</a>(<a class="code" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;envelope_from_address&quot;</span>);</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <span class="keywordflow">if</span> (!mailbox &amp;&amp; c_envelope_from_address)</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;      mailbox = c_envelope_from_address-&gt;<a class="code" href="structAddress.html#a8ea3ae93a2550c76c392a9001dbbaefd">mailbox</a>;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <span class="keywordflow">if</span> (((<a class="code" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; APPLICATION_SMIME) != 0) &amp;&amp; (security &amp; APPLICATION_SMIME))</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;      <a class="code" href="cryptglue_8c.html#a9f57744c7bcac595aa1a8838f83dc369">crypt_smime_set_sender</a>(mailbox);</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (((<a class="code" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; APPLICATION_PGP) != 0) &amp;&amp; (security &amp; APPLICATION_PGP))</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;      <a class="code" href="cryptglue_8c.html#a9f42f50373941a87a03df3424ce1b7c4">crypt_pgp_set_sender</a>(mailbox);</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <span class="keywordflow">if</span> (free_from)</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;      <a class="code" href="address_2address_8c.html#a40eda06e6e64ff9d9f1e7d3b69e7c846">mutt_addr_free</a>(&amp;from);</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  }</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> c_crypt_protected_headers_write =</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;      <a class="code" href="helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(<a class="code" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;crypt_protected_headers_write&quot;</span>);</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  <span class="keywordflow">if</span> (c_crypt_protected_headers_write)</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  {</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="keyword">struct </span><a class="code" href="structEnvelope.html">Envelope</a> *protected_headers = <a class="code" href="email_2envelope_8c.html#a51f04365c2b348d829e7cd3710c55b5b">mutt_env_new</a>();</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <a class="code" href="mutt_2string_8c.html#ae9b6bbaa52b6ce51f2a384fe500e028e">mutt_str_replace</a>(&amp;protected_headers-&gt;<a class="code" href="structEnvelope.html#aa3d22c82ed26a0727508d26363e98ea7">subject</a>, e-&gt;<a class="code" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code" href="structEnvelope.html#aa3d22c82ed26a0727508d26363e98ea7">subject</a>);</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <span class="comment">/* Note: if other headers get added, such as to, cc, then a call to</span></div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment">     * mutt_env_to_intl() will need to be added here too. */</span></div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <a class="code" href="sendlib_8c.html#ac35da3d19eb0d95d4f6260adab57b4c9">mutt_prepare_envelope</a>(protected_headers, 0, <a class="code" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>);</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <a class="code" href="email_2envelope_8c.html#a244dacf9b1001c9ce1dbd473e001381f">mutt_env_free</a>(&amp;e-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>-&gt;<a class="code" href="structBody.html#a62f6c9b4245ed3b6b9296adb45aa4010">mime_headers</a>);</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    e-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>-&gt;<a class="code" href="structBody.html#a62f6c9b4245ed3b6b9296adb45aa4010">mime_headers</a> = protected_headers;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <span class="comment">/* Optional part of the draft RFC, but required by Enigmail */</span></div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <a class="code" href="parameter_8c.html#a42249fc15b1e52df046a0a10de29da44">mutt_param_set</a>(&amp;e-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>-&gt;<a class="code" href="structBody.html#a782cee95e0064e3895b88248bdfc781a">parameter</a>, <span class="stringliteral">&quot;protected-headers&quot;</span>, <span class="stringliteral">&quot;v1&quot;</span>);</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  }</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  {</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <a class="code" href="parameter_8c.html#a34454ee6af9d43eeabf80898dc7270b8">mutt_param_delete</a>(&amp;e-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>-&gt;<a class="code" href="structBody.html#a782cee95e0064e3895b88248bdfc781a">parameter</a>, <span class="stringliteral">&quot;protected-headers&quot;</span>);</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  }</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="preprocessor">#ifdef USE_AUTOCRYPT</span></div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  <span class="comment">/* A note about e-&gt;body-&gt;mime_headers.  If postpone or send</span></div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="comment">   * fails, the mime_headers is cleared out before returning to the</span></div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="comment">   * compose menu.  So despite the &quot;robustness&quot; code above and in the</span></div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="comment">   * gen_gossip_list function below, mime_headers will not be set when</span></div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="comment">   * entering mutt_protect().</span></div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="comment">   *</span></div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="comment">   * This is important to note because the user could toggle</span></div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="comment">   * $crypt_protected_headers_write or $autocrypt off back in the</span></div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="comment">   * compose menu.  We don&#39;t want mutt_write_rfc822_header() to write</span></div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment">   * stale data from one option if the other is set.</span></div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> c_autocrypt = <a class="code" href="helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(<a class="code" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;autocrypt&quot;</span>);</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  <span class="keywordflow">if</span> (c_autocrypt &amp;&amp; !postpone &amp;&amp; (security &amp; SEC_AUTOCRYPT))</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  {</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <a class="code" href="autocrypt_8c.html#aea9f6e4bd078dcaebec5c0d9b75a30d0">mutt_autocrypt_generate_gossip_list</a>(m, e);</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  }</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;  <span class="keywordflow">if</span> (sign)</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  {</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <span class="keywordflow">if</span> (((<a class="code" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; APPLICATION_SMIME) != 0) &amp;&amp; (security &amp; APPLICATION_SMIME))</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    {</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;      tmp_pbody = <a class="code" href="cryptglue_8c.html#a8a5cfb9361fdcea0c4e35095f0886baa">crypt_smime_sign_message</a>(e-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>, &amp;e-&gt;<a class="code" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code" href="structEnvelope.html#af1aa00aed4b8767cf98f08e45a432ad8">from</a>);</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;      <span class="keywordflow">if</span> (!tmp_pbody)</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;        <span class="keywordflow">goto</span> bail;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;      pbody = tmp_pbody;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;      tmp_smime_pbody = tmp_pbody;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    }</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> c_pgp_retainable_sigs =</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        <a class="code" href="helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(<a class="code" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;pgp_retainable_sigs&quot;</span>);</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <span class="keywordflow">if</span> (((<a class="code" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; APPLICATION_PGP) != 0) &amp;&amp; (security &amp; APPLICATION_PGP) &amp;&amp;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        (!(security &amp; (<a class="code" href="ncrypt_2lib_8h.html#aacaa4abd4c0696e260b7a0f1d466360a">SEC_ENCRYPT</a> | SEC_AUTOCRYPT)) || c_pgp_retainable_sigs))</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    {</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;      tmp_pbody = <a class="code" href="cryptglue_8c.html#abb7ee2dc3d7dbc1ccb6a4986d9a9c92b">crypt_pgp_sign_message</a>(e-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>, &amp;e-&gt;<a class="code" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code" href="structEnvelope.html#af1aa00aed4b8767cf98f08e45a432ad8">from</a>);</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;      <span class="keywordflow">if</span> (!tmp_pbody)</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;        <span class="keywordflow">goto</span> bail;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;      has_retainable_sig = <span class="keyword">true</span>;</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;      sign = <a class="code" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a>;</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;      pbody = tmp_pbody;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;      tmp_pgp_pbody = tmp_pbody;</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    }</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> != 0) &amp;&amp; (security &amp; APPLICATION_SMIME) &amp;&amp; (security &amp; APPLICATION_PGP))</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    {</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;      <span class="comment">/* here comes the draft ;-) */</span></div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    }</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;  }</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;  <span class="keywordflow">if</span> (security &amp; (<a class="code" href="ncrypt_2lib_8h.html#aacaa4abd4c0696e260b7a0f1d466360a">SEC_ENCRYPT</a> | SEC_AUTOCRYPT))</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  {</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <span class="keywordflow">if</span> (((<a class="code" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; APPLICATION_SMIME) != 0) &amp;&amp; (security &amp; APPLICATION_SMIME))</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    {</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;      tmp_pbody = <a class="code" href="cryptglue_8c.html#a2fe1beb64b690bc9f5f77c910c124a7d">crypt_smime_build_smime_entity</a>(tmp_smime_pbody, keylist);</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;      <span class="keywordflow">if</span> (!tmp_pbody)</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;      {</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        <span class="comment">/* signed ? free it! */</span></div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        <span class="keywordflow">goto</span> bail;</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;      }</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;      <span class="comment">/* free tmp_body if messages was signed AND encrypted ... */</span></div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;      <span class="keywordflow">if</span> ((tmp_smime_pbody != e-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>) &amp;&amp; (tmp_smime_pbody != tmp_pbody))</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;      {</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;        <span class="comment">/* detach and don&#39;t delete e-&gt;body,</span></div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="comment">         * which tmp_smime_pbody-&gt;parts after signing. */</span></div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        tmp_smime_pbody-&gt;<a class="code" href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">parts</a> = tmp_smime_pbody-&gt;<a class="code" href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">parts</a>-&gt;<a class="code" href="structBody.html#ac55cdfce46eed13151dcfe9b329d254c">next</a>;</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        e-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>-&gt;<a class="code" href="structBody.html#ac55cdfce46eed13151dcfe9b329d254c">next</a> = NULL;</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;        <a class="code" href="email_2body_8c.html#a129af1c316fcbc26b55fb48957bab2cb">mutt_body_free</a>(&amp;tmp_smime_pbody);</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;      }</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;      pbody = tmp_pbody;</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    }</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    <span class="keywordflow">if</span> (((<a class="code" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; APPLICATION_PGP) != 0) &amp;&amp; (security &amp; APPLICATION_PGP))</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    {</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;      pbody =</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;          <a class="code" href="cryptglue_8c.html#aca6c03b64aab01e9d26c9708fd72c2c5">crypt_pgp_encrypt_message</a>(m, e, tmp_pgp_pbody, keylist, sign, &amp;e-&gt;<a class="code" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code" href="structEnvelope.html#af1aa00aed4b8767cf98f08e45a432ad8">from</a>);</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;      <span class="keywordflow">if</span> (!pbody)</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;      {</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;        <span class="comment">/* did we perform a retainable signature? */</span></div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        <span class="keywordflow">if</span> (has_retainable_sig)</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;        {</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;          <span class="comment">/* remove the outer multipart layer */</span></div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;          tmp_pgp_pbody = <a class="code" href="multipart_8c.html#a71d5ccd20fbbbe2fa56e6d1f577e34ae">mutt_remove_multipart</a>(tmp_pgp_pbody);</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;          <span class="comment">/* get rid of the signature */</span></div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;          <a class="code" href="email_2body_8c.html#a129af1c316fcbc26b55fb48957bab2cb">mutt_body_free</a>(&amp;tmp_pgp_pbody-&gt;<a class="code" href="structBody.html#ac55cdfce46eed13151dcfe9b329d254c">next</a>);</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;        }</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        <span class="keywordflow">goto</span> bail;</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;      }</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;      <span class="comment">// destroy temporary signature envelope when doing retainable signatures.</span></div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;      <span class="keywordflow">if</span> (has_retainable_sig)</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;      {</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;        tmp_pgp_pbody = <a class="code" href="multipart_8c.html#a71d5ccd20fbbbe2fa56e6d1f577e34ae">mutt_remove_multipart</a>(tmp_pgp_pbody);</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;        <a class="code" href="email_2body_8c.html#a129af1c316fcbc26b55fb48957bab2cb">mutt_body_free</a>(&amp;tmp_pgp_pbody-&gt;<a class="code" href="structBody.html#ac55cdfce46eed13151dcfe9b329d254c">next</a>);</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;      }</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    }</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;  }</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;  <span class="keywordflow">if</span> (pbody)</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;  {</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    e-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a> = pbody;</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;  }</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;bail:</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;  <a class="code" href="email_2envelope_8c.html#a244dacf9b1001c9ce1dbd473e001381f">mutt_env_free</a>(&amp;e-&gt;<a class="code" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>-&gt;<a class="code" href="structBody.html#a62f6c9b4245ed3b6b9296adb45aa4010">mime_headers</a>);</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;  <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;}</div><div class="ttc" id="ncrypt_2lib_8h_html_a68503f0e36de213094c8546b4f74eef1"><div class="ttname"><a href="ncrypt_2lib_8h.html#a68503f0e36de213094c8546b4f74eef1">PGP_INLINE</a></div><div class="ttdeci">#define PGP_INLINE</div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00097">lib.h:97</a></div></div>
<div class="ttc" id="structBody_html_a62f6c9b4245ed3b6b9296adb45aa4010"><div class="ttname"><a href="structBody.html#a62f6c9b4245ed3b6b9296adb45aa4010">Body::mime_headers</a></div><div class="ttdeci">struct Envelope * mime_headers</div><div class="ttdoc">Memory hole protected headers. </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00063">body.h:63</a></div></div>
<div class="ttc" id="helpers_8c_html_ae50f679dd6c5bd1ba820884c8602f038"><div class="ttname"><a href="helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a></div><div class="ttdeci">bool cs_subset_bool(const struct ConfigSubset *sub, const char *name)</div><div class="ttdoc">Get a boolean config item by name. </div><div class="ttdef"><b>Definition:</b> <a href="helpers_8c_source.html#l00071">helpers.c:71</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_ad980bff69bb614893ad8e7e1c28a5023"><div class="ttname"><a href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a></div><div class="ttdeci">#define WithCrypto</div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00113">lib.h:113</a></div></div>
<div class="ttc" id="email_2envelope_8c_html_a244dacf9b1001c9ce1dbd473e001381f"><div class="ttname"><a href="email_2envelope_8c.html#a244dacf9b1001c9ce1dbd473e001381f">mutt_env_free</a></div><div class="ttdeci">void mutt_env_free(struct Envelope **ptr)</div><div class="ttdoc">Free an Envelope. </div><div class="ttdef"><b>Definition:</b> <a href="email_2envelope_8c_source.html#l00096">envelope.c:96</a></div></div>
<div class="ttc" id="autocrypt_8c_html_aea9f6e4bd078dcaebec5c0d9b75a30d0"><div class="ttname"><a href="autocrypt_8c.html#aea9f6e4bd078dcaebec5c0d9b75a30d0">mutt_autocrypt_generate_gossip_list</a></div><div class="ttdeci">int mutt_autocrypt_generate_gossip_list(struct Mailbox *m, struct Email *e)</div><div class="ttdoc">Create the gossip list headers. </div><div class="ttdef"><b>Definition:</b> <a href="autocrypt_8c_source.html#l00841">autocrypt.c:841</a></div></div>
<div class="ttc" id="queue_8h_html_a7d6894360bd1c41e0e6f6d84998c1362"><div class="ttname"><a href="queue_8h.html#a7d6894360bd1c41e0e6f6d84998c1362">TAILQ_FIRST</a></div><div class="ttdeci">#define TAILQ_FIRST(head)</div><div class="ttdef"><b>Definition:</b> <a href="queue_8h_source.html#l00716">queue.h:716</a></div></div>
<div class="ttc" id="structEmail_html_a57ad6ac618c0f685804f6f5bb390b3a6"><div class="ttname"><a href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">Email::body</a></div><div class="ttdeci">struct Body * body</div><div class="ttdoc">List of MIME parts. </div><div class="ttdef"><b>Definition:</b> <a href="email_8h_source.html#l00091">email.h:91</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a95845954210adfc850d5602843f858d4"><div class="ttname"><a href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a></div><div class="ttdeci">#define SEC_NO_FLAGS</div><div class="ttdoc">No flags are set. </div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00074">lib.h:74</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_aacaa4abd4c0696e260b7a0f1d466360a"><div class="ttname"><a href="ncrypt_2lib_8h.html#aacaa4abd4c0696e260b7a0f1d466360a">SEC_ENCRYPT</a></div><div class="ttdeci">#define SEC_ENCRYPT</div><div class="ttdoc">Email is encrypted. </div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00075">lib.h:75</a></div></div>
<div class="ttc" id="cryptglue_8c_html_a9f42f50373941a87a03df3424ce1b7c4"><div class="ttname"><a href="cryptglue_8c.html#a9f42f50373941a87a03df3424ce1b7c4">crypt_pgp_set_sender</a></div><div class="ttdeci">void crypt_pgp_set_sender(const char *sender)</div><div class="ttdoc">Wrapper for CryptModuleSpecs::set_sender() </div><div class="ttdef"><b>Definition:</b> <a href="cryptglue_8c_source.html#l00410">cryptglue.c:410</a></div></div>
<div class="ttc" id="mutt_2message_8h_html_a479d658dfd60fe8d9709ec67a58b34ca"><div class="ttname"><a href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a></div><div class="ttdeci">#define _(a)</div><div class="ttdef"><b>Definition:</b> <a href="mutt_2message_8h_source.html#l00028">message.h:28</a></div></div>
<div class="ttc" id="structBody_html_ac55cdfce46eed13151dcfe9b329d254c"><div class="ttname"><a href="structBody.html#ac55cdfce46eed13151dcfe9b329d254c">Body::next</a></div><div class="ttdeci">struct Body * next</div><div class="ttdoc">next attachment in the list </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00053">body.h:53</a></div></div>
<div class="ttc" id="structAddress_html"><div class="ttname"><a href="structAddress.html">Address</a></div><div class="ttdoc">An email address. </div><div class="ttdef"><b>Definition:</b> <a href="address_2address_8h_source.html#l00035">address.h:35</a></div></div>
<div class="ttc" id="structAddress_html_a8ea3ae93a2550c76c392a9001dbbaefd"><div class="ttname"><a href="structAddress.html#a8ea3ae93a2550c76c392a9001dbbaefd">Address::mailbox</a></div><div class="ttdeci">char * mailbox</div><div class="ttdoc">Mailbox and host address. </div><div class="ttdef"><b>Definition:</b> <a href="address_2address_8h_source.html#l00038">address.h:38</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a0b36be5c32ca90d8f2caef9ea9d627fc"><div class="ttname"><a href="ncrypt_2lib_8h.html#a0b36be5c32ca90d8f2caef9ea9d627fc">SEC_AUTOCRYPT</a></div><div class="ttdeci">#define SEC_AUTOCRYPT</div><div class="ttdoc">(Autocrypt) Message will be, or was Autocrypt encrypt+signed </div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00084">lib.h:84</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a2073a168ca3a64c3c30d13fa4917a05d"><div class="ttname"><a href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a></div><div class="ttdeci">uint16_t SecurityFlags</div><div class="ttdoc">Flags, e.g. SEC_ENCRYPT. </div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00071">lib.h:71</a></div></div>
<div class="ttc" id="email_2envelope_8c_html_a51f04365c2b348d829e7cd3710c55b5b"><div class="ttname"><a href="email_2envelope_8c.html#a51f04365c2b348d829e7cd3710c55b5b">mutt_env_new</a></div><div class="ttdeci">struct Envelope * mutt_env_new(void)</div><div class="ttdoc">Create a new Envelope. </div><div class="ttdef"><b>Definition:</b> <a href="email_2envelope_8c_source.html#l00042">envelope.c:42</a></div></div>
<div class="ttc" id="helpers_8c_html_a1118361831f5c60ec14ce80ae37267d9"><div class="ttname"><a href="helpers_8c.html#a1118361831f5c60ec14ce80ae37267d9">cs_subset_address</a></div><div class="ttdeci">const struct Address * cs_subset_address(const struct ConfigSubset *sub, const char *name)</div><div class="ttdoc">Get an Address config item by name. </div><div class="ttdef"><b>Definition:</b> <a href="helpers_8c_source.html#l00049">helpers.c:49</a></div></div>
<div class="ttc" id="address_2address_8c_html_a40eda06e6e64ff9d9f1e7d3b69e7c846"><div class="ttname"><a href="address_2address_8c.html#a40eda06e6e64ff9d9f1e7d3b69e7c846">mutt_addr_free</a></div><div class="ttdeci">void mutt_addr_free(struct Address **ptr)</div><div class="ttdoc">Free a single Address. </div><div class="ttdef"><b>Definition:</b> <a href="address_2address_8c_source.html#l00440">address.c:440</a></div></div>
<div class="ttc" id="structNeoMutt_html"><div class="ttname"><a href="structNeoMutt.html">NeoMutt</a></div><div class="ttdoc">Container for Accounts, Notifications. </div><div class="ttdef"><b>Definition:</b> <a href="neomutt_8h_source.html#l00036">neomutt.h:36</a></div></div>
<div class="ttc" id="structBody_html"><div class="ttname"><a href="structBody.html">Body</a></div><div class="ttdoc">The body of an email. </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00034">body.h:34</a></div></div>
<div class="ttc" id="quad_8h_html_a738f558a271fe5035e0ee3b700ee35db"><div class="ttname"><a href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35db">QuadOption</a></div><div class="ttdeci">QuadOption</div><div class="ttdoc">Possible values for a quad-option. </div><div class="ttdef"><b>Definition:</b> <a href="quad_8h_source.html#l00035">quad.h:35</a></div></div>
<div class="ttc" id="cryptglue_8c_html_a9f57744c7bcac595aa1a8838f83dc369"><div class="ttname"><a href="cryptglue_8c.html#a9f57744c7bcac595aa1a8838f83dc369">crypt_smime_set_sender</a></div><div class="ttdeci">void crypt_smime_set_sender(const char *sender)</div><div class="ttdoc">Wrapper for CryptModuleSpecs::set_sender() </div><div class="ttdef"><b>Definition:</b> <a href="cryptglue_8c_source.html#l00547">cryptglue.c:547</a></div></div>
<div class="ttc" id="cryptglue_8c_html_a8a5cfb9361fdcea0c4e35095f0886baa"><div class="ttname"><a href="cryptglue_8c.html#a8a5cfb9361fdcea0c4e35095f0886baa">crypt_smime_sign_message</a></div><div class="ttdeci">struct Body * crypt_smime_sign_message(struct Body *a, const struct AddressList *from)</div><div class="ttdoc">Wrapper for CryptModuleSpecs::sign_message() </div><div class="ttdef"><b>Definition:</b> <a href="cryptglue_8c_source.html#l00494">cryptglue.c:494</a></div></div>
<div class="ttc" id="crypt_8c_html_a4ee7f1419a7e39b0e9f1f9d550f4de43"><div class="ttname"><a href="crypt_8c.html#a4ee7f1419a7e39b0e9f1f9d550f4de43">crypt_valid_passphrase</a></div><div class="ttdeci">bool crypt_valid_passphrase(SecurityFlags flags)</div><div class="ttdoc">Check that we have a usable passphrase, ask if not. </div><div class="ttdef"><b>Definition:</b> <a href="crypt_8c_source.html#l00135">crypt.c:135</a></div></div>
<div class="ttc" id="sendlib_8c_html_ac35da3d19eb0d95d4f6260adab57b4c9"><div class="ttname"><a href="sendlib_8c.html#ac35da3d19eb0d95d4f6260adab57b4c9">mutt_prepare_envelope</a></div><div class="ttdeci">void mutt_prepare_envelope(struct Envelope *env, bool final, struct ConfigSubset *sub)</div><div class="ttdoc">Prepare an email header. </div><div class="ttdef"><b>Definition:</b> <a href="sendlib_8c_source.html#l01243">sendlib.c:1243</a></div></div>
<div class="ttc" id="structEnvelope_html_af1aa00aed4b8767cf98f08e45a432ad8"><div class="ttname"><a href="structEnvelope.html#af1aa00aed4b8767cf98f08e45a432ad8">Envelope::from</a></div><div class="ttdeci">struct AddressList from</div><div class="ttdoc">Email&amp;#39;s &amp;#39;From&amp;#39; list. </div><div class="ttdef"><b>Definition:</b> <a href="envelope_8h_source.html#l00057">envelope.h:57</a></div></div>
<div class="ttc" id="structEmail_html_a34cc4493729d7a3b1f4ed783e739a9ec"><div class="ttname"><a href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">Email::env</a></div><div class="ttdeci">struct Envelope * env</div><div class="ttdoc">Envelope information. </div><div class="ttdef"><b>Definition:</b> <a href="email_8h_source.html#l00090">email.h:90</a></div></div>
<div class="ttc" id="question_2lib_8h_html_ab02047769214ff014b9a8a1782babadc"><div class="ttname"><a href="question_2lib_8h.html#ab02047769214ff014b9a8a1782babadc">query_quadoption</a></div><div class="ttdeci">enum QuadOption query_quadoption(enum QuadOption opt, const char *prompt)</div><div class="ttdoc">Ask the user a quad-question. </div><div class="ttdef"><b>Definition:</b> <a href="question_8c_source.html#l00347">question.c:347</a></div></div>
<div class="ttc" id="mutt_2string_8c_html_a29db81d6f5a7dd216cbea75ecf8a5885"><div class="ttname"><a href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a></div><div class="ttdeci">bool mutt_istr_equal(const char *a, const char *b)</div><div class="ttdoc">Compare two strings, ignoring case. </div><div class="ttdef"><b>Definition:</b> <a href="mutt_2string_8c_source.html#l00916">string.c:916</a></div></div>
<div class="ttc" id="structBody_html_ace00f9cba9b46a2d434764335d2fa43a"><div class="ttname"><a href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">Body::subtype</a></div><div class="ttdeci">char * subtype</div><div class="ttdoc">content-type subtype </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00037">body.h:37</a></div></div>
<div class="ttc" id="parameter_8c_html_a34454ee6af9d43eeabf80898dc7270b8"><div class="ttname"><a href="parameter_8c.html#a34454ee6af9d43eeabf80898dc7270b8">mutt_param_delete</a></div><div class="ttdeci">void mutt_param_delete(struct ParameterList *pl, const char *attribute)</div><div class="ttdoc">Delete a matching Parameter. </div><div class="ttdef"><b>Definition:</b> <a href="parameter_8c_source.html#l00142">parameter.c:142</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a798dfac1e8839ca89375b4ec62b3eff2"><div class="ttname"><a href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a></div><div class="ttdeci">#define APPLICATION_SMIME</div><div class="ttdoc">Use SMIME to encrypt/sign. </div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00088">lib.h:88</a></div></div>
<div class="ttc" id="multipart_8c_html_a71d5ccd20fbbbe2fa56e6d1f577e34ae"><div class="ttname"><a href="multipart_8c.html#a71d5ccd20fbbbe2fa56e6d1f577e34ae">mutt_remove_multipart</a></div><div class="ttdeci">struct Body * mutt_remove_multipart(struct Body *b)</div><div class="ttdoc">Extract the multipart body if it exists. </div><div class="ttdef"><b>Definition:</b> <a href="multipart_8c_source.html#l00126">multipart.c:126</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a587e679a4c9cc44f11f0c467bb22b0af"><div class="ttname"><a href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a></div><div class="ttdeci">#define APPLICATION_PGP</div><div class="ttdoc">Use PGP to encrypt/sign. </div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00087">lib.h:87</a></div></div>
<div class="ttc" id="curs__lib_8c_html_acd14d074d8b9e6cb21e851dd573cdec2"><div class="ttname"><a href="curs__lib_8c.html#acd14d074d8b9e6cb21e851dd573cdec2">mutt_endwin</a></div><div class="ttdeci">void mutt_endwin(void)</div><div class="ttdoc">Shutdown curses/slang. </div><div class="ttdef"><b>Definition:</b> <a href="curs__lib_8c_source.html#l00422">curs_lib.c:422</a></div></div>
<div class="ttc" id="send_8c_html_aa93b7a6bc9e26176ebf17bf37c7d2a87"><div class="ttname"><a href="send_8c.html#aa93b7a6bc9e26176ebf17bf37c7d2a87">mutt_default_from</a></div><div class="ttdeci">struct Address * mutt_default_from(struct ConfigSubset *sub)</div><div class="ttdoc">Get a default &amp;#39;from&amp;#39; Address. </div><div class="ttdef"><b>Definition:</b> <a href="send_8c_source.html#l01454">send.c:1454</a></div></div>
<div class="ttc" id="mime_8h_html_a3ccd048df649c335df5a7f82673bbc79ad88e88afaec507209421bba20aeeb167"><div class="ttname"><a href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79ad88e88afaec507209421bba20aeeb167">TYPE_TEXT</a></div><div class="ttdoc">Type: &amp;#39;text/*&amp;#39;. </div><div class="ttdef"><b>Definition:</b> <a href="mime_8h_source.html#l00038">mime.h:38</a></div></div>
<div class="ttc" id="structBody_html_a0b87b7bdb6faef44d9aac4854975f805"><div class="ttname"><a href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">Body::parts</a></div><div class="ttdeci">struct Body * parts</div><div class="ttdoc">parts of a multipart or message/rfc822 </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00054">body.h:54</a></div></div>
<div class="ttc" id="email_2body_8c_html_a129af1c316fcbc26b55fb48957bab2cb"><div class="ttname"><a href="email_2body_8c.html#a129af1c316fcbc26b55fb48957bab2cb">mutt_body_free</a></div><div class="ttdeci">void mutt_body_free(struct Body **ptr)</div><div class="ttdoc">Free a Body. </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8c_source.html#l00057">body.c:57</a></div></div>
<div class="ttc" id="structEmail_html_a570a81cd747437c9ea4357947731ae10"><div class="ttname"><a href="structEmail.html#a570a81cd747437c9ea4357947731ae10">Email::security</a></div><div class="ttdeci">SecurityFlags security</div><div class="ttdoc">bit 0-10: flags, bit 11,12: application, bit 13: traditional pgp See: ncrypt/lib.h pgplib...</div><div class="ttdef"><b>Definition:</b> <a href="email_8h_source.html#l00039">email.h:39</a></div></div>
<div class="ttc" id="helpers_8c_html_a9154ba713ce99b0937f475eec7c61af9"><div class="ttname"><a href="helpers_8c.html#a9154ba713ce99b0937f475eec7c61af9">cs_subset_quad</a></div><div class="ttdeci">enum QuadOption cs_subset_quad(const struct ConfigSubset *sub, const char *name)</div><div class="ttdoc">Get a quad-value config item by name. </div><div class="ttdef"><b>Definition:</b> <a href="helpers_8c_source.html#l00204">helpers.c:204</a></div></div>
<div class="ttc" id="structBody_html_af77d79aadb278bef8f2829c268f2486f"><div class="ttname"><a href="structBody.html#af77d79aadb278bef8f2829c268f2486f">Body::type</a></div><div class="ttdeci">unsigned int type</div><div class="ttdoc">content-type primary type, ContentType </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00065">body.h:65</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_ae12c003463c99d28f65f1d6b8b053b2c"><div class="ttname"><a href="ncrypt_2lib_8h.html#ae12c003463c99d28f65f1d6b8b053b2c">SEC_SIGN</a></div><div class="ttdeci">#define SEC_SIGN</div><div class="ttdoc">Email is signed. </div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00076">lib.h:76</a></div></div>
<div class="ttc" id="cryptglue_8c_html_a2fe1beb64b690bc9f5f77c910c124a7d"><div class="ttname"><a href="cryptglue_8c.html#a2fe1beb64b690bc9f5f77c910c124a7d">crypt_smime_build_smime_entity</a></div><div class="ttdeci">struct Body * crypt_smime_build_smime_entity(struct Body *a, char *certlist)</div><div class="ttdoc">Wrapper for CryptModuleSpecs::smime_build_smime_entity() </div><div class="ttdef"><b>Definition:</b> <a href="cryptglue_8c_source.html#l00505">cryptglue.c:505</a></div></div>
<div class="ttc" id="structEnvelope_html_aa3d22c82ed26a0727508d26363e98ea7"><div class="ttname"><a href="structEnvelope.html#aa3d22c82ed26a0727508d26363e98ea7">Envelope::subject</a></div><div class="ttdeci">char * subject</div><div class="ttdoc">Email&amp;#39;s subject. </div><div class="ttdef"><b>Definition:</b> <a href="envelope_8h_source.html#l00066">envelope.h:66</a></div></div>
<div class="ttc" id="cryptglue_8c_html_aca6c03b64aab01e9d26c9708fd72c2c5"><div class="ttname"><a href="cryptglue_8c.html#aca6c03b64aab01e9d26c9708fd72c2c5">crypt_pgp_encrypt_message</a></div><div class="ttdeci">struct Body * crypt_pgp_encrypt_message(struct Mailbox *m, struct Email *e, struct Body *a, char *keylist, int sign, const struct AddressList *from)</div><div class="ttdoc">Wrapper for CryptModuleSpecs::pgp_encrypt_message() </div><div class="ttdef"><b>Definition:</b> <a href="cryptglue_8c_source.html#l00343">cryptglue.c:343</a></div></div>
<div class="ttc" id="mutt_2string_8c_html_ae9b6bbaa52b6ce51f2a384fe500e028e"><div class="ttname"><a href="mutt_2string_8c.html#ae9b6bbaa52b6ce51f2a384fe500e028e">mutt_str_replace</a></div><div class="ttdeci">char * mutt_str_replace(char **p, const char *s)</div><div class="ttdoc">Replace one string with another. </div><div class="ttdef"><b>Definition:</b> <a href="mutt_2string_8c_source.html#l00446">string.c:446</a></div></div>
<div class="ttc" id="logging_8h_html_acc1fd6d7ab1603e80e11e84e90d061e4"><div class="ttname"><a href="logging_8h.html#acc1fd6d7ab1603e80e11e84e90d061e4">mutt_error</a></div><div class="ttdeci">#define mutt_error(...)</div><div class="ttdef"><b>Definition:</b> <a href="logging_8h_source.html#l00084">logging.h:84</a></div></div>
<div class="ttc" id="cryptglue_8c_html_abb7ee2dc3d7dbc1ccb6a4986d9a9c92b"><div class="ttname"><a href="cryptglue_8c.html#abb7ee2dc3d7dbc1ccb6a4986d9a9c92b">crypt_pgp_sign_message</a></div><div class="ttdeci">struct Body * crypt_pgp_sign_message(struct Body *a, const struct AddressList *from)</div><div class="ttdoc">Wrapper for CryptModuleSpecs::sign_message() </div><div class="ttdef"><b>Definition:</b> <a href="cryptglue_8c_source.html#l00332">cryptglue.c:332</a></div></div>
<div class="ttc" id="parameter_8c_html_a0c6d54a87e015a496c8dbecfcd4002c9"><div class="ttname"><a href="parameter_8c.html#a0c6d54a87e015a496c8dbecfcd4002c9">mutt_param_get</a></div><div class="ttdeci">char * mutt_param_get(const struct ParameterList *pl, const char *s)</div><div class="ttdoc">Find a matching Parameter. </div><div class="ttdef"><b>Definition:</b> <a href="parameter_8c_source.html#l00084">parameter.c:84</a></div></div>
<div class="ttc" id="structNeoMutt_html_af98065e32243ce9331f93b7f30247d47"><div class="ttname"><a href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">NeoMutt::sub</a></div><div class="ttdeci">struct ConfigSubset * sub</div><div class="ttdoc">Inherited config items. </div><div class="ttdef"><b>Definition:</b> <a href="neomutt_8h_source.html#l00039">neomutt.h:39</a></div></div>
<div class="ttc" id="structBody_html_a782cee95e0064e3895b88248bdfc781a"><div class="ttname"><a href="structBody.html#a782cee95e0064e3895b88248bdfc781a">Body::parameter</a></div><div class="ttdeci">struct ParameterList parameter</div><div class="ttdoc">parameters of the content-type </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00039">body.h:39</a></div></div>
<div class="ttc" id="parameter_8c_html_a42249fc15b1e52df046a0a10de29da44"><div class="ttname"><a href="parameter_8c.html#a42249fc15b1e52df046a0a10de29da44">mutt_param_set</a></div><div class="ttdeci">void mutt_param_set(struct ParameterList *pl, const char *attribute, const char *value)</div><div class="ttdoc">Set a Parameter. </div><div class="ttdef"><b>Definition:</b> <a href="parameter_8c_source.html#l00110">parameter.c:110</a></div></div>
<div class="ttc" id="structEnvelope_html"><div class="ttname"><a href="structEnvelope.html">Envelope</a></div><div class="ttdoc">The header of an Email. </div><div class="ttdef"><b>Definition:</b> <a href="envelope_8h_source.html#l00054">envelope.h:54</a></div></div>
<div class="ttc" id="quad_8h_html_a738f558a271fe5035e0ee3b700ee35dbafee7088606c4724651c799a6a0b182b7"><div class="ttname"><a href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35dbafee7088606c4724651c799a6a0b182b7">MUTT_YES</a></div><div class="ttdoc">User answered &amp;#39;Yes&amp;#39;, or assume &amp;#39;Yes&amp;#39;. </div><div class="ttdef"><b>Definition:</b> <a href="quad_8h_source.html#l00039">quad.h:39</a></div></div>
<div class="ttc" id="cryptglue_8c_html_a18917d06dade2acda8b92af955f8663d"><div class="ttname"><a href="cryptglue_8c.html#a18917d06dade2acda8b92af955f8663d">crypt_pgp_traditional_encryptsign</a></div><div class="ttdeci">struct Body * crypt_pgp_traditional_encryptsign(struct Body *a, SecurityFlags flags, char *keylist)</div><div class="ttdoc">Wrapper for CryptModuleSpecs::pgp_traditional_encryptsign() </div><div class="ttdef"><b>Definition:</b> <a href="cryptglue_8c_source.html#l00299">cryptglue.c:299</a></div></div>
</div><!-- fragment --><div id="dynsection-25" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-25-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-25-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-25-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_afb7fbdc0157b9f7fd68b378232d554fc_cgraph.svg" width="744" height="1352"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div id="dynsection-26" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-26-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-26-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-26-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_afb7fbdc0157b9f7fd68b378232d554fc_icgraph.svg" width="519" height="139"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="aced59da2579d14e9b136b372ce683bc5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aced59da2579d14e9b136b372ce683bc5">&#9670;&nbsp;</a></span>mutt_protected_headers_handler()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mutt_protected_headers_handler </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structBody.html">Body</a> *&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structState.html">State</a> *&#160;</td>
          <td class="paramname"><em>s</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Process a protected header - Implements <a class="el" href="handler_8c.html#a05af946c0d51f30e6b10e75510d79458" title="Manage a PGP or S/MIME encrypted MIME part. ">handler_t</a>. </p>

<p class="definition">Definition at line <a class="el" href="crypt_8c_source.html#l01126">1126</a> of file <a class="el" href="crypt_8c_source.html">crypt.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;{</div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> c_crypt_protected_headers_read =</div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;      <a class="code" href="helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(<a class="code" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;crypt_protected_headers_read&quot;</span>);</div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;  <span class="keywordflow">if</span> (c_crypt_protected_headers_read &amp;&amp; b-&gt;<a class="code" href="structBody.html#a62f6c9b4245ed3b6b9296adb45aa4010">mime_headers</a>)</div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;  {</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;    <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structBody.html#a62f6c9b4245ed3b6b9296adb45aa4010">mime_headers</a>-&gt;<a class="code" href="structEnvelope.html#aa3d22c82ed26a0727508d26363e98ea7">subject</a>)</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;    {</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">bool</span> display = (s-&gt;<a class="code" href="structState.html#a5d855f7d518fde2ac4e8e409cbb24ad3">flags</a> &amp; <a class="code" href="state_8h.html#a5f9dc9c8012c0aeeacaa122b882c65a6">MUTT_DISPLAY</a>);</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">bool</span> c_weed = <a class="code" href="helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(<a class="code" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;weed&quot;</span>);</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;      <span class="keywordflow">if</span> (display &amp;&amp; c_weed &amp;&amp; <a class="code" href="parse_8c.html#a5f2728949322a1a6210d61d9629005d1">mutt_matches_ignore</a>(<span class="stringliteral">&quot;subject&quot;</span>))</div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;        <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;      <a class="code" href="state_8c.html#a9e0c1a01c087cce0d8be1eaaa8a6c7f8">state_mark_protected_header</a>(s);</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">short</span> c_wrap = <a class="code" href="helpers_8c.html#a96039a9f8d37daad993ae7b490510339">cs_subset_number</a>(<a class="code" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;wrap&quot;</span>);</div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;      <span class="keywordtype">int</span> wraplen = display ? <a class="code" href="mutt__window_8c.html#abab364f87c187982863f3bbed871f7e6">mutt_window_wrap_cols</a>(s-&gt;<a class="code" href="structState.html#a2c506e7d8513e59e6162cdc5d6f9f320">wraplen</a>, c_wrap) : 0;</div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;      <a class="code" href="header_8c.html#acb110e1fda6d0ddb3cdf8074ba439441">mutt_write_one_header</a>(s-&gt;<a class="code" href="structState.html#a88fc722d3012ebf69d3a061cbf6bc296">fp_out</a>, <span class="stringliteral">&quot;Subject&quot;</span>, b-&gt;<a class="code" href="structBody.html#a62f6c9b4245ed3b6b9296adb45aa4010">mime_headers</a>-&gt;<a class="code" href="structEnvelope.html#aa3d22c82ed26a0727508d26363e98ea7">subject</a>, s-&gt;<a class="code" href="structState.html#a91d10ebc85ef4f64a22ccb0d799758b7">prefix</a>,</div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;                            wraplen, display ? <a class="code" href="copy_8h.html#a78788518de9fe57639d22d204a686383">CH_DISPLAY</a> : <a class="code" href="copy_8h.html#af310a44d7c96b22de90934cb18634b58">CH_NO_FLAGS</a>, <a class="code" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>);</div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;      <a class="code" href="state_8h.html#a0ea44a0777d9d2712ba6db4350f1e671">state_puts</a>(s, <span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;    }</div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;  }</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;</div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;}</div><div class="ttc" id="parse_8c_html_a5f2728949322a1a6210d61d9629005d1"><div class="ttname"><a href="parse_8c.html#a5f2728949322a1a6210d61d9629005d1">mutt_matches_ignore</a></div><div class="ttdeci">bool mutt_matches_ignore(const char *s)</div><div class="ttdoc">Does the string match the ignore list. </div><div class="ttdef"><b>Definition:</b> <a href="parse_8c_source.html#l00316">parse.c:316</a></div></div>
<div class="ttc" id="state_8h_html_a5f9dc9c8012c0aeeacaa122b882c65a6"><div class="ttname"><a href="state_8h.html#a5f9dc9c8012c0aeeacaa122b882c65a6">MUTT_DISPLAY</a></div><div class="ttdeci">#define MUTT_DISPLAY</div><div class="ttdoc">Output is displayed to the user. </div><div class="ttdef"><b>Definition:</b> <a href="state_8h_source.html#l00032">state.h:32</a></div></div>
<div class="ttc" id="structBody_html_a62f6c9b4245ed3b6b9296adb45aa4010"><div class="ttname"><a href="structBody.html#a62f6c9b4245ed3b6b9296adb45aa4010">Body::mime_headers</a></div><div class="ttdeci">struct Envelope * mime_headers</div><div class="ttdoc">Memory hole protected headers. </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00063">body.h:63</a></div></div>
<div class="ttc" id="helpers_8c_html_ae50f679dd6c5bd1ba820884c8602f038"><div class="ttname"><a href="helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a></div><div class="ttdeci">bool cs_subset_bool(const struct ConfigSubset *sub, const char *name)</div><div class="ttdoc">Get a boolean config item by name. </div><div class="ttdef"><b>Definition:</b> <a href="helpers_8c_source.html#l00071">helpers.c:71</a></div></div>
<div class="ttc" id="state_8h_html_a0ea44a0777d9d2712ba6db4350f1e671"><div class="ttname"><a href="state_8h.html#a0ea44a0777d9d2712ba6db4350f1e671">state_puts</a></div><div class="ttdeci">#define state_puts(STATE, STR)</div><div class="ttdef"><b>Definition:</b> <a href="state_8h_source.html#l00055">state.h:55</a></div></div>
<div class="ttc" id="structState_html_a91d10ebc85ef4f64a22ccb0d799758b7"><div class="ttname"><a href="structState.html#a91d10ebc85ef4f64a22ccb0d799758b7">State::prefix</a></div><div class="ttdeci">char * prefix</div><div class="ttdoc">String to add to the beginning of each output line. </div><div class="ttdef"><b>Definition:</b> <a href="state_8h_source.html#l00048">state.h:48</a></div></div>
<div class="ttc" id="structState_html_a88fc722d3012ebf69d3a061cbf6bc296"><div class="ttname"><a href="structState.html#a88fc722d3012ebf69d3a061cbf6bc296">State::fp_out</a></div><div class="ttdeci">FILE * fp_out</div><div class="ttdoc">File to write to. </div><div class="ttdef"><b>Definition:</b> <a href="state_8h_source.html#l00047">state.h:47</a></div></div>
<div class="ttc" id="helpers_8c_html_a96039a9f8d37daad993ae7b490510339"><div class="ttname"><a href="helpers_8c.html#a96039a9f8d37daad993ae7b490510339">cs_subset_number</a></div><div class="ttdeci">short cs_subset_number(const struct ConfigSubset *sub, const char *name)</div><div class="ttdoc">Get a number config item by name. </div><div class="ttdef"><b>Definition:</b> <a href="helpers_8c_source.html#l00159">helpers.c:159</a></div></div>
<div class="ttc" id="structNeoMutt_html"><div class="ttname"><a href="structNeoMutt.html">NeoMutt</a></div><div class="ttdoc">Container for Accounts, Notifications. </div><div class="ttdef"><b>Definition:</b> <a href="neomutt_8h_source.html#l00036">neomutt.h:36</a></div></div>
<div class="ttc" id="structState_html_a5d855f7d518fde2ac4e8e409cbb24ad3"><div class="ttname"><a href="structState.html#a5d855f7d518fde2ac4e8e409cbb24ad3">State::flags</a></div><div class="ttdeci">StateFlags flags</div><div class="ttdoc">Flags, e.g. MUTT_DISPLAY. </div><div class="ttdef"><b>Definition:</b> <a href="state_8h_source.html#l00049">state.h:49</a></div></div>
<div class="ttc" id="structState_html_a2c506e7d8513e59e6162cdc5d6f9f320"><div class="ttname"><a href="structState.html#a2c506e7d8513e59e6162cdc5d6f9f320">State::wraplen</a></div><div class="ttdeci">int wraplen</div><div class="ttdoc">Width to wrap lines to (when flags &amp; MUTT_DISPLAY) </div><div class="ttdef"><b>Definition:</b> <a href="state_8h_source.html#l00050">state.h:50</a></div></div>
<div class="ttc" id="copy_8h_html_af310a44d7c96b22de90934cb18634b58"><div class="ttname"><a href="copy_8h.html#af310a44d7c96b22de90934cb18634b58">CH_NO_FLAGS</a></div><div class="ttdeci">#define CH_NO_FLAGS</div><div class="ttdoc">No flags are set. </div><div class="ttdef"><b>Definition:</b> <a href="copy_8h_source.html#l00051">copy.h:51</a></div></div>
<div class="ttc" id="copy_8h_html_a78788518de9fe57639d22d204a686383"><div class="ttname"><a href="copy_8h.html#a78788518de9fe57639d22d204a686383">CH_DISPLAY</a></div><div class="ttdeci">#define CH_DISPLAY</div><div class="ttdoc">Display result to user. </div><div class="ttdef"><b>Definition:</b> <a href="copy_8h_source.html#l00070">copy.h:70</a></div></div>
<div class="ttc" id="mutt__window_8c_html_abab364f87c187982863f3bbed871f7e6"><div class="ttname"><a href="mutt__window_8c.html#abab364f87c187982863f3bbed871f7e6">mutt_window_wrap_cols</a></div><div class="ttdeci">int mutt_window_wrap_cols(int width, short wrap)</div><div class="ttdoc">Calculate the wrap column for a given screen width. </div><div class="ttdef"><b>Definition:</b> <a href="mutt__window_8c_source.html#l00386">mutt_window.c:386</a></div></div>
<div class="ttc" id="state_8c_html_a9e0c1a01c087cce0d8be1eaaa8a6c7f8"><div class="ttname"><a href="state_8c.html#a9e0c1a01c087cce0d8be1eaaa8a6c7f8">state_mark_protected_header</a></div><div class="ttdeci">void state_mark_protected_header(struct State *s)</div><div class="ttdoc">Write a unique marker around protected headers. </div><div class="ttdef"><b>Definition:</b> <a href="state_8c_source.html#l00089">state.c:89</a></div></div>
<div class="ttc" id="structEnvelope_html_aa3d22c82ed26a0727508d26363e98ea7"><div class="ttname"><a href="structEnvelope.html#aa3d22c82ed26a0727508d26363e98ea7">Envelope::subject</a></div><div class="ttdeci">char * subject</div><div class="ttdoc">Email&amp;#39;s subject. </div><div class="ttdef"><b>Definition:</b> <a href="envelope_8h_source.html#l00066">envelope.h:66</a></div></div>
<div class="ttc" id="structNeoMutt_html_af98065e32243ce9331f93b7f30247d47"><div class="ttname"><a href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">NeoMutt::sub</a></div><div class="ttdeci">struct ConfigSubset * sub</div><div class="ttdoc">Inherited config items. </div><div class="ttdef"><b>Definition:</b> <a href="neomutt_8h_source.html#l00039">neomutt.h:39</a></div></div>
<div class="ttc" id="header_8c_html_acb110e1fda6d0ddb3cdf8074ba439441"><div class="ttname"><a href="header_8c.html#acb110e1fda6d0ddb3cdf8074ba439441">mutt_write_one_header</a></div><div class="ttdeci">int mutt_write_one_header(FILE *fp, const char *tag, const char *value, const char *pfx, int wraplen, CopyHeaderFlags chflags, struct ConfigSubset *sub)</div><div class="ttdoc">Write one header line to a file. </div><div class="ttdef"><b>Definition:</b> <a href="header_8c_source.html#l00420">header.c:420</a></div></div>
</div><!-- fragment --><div id="dynsection-27" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-27-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-27-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-27-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_aced59da2579d14e9b136b372ce683bc5_cgraph.svg" width="614" height="264"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div id="dynsection-28" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-28-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-28-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-28-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_aced59da2579d14e9b136b372ce683bc5_icgraph.svg" width="439" height="286"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a52c65477f5b80ad3dc8028663653771d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a52c65477f5b80ad3dc8028663653771d">&#9670;&nbsp;</a></span>mutt_should_hide_protected_subject()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool mutt_should_hide_protected_subject </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structEmail.html">Email</a> *&#160;</td>
          <td class="paramname"><em>e</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Should <a class="el" href="structNeoMutt.html" title="Container for Accounts, Notifications. ">NeoMutt</a> hide the protected subject? </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">e</td><td><a class="el" href="structEmail.html" title="The envelope/body of an email. ">Email</a> to test </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">true</td><td>The subject should be protected </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="crypt_8c_source.html#l01108">1108</a> of file <a class="el" href="crypt_8c_source.html">crypt.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;{</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> c_crypt_protected_headers_write =</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;      <a class="code" href="helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(<a class="code" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;crypt_protected_headers_write&quot;</span>);</div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keyword">const</span> c_crypt_protected_headers_subject =</div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;      <a class="code" href="helpers_8c.html#ac477c591155aa4ae0452bbabc0affffe">cs_subset_string</a>(<a class="code" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;crypt_protected_headers_subject&quot;</span>);</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;  <span class="keywordflow">if</span> (c_crypt_protected_headers_write &amp;&amp; (e-&gt;<a class="code" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> &amp; (<a class="code" href="ncrypt_2lib_8h.html#aacaa4abd4c0696e260b7a0f1d466360a">SEC_ENCRYPT</a> | <a class="code" href="ncrypt_2lib_8h.html#a0b36be5c32ca90d8f2caef9ea9d627fc">SEC_AUTOCRYPT</a>)) &amp;&amp;</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;      !(e-&gt;<a class="code" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> &amp; <a class="code" href="ncrypt_2lib_8h.html#a074f827472ad45f11ec1132cdfed2daf">SEC_INLINE</a>) &amp;&amp; c_crypt_protected_headers_subject)</div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;  {</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;  }</div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;}</div><div class="ttc" id="helpers_8c_html_ae50f679dd6c5bd1ba820884c8602f038"><div class="ttname"><a href="helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a></div><div class="ttdeci">bool cs_subset_bool(const struct ConfigSubset *sub, const char *name)</div><div class="ttdoc">Get a boolean config item by name. </div><div class="ttdef"><b>Definition:</b> <a href="helpers_8c_source.html#l00071">helpers.c:71</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_aacaa4abd4c0696e260b7a0f1d466360a"><div class="ttname"><a href="ncrypt_2lib_8h.html#aacaa4abd4c0696e260b7a0f1d466360a">SEC_ENCRYPT</a></div><div class="ttdeci">#define SEC_ENCRYPT</div><div class="ttdoc">Email is encrypted. </div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00075">lib.h:75</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a0b36be5c32ca90d8f2caef9ea9d627fc"><div class="ttname"><a href="ncrypt_2lib_8h.html#a0b36be5c32ca90d8f2caef9ea9d627fc">SEC_AUTOCRYPT</a></div><div class="ttdeci">#define SEC_AUTOCRYPT</div><div class="ttdoc">(Autocrypt) Message will be, or was Autocrypt encrypt+signed </div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00084">lib.h:84</a></div></div>
<div class="ttc" id="structNeoMutt_html"><div class="ttname"><a href="structNeoMutt.html">NeoMutt</a></div><div class="ttdoc">Container for Accounts, Notifications. </div><div class="ttdef"><b>Definition:</b> <a href="neomutt_8h_source.html#l00036">neomutt.h:36</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a074f827472ad45f11ec1132cdfed2daf"><div class="ttname"><a href="ncrypt_2lib_8h.html#a074f827472ad45f11ec1132cdfed2daf">SEC_INLINE</a></div><div class="ttdeci">#define SEC_INLINE</div><div class="ttdoc">Email has an inline signature. </div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00082">lib.h:82</a></div></div>
<div class="ttc" id="helpers_8c_html_ac477c591155aa4ae0452bbabc0affffe"><div class="ttname"><a href="helpers_8c.html#ac477c591155aa4ae0452bbabc0affffe">cs_subset_string</a></div><div class="ttdeci">const char * cs_subset_string(const struct ConfigSubset *sub, const char *name)</div><div class="ttdoc">Get a string config item by name. </div><div class="ttdef"><b>Definition:</b> <a href="helpers_8c_source.html#l00295">helpers.c:295</a></div></div>
<div class="ttc" id="structEmail_html_a570a81cd747437c9ea4357947731ae10"><div class="ttname"><a href="structEmail.html#a570a81cd747437c9ea4357947731ae10">Email::security</a></div><div class="ttdeci">SecurityFlags security</div><div class="ttdoc">bit 0-10: flags, bit 11,12: application, bit 13: traditional pgp See: ncrypt/lib.h pgplib...</div><div class="ttdef"><b>Definition:</b> <a href="email_8h_source.html#l00039">email.h:39</a></div></div>
<div class="ttc" id="structNeoMutt_html_af98065e32243ce9331f93b7f30247d47"><div class="ttname"><a href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">NeoMutt::sub</a></div><div class="ttdeci">struct ConfigSubset * sub</div><div class="ttdoc">Inherited config items. </div><div class="ttdef"><b>Definition:</b> <a href="neomutt_8h_source.html#l00039">neomutt.h:39</a></div></div>
</div><!-- fragment --><div id="dynsection-29" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-29-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-29-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-29-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_a52c65477f5b80ad3dc8028663653771d_cgraph.svg" width="396" height="88"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div id="dynsection-30" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-30-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-30-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-30-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_a52c65477f5b80ad3dc8028663653771d_icgraph.svg" width="384" height="139"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a3e7ec2b5bc58891704d4c49159cbef9a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3e7ec2b5bc58891704d4c49159cbef9a">&#9670;&nbsp;</a></span>mutt_signed_handler()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mutt_signed_handler </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structBody.html">Body</a> *&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structState.html">State</a> *&#160;</td>
          <td class="paramname"><em>s</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Verify a "multipart/signed" body - Implements <a class="el" href="handler_8c.html#a05af946c0d51f30e6b10e75510d79458" title="Manage a PGP or S/MIME encrypted MIME part. ">handler_t</a>. </p>

<p class="definition">Definition at line <a class="el" href="crypt_8c_source.html#l01156">1156</a> of file <a class="el" href="crypt_8c_source.html">crypt.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;{</div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a>)</div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;  <span class="keywordtype">bool</span> inconsistent = <span class="keyword">false</span>;</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;  <span class="keyword">struct </span><a class="code" href="structBody.html">Body</a> *top = b;</div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;  <span class="keyword">struct </span><a class="code" href="structBody.html">Body</a> **signatures = NULL;</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;  <span class="keywordtype">int</span> sigcnt = 0;</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;  <span class="keywordtype">int</span> rc = 0;</div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;  <span class="keyword">struct </span><a class="code" href="structBuffer.html">Buffer</a> *tempfile = NULL;</div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;  b = b-&gt;<a class="code" href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">parts</a>;</div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;  <a class="code" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a> signed_type = <a class="code" href="crypt_8c.html#a345fb1ff241b3fc778632947c2b08d37">mutt_is_multipart_signed</a>(top);</div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;  <span class="keywordflow">if</span> (signed_type == <a class="code" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a>)</div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;  {</div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;    <span class="comment">/* A null protocol value is already checked for in mutt_body_handler() */</span></div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;    <a class="code" href="state_8c.html#a274bd2d5df990d61848a6be9b18840f7">state_printf</a>(s,</div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;                 <a class="code" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;[-- Error: &quot;</span></div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;                   <span class="stringliteral">&quot;Unknown multipart/signed protocol %s --]\n\n&quot;</span>),</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;                 <a class="code" href="parameter_8c.html#a0c6d54a87e015a496c8dbecfcd4002c9">mutt_param_get</a>(&amp;top-&gt;<a class="code" href="structBody.html#a782cee95e0064e3895b88248bdfc781a">parameter</a>, <span class="stringliteral">&quot;protocol&quot;</span>));</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="handler_8c.html#adae8bf0eec9bee0bd62f639bbcf8599f">mutt_body_handler</a>(b, s);</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;  }</div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;</div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;  <span class="keywordflow">if</span> (!(b &amp;&amp; b-&gt;<a class="code" href="structBody.html#ac55cdfce46eed13151dcfe9b329d254c">next</a>))</div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;    inconsistent = <span class="keyword">true</span>;</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;  {</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;    <span class="keywordflow">switch</span> (signed_type)</div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;    {</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="ncrypt_2lib_8h.html#ae12c003463c99d28f65f1d6b8b053b2c">SEC_SIGN</a>:</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;        <span class="keywordflow">if</span> ((b-&gt;<a class="code" href="structBody.html#ac55cdfce46eed13151dcfe9b329d254c">next</a>-&gt;<a class="code" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a> != <a class="code" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79a877e24e62c85f20ff0e0f09ab983031e">TYPE_MULTIPART</a>) || !<a class="code" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(b-&gt;<a class="code" href="structBody.html#ac55cdfce46eed13151dcfe9b329d254c">next</a>-&gt;<a class="code" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>, <span class="stringliteral">&quot;mixed&quot;</span>))</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;        {</div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;          inconsistent = <span class="keyword">true</span>;</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;        }</div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="ncrypt_2lib_8h.html#a14f75a650c49341776276f44881d54b2">PGP_SIGN</a>:</div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;        <span class="keywordflow">if</span> ((b-&gt;<a class="code" href="structBody.html#ac55cdfce46eed13151dcfe9b329d254c">next</a>-&gt;<a class="code" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a> != <a class="code" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79ac5074066199e3f540550ca0b1a38978e">TYPE_APPLICATION</a>) ||</div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;            !<a class="code" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(b-&gt;<a class="code" href="structBody.html#ac55cdfce46eed13151dcfe9b329d254c">next</a>-&gt;<a class="code" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>, <span class="stringliteral">&quot;pgp-signature&quot;</span>))</div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;        {</div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;          inconsistent = <span class="keyword">true</span>;</div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;        }</div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="ncrypt_2lib_8h.html#a67114d960e61fc36c467f4bf08d37335">SMIME_SIGN</a>:</div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;        <span class="keywordflow">if</span> ((b-&gt;<a class="code" href="structBody.html#ac55cdfce46eed13151dcfe9b329d254c">next</a>-&gt;<a class="code" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a> != <a class="code" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79ac5074066199e3f540550ca0b1a38978e">TYPE_APPLICATION</a>) ||</div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;            (!<a class="code" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(b-&gt;<a class="code" href="structBody.html#ac55cdfce46eed13151dcfe9b329d254c">next</a>-&gt;<a class="code" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>, <span class="stringliteral">&quot;x-pkcs7-signature&quot;</span>) &amp;&amp;</div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;             !<a class="code" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(b-&gt;<a class="code" href="structBody.html#ac55cdfce46eed13151dcfe9b329d254c">next</a>-&gt;<a class="code" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>, <span class="stringliteral">&quot;pkcs7-signature&quot;</span>)))</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;        {</div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;          inconsistent = <span class="keyword">true</span>;</div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;        }</div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;      <span class="keywordflow">default</span>:</div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;        inconsistent = <span class="keyword">true</span>;</div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;    }</div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;  }</div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;  <span class="keywordflow">if</span> (inconsistent)</div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;  {</div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;    <a class="code" href="state_8c.html#a8d8c6b5b8e9a2427e68fab5f5403cb63">state_attach_puts</a>(s, <a class="code" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;[-- Error: Missing or bad-format multipart/signed &quot;</span></div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;                           <span class="stringliteral">&quot;signature --]\n\n&quot;</span>));</div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="handler_8c.html#adae8bf0eec9bee0bd62f639bbcf8599f">mutt_body_handler</a>(b, s);</div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;  }</div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;</div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;  <span class="keywordflow">if</span> (s-&gt;<a class="code" href="structState.html#a5d855f7d518fde2ac4e8e409cbb24ad3">flags</a> &amp; <a class="code" href="state_8h.html#a5f9dc9c8012c0aeeacaa122b882c65a6">MUTT_DISPLAY</a>)</div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;  {</div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;    <a class="code" href="crypt_8c.html#a3f891994e68f268a2b82c0e2e60bf079">crypt_fetch_signatures</a>(&amp;signatures, b-&gt;<a class="code" href="structBody.html#ac55cdfce46eed13151dcfe9b329d254c">next</a>, &amp;sigcnt);</div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;</div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;    <span class="keywordflow">if</span> (sigcnt != 0)</div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;    {</div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;      tempfile = <a class="code" href="pool_8c.html#a2129d5ea0085753afdd37cf62161845d">mutt_buffer_pool_get</a>();</div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;      <a class="code" href="muttlib_8h.html#a7f1db9db6f710a84cace77248096e2ac">mutt_buffer_mktemp</a>(tempfile);</div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;      <span class="keywordtype">bool</span> goodsig = <span class="keyword">true</span>;</div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="crypt_8c.html#a32cadd5ce0071d7f003dde3d80f52d5d">crypt_write_signed</a>(b, s, <a class="code" href="buffer_8h.html#a4aca040fb75bc1dfc086cbfbf14ac8cd">mutt_buffer_string</a>(tempfile)) == 0)</div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;      {</div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; sigcnt; i++)</div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;        {</div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;          <span class="keywordflow">if</span> (((<a class="code" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a>) != 0) &amp;&amp;</div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;              (signatures[i]-&gt;type == <a class="code" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79ac5074066199e3f540550ca0b1a38978e">TYPE_APPLICATION</a>) &amp;&amp;</div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;              <a class="code" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(signatures[i]-&gt;subtype, <span class="stringliteral">&quot;pgp-signature&quot;</span>))</div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;          {</div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="cryptglue_8c.html#a9457dc1f6c58f46461c4866e08946b5c">crypt_pgp_verify_one</a>(signatures[i], s, <a class="code" href="buffer_8h.html#a4aca040fb75bc1dfc086cbfbf14ac8cd">mutt_buffer_string</a>(tempfile)) != 0)</div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;              goodsig = <span class="keyword">false</span>;</div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;</div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;          }</div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;          <span class="keywordflow">if</span> (((<a class="code" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code" href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a>) != 0) &amp;&amp;</div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;              (signatures[i]-&gt;type == <a class="code" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79ac5074066199e3f540550ca0b1a38978e">TYPE_APPLICATION</a>) &amp;&amp;</div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;              (<a class="code" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(signatures[i]-&gt;subtype, <span class="stringliteral">&quot;x-pkcs7-signature&quot;</span>) ||</div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;               <a class="code" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(signatures[i]-&gt;subtype, <span class="stringliteral">&quot;pkcs7-signature&quot;</span>)))</div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;          {</div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="cryptglue_8c.html#a805ac5f7d1ad9d7714f01d2e13e8b6be">crypt_smime_verify_one</a>(signatures[i], s, <a class="code" href="buffer_8h.html#a4aca040fb75bc1dfc086cbfbf14ac8cd">mutt_buffer_string</a>(tempfile)) != 0)</div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;              goodsig = <span class="keyword">false</span>;</div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;</div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;          }</div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;</div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;          <a class="code" href="state_8c.html#a274bd2d5df990d61848a6be9b18840f7">state_printf</a>(s,</div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;                       <a class="code" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;[-- Warning: &quot;</span></div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;                         <span class="stringliteral">&quot;We can&#39;t verify %s/%s signatures. --]\n\n&quot;</span>),</div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;                       <a class="code" href="mime_8h.html#ab12186b6fac3d22b88fac67700f07b1d">TYPE</a>(signatures[i]), signatures[i]-&gt;subtype);</div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;        }</div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;      }</div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;</div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;      <a class="code" href="file_8c.html#ae57463c2854c006a3c67b78736e9056e">mutt_file_unlink</a>(<a class="code" href="buffer_8h.html#a4aca040fb75bc1dfc086cbfbf14ac8cd">mutt_buffer_string</a>(tempfile));</div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;      <a class="code" href="pool_8c.html#a08b48e2ac8849341888ee7429cc5093c">mutt_buffer_pool_release</a>(&amp;tempfile);</div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;</div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;      top-&gt;<a class="code" href="structBody.html#ae4b2706a5c4601ae1497a96e047d8f5e">goodsig</a> = goodsig;</div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;      top-&gt;<a class="code" href="structBody.html#a4de063a5f09cb7376f9fde6bb0fe48bc">badsig</a> = !goodsig;</div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;</div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;      <span class="comment">/* Now display the signed body */</span></div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;      <a class="code" href="state_8c.html#a8d8c6b5b8e9a2427e68fab5f5403cb63">state_attach_puts</a>(s, <a class="code" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;[-- The following data is signed --]\n\n&quot;</span>));</div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;</div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;      <a class="code" href="crypt_8c.html#aced59da2579d14e9b136b372ce683bc5">mutt_protected_headers_handler</a>(b, s);</div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;</div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;      <a class="code" href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;signatures);</div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;    }</div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;    {</div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;      <a class="code" href="state_8c.html#a8d8c6b5b8e9a2427e68fab5f5403cb63">state_attach_puts</a>(s,</div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;                        <a class="code" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;[-- Warning: Can&#39;t find any signatures. --]\n\n&quot;</span>));</div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;    }</div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;  }</div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;</div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;  rc = <a class="code" href="handler_8c.html#adae8bf0eec9bee0bd62f639bbcf8599f">mutt_body_handler</a>(b, s);</div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;</div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;  <span class="keywordflow">if</span> ((s-&gt;<a class="code" href="structState.html#a5d855f7d518fde2ac4e8e409cbb24ad3">flags</a> &amp; <a class="code" href="state_8h.html#a5f9dc9c8012c0aeeacaa122b882c65a6">MUTT_DISPLAY</a>) &amp;&amp; (sigcnt != 0))</div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;    <a class="code" href="state_8c.html#a8d8c6b5b8e9a2427e68fab5f5403cb63">state_attach_puts</a>(s, <a class="code" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;\n[-- End of signed data --]\n&quot;</span>));</div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;</div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;  <span class="keywordflow">return</span> rc;</div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;}</div><div class="ttc" id="state_8c_html_a274bd2d5df990d61848a6be9b18840f7"><div class="ttname"><a href="state_8c.html#a274bd2d5df990d61848a6be9b18840f7">state_printf</a></div><div class="ttdeci">int state_printf(struct State *s, const char *fmt,...)</div><div class="ttdoc">Write a formatted string to the State. </div><div class="ttdef"><b>Definition:</b> <a href="state_8c_source.html#l00187">state.c:187</a></div></div>
<div class="ttc" id="muttlib_8h_html_a7f1db9db6f710a84cace77248096e2ac"><div class="ttname"><a href="muttlib_8h.html#a7f1db9db6f710a84cace77248096e2ac">mutt_buffer_mktemp</a></div><div class="ttdeci">#define mutt_buffer_mktemp(buf)</div><div class="ttdef"><b>Definition:</b> <a href="muttlib_8h_source.html#l00074">muttlib.h:74</a></div></div>
<div class="ttc" id="state_8h_html_a5f9dc9c8012c0aeeacaa122b882c65a6"><div class="ttname"><a href="state_8h.html#a5f9dc9c8012c0aeeacaa122b882c65a6">MUTT_DISPLAY</a></div><div class="ttdeci">#define MUTT_DISPLAY</div><div class="ttdoc">Output is displayed to the user. </div><div class="ttdef"><b>Definition:</b> <a href="state_8h_source.html#l00032">state.h:32</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a67114d960e61fc36c467f4bf08d37335"><div class="ttname"><a href="ncrypt_2lib_8h.html#a67114d960e61fc36c467f4bf08d37335">SMIME_SIGN</a></div><div class="ttdeci">#define SMIME_SIGN</div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00100">lib.h:100</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_ad980bff69bb614893ad8e7e1c28a5023"><div class="ttname"><a href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a></div><div class="ttdeci">#define WithCrypto</div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00113">lib.h:113</a></div></div>
<div class="ttc" id="pool_8c_html_a2129d5ea0085753afdd37cf62161845d"><div class="ttname"><a href="pool_8c.html#a2129d5ea0085753afdd37cf62161845d">mutt_buffer_pool_get</a></div><div class="ttdeci">struct Buffer * mutt_buffer_pool_get(void)</div><div class="ttdoc">Get a Buffer from the pool. </div><div class="ttdef"><b>Definition:</b> <a href="pool_8c_source.html#l00101">pool.c:101</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a95845954210adfc850d5602843f858d4"><div class="ttname"><a href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a></div><div class="ttdeci">#define SEC_NO_FLAGS</div><div class="ttdoc">No flags are set. </div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00074">lib.h:74</a></div></div>
<div class="ttc" id="pool_8c_html_a08b48e2ac8849341888ee7429cc5093c"><div class="ttname"><a href="pool_8c.html#a08b48e2ac8849341888ee7429cc5093c">mutt_buffer_pool_release</a></div><div class="ttdeci">void mutt_buffer_pool_release(struct Buffer **pbuf)</div><div class="ttdoc">Free a Buffer from the pool. </div><div class="ttdef"><b>Definition:</b> <a href="pool_8c_source.html#l00112">pool.c:112</a></div></div>
<div class="ttc" id="file_8c_html_ae57463c2854c006a3c67b78736e9056e"><div class="ttname"><a href="file_8c.html#ae57463c2854c006a3c67b78736e9056e">mutt_file_unlink</a></div><div class="ttdeci">void mutt_file_unlink(const char *s)</div><div class="ttdoc">Delete a file, carefully. </div><div class="ttdef"><b>Definition:</b> <a href="file_8c_source.html#l00195">file.c:195</a></div></div>
<div class="ttc" id="structBuffer_html"><div class="ttname"><a href="structBuffer.html">Buffer</a></div><div class="ttdoc">String manipulation buffer. </div><div class="ttdef"><b>Definition:</b> <a href="buffer_8h_source.html#l00033">buffer.h:33</a></div></div>
<div class="ttc" id="mutt_2message_8h_html_a479d658dfd60fe8d9709ec67a58b34ca"><div class="ttname"><a href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a></div><div class="ttdeci">#define _(a)</div><div class="ttdef"><b>Definition:</b> <a href="mutt_2message_8h_source.html#l00028">message.h:28</a></div></div>
<div class="ttc" id="structBody_html_ac55cdfce46eed13151dcfe9b329d254c"><div class="ttname"><a href="structBody.html#ac55cdfce46eed13151dcfe9b329d254c">Body::next</a></div><div class="ttdeci">struct Body * next</div><div class="ttdoc">next attachment in the list </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00053">body.h:53</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a2073a168ca3a64c3c30d13fa4917a05d"><div class="ttname"><a href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a></div><div class="ttdeci">uint16_t SecurityFlags</div><div class="ttdoc">Flags, e.g. SEC_ENCRYPT. </div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00071">lib.h:71</a></div></div>
<div class="ttc" id="crypt_8c_html_a32cadd5ce0071d7f003dde3d80f52d5d"><div class="ttname"><a href="crypt_8c.html#a32cadd5ce0071d7f003dde3d80f52d5d">crypt_write_signed</a></div><div class="ttdeci">int crypt_write_signed(struct Body *a, struct State *s, const char *tempfile)</div><div class="ttdoc">Write the message body/part. </div><div class="ttdef"><b>Definition:</b> <a href="crypt_8c_source.html#l00770">crypt.c:770</a></div></div>
<div class="ttc" id="structBody_html"><div class="ttname"><a href="structBody.html">Body</a></div><div class="ttdoc">The body of an email. </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00034">body.h:34</a></div></div>
<div class="ttc" id="buffer_8h_html_a4aca040fb75bc1dfc086cbfbf14ac8cd"><div class="ttname"><a href="buffer_8h.html#a4aca040fb75bc1dfc086cbfbf14ac8cd">mutt_buffer_string</a></div><div class="ttdeci">static const char * mutt_buffer_string(const struct Buffer *buf)</div><div class="ttdoc">Convert a buffer to a const char * &quot;string&quot;. </div><div class="ttdef"><b>Definition:</b> <a href="buffer_8h_source.html#l00077">buffer.h:77</a></div></div>
<div class="ttc" id="structState_html_a5d855f7d518fde2ac4e8e409cbb24ad3"><div class="ttname"><a href="structState.html#a5d855f7d518fde2ac4e8e409cbb24ad3">State::flags</a></div><div class="ttdeci">StateFlags flags</div><div class="ttdoc">Flags, e.g. MUTT_DISPLAY. </div><div class="ttdef"><b>Definition:</b> <a href="state_8h_source.html#l00049">state.h:49</a></div></div>
<div class="ttc" id="structBody_html_a4de063a5f09cb7376f9fde6bb0fe48bc"><div class="ttname"><a href="structBody.html#a4de063a5f09cb7376f9fde6bb0fe48bc">Body::badsig</a></div><div class="ttdeci">bool badsig</div><div class="ttdoc">Bad cryptographic signature (needed to check encrypted s/mime-signatures) </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00078">body.h:78</a></div></div>
<div class="ttc" id="crypt_8c_html_a345fb1ff241b3fc778632947c2b08d37"><div class="ttname"><a href="crypt_8c.html#a345fb1ff241b3fc778632947c2b08d37">mutt_is_multipart_signed</a></div><div class="ttdeci">SecurityFlags mutt_is_multipart_signed(struct Body *b)</div><div class="ttdoc">Is a message signed? </div><div class="ttdef"><b>Definition:</b> <a href="crypt_8c_source.html#l00420">crypt.c:420</a></div></div>
<div class="ttc" id="mutt_2string_8c_html_a29db81d6f5a7dd216cbea75ecf8a5885"><div class="ttname"><a href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a></div><div class="ttdeci">bool mutt_istr_equal(const char *a, const char *b)</div><div class="ttdoc">Compare two strings, ignoring case. </div><div class="ttdef"><b>Definition:</b> <a href="mutt_2string_8c_source.html#l00916">string.c:916</a></div></div>
<div class="ttc" id="structBody_html_ace00f9cba9b46a2d434764335d2fa43a"><div class="ttname"><a href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">Body::subtype</a></div><div class="ttdeci">char * subtype</div><div class="ttdoc">content-type subtype </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00037">body.h:37</a></div></div>
<div class="ttc" id="crypt_8c_html_aced59da2579d14e9b136b372ce683bc5"><div class="ttname"><a href="crypt_8c.html#aced59da2579d14e9b136b372ce683bc5">mutt_protected_headers_handler</a></div><div class="ttdeci">int mutt_protected_headers_handler(struct Body *b, struct State *s)</div><div class="ttdoc">Process a protected header - Implements handler_t. </div><div class="ttdef"><b>Definition:</b> <a href="crypt_8c_source.html#l01126">crypt.c:1126</a></div></div>
<div class="ttc" id="structBody_html_ae4b2706a5c4601ae1497a96e047d8f5e"><div class="ttname"><a href="structBody.html#ae4b2706a5c4601ae1497a96e047d8f5e">Body::goodsig</a></div><div class="ttdeci">bool goodsig</div><div class="ttdoc">Good cryptographic signature. </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00076">body.h:76</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a798dfac1e8839ca89375b4ec62b3eff2"><div class="ttname"><a href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a></div><div class="ttdeci">#define APPLICATION_SMIME</div><div class="ttdoc">Use SMIME to encrypt/sign. </div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00088">lib.h:88</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a587e679a4c9cc44f11f0c467bb22b0af"><div class="ttname"><a href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a></div><div class="ttdeci">#define APPLICATION_PGP</div><div class="ttdoc">Use PGP to encrypt/sign. </div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00087">lib.h:87</a></div></div>
<div class="ttc" id="structBody_html_a0b87b7bdb6faef44d9aac4854975f805"><div class="ttname"><a href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">Body::parts</a></div><div class="ttdeci">struct Body * parts</div><div class="ttdoc">parts of a multipart or message/rfc822 </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00054">body.h:54</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a14f75a650c49341776276f44881d54b2"><div class="ttname"><a href="ncrypt_2lib_8h.html#a14f75a650c49341776276f44881d54b2">PGP_SIGN</a></div><div class="ttdeci">#define PGP_SIGN</div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00094">lib.h:94</a></div></div>
<div class="ttc" id="crypt_8c_html_a3f891994e68f268a2b82c0e2e60bf079"><div class="ttname"><a href="crypt_8c.html#a3f891994e68f268a2b82c0e2e60bf079">crypt_fetch_signatures</a></div><div class="ttdeci">static void crypt_fetch_signatures(struct Body ***signatures, struct Body *a, int *n)</div><div class="ttdoc">Create an array of an emails parts. </div><div class="ttdef"><b>Definition:</b> <a href="crypt_8c_source.html#l01084">crypt.c:1084</a></div></div>
<div class="ttc" id="structBody_html_af77d79aadb278bef8f2829c268f2486f"><div class="ttname"><a href="structBody.html#af77d79aadb278bef8f2829c268f2486f">Body::type</a></div><div class="ttdeci">unsigned int type</div><div class="ttdoc">content-type primary type, ContentType </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00065">body.h:65</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_ae12c003463c99d28f65f1d6b8b053b2c"><div class="ttname"><a href="ncrypt_2lib_8h.html#ae12c003463c99d28f65f1d6b8b053b2c">SEC_SIGN</a></div><div class="ttdeci">#define SEC_SIGN</div><div class="ttdoc">Email is signed. </div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00076">lib.h:76</a></div></div>
<div class="ttc" id="state_8c_html_a8d8c6b5b8e9a2427e68fab5f5403cb63"><div class="ttname"><a href="state_8c.html#a8d8c6b5b8e9a2427e68fab5f5403cb63">state_attach_puts</a></div><div class="ttdeci">void state_attach_puts(struct State *s, const char *t)</div><div class="ttdoc">Write a string to the state. </div><div class="ttdef"><b>Definition:</b> <a href="state_8c_source.html#l00104">state.c:104</a></div></div>
<div class="ttc" id="mime_8h_html_ab12186b6fac3d22b88fac67700f07b1d"><div class="ttname"><a href="mime_8h.html#ab12186b6fac3d22b88fac67700f07b1d">TYPE</a></div><div class="ttdeci">#define TYPE(body)</div><div class="ttdef"><b>Definition:</b> <a href="mime_8h_source.html#l00089">mime.h:89</a></div></div>
<div class="ttc" id="mime_8h_html_a3ccd048df649c335df5a7f82673bbc79a877e24e62c85f20ff0e0f09ab983031e"><div class="ttname"><a href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79a877e24e62c85f20ff0e0f09ab983031e">TYPE_MULTIPART</a></div><div class="ttdoc">Type: &amp;#39;multipart/*&amp;#39;. </div><div class="ttdef"><b>Definition:</b> <a href="mime_8h_source.html#l00037">mime.h:37</a></div></div>
<div class="ttc" id="memory_8h_html_a25875003b43b81a4302256caa4a13599"><div class="ttname"><a href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a></div><div class="ttdeci">#define FREE(x)</div><div class="ttdef"><b>Definition:</b> <a href="memory_8h_source.html#l00040">memory.h:40</a></div></div>
<div class="ttc" id="parameter_8c_html_a0c6d54a87e015a496c8dbecfcd4002c9"><div class="ttname"><a href="parameter_8c.html#a0c6d54a87e015a496c8dbecfcd4002c9">mutt_param_get</a></div><div class="ttdeci">char * mutt_param_get(const struct ParameterList *pl, const char *s)</div><div class="ttdoc">Find a matching Parameter. </div><div class="ttdef"><b>Definition:</b> <a href="parameter_8c_source.html#l00084">parameter.c:84</a></div></div>
<div class="ttc" id="cryptglue_8c_html_a805ac5f7d1ad9d7714f01d2e13e8b6be"><div class="ttname"><a href="cryptglue_8c.html#a805ac5f7d1ad9d7714f01d2e13e8b6be">crypt_smime_verify_one</a></div><div class="ttdeci">int crypt_smime_verify_one(struct Body *sigbdy, struct State *s, const char *tempf)</div><div class="ttdoc">Wrapper for CryptModuleSpecs::verify_one() </div><div class="ttdef"><b>Definition:</b> <a href="cryptglue_8c_source.html#l00525">cryptglue.c:525</a></div></div>
<div class="ttc" id="handler_8c_html_adae8bf0eec9bee0bd62f639bbcf8599f"><div class="ttname"><a href="handler_8c.html#adae8bf0eec9bee0bd62f639bbcf8599f">mutt_body_handler</a></div><div class="ttdeci">int mutt_body_handler(struct Body *b, struct State *s)</div><div class="ttdoc">Handler for the Body of an email. </div><div class="ttdef"><b>Definition:</b> <a href="handler_8c_source.html#l01604">handler.c:1604</a></div></div>
<div class="ttc" id="structBody_html_a782cee95e0064e3895b88248bdfc781a"><div class="ttname"><a href="structBody.html#a782cee95e0064e3895b88248bdfc781a">Body::parameter</a></div><div class="ttdeci">struct ParameterList parameter</div><div class="ttdoc">parameters of the content-type </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00039">body.h:39</a></div></div>
<div class="ttc" id="mime_8h_html_a3ccd048df649c335df5a7f82673bbc79ac5074066199e3f540550ca0b1a38978e"><div class="ttname"><a href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79ac5074066199e3f540550ca0b1a38978e">TYPE_APPLICATION</a></div><div class="ttdoc">Type: &amp;#39;application/*&amp;#39;. </div><div class="ttdef"><b>Definition:</b> <a href="mime_8h_source.html#l00033">mime.h:33</a></div></div>
<div class="ttc" id="cryptglue_8c_html_a9457dc1f6c58f46461c4866e08946b5c"><div class="ttname"><a href="cryptglue_8c.html#a9457dc1f6c58f46461c4866e08946b5c">crypt_pgp_verify_one</a></div><div class="ttdeci">int crypt_pgp_verify_one(struct Body *sigbdy, struct State *s, const char *tempf)</div><div class="ttdoc">Wrapper for CryptModuleSpecs::verify_one() </div><div class="ttdef"><b>Definition:</b> <a href="cryptglue_8c_source.html#l00379">cryptglue.c:379</a></div></div>
</div><!-- fragment --><div id="dynsection-31" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-31-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-31-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-31-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_a3e7ec2b5bc58891704d4c49159cbef9a_cgraph.svg" width="768" height="768"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div id="dynsection-32" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-32-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-32-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-32-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_a3e7ec2b5bc58891704d4c49159cbef9a_icgraph.svg" width="366" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a397940a79b0c75800fed7d264f7fd6b4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a397940a79b0c75800fed7d264f7fd6b4">&#9670;&nbsp;</a></span>crypt_cleanup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void crypt_cleanup </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Clean up backend. </p>

<p class="definition">Definition at line <a class="el" href="cryptglue_8c_source.html#l00143">143</a> of file <a class="el" href="cryptglue_8c_source.html">cryptglue.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;{</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="cryptglue_8c.html#a69a7f3b98b67a0831a8a5e3fc47d5c93">CRYPT_MOD_CALL_CHECK</a>(PGP, cleanup))</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    (<a class="code" href="cryptglue_8c.html#acaf721ab817757c241a5abd18fc8618b">CRYPT_MOD_CALL</a>(PGP, cleanup))();</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="cryptglue_8c.html#a69a7f3b98b67a0831a8a5e3fc47d5c93">CRYPT_MOD_CALL_CHECK</a>(SMIME, cleanup))</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    (<a class="code" href="cryptglue_8c.html#acaf721ab817757c241a5abd18fc8618b">CRYPT_MOD_CALL</a>(SMIME, cleanup))();</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;}</div><div class="ttc" id="cryptglue_8c_html_acaf721ab817757c241a5abd18fc8618b"><div class="ttname"><a href="cryptglue_8c.html#acaf721ab817757c241a5abd18fc8618b">CRYPT_MOD_CALL</a></div><div class="ttdeci">#define CRYPT_MOD_CALL(identifier, func)</div><div class="ttdef"><b>Definition:</b> <a href="cryptglue_8c_source.html#l00086">cryptglue.c:86</a></div></div>
<div class="ttc" id="cryptglue_8c_html_a69a7f3b98b67a0831a8a5e3fc47d5c93"><div class="ttname"><a href="cryptglue_8c.html#a69a7f3b98b67a0831a8a5e3fc47d5c93">CRYPT_MOD_CALL_CHECK</a></div><div class="ttdeci">#define CRYPT_MOD_CALL_CHECK(identifier, func)</div><div class="ttdef"><b>Definition:</b> <a href="cryptglue_8c_source.html#l00080">cryptglue.c:80</a></div></div>
</div><!-- fragment --><div id="dynsection-33" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-33-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-33-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-33-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_a397940a79b0c75800fed7d264f7fd6b4_icgraph.svg" width="227" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a07a6c891658dd90ef8333a1e5bbcc285"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a07a6c891658dd90ef8333a1e5bbcc285">&#9670;&nbsp;</a></span>crypt_has_module_backend()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool crypt_has_module_backend </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a>&#160;</td>
          <td class="paramname"><em>type</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Is there a crypto backend for a given type? </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">type</td><td>Crypto type, see <a class="el" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d" title="Flags, e.g. SEC_ENCRYPT. ">SecurityFlags</a> </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">true</td><td>Backend is present </td></tr>
    <tr><td class="paramname">false</td><td>Backend is not present </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="cryptglue_8c_source.html#l00172">172</a> of file <a class="el" href="cryptglue_8c_source.html">cryptglue.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;{</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <span class="keywordflow">if</span> (((<a class="code" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a>) != 0) &amp;&amp; (type &amp; APPLICATION_PGP) &amp;&amp;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;      <a class="code" href="crypt__mod_8c.html#ab76c8564c3062e3855452cacc1baa71e">crypto_module_lookup</a>(APPLICATION_PGP))</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  {</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  }</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  <span class="keywordflow">if</span> (((<a class="code" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code" href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a>) != 0) &amp;&amp; (type &amp; APPLICATION_SMIME) &amp;&amp;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;      <a class="code" href="crypt__mod_8c.html#ab76c8564c3062e3855452cacc1baa71e">crypto_module_lookup</a>(APPLICATION_SMIME))</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  {</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  }</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;}</div><div class="ttc" id="ncrypt_2lib_8h_html_ad980bff69bb614893ad8e7e1c28a5023"><div class="ttname"><a href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a></div><div class="ttdeci">#define WithCrypto</div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00113">lib.h:113</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a798dfac1e8839ca89375b4ec62b3eff2"><div class="ttname"><a href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a></div><div class="ttdeci">#define APPLICATION_SMIME</div><div class="ttdoc">Use SMIME to encrypt/sign. </div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00088">lib.h:88</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a587e679a4c9cc44f11f0c467bb22b0af"><div class="ttname"><a href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a></div><div class="ttdeci">#define APPLICATION_PGP</div><div class="ttdoc">Use PGP to encrypt/sign. </div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00087">lib.h:87</a></div></div>
<div class="ttc" id="crypt__mod_8c_html_ab76c8564c3062e3855452cacc1baa71e"><div class="ttname"><a href="crypt__mod_8c.html#ab76c8564c3062e3855452cacc1baa71e">crypto_module_lookup</a></div><div class="ttdeci">struct CryptModuleSpecs * crypto_module_lookup(int identifier)</div><div class="ttdoc">Lookup a crypto module by name. </div><div class="ttdef"><b>Definition:</b> <a href="crypt__mod_8c_source.html#l00065">crypt_mod.c:65</a></div></div>
</div><!-- fragment --><div id="dynsection-34" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-34-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-34-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-34-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_a07a6c891658dd90ef8333a1e5bbcc285_cgraph.svg" width="432" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div id="dynsection-35" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-35-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-35-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-35-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_a07a6c891658dd90ef8333a1e5bbcc285_icgraph.svg" width="630" height="63"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="aaecf706c319966f9eafd582b58ba531f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaecf706c319966f9eafd582b58ba531f">&#9670;&nbsp;</a></span>crypt_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void crypt_init </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialise the crypto backends. </p>
<p>This calls <a class="el" href="structCryptModuleSpecs.html#a819c87369b2dc3806d846c3a7e9fb7b6" title="Initialise the crypto module. ">CryptModuleSpecs::init()</a> </p>

<p class="definition">Definition at line <a class="el" href="cryptglue_8c_source.html#l00094">94</a> of file <a class="el" href="cryptglue_8c_source.html">cryptglue.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;{</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="preprocessor">#ifdef CRYPT_BACKEND_GPGME</span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> c_crypt_use_gpgme =</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;      <a class="code" href="helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(<a class="code" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;crypt_use_gpgme&quot;</span>);</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="preprocessor">#ifdef CRYPT_BACKEND_CLASSIC_PGP</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  <span class="keywordflow">if</span> (</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;#ifdef CRYPT_BACKEND_GPGME</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;      (!c_crypt_use_gpgme)</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;#<span class="keywordflow">else</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;      1</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;#endif</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  )</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <a class="code" href="crypt__mod_8c.html#a6f1125b13e6eb22540110a6afc5da0fd">crypto_module_register</a>(&amp;<a class="code" href="cryptglue_8c.html#a1f7c9dc5fc2564205211bbc38c0e191e">CryptModPgpClassic</a>);</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="preprocessor">#ifdef CRYPT_BACKEND_CLASSIC_SMIME</span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  <span class="keywordflow">if</span> (</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;#ifdef CRYPT_BACKEND_GPGME</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;      (!c_crypt_use_gpgme)</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;#<span class="keywordflow">else</span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;      1</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;#endif</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  )</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <a class="code" href="crypt__mod_8c.html#a6f1125b13e6eb22540110a6afc5da0fd">crypto_module_register</a>(&amp;<a class="code" href="cryptglue_8c.html#ae586200df6b40e4d660cca9a505b6b05">CryptModSmimeClassic</a>);</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="preprocessor">#ifdef CRYPT_BACKEND_GPGME</span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  <span class="keywordflow">if</span> (c_crypt_use_gpgme)</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  {</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <a class="code" href="crypt__mod_8c.html#a6f1125b13e6eb22540110a6afc5da0fd">crypto_module_register</a>(&amp;<a class="code" href="cryptglue_8c.html#a18a127bb6ba65da242de83f9a996a072">CryptModPgpGpgme</a>);</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <a class="code" href="crypt__mod_8c.html#a6f1125b13e6eb22540110a6afc5da0fd">crypto_module_register</a>(&amp;<a class="code" href="cryptglue_8c.html#a90e492b5253e62d56fc2adbaa7a6120a">CryptModSmimeGpgme</a>);</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  }</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="preprocessor">#if defined(CRYPT_BACKEND_CLASSIC_PGP) ||                                      \</span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="preprocessor">    defined(CRYPT_BACKEND_CLASSIC_SMIME) || defined(CRYPT_BACKEND_GPGME)</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="cryptglue_8c.html#a69a7f3b98b67a0831a8a5e3fc47d5c93">CRYPT_MOD_CALL_CHECK</a>(PGP, init))</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <a class="code" href="cryptglue_8c.html#acaf721ab817757c241a5abd18fc8618b">CRYPT_MOD_CALL</a>(PGP, init)();</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="cryptglue_8c.html#a69a7f3b98b67a0831a8a5e3fc47d5c93">CRYPT_MOD_CALL_CHECK</a>(SMIME, init))</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <a class="code" href="cryptglue_8c.html#acaf721ab817757c241a5abd18fc8618b">CRYPT_MOD_CALL</a>(SMIME, init)();</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;}</div><div class="ttc" id="helpers_8c_html_ae50f679dd6c5bd1ba820884c8602f038"><div class="ttname"><a href="helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a></div><div class="ttdeci">bool cs_subset_bool(const struct ConfigSubset *sub, const char *name)</div><div class="ttdoc">Get a boolean config item by name. </div><div class="ttdef"><b>Definition:</b> <a href="helpers_8c_source.html#l00071">helpers.c:71</a></div></div>
<div class="ttc" id="cryptglue_8c_html_acaf721ab817757c241a5abd18fc8618b"><div class="ttname"><a href="cryptglue_8c.html#acaf721ab817757c241a5abd18fc8618b">CRYPT_MOD_CALL</a></div><div class="ttdeci">#define CRYPT_MOD_CALL(identifier, func)</div><div class="ttdef"><b>Definition:</b> <a href="cryptglue_8c_source.html#l00086">cryptglue.c:86</a></div></div>
<div class="ttc" id="crypt__mod_8c_html_a6f1125b13e6eb22540110a6afc5da0fd"><div class="ttname"><a href="crypt__mod_8c.html#a6f1125b13e6eb22540110a6afc5da0fd">crypto_module_register</a></div><div class="ttdeci">void crypto_module_register(struct CryptModuleSpecs *specs)</div><div class="ttdoc">Register a new crypto module. </div><div class="ttdef"><b>Definition:</b> <a href="crypt__mod_8c_source.html#l00051">crypt_mod.c:51</a></div></div>
<div class="ttc" id="structNeoMutt_html"><div class="ttname"><a href="structNeoMutt.html">NeoMutt</a></div><div class="ttdoc">Container for Accounts, Notifications. </div><div class="ttdef"><b>Definition:</b> <a href="neomutt_8h_source.html#l00036">neomutt.h:36</a></div></div>
<div class="ttc" id="cryptglue_8c_html_ae586200df6b40e4d660cca9a505b6b05"><div class="ttname"><a href="cryptglue_8c.html#ae586200df6b40e4d660cca9a505b6b05">CryptModSmimeClassic</a></div><div class="ttdeci">struct CryptModuleSpecs CryptModSmimeClassic</div><div class="ttdoc">CLI SMIME - Implements CryptModuleSpecs. </div><div class="ttdef"><b>Definition:</b> <a href="crypt__mod__smime__classic_8c_source.html#l00057">crypt_mod_smime_classic.c:57</a></div></div>
<div class="ttc" id="cryptglue_8c_html_a1f7c9dc5fc2564205211bbc38c0e191e"><div class="ttname"><a href="cryptglue_8c.html#a1f7c9dc5fc2564205211bbc38c0e191e">CryptModPgpClassic</a></div><div class="ttdeci">struct CryptModuleSpecs CryptModPgpClassic</div><div class="ttdoc">CLI PGP - Implements CryptModuleSpecs. </div><div class="ttdef"><b>Definition:</b> <a href="crypt__mod__pgp__classic_8c_source.html#l00043">crypt_mod_pgp_classic.c:43</a></div></div>
<div class="ttc" id="cryptglue_8c_html_a18a127bb6ba65da242de83f9a996a072"><div class="ttname"><a href="cryptglue_8c.html#a18a127bb6ba65da242de83f9a996a072">CryptModPgpGpgme</a></div><div class="ttdeci">struct CryptModuleSpecs CryptModPgpGpgme</div><div class="ttdoc">GPGME PGP - Implements CryptModuleSpecs. </div><div class="ttdef"><b>Definition:</b> <a href="crypt__mod__pgp__gpgme_8c_source.html#l00059">crypt_mod_pgp_gpgme.c:59</a></div></div>
<div class="ttc" id="cryptglue_8c_html_a69a7f3b98b67a0831a8a5e3fc47d5c93"><div class="ttname"><a href="cryptglue_8c.html#a69a7f3b98b67a0831a8a5e3fc47d5c93">CRYPT_MOD_CALL_CHECK</a></div><div class="ttdeci">#define CRYPT_MOD_CALL_CHECK(identifier, func)</div><div class="ttdef"><b>Definition:</b> <a href="cryptglue_8c_source.html#l00080">cryptglue.c:80</a></div></div>
<div class="ttc" id="cryptglue_8c_html_a90e492b5253e62d56fc2adbaa7a6120a"><div class="ttname"><a href="cryptglue_8c.html#a90e492b5253e62d56fc2adbaa7a6120a">CryptModSmimeGpgme</a></div><div class="ttdeci">struct CryptModuleSpecs CryptModSmimeGpgme</div><div class="ttdoc">GPGME SMIME - Implements CryptModuleSpecs. </div><div class="ttdef"><b>Definition:</b> <a href="crypt__mod__smime__gpgme_8c_source.html#l00059">crypt_mod_smime_gpgme.c:59</a></div></div>
<div class="ttc" id="structNeoMutt_html_af98065e32243ce9331f93b7f30247d47"><div class="ttname"><a href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">NeoMutt::sub</a></div><div class="ttdeci">struct ConfigSubset * sub</div><div class="ttdoc">Inherited config items. </div><div class="ttdef"><b>Definition:</b> <a href="neomutt_8h_source.html#l00039">neomutt.h:39</a></div></div>
</div><!-- fragment --><div id="dynsection-36" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-36-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-36-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-36-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_aaecf706c319966f9eafd582b58ba531f_cgraph.svg" width="318" height="88"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div id="dynsection-37" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-37-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-37-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-37-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_aaecf706c319966f9eafd582b58ba531f_icgraph.svg" width="196" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a166ec08d102f4330fdd0cc44a32bdf96"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a166ec08d102f4330fdd0cc44a32bdf96">&#9670;&nbsp;</a></span>crypt_invoke_message()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void crypt_invoke_message </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a>&#160;</td>
          <td class="paramname"><em>type</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Display an informative message. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">type</td><td>Crypto type, see <a class="el" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d" title="Flags, e.g. SEC_ENCRYPT. ">SecurityFlags</a></td></tr>
  </table>
  </dd>
</dl>
<p>Show a message that a backend will be invoked. </p>

<p class="definition">Definition at line <a class="el" href="cryptglue_8c_source.html#l00158">158</a> of file <a class="el" href="cryptglue_8c_source.html">cryptglue.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;{</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  <span class="keywordflow">if</span> (((<a class="code" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a>) != 0) &amp;&amp; (type &amp; APPLICATION_PGP))</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <a class="code" href="logging_8h.html#ae108f891125caafa9250cf0959c40c04">mutt_message</a>(<a class="code" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Invoking PGP...&quot;</span>));</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (((<a class="code" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code" href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a>) != 0) &amp;&amp; (type &amp; APPLICATION_SMIME))</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <a class="code" href="logging_8h.html#ae108f891125caafa9250cf0959c40c04">mutt_message</a>(<a class="code" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Invoking S/MIME...&quot;</span>));</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;}</div><div class="ttc" id="ncrypt_2lib_8h_html_ad980bff69bb614893ad8e7e1c28a5023"><div class="ttname"><a href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a></div><div class="ttdeci">#define WithCrypto</div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00113">lib.h:113</a></div></div>
<div class="ttc" id="logging_8h_html_ae108f891125caafa9250cf0959c40c04"><div class="ttname"><a href="logging_8h.html#ae108f891125caafa9250cf0959c40c04">mutt_message</a></div><div class="ttdeci">#define mutt_message(...)</div><div class="ttdef"><b>Definition:</b> <a href="logging_8h_source.html#l00083">logging.h:83</a></div></div>
<div class="ttc" id="mutt_2message_8h_html_a479d658dfd60fe8d9709ec67a58b34ca"><div class="ttname"><a href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a></div><div class="ttdeci">#define _(a)</div><div class="ttdef"><b>Definition:</b> <a href="mutt_2message_8h_source.html#l00028">message.h:28</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a798dfac1e8839ca89375b4ec62b3eff2"><div class="ttname"><a href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a></div><div class="ttdeci">#define APPLICATION_SMIME</div><div class="ttdoc">Use SMIME to encrypt/sign. </div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00088">lib.h:88</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a587e679a4c9cc44f11f0c467bb22b0af"><div class="ttname"><a href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a></div><div class="ttdeci">#define APPLICATION_PGP</div><div class="ttdoc">Use PGP to encrypt/sign. </div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00087">lib.h:87</a></div></div>
</div><!-- fragment --><div id="dynsection-38" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-38-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-38-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-38-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_a166ec08d102f4330fdd0cc44a32bdf96_icgraph.svg" width="404" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="aaf94d2bf9e0c58d5d8e436397611be27"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaf94d2bf9e0c58d5d8e436397611be27">&#9670;&nbsp;</a></span>crypt_pgp_application_handler()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int crypt_pgp_application_handler </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structBody.html">Body</a> *&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structState.html">State</a> *&#160;</td>
          <td class="paramname"><em>s</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Wrapper for <a class="el" href="structCryptModuleSpecs.html#ab422f00f242155c816f7b4a16af52d60" title="Manage the MIME type &quot;application/pgp&quot; or &quot;application/smime&quot;. ">CryptModuleSpecs::application_handler()</a> </p>
<p>Implements <a class="el" href="handler_8c.html#a05af946c0d51f30e6b10e75510d79458" title="Manage a PGP or S/MIME encrypted MIME part. ">handler_t</a> </p>

<p class="definition">Definition at line <a class="el" href="cryptglue_8c_source.html#l00240">240</a> of file <a class="el" href="cryptglue_8c_source.html">cryptglue.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;{</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="cryptglue_8c.html#a69a7f3b98b67a0831a8a5e3fc47d5c93">CRYPT_MOD_CALL_CHECK</a>(PGP, application_handler))</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="cryptglue_8c.html#acaf721ab817757c241a5abd18fc8618b">CRYPT_MOD_CALL</a>(PGP, application_handler)(b, s);</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;}</div><div class="ttc" id="cryptglue_8c_html_acaf721ab817757c241a5abd18fc8618b"><div class="ttname"><a href="cryptglue_8c.html#acaf721ab817757c241a5abd18fc8618b">CRYPT_MOD_CALL</a></div><div class="ttdeci">#define CRYPT_MOD_CALL(identifier, func)</div><div class="ttdef"><b>Definition:</b> <a href="cryptglue_8c_source.html#l00086">cryptglue.c:86</a></div></div>
<div class="ttc" id="cryptglue_8c_html_a69a7f3b98b67a0831a8a5e3fc47d5c93"><div class="ttname"><a href="cryptglue_8c.html#a69a7f3b98b67a0831a8a5e3fc47d5c93">CRYPT_MOD_CALL_CHECK</a></div><div class="ttdeci">#define CRYPT_MOD_CALL_CHECK(identifier, func)</div><div class="ttdef"><b>Definition:</b> <a href="cryptglue_8c_source.html#l00080">cryptglue.c:80</a></div></div>
</div><!-- fragment --><div id="dynsection-39" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-39-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-39-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-39-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_aaf94d2bf9e0c58d5d8e436397611be27_icgraph.svg" width="372" height="52"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a5959b6797c94b22a7d391cbb5fd2fa33"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5959b6797c94b22a7d391cbb5fd2fa33">&#9670;&nbsp;</a></span>crypt_pgp_check_traditional()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool crypt_pgp_check_traditional </td>
          <td>(</td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>fp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structBody.html">Body</a> *&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>just_one</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Wrapper for <a class="el" href="structCryptModuleSpecs.html#abbb74e663273948a7e2ad35a1135e6a2" title="Look for inline (non-MIME) PGP content. ">CryptModuleSpecs::pgp_check_traditional()</a> </p>

<p class="definition">Definition at line <a class="el" href="cryptglue_8c_source.html#l00288">288</a> of file <a class="el" href="cryptglue_8c_source.html">cryptglue.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;{</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="cryptglue_8c.html#a69a7f3b98b67a0831a8a5e3fc47d5c93">CRYPT_MOD_CALL_CHECK</a>(PGP, pgp_check_traditional))</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="cryptglue_8c.html#acaf721ab817757c241a5abd18fc8618b">CRYPT_MOD_CALL</a>(PGP, pgp_check_traditional)(fp, b, just_one);</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;}</div><div class="ttc" id="cryptglue_8c_html_acaf721ab817757c241a5abd18fc8618b"><div class="ttname"><a href="cryptglue_8c.html#acaf721ab817757c241a5abd18fc8618b">CRYPT_MOD_CALL</a></div><div class="ttdeci">#define CRYPT_MOD_CALL(identifier, func)</div><div class="ttdef"><b>Definition:</b> <a href="cryptglue_8c_source.html#l00086">cryptglue.c:86</a></div></div>
<div class="ttc" id="cryptglue_8c_html_a69a7f3b98b67a0831a8a5e3fc47d5c93"><div class="ttname"><a href="cryptglue_8c.html#a69a7f3b98b67a0831a8a5e3fc47d5c93">CRYPT_MOD_CALL_CHECK</a></div><div class="ttdeci">#define CRYPT_MOD_CALL_CHECK(identifier, func)</div><div class="ttdef"><b>Definition:</b> <a href="cryptglue_8c_source.html#l00080">cryptglue.c:80</a></div></div>
</div><!-- fragment --><div id="dynsection-40" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-40-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-40-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-40-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_a5959b6797c94b22a7d391cbb5fd2fa33_icgraph.svg" width="431" height="104"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="aa8e21077ffe83ed3b10dc22acdd6c2e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa8e21077ffe83ed3b10dc22acdd6c2e2">&#9670;&nbsp;</a></span>crypt_pgp_decrypt_mime()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int crypt_pgp_decrypt_mime </td>
          <td>(</td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>fp_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">FILE **&#160;</td>
          <td class="paramname"><em>fp_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structBody.html">Body</a> *&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structBody.html">Body</a> **&#160;</td>
          <td class="paramname"><em>cur</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Wrapper for <a class="el" href="structCryptModuleSpecs.html#a4cba06c7d0dfb0e4d1fba7c9ded25c0d" title="Decrypt an encrypted MIME part. ">CryptModuleSpecs::decrypt_mime()</a> </p>

<p class="definition">Definition at line <a class="el" href="cryptglue_8c_source.html#l00212">212</a> of file <a class="el" href="cryptglue_8c_source.html">cryptglue.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;{</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="preprocessor">#ifdef USE_AUTOCRYPT</span></div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> c_autocrypt = <a class="code" href="helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(<a class="code" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;autocrypt&quot;</span>);</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  <span class="keywordflow">if</span> (c_autocrypt)</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  {</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <a class="code" href="options_8h.html#a4ea42e47a0dfd921b66ebc59db05d025">OptAutocryptGpgme</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <span class="keywordtype">int</span> result = <a class="code" href="crypt__gpgme_8c.html#a473ba915ca379bb659a754b8792f2cfa">pgp_gpgme_decrypt_mime</a>(fp_in, fp_out, b, cur);</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <a class="code" href="options_8h.html#a4ea42e47a0dfd921b66ebc59db05d025">OptAutocryptGpgme</a> = <span class="keyword">false</span>;</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <span class="keywordflow">if</span> (result == 0)</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    {</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;      b-&gt;<a class="code" href="structBody.html#a63e1a4c2a0bacf3d1d5869edfebed0dd">is_autocrypt</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;      <span class="keywordflow">return</span> result;</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    }</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  }</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="cryptglue_8c.html#a69a7f3b98b67a0831a8a5e3fc47d5c93">CRYPT_MOD_CALL_CHECK</a>(PGP, decrypt_mime))</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="cryptglue_8c.html#acaf721ab817757c241a5abd18fc8618b">CRYPT_MOD_CALL</a>(PGP, decrypt_mime)(fp_in, fp_out, b, cur);</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;}</div><div class="ttc" id="helpers_8c_html_ae50f679dd6c5bd1ba820884c8602f038"><div class="ttname"><a href="helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a></div><div class="ttdeci">bool cs_subset_bool(const struct ConfigSubset *sub, const char *name)</div><div class="ttdoc">Get a boolean config item by name. </div><div class="ttdef"><b>Definition:</b> <a href="helpers_8c_source.html#l00071">helpers.c:71</a></div></div>
<div class="ttc" id="structBody_html_a63e1a4c2a0bacf3d1d5869edfebed0dd"><div class="ttname"><a href="structBody.html#a63e1a4c2a0bacf3d1d5869edfebed0dd">Body::is_autocrypt</a></div><div class="ttdeci">bool is_autocrypt</div><div class="ttdoc">Flag autocrypt-decrypted messages for replying. </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00080">body.h:80</a></div></div>
<div class="ttc" id="options_8h_html_a4ea42e47a0dfd921b66ebc59db05d025"><div class="ttname"><a href="options_8h.html#a4ea42e47a0dfd921b66ebc59db05d025">OptAutocryptGpgme</a></div><div class="ttdeci">WHERE bool OptAutocryptGpgme</div><div class="ttdoc">(pseudo) use Autocrypt context inside ncrypt/crypt_gpgme.c </div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00033">options.h:33</a></div></div>
<div class="ttc" id="cryptglue_8c_html_acaf721ab817757c241a5abd18fc8618b"><div class="ttname"><a href="cryptglue_8c.html#acaf721ab817757c241a5abd18fc8618b">CRYPT_MOD_CALL</a></div><div class="ttdeci">#define CRYPT_MOD_CALL(identifier, func)</div><div class="ttdef"><b>Definition:</b> <a href="cryptglue_8c_source.html#l00086">cryptglue.c:86</a></div></div>
<div class="ttc" id="structNeoMutt_html"><div class="ttname"><a href="structNeoMutt.html">NeoMutt</a></div><div class="ttdoc">Container for Accounts, Notifications. </div><div class="ttdef"><b>Definition:</b> <a href="neomutt_8h_source.html#l00036">neomutt.h:36</a></div></div>
<div class="ttc" id="crypt__gpgme_8c_html_a473ba915ca379bb659a754b8792f2cfa"><div class="ttname"><a href="crypt__gpgme_8c.html#a473ba915ca379bb659a754b8792f2cfa">pgp_gpgme_decrypt_mime</a></div><div class="ttdeci">int pgp_gpgme_decrypt_mime(FILE *fp_in, FILE **fp_out, struct Body *b, struct Body **cur)</div><div class="ttdoc">Implements CryptModuleSpecs::decrypt_mime() </div><div class="ttdef"><b>Definition:</b> <a href="crypt__gpgme_8c_source.html#l02208">crypt_gpgme.c:2208</a></div></div>
<div class="ttc" id="cryptglue_8c_html_a69a7f3b98b67a0831a8a5e3fc47d5c93"><div class="ttname"><a href="cryptglue_8c.html#a69a7f3b98b67a0831a8a5e3fc47d5c93">CRYPT_MOD_CALL_CHECK</a></div><div class="ttdeci">#define CRYPT_MOD_CALL_CHECK(identifier, func)</div><div class="ttdef"><b>Definition:</b> <a href="cryptglue_8c_source.html#l00080">cryptglue.c:80</a></div></div>
<div class="ttc" id="structNeoMutt_html_af98065e32243ce9331f93b7f30247d47"><div class="ttname"><a href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">NeoMutt::sub</a></div><div class="ttdeci">struct ConfigSubset * sub</div><div class="ttdoc">Inherited config items. </div><div class="ttdef"><b>Definition:</b> <a href="neomutt_8h_source.html#l00039">neomutt.h:39</a></div></div>
</div><!-- fragment --><div id="dynsection-41" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-41-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-41-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-41-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_aa8e21077ffe83ed3b10dc22acdd6c2e2_cgraph.svg" width="444" height="88"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div id="dynsection-42" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-42-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-42-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-42-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_aa8e21077ffe83ed3b10dc22acdd6c2e2_icgraph.svg" width="467" height="163"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="ab8e4063aa85a986a6879cbd45e14096c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab8e4063aa85a986a6879cbd45e14096c">&#9670;&nbsp;</a></span>crypt_pgp_encrypted_handler()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int crypt_pgp_encrypted_handler </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structBody.html">Body</a> *&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structState.html">State</a> *&#160;</td>
          <td class="paramname"><em>s</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Wrapper for <a class="el" href="structCryptModuleSpecs.html#a356c4135c3412cfae7dad038630aa9bf" title="Manage a PGP or S/MIME encrypted MIME part. ">CryptModuleSpecs::encrypted_handler()</a> </p>
<p>Implements <a class="el" href="handler_8c.html#a05af946c0d51f30e6b10e75510d79458" title="Manage a PGP or S/MIME encrypted MIME part. ">handler_t</a> </p>

<p class="definition">Definition at line <a class="el" href="cryptglue_8c_source.html#l00253">253</a> of file <a class="el" href="cryptglue_8c_source.html">cryptglue.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;{</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="preprocessor">#ifdef USE_AUTOCRYPT</span></div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> c_autocrypt = <a class="code" href="helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(<a class="code" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;autocrypt&quot;</span>);</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  <span class="keywordflow">if</span> (c_autocrypt)</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  {</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <a class="code" href="options_8h.html#a4ea42e47a0dfd921b66ebc59db05d025">OptAutocryptGpgme</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <span class="keywordtype">int</span> result = <a class="code" href="crypt__gpgme_8c.html#a49d3535b68adb1b38c4599091d04a7b2">pgp_gpgme_encrypted_handler</a>(b, s);</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <a class="code" href="options_8h.html#a4ea42e47a0dfd921b66ebc59db05d025">OptAutocryptGpgme</a> = <span class="keyword">false</span>;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="keywordflow">if</span> (result == 0)</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    {</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;      b-&gt;<a class="code" href="structBody.html#a63e1a4c2a0bacf3d1d5869edfebed0dd">is_autocrypt</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;      <span class="keywordflow">return</span> result;</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    }</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  }</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="cryptglue_8c.html#a69a7f3b98b67a0831a8a5e3fc47d5c93">CRYPT_MOD_CALL_CHECK</a>(PGP, encrypted_handler))</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="cryptglue_8c.html#acaf721ab817757c241a5abd18fc8618b">CRYPT_MOD_CALL</a>(PGP, encrypted_handler)(b, s);</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;}</div><div class="ttc" id="helpers_8c_html_ae50f679dd6c5bd1ba820884c8602f038"><div class="ttname"><a href="helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a></div><div class="ttdeci">bool cs_subset_bool(const struct ConfigSubset *sub, const char *name)</div><div class="ttdoc">Get a boolean config item by name. </div><div class="ttdef"><b>Definition:</b> <a href="helpers_8c_source.html#l00071">helpers.c:71</a></div></div>
<div class="ttc" id="structBody_html_a63e1a4c2a0bacf3d1d5869edfebed0dd"><div class="ttname"><a href="structBody.html#a63e1a4c2a0bacf3d1d5869edfebed0dd">Body::is_autocrypt</a></div><div class="ttdeci">bool is_autocrypt</div><div class="ttdoc">Flag autocrypt-decrypted messages for replying. </div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00080">body.h:80</a></div></div>
<div class="ttc" id="options_8h_html_a4ea42e47a0dfd921b66ebc59db05d025"><div class="ttname"><a href="options_8h.html#a4ea42e47a0dfd921b66ebc59db05d025">OptAutocryptGpgme</a></div><div class="ttdeci">WHERE bool OptAutocryptGpgme</div><div class="ttdoc">(pseudo) use Autocrypt context inside ncrypt/crypt_gpgme.c </div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00033">options.h:33</a></div></div>
<div class="ttc" id="cryptglue_8c_html_acaf721ab817757c241a5abd18fc8618b"><div class="ttname"><a href="cryptglue_8c.html#acaf721ab817757c241a5abd18fc8618b">CRYPT_MOD_CALL</a></div><div class="ttdeci">#define CRYPT_MOD_CALL(identifier, func)</div><div class="ttdef"><b>Definition:</b> <a href="cryptglue_8c_source.html#l00086">cryptglue.c:86</a></div></div>
<div class="ttc" id="structNeoMutt_html"><div class="ttname"><a href="structNeoMutt.html">NeoMutt</a></div><div class="ttdoc">Container for Accounts, Notifications. </div><div class="ttdef"><b>Definition:</b> <a href="neomutt_8h_source.html#l00036">neomutt.h:36</a></div></div>
<div class="ttc" id="crypt__gpgme_8c_html_a49d3535b68adb1b38c4599091d04a7b2"><div class="ttname"><a href="crypt__gpgme_8c.html#a49d3535b68adb1b38c4599091d04a7b2">pgp_gpgme_encrypted_handler</a></div><div class="ttdeci">int pgp_gpgme_encrypted_handler(struct Body *a, struct State *s)</div><div class="ttdoc">Implements CryptModuleSpecs::encrypted_handler() </div><div class="ttdef"><b>Definition:</b> <a href="crypt__gpgme_8c_source.html#l03061">crypt_gpgme.c:3061</a></div></div>
<div class="ttc" id="cryptglue_8c_html_a69a7f3b98b67a0831a8a5e3fc47d5c93"><div class="ttname"><a href="cryptglue_8c.html#a69a7f3b98b67a0831a8a5e3fc47d5c93">CRYPT_MOD_CALL_CHECK</a></div><div class="ttdeci">#define CRYPT_MOD_CALL_CHECK(identifier, func)</div><div class="ttdef"><b>Definition:</b> <a href="cryptglue_8c_source.html#l00080">cryptglue.c:80</a></div></div>
<div class="ttc" id="structNeoMutt_html_af98065e32243ce9331f93b7f30247d47"><div class="ttname"><a href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">NeoMutt::sub</a></div><div class="ttdeci">struct ConfigSubset * sub</div><div class="ttdoc">Inherited config items. </div><div class="ttdef"><b>Definition:</b> <a href="neomutt_8h_source.html#l00039">neomutt.h:39</a></div></div>
</div><!-- fragment --><div id="dynsection-43" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-43-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-43-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-43-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_ab8e4063aa85a986a6879cbd45e14096c_cgraph.svg" width="388" height="104"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div id="dynsection-44" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-44-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-44-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-44-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_ab8e4063aa85a986a6879cbd45e14096c_icgraph.svg" width="415" height="118"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="afa26cebcc0c8d8866129fc2eabdbe874"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa26cebcc0c8d8866129fc2eabdbe874">&#9670;&nbsp;</a></span>crypt_pgp_extract_key_from_attachment()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void crypt_pgp_extract_key_from_attachment </td>
          <td>(</td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>fp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structBody.html">Body</a> *&#160;</td>
          <td class="paramname"><em>top</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Wrapper for <a class="el" href="structCryptModuleSpecs.html#a7c197e2213c950245ad7bde7f0c51256" title="Extract PGP key from an attachment. ">CryptModuleSpecs::pgp_extract_key_from_attachment()</a> </p>

<p class="definition">Definition at line <a class="el" href="cryptglue_8c_source.html#l00401">401</a> of file <a class="el" href="cryptglue_8c_source.html">cryptglue.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;{</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="cryptglue_8c.html#a69a7f3b98b67a0831a8a5e3fc47d5c93">CRYPT_MOD_CALL_CHECK</a>(PGP, pgp_extract_key_from_attachment))</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <a class="code" href="cryptglue_8c.html#acaf721ab817757c241a5abd18fc8618b">CRYPT_MOD_CALL</a>(PGP, pgp_extract_key_from_attachment)(fp, top);</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;}</div><div class="ttc" id="cryptglue_8c_html_acaf721ab817757c241a5abd18fc8618b"><div class="ttname"><a href="cryptglue_8c.html#acaf721ab817757c241a5abd18fc8618b">CRYPT_MOD_CALL</a></div><div class="ttdeci">#define CRYPT_MOD_CALL(identifier, func)</div><div class="ttdef"><b>Definition:</b> <a href="cryptglue_8c_source.html#l00086">cryptglue.c:86</a></div></div>
<div class="ttc" id="cryptglue_8c_html_a69a7f3b98b67a0831a8a5e3fc47d5c93"><div class="ttname"><a href="cryptglue_8c.html#a69a7f3b98b67a0831a8a5e3fc47d5c93">CRYPT_MOD_CALL_CHECK</a></div><div class="ttdeci">#define CRYPT_MOD_CALL_CHECK(identifier, func)</div><div class="ttdef"><b>Definition:</b> <a href="cryptglue_8c_source.html#l00080">cryptglue.c:80</a></div></div>
</div><!-- fragment --><div id="dynsection-45" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-45-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-45-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-45-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_afa26cebcc0c8d8866129fc2eabdbe874_icgraph.svg" width="374" height="52"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a7d989caa27c6539e55662007a6cf2cc5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7d989caa27c6539e55662007a6cf2cc5">&#9670;&nbsp;</a></span>crypt_pgp_invoke_getkeys()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void crypt_pgp_invoke_getkeys </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structAddress.html">Address</a> *&#160;</td>
          <td class="paramname"><em>addr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Wrapper for <a class="el" href="structCryptModuleSpecs.html#acd2b13751354a0ea6dc82ee6bbdf3724" title="Run a command to download a PGP key. ">CryptModuleSpecs::pgp_invoke_getkeys()</a> </p>

<p class="definition">Definition at line <a class="el" href="cryptglue_8c_source.html#l00279">279</a> of file <a class="el" href="cryptglue_8c_source.html">cryptglue.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;{</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="cryptglue_8c.html#a69a7f3b98b67a0831a8a5e3fc47d5c93">CRYPT_MOD_CALL_CHECK</a>(PGP, pgp_invoke_getkeys))</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <a class="code" href="cryptglue_8c.html#acaf721ab817757c241a5abd18fc8618b">CRYPT_MOD_CALL</a>(PGP, pgp_invoke_getkeys)(addr);</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;}</div><div class="ttc" id="cryptglue_8c_html_acaf721ab817757c241a5abd18fc8618b"><div class="ttname"><a href="cryptglue_8c.html#acaf721ab817757c241a5abd18fc8618b">CRYPT_MOD_CALL</a></div><div class="ttdeci">#define CRYPT_MOD_CALL(identifier, func)</div><div class="ttdef"><b>Definition:</b> <a href="cryptglue_8c_source.html#l00086">cryptglue.c:86</a></div></div>
<div class="ttc" id="cryptglue_8c_html_a69a7f3b98b67a0831a8a5e3fc47d5c93"><div class="ttname"><a href="cryptglue_8c.html#a69a7f3b98b67a0831a8a5e3fc47d5c93">CRYPT_MOD_CALL_CHECK</a></div><div class="ttdeci">#define CRYPT_MOD_CALL_CHECK(identifier, func)</div><div class="ttdef"><b>Definition:</b> <a href="cryptglue_8c_source.html#l00080">cryptglue.c:80</a></div></div>
</div><!-- fragment --><div id="dynsection-46" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-46-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-46-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-46-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_a7d989caa27c6539e55662007a6cf2cc5_icgraph.svg" width="428" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="ac671b1b0cd5df34d49ea749d29df8d3f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac671b1b0cd5df34d49ea749d29df8d3f">&#9670;&nbsp;</a></span>crypt_pgp_make_key_attachment()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structBody.html">Body</a>* crypt_pgp_make_key_attachment </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Wrapper for <a class="el" href="structCryptModuleSpecs.html#a505fa888b6994755f055d202c339dbef" title="Generate a public key attachment. ">CryptModuleSpecs::pgp_make_key_attachment()</a> </p>

<p class="definition">Definition at line <a class="el" href="cryptglue_8c_source.html#l00310">310</a> of file <a class="el" href="cryptglue_8c_source.html">cryptglue.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;{</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="cryptglue_8c.html#a69a7f3b98b67a0831a8a5e3fc47d5c93">CRYPT_MOD_CALL_CHECK</a>(PGP, pgp_make_key_attachment))</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="cryptglue_8c.html#acaf721ab817757c241a5abd18fc8618b">CRYPT_MOD_CALL</a>(PGP, pgp_make_key_attachment)();</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  <span class="keywordflow">return</span> NULL;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;}</div><div class="ttc" id="cryptglue_8c_html_acaf721ab817757c241a5abd18fc8618b"><div class="ttname"><a href="cryptglue_8c.html#acaf721ab817757c241a5abd18fc8618b">CRYPT_MOD_CALL</a></div><div class="ttdeci">#define CRYPT_MOD_CALL(identifier, func)</div><div class="ttdef"><b>Definition:</b> <a href="cryptglue_8c_source.html#l00086">cryptglue.c:86</a></div></div>
<div class="ttc" id="cryptglue_8c_html_a69a7f3b98b67a0831a8a5e3fc47d5c93"><div class="ttname"><a href="cryptglue_8c.html#a69a7f3b98b67a0831a8a5e3fc47d5c93">CRYPT_MOD_CALL_CHECK</a></div><div class="ttdeci">#define CRYPT_MOD_CALL_CHECK(identifier, func)</div><div class="ttdef"><b>Definition:</b> <a href="cryptglue_8c_source.html#l00080">cryptglue.c:80</a></div></div>
</div><!-- fragment --><div id="dynsection-47" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-47-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-47-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-47-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_ac671b1b0cd5df34d49ea749d29df8d3f_icgraph.svg" width="383" height="88"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="abebf8caf41c84183ebacca4e7d7afe8c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abebf8caf41c84183ebacca4e7d7afe8c">&#9670;&nbsp;</a></span>crypt_pgp_send_menu()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a> crypt_pgp_send_menu </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structMailbox.html">Mailbox</a> *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structEmail.html">Email</a> *&#160;</td>
          <td class="paramname"><em>e</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Wrapper for <a class="el" href="structCryptModuleSpecs.html#a276f84536aedc54559c57018a76ff89d" title="Ask the user whether to sign and/or encrypt the email. ">CryptModuleSpecs::send_menu()</a> </p>

<p class="definition">Definition at line <a class="el" href="cryptglue_8c_source.html#l00390">390</a> of file <a class="el" href="cryptglue_8c_source.html">cryptglue.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;{</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="cryptglue_8c.html#a69a7f3b98b67a0831a8a5e3fc47d5c93">CRYPT_MOD_CALL_CHECK</a>(PGP, send_menu))</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="cryptglue_8c.html#acaf721ab817757c241a5abd18fc8618b">CRYPT_MOD_CALL</a>(PGP, send_menu)(m, e);</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;}</div><div class="ttc" id="cryptglue_8c_html_acaf721ab817757c241a5abd18fc8618b"><div class="ttname"><a href="cryptglue_8c.html#acaf721ab817757c241a5abd18fc8618b">CRYPT_MOD_CALL</a></div><div class="ttdeci">#define CRYPT_MOD_CALL(identifier, func)</div><div class="ttdef"><b>Definition:</b> <a href="cryptglue_8c_source.html#l00086">cryptglue.c:86</a></div></div>
<div class="ttc" id="cryptglue_8c_html_a69a7f3b98b67a0831a8a5e3fc47d5c93"><div class="ttname"><a href="cryptglue_8c.html#a69a7f3b98b67a0831a8a5e3fc47d5c93">CRYPT_MOD_CALL_CHECK</a></div><div class="ttdeci">#define CRYPT_MOD_CALL_CHECK(identifier, func)</div><div class="ttdef"><b>Definition:</b> <a href="cryptglue_8c_source.html#l00080">cryptglue.c:80</a></div></div>
</div><!-- fragment --><div id="dynsection-48" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-48-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-48-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-48-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_abebf8caf41c84183ebacca4e7d7afe8c_icgraph.svg" width="390" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a449d34e46ef8984a0a435909e1c0d7ab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a449d34e46ef8984a0a435909e1c0d7ab">&#9670;&nbsp;</a></span>crypt_smime_application_handler()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int crypt_smime_application_handler </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structBody.html">Body</a> *&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structState.html">State</a> *&#160;</td>
          <td class="paramname"><em>s</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Wrapper for <a class="el" href="structCryptModuleSpecs.html#ab422f00f242155c816f7b4a16af52d60" title="Manage the MIME type &quot;application/pgp&quot; or &quot;application/smime&quot;. ">CryptModuleSpecs::application_handler()</a> </p>
<p>Implements <a class="el" href="handler_8c.html#a05af946c0d51f30e6b10e75510d79458" title="Manage a PGP or S/MIME encrypted MIME part. ">handler_t</a> </p>

<p class="definition">Definition at line <a class="el" href="cryptglue_8c_source.html#l00452">452</a> of file <a class="el" href="cryptglue_8c_source.html">cryptglue.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;{</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="cryptglue_8c.html#a69a7f3b98b67a0831a8a5e3fc47d5c93">CRYPT_MOD_CALL_CHECK</a>(SMIME, application_handler))</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="cryptglue_8c.html#acaf721ab817757c241a5abd18fc8618b">CRYPT_MOD_CALL</a>(SMIME, application_handler)(b, s);</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;  <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;}</div><div class="ttc" id="cryptglue_8c_html_acaf721ab817757c241a5abd18fc8618b"><div class="ttname"><a href="cryptglue_8c.html#acaf721ab817757c241a5abd18fc8618b">CRYPT_MOD_CALL</a></div><div class="ttdeci">#define CRYPT_MOD_CALL(identifier, func)</div><div class="ttdef"><b>Definition:</b> <a href="cryptglue_8c_source.html#l00086">cryptglue.c:86</a></div></div>
<div class="ttc" id="cryptglue_8c_html_a69a7f3b98b67a0831a8a5e3fc47d5c93"><div class="ttname"><a href="cryptglue_8c.html#a69a7f3b98b67a0831a8a5e3fc47d5c93">CRYPT_MOD_CALL_CHECK</a></div><div class="ttdeci">#define CRYPT_MOD_CALL_CHECK(identifier, func)</div><div class="ttdef"><b>Definition:</b> <a href="cryptglue_8c_source.html#l00080">cryptglue.c:80</a></div></div>
</div><!-- fragment --><div id="dynsection-49" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-49-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-49-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-49-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_a449d34e46ef8984a0a435909e1c0d7ab_icgraph.svg" width="394" height="52"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a34e8cf4a9f68adbcd30d41a242ede1e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a34e8cf4a9f68adbcd30d41a242ede1e7">&#9670;&nbsp;</a></span>crypt_smime_decrypt_mime()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int crypt_smime_decrypt_mime </td>
          <td>(</td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>fp_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">FILE **&#160;</td>
          <td class="paramname"><em>fp_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structBody.html">Body</a> *&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structBody.html">Body</a> **&#160;</td>
          <td class="paramname"><em>cur</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Wrapper for <a class="el" href="structCryptModuleSpecs.html#a4cba06c7d0dfb0e4d1fba7c9ded25c0d" title="Decrypt an encrypted MIME part. ">CryptModuleSpecs::decrypt_mime()</a> </p>

<p class="definition">Definition at line <a class="el" href="cryptglue_8c_source.html#l00439">439</a> of file <a class="el" href="cryptglue_8c_source.html">cryptglue.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;{</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="cryptglue_8c.html#a69a7f3b98b67a0831a8a5e3fc47d5c93">CRYPT_MOD_CALL_CHECK</a>(SMIME, decrypt_mime))</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="cryptglue_8c.html#acaf721ab817757c241a5abd18fc8618b">CRYPT_MOD_CALL</a>(SMIME, decrypt_mime)(fp_in, fp_out, b, cur);</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;  <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;}</div><div class="ttc" id="cryptglue_8c_html_acaf721ab817757c241a5abd18fc8618b"><div class="ttname"><a href="cryptglue_8c.html#acaf721ab817757c241a5abd18fc8618b">CRYPT_MOD_CALL</a></div><div class="ttdeci">#define CRYPT_MOD_CALL(identifier, func)</div><div class="ttdef"><b>Definition:</b> <a href="cryptglue_8c_source.html#l00086">cryptglue.c:86</a></div></div>
<div class="ttc" id="cryptglue_8c_html_a69a7f3b98b67a0831a8a5e3fc47d5c93"><div class="ttname"><a href="cryptglue_8c.html#a69a7f3b98b67a0831a8a5e3fc47d5c93">CRYPT_MOD_CALL_CHECK</a></div><div class="ttdeci">#define CRYPT_MOD_CALL_CHECK(identifier, func)</div><div class="ttdef"><b>Definition:</b> <a href="cryptglue_8c_source.html#l00080">cryptglue.c:80</a></div></div>
</div><!-- fragment --><div id="dynsection-50" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-50-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-50-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-50-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_a34e8cf4a9f68adbcd30d41a242ede1e7_icgraph.svg" width="488" height="112"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a3f60f47f4d4dee7f43f502b7244af35f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3f60f47f4d4dee7f43f502b7244af35f">&#9670;&nbsp;</a></span>crypt_smime_getkeys()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void crypt_smime_getkeys </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structEnvelope.html">Envelope</a> *&#160;</td>
          <td class="paramname"><em>env</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Wrapper for <a class="el" href="structCryptModuleSpecs.html#a555d3da530f7c25207fcbae9efa8ab03" title="Get the S/MIME keys required to encrypt this email. ">CryptModuleSpecs::smime_getkeys()</a> </p>

<p class="definition">Definition at line <a class="el" href="cryptglue_8c_source.html#l00463">463</a> of file <a class="el" href="cryptglue_8c_source.html">cryptglue.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;{</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="cryptglue_8c.html#a69a7f3b98b67a0831a8a5e3fc47d5c93">CRYPT_MOD_CALL_CHECK</a>(SMIME, smime_getkeys))</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    <a class="code" href="cryptglue_8c.html#acaf721ab817757c241a5abd18fc8618b">CRYPT_MOD_CALL</a>(SMIME, smime_getkeys)(env);</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;}</div><div class="ttc" id="cryptglue_8c_html_acaf721ab817757c241a5abd18fc8618b"><div class="ttname"><a href="cryptglue_8c.html#acaf721ab817757c241a5abd18fc8618b">CRYPT_MOD_CALL</a></div><div class="ttdeci">#define CRYPT_MOD_CALL(identifier, func)</div><div class="ttdef"><b>Definition:</b> <a href="cryptglue_8c_source.html#l00086">cryptglue.c:86</a></div></div>
<div class="ttc" id="cryptglue_8c_html_a69a7f3b98b67a0831a8a5e3fc47d5c93"><div class="ttname"><a href="cryptglue_8c.html#a69a7f3b98b67a0831a8a5e3fc47d5c93">CRYPT_MOD_CALL_CHECK</a></div><div class="ttdeci">#define CRYPT_MOD_CALL_CHECK(identifier, func)</div><div class="ttdef"><b>Definition:</b> <a href="cryptglue_8c_source.html#l00080">cryptglue.c:80</a></div></div>
</div><!-- fragment --><div id="dynsection-51" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-51-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-51-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-51-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_a3f60f47f4d4dee7f43f502b7244af35f_icgraph.svg" width="447" height="163"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a352931faf3dbfb2f6d2d6c0a32ad830e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a352931faf3dbfb2f6d2d6c0a32ad830e">&#9670;&nbsp;</a></span>crypt_smime_send_menu()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a> crypt_smime_send_menu </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structMailbox.html">Mailbox</a> *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structEmail.html">Email</a> *&#160;</td>
          <td class="paramname"><em>e</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Wrapper for <a class="el" href="structCryptModuleSpecs.html#a276f84536aedc54559c57018a76ff89d" title="Ask the user whether to sign and/or encrypt the email. ">CryptModuleSpecs::send_menu()</a> </p>

<p class="definition">Definition at line <a class="el" href="cryptglue_8c_source.html#l00536">536</a> of file <a class="el" href="cryptglue_8c_source.html">cryptglue.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;{</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="cryptglue_8c.html#a69a7f3b98b67a0831a8a5e3fc47d5c93">CRYPT_MOD_CALL_CHECK</a>(SMIME, send_menu))</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="cryptglue_8c.html#acaf721ab817757c241a5abd18fc8618b">CRYPT_MOD_CALL</a>(SMIME, send_menu)(m, e);</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;}</div><div class="ttc" id="cryptglue_8c_html_acaf721ab817757c241a5abd18fc8618b"><div class="ttname"><a href="cryptglue_8c.html#acaf721ab817757c241a5abd18fc8618b">CRYPT_MOD_CALL</a></div><div class="ttdeci">#define CRYPT_MOD_CALL(identifier, func)</div><div class="ttdef"><b>Definition:</b> <a href="cryptglue_8c_source.html#l00086">cryptglue.c:86</a></div></div>
<div class="ttc" id="cryptglue_8c_html_a69a7f3b98b67a0831a8a5e3fc47d5c93"><div class="ttname"><a href="cryptglue_8c.html#a69a7f3b98b67a0831a8a5e3fc47d5c93">CRYPT_MOD_CALL_CHECK</a></div><div class="ttdeci">#define CRYPT_MOD_CALL_CHECK(identifier, func)</div><div class="ttdef"><b>Definition:</b> <a href="cryptglue_8c_source.html#l00080">cryptglue.c:80</a></div></div>
</div><!-- fragment --><div id="dynsection-52" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-52-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-52-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-52-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_a352931faf3dbfb2f6d2d6c0a32ad830e_icgraph.svg" width="411" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="aa05d4e0d23b75f9074f47ff55d7b724b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa05d4e0d23b75f9074f47ff55d7b724b">&#9670;&nbsp;</a></span>crypt_smime_verify_sender()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int crypt_smime_verify_sender </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structMailbox.html">Mailbox</a> *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structEmail.html">Email</a> *&#160;</td>
          <td class="paramname"><em>e</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structMessage.html">Message</a> *&#160;</td>
          <td class="paramname"><em>msg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Wrapper for <a class="el" href="structCryptModuleSpecs.html#a9257536042f1c581c2d8e142e94ae660" title="Does the sender match the certificate? ">CryptModuleSpecs::smime_verify_sender()</a> </p>

<p class="definition">Definition at line <a class="el" href="cryptglue_8c_source.html#l00472">472</a> of file <a class="el" href="cryptglue_8c_source.html">cryptglue.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;{</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="cryptglue_8c.html#a69a7f3b98b67a0831a8a5e3fc47d5c93">CRYPT_MOD_CALL_CHECK</a>(SMIME, smime_verify_sender))</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="cryptglue_8c.html#acaf721ab817757c241a5abd18fc8618b">CRYPT_MOD_CALL</a>(SMIME, smime_verify_sender)(m, e, msg);</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;  <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;}</div><div class="ttc" id="cryptglue_8c_html_acaf721ab817757c241a5abd18fc8618b"><div class="ttname"><a href="cryptglue_8c.html#acaf721ab817757c241a5abd18fc8618b">CRYPT_MOD_CALL</a></div><div class="ttdeci">#define CRYPT_MOD_CALL(identifier, func)</div><div class="ttdef"><b>Definition:</b> <a href="cryptglue_8c_source.html#l00086">cryptglue.c:86</a></div></div>
<div class="ttc" id="cryptglue_8c_html_a69a7f3b98b67a0831a8a5e3fc47d5c93"><div class="ttname"><a href="cryptglue_8c.html#a69a7f3b98b67a0831a8a5e3fc47d5c93">CRYPT_MOD_CALL_CHECK</a></div><div class="ttdeci">#define CRYPT_MOD_CALL_CHECK(identifier, func)</div><div class="ttdef"><b>Definition:</b> <a href="cryptglue_8c_source.html#l00080">cryptglue.c:80</a></div></div>
</div><!-- fragment --><div id="dynsection-53" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-53-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-53-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-53-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_aa05d4e0d23b75f9074f47ff55d7b724b_icgraph.svg" width="384" height="52"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a6f815761abc33bf614605b9a39b3002b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6f815761abc33bf614605b9a39b3002b">&#9670;&nbsp;</a></span>crypto_module_free()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void crypto_module_free </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Clean up the crypto modules. </p>

<p class="definition">Definition at line <a class="el" href="crypt__mod_8c_source.html#l00081">81</a> of file <a class="el" href="crypt__mod_8c_source.html">crypt_mod.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;{</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <span class="keyword">struct </span><a class="code" href="structCryptModule.html">CryptModule</a> *np = NULL, *tmp = NULL;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  <a class="code" href="queue_8h.html#ac3203dcce73148c142df4586eb55ce55">STAILQ_FOREACH_SAFE</a>(np, &amp;<a class="code" href="crypt__mod_8c.html#af02141bb2d6f54361dee65146fc22c82">CryptModules</a>, entries, tmp)</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  {</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <a class="code" href="queue_8h.html#a2a0d6665f277f80bf301a16e6ab2403c">STAILQ_REMOVE</a>(&amp;<a class="code" href="crypt__mod_8c.html#af02141bb2d6f54361dee65146fc22c82">CryptModules</a>, np, <a class="code" href="structCryptModule.html">CryptModule</a>, entries);</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <a class="code" href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;np);</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  }</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;}</div><div class="ttc" id="queue_8h_html_a2a0d6665f277f80bf301a16e6ab2403c"><div class="ttname"><a href="queue_8h.html#a2a0d6665f277f80bf301a16e6ab2403c">STAILQ_REMOVE</a></div><div class="ttdeci">#define STAILQ_REMOVE(head, elm, type, field)</div><div class="ttdef"><b>Definition:</b> <a href="queue_8h_source.html#l00399">queue.h:399</a></div></div>
<div class="ttc" id="structCryptModule_html"><div class="ttname"><a href="structCryptModule.html">CryptModule</a></div><div class="ttdoc">A crypto plugin module. </div><div class="ttdef"><b>Definition:</b> <a href="crypt__mod_8c_source.html#l00038">crypt_mod.c:38</a></div></div>
<div class="ttc" id="crypt__mod_8c_html_af02141bb2d6f54361dee65146fc22c82"><div class="ttname"><a href="crypt__mod_8c.html#af02141bb2d6f54361dee65146fc22c82">CryptModules</a></div><div class="ttdeci">static struct CryptModuleList CryptModules</div><div class="ttdef"><b>Definition:</b> <a href="crypt__mod_8c_source.html#l00045">crypt_mod.c:45</a></div></div>
<div class="ttc" id="queue_8h_html_ac3203dcce73148c142df4586eb55ce55"><div class="ttname"><a href="queue_8h.html#ac3203dcce73148c142df4586eb55ce55">STAILQ_FOREACH_SAFE</a></div><div class="ttdeci">#define STAILQ_FOREACH_SAFE(var, head, field, tvar)</div><div class="ttdef"><b>Definition:</b> <a href="queue_8h_source.html#l00359">queue.h:359</a></div></div>
<div class="ttc" id="memory_8h_html_a25875003b43b81a4302256caa4a13599"><div class="ttname"><a href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a></div><div class="ttdeci">#define FREE(x)</div><div class="ttdef"><b>Definition:</b> <a href="memory_8h_source.html#l00040">memory.h:40</a></div></div>
</div><!-- fragment --><div id="dynsection-54" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-54-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-54-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-54-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_a6f815761abc33bf614605b9a39b3002b_icgraph.svg" width="266" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a7061521ecb51237cbbc557440353af39"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7061521ecb51237cbbc557440353af39">&#9670;&nbsp;</a></span>pgp_gpgme_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void pgp_gpgme_init </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Implements <a class="el" href="structCryptModuleSpecs.html#a819c87369b2dc3806d846c3a7e9fb7b6" title="Initialise the crypto module. ">CryptModuleSpecs::init()</a> </p>

<p class="definition">Definition at line <a class="el" href="crypt__gpgme_8c_source.html#l04164">4164</a> of file <a class="el" href="crypt__gpgme_8c_source.html">crypt_gpgme.c</a>.</p>
<div class="fragment"><div class="line"><a name="l04165"></a><span class="lineno"> 4165</span>&#160;{</div><div class="line"><a name="l04166"></a><span class="lineno"> 4166</span>&#160;  <a class="code" href="crypt__gpgme_8c.html#a145bf0426df849dc84a86732a6f679f1">init_common</a>();</div><div class="line"><a name="l04167"></a><span class="lineno"> 4167</span>&#160;  <a class="code" href="crypt__gpgme_8c.html#aead4e2c25ab6b1ea42f818cc243cd2d1">init_pgp</a>();</div><div class="line"><a name="l04168"></a><span class="lineno"> 4168</span>&#160;}</div><div class="ttc" id="crypt__gpgme_8c_html_a145bf0426df849dc84a86732a6f679f1"><div class="ttname"><a href="crypt__gpgme_8c.html#a145bf0426df849dc84a86732a6f679f1">init_common</a></div><div class="ttdeci">static void init_common(void)</div><div class="ttdoc">Initialise code common to PGP and SMIME parts of GPGME. </div><div class="ttdef"><b>Definition:</b> <a href="crypt__gpgme_8c_source.html#l04123">crypt_gpgme.c:4123</a></div></div>
<div class="ttc" id="crypt__gpgme_8c_html_aead4e2c25ab6b1ea42f818cc243cd2d1"><div class="ttname"><a href="crypt__gpgme_8c.html#aead4e2c25ab6b1ea42f818cc243cd2d1">init_pgp</a></div><div class="ttdeci">static void init_pgp(void)</div><div class="ttdoc">Initialise the PGP crypto backend. </div><div class="ttdef"><b>Definition:</b> <a href="crypt__gpgme_8c_source.html#l04142">crypt_gpgme.c:4142</a></div></div>
</div><!-- fragment --><div id="dynsection-55" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-55-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-55-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-55-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_a7061521ecb51237cbbc557440353af39_cgraph.svg" width="292" height="88"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div id="dynsection-56" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-56-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-56-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-56-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_a7061521ecb51237cbbc557440353af39_icgraph.svg" width="388" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a2e8df329d00791c453eb6b3f60eabfdf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e8df329d00791c453eb6b3f60eabfdf">&#9670;&nbsp;</a></span>mutt_gpgme_select_secret_key()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mutt_gpgme_select_secret_key </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structBuffer.html">Buffer</a> *&#160;</td>
          <td class="paramname"><em>keyid</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Select a private Autocrypt key for a new account. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">keyid</td><td>Autocrypt Key id </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Success </td></tr>
    <tr><td class="paramname">-1</td><td>Error</td></tr>
  </table>
  </dd>
</dl>
<p>Unfortunately, the internal <a class="el" href="crypt__gpgme_8c.html" title="Wrapper for PGP/SMIME calls to GPGME. ">ncrypt/crypt_gpgme.c</a> functions use <a class="el" href="structCryptKeyInfo.html" title="A stored PGP key. ">CryptKeyInfo</a>, and so aren't exportable.</p>
<p>This function queries all private keys, provides the crypt_select_keys() menu, and returns the selected key fingerprint in keyid. </p>

<p class="definition">Definition at line <a class="el" href="crypt__gpgme_8c_source.html#l03976">3976</a> of file <a class="el" href="crypt__gpgme_8c_source.html">crypt_gpgme.c</a>.</p>
<div class="fragment"><div class="line"><a name="l03977"></a><span class="lineno"> 3977</span>&#160;{</div><div class="line"><a name="l03978"></a><span class="lineno"> 3978</span>&#160;  <span class="keywordtype">int</span> rc = -1, junk;</div><div class="line"><a name="l03979"></a><span class="lineno"> 3979</span>&#160;  gpgme_error_t err;</div><div class="line"><a name="l03980"></a><span class="lineno"> 3980</span>&#160;  gpgme_key_t key = NULL;</div><div class="line"><a name="l03981"></a><span class="lineno"> 3981</span>&#160;  gpgme_user_id_t uid = NULL;</div><div class="line"><a name="l03982"></a><span class="lineno"> 3982</span>&#160;  <span class="keyword">struct </span><a class="code" href="structCryptKeyInfo.html">CryptKeyInfo</a> *results = NULL, *k = NULL;</div><div class="line"><a name="l03983"></a><span class="lineno"> 3983</span>&#160;  <span class="keyword">struct </span><a class="code" href="structCryptKeyInfo.html">CryptKeyInfo</a> **kend = NULL;</div><div class="line"><a name="l03984"></a><span class="lineno"> 3984</span>&#160;  <span class="keyword">struct </span><a class="code" href="structCryptKeyInfo.html">CryptKeyInfo</a> *choice = NULL;</div><div class="line"><a name="l03985"></a><span class="lineno"> 3985</span>&#160;</div><div class="line"><a name="l03986"></a><span class="lineno"> 3986</span>&#160;  gpgme_ctx_t ctx = <a class="code" href="crypt__gpgme_8c.html#a54ca8638b13c6da904a48009a8bba358">create_gpgme_context</a>(<span class="keyword">false</span>);</div><div class="line"><a name="l03987"></a><span class="lineno"> 3987</span>&#160;</div><div class="line"><a name="l03988"></a><span class="lineno"> 3988</span>&#160;  <span class="comment">/* list all secret keys */</span></div><div class="line"><a name="l03989"></a><span class="lineno"> 3989</span>&#160;  <span class="keywordflow">if</span> (gpgme_op_keylist_start(ctx, NULL, 1))</div><div class="line"><a name="l03990"></a><span class="lineno"> 3990</span>&#160;    <span class="keywordflow">goto</span> cleanup;</div><div class="line"><a name="l03991"></a><span class="lineno"> 3991</span>&#160;</div><div class="line"><a name="l03992"></a><span class="lineno"> 3992</span>&#160;  kend = &amp;results;</div><div class="line"><a name="l03993"></a><span class="lineno"> 3993</span>&#160;</div><div class="line"><a name="l03994"></a><span class="lineno"> 3994</span>&#160;  <span class="keywordflow">while</span> (!(err = gpgme_op_keylist_next(ctx, &amp;key)))</div><div class="line"><a name="l03995"></a><span class="lineno"> 3995</span>&#160;  {</div><div class="line"><a name="l03996"></a><span class="lineno"> 3996</span>&#160;    <a class="code" href="ncrypt_2lib_8h.html#a530487c28aacc2c2d50f12eefb8c5506">KeyFlags</a> <a class="code" href="structCryptKeyInfo.html#a2894df08ee0680de1cb45856e8169bda">flags</a> = <a class="code" href="ncrypt_2lib_8h.html#a827146354c736ec416508944692e52b2">KEYFLAG_NO_FLAGS</a>;</div><div class="line"><a name="l03997"></a><span class="lineno"> 3997</span>&#160;</div><div class="line"><a name="l03998"></a><span class="lineno"> 3998</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="crypt__gpgme_8c.html#abb291e3ef82be0b81dd87945790b1ab8">key_check_cap</a>(key, <a class="code" href="crypt__gpgme_8h.html#aedb110bc0a5b06622df514a7b1f9bca7a75ebf9fda903040f7f471570de3b8007">KEY_CAP_CAN_ENCRYPT</a>))</div><div class="line"><a name="l03999"></a><span class="lineno"> 3999</span>&#160;      flags |= <a class="code" href="ncrypt_2lib_8h.html#a7254adf21a76d4ceea08bd931df4310f">KEYFLAG_CANENCRYPT</a>;</div><div class="line"><a name="l04000"></a><span class="lineno"> 4000</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="crypt__gpgme_8c.html#abb291e3ef82be0b81dd87945790b1ab8">key_check_cap</a>(key, <a class="code" href="crypt__gpgme_8h.html#aedb110bc0a5b06622df514a7b1f9bca7ae432daf7afa64983a95cfd196db416d4">KEY_CAP_CAN_SIGN</a>))</div><div class="line"><a name="l04001"></a><span class="lineno"> 4001</span>&#160;      flags |= <a class="code" href="ncrypt_2lib_8h.html#aee8e2da44282ca27f6a786cef781334f">KEYFLAG_CANSIGN</a>;</div><div class="line"><a name="l04002"></a><span class="lineno"> 4002</span>&#160;</div><div class="line"><a name="l04003"></a><span class="lineno"> 4003</span>&#160;    <span class="keywordflow">if</span> (key-&gt;revoked)</div><div class="line"><a name="l04004"></a><span class="lineno"> 4004</span>&#160;      flags |= <a class="code" href="ncrypt_2lib_8h.html#acb95b48318487d9eb8f9709e933d749e">KEYFLAG_REVOKED</a>;</div><div class="line"><a name="l04005"></a><span class="lineno"> 4005</span>&#160;    <span class="keywordflow">if</span> (key-&gt;expired)</div><div class="line"><a name="l04006"></a><span class="lineno"> 4006</span>&#160;      flags |= <a class="code" href="ncrypt_2lib_8h.html#a20472f13517d60d40aa75287afc81c5d">KEYFLAG_EXPIRED</a>;</div><div class="line"><a name="l04007"></a><span class="lineno"> 4007</span>&#160;    <span class="keywordflow">if</span> (key-&gt;disabled)</div><div class="line"><a name="l04008"></a><span class="lineno"> 4008</span>&#160;      flags |= <a class="code" href="ncrypt_2lib_8h.html#a989f3449b764c6a8f5f5e0481569884a">KEYFLAG_DISABLED</a>;</div><div class="line"><a name="l04009"></a><span class="lineno"> 4009</span>&#160;</div><div class="line"><a name="l04010"></a><span class="lineno"> 4010</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="mailbox_8c.html#a103fe1fcacccda7d9cdacde44721faef">idx</a>;</div><div class="line"><a name="l04011"></a><span class="lineno"> 4011</span>&#160;    <span class="keywordflow">for</span> (idx = 0, uid = key-&gt;uids; uid; idx++, uid = uid-&gt;next)</div><div class="line"><a name="l04012"></a><span class="lineno"> 4012</span>&#160;    {</div><div class="line"><a name="l04013"></a><span class="lineno"> 4013</span>&#160;      k = <a class="code" href="memory_8c.html#a4c1612d209c7825d55e6a014df352f03">mutt_mem_calloc</a>(1, <span class="keyword">sizeof</span>(*k));</div><div class="line"><a name="l04014"></a><span class="lineno"> 4014</span>&#160;      k-&gt;kobj = key;</div><div class="line"><a name="l04015"></a><span class="lineno"> 4015</span>&#160;      gpgme_key_ref(k-&gt;kobj);</div><div class="line"><a name="l04016"></a><span class="lineno"> 4016</span>&#160;      k-&gt;idx = <a class="code" href="mailbox_8c.html#a103fe1fcacccda7d9cdacde44721faef">idx</a>;</div><div class="line"><a name="l04017"></a><span class="lineno"> 4017</span>&#160;      k-&gt;uid = uid-&gt;uid;</div><div class="line"><a name="l04018"></a><span class="lineno"> 4018</span>&#160;      k-&gt;flags = <a class="code" href="structCryptKeyInfo.html#a2894df08ee0680de1cb45856e8169bda">flags</a>;</div><div class="line"><a name="l04019"></a><span class="lineno"> 4019</span>&#160;      <span class="keywordflow">if</span> (uid-&gt;revoked)</div><div class="line"><a name="l04020"></a><span class="lineno"> 4020</span>&#160;        k-&gt;flags |= <a class="code" href="ncrypt_2lib_8h.html#acb95b48318487d9eb8f9709e933d749e">KEYFLAG_REVOKED</a>;</div><div class="line"><a name="l04021"></a><span class="lineno"> 4021</span>&#160;      k-&gt;validity = uid-&gt;validity;</div><div class="line"><a name="l04022"></a><span class="lineno"> 4022</span>&#160;      *kend = k;</div><div class="line"><a name="l04023"></a><span class="lineno"> 4023</span>&#160;      kend = &amp;k-&gt;<a class="code" href="structCryptKeyInfo.html#a6ff63ed6d46d28597f6e51b7720fb006">next</a>;</div><div class="line"><a name="l04024"></a><span class="lineno"> 4024</span>&#160;    }</div><div class="line"><a name="l04025"></a><span class="lineno"> 4025</span>&#160;    gpgme_key_unref(key);</div><div class="line"><a name="l04026"></a><span class="lineno"> 4026</span>&#160;  }</div><div class="line"><a name="l04027"></a><span class="lineno"> 4027</span>&#160;  <span class="keywordflow">if</span> (gpg_err_code(err) != GPG_ERR_EOF)</div><div class="line"><a name="l04028"></a><span class="lineno"> 4028</span>&#160;    <a class="code" href="logging_8h.html#acc1fd6d7ab1603e80e11e84e90d061e4">mutt_error</a>(<a class="code" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;gpgme_op_keylist_next failed: %s&quot;</span>), gpgme_strerror(err));</div><div class="line"><a name="l04029"></a><span class="lineno"> 4029</span>&#160;  gpgme_op_keylist_end(ctx);</div><div class="line"><a name="l04030"></a><span class="lineno"> 4030</span>&#160;</div><div class="line"><a name="l04031"></a><span class="lineno"> 4031</span>&#160;  <span class="keywordflow">if</span> (!results)</div><div class="line"><a name="l04032"></a><span class="lineno"> 4032</span>&#160;  {</div><div class="line"><a name="l04033"></a><span class="lineno"> 4033</span>&#160;    <span class="comment">/* L10N: mutt_gpgme_select_secret_key() tries to list all secret keys to choose</span></div><div class="line"><a name="l04034"></a><span class="lineno"> 4034</span>&#160;<span class="comment">       from.  This error is displayed if no results were found.  */</span></div><div class="line"><a name="l04035"></a><span class="lineno"> 4035</span>&#160;    <a class="code" href="logging_8h.html#acc1fd6d7ab1603e80e11e84e90d061e4">mutt_error</a>(<a class="code" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;No secret keys found&quot;</span>));</div><div class="line"><a name="l04036"></a><span class="lineno"> 4036</span>&#160;    <span class="keywordflow">goto</span> cleanup;</div><div class="line"><a name="l04037"></a><span class="lineno"> 4037</span>&#160;  }</div><div class="line"><a name="l04038"></a><span class="lineno"> 4038</span>&#160;</div><div class="line"><a name="l04039"></a><span class="lineno"> 4039</span>&#160;  choice = <a class="code" href="dlggpgme_8c.html#a5617f65588f988b6cafe9d1f3bf63edb">dlg_select_gpgme_key</a>(results, NULL, <span class="stringliteral">&quot;*&quot;</span>, <a class="code" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a>, &amp;junk);</div><div class="line"><a name="l04040"></a><span class="lineno"> 4040</span>&#160;  <span class="keywordflow">if</span> (!(choice &amp;&amp; choice-&gt;<a class="code" href="structCryptKeyInfo.html#ae1f570089508f19aa36f6c1cdb31eca0">kobj</a> &amp;&amp; choice-&gt;<a class="code" href="structCryptKeyInfo.html#ae1f570089508f19aa36f6c1cdb31eca0">kobj</a>-&gt;subkeys &amp;&amp; choice-&gt;<a class="code" href="structCryptKeyInfo.html#ae1f570089508f19aa36f6c1cdb31eca0">kobj</a>-&gt;subkeys-&gt;fpr))</div><div class="line"><a name="l04041"></a><span class="lineno"> 4041</span>&#160;    <span class="keywordflow">goto</span> cleanup;</div><div class="line"><a name="l04042"></a><span class="lineno"> 4042</span>&#160;  <a class="code" href="buffer_8c.html#a4bcc481586ae3af02645b4e23e48e0d7">mutt_buffer_strcpy</a>(keyid, choice-&gt;<a class="code" href="structCryptKeyInfo.html#ae1f570089508f19aa36f6c1cdb31eca0">kobj</a>-&gt;subkeys-&gt;fpr);</div><div class="line"><a name="l04043"></a><span class="lineno"> 4043</span>&#160;</div><div class="line"><a name="l04044"></a><span class="lineno"> 4044</span>&#160;  rc = 0;</div><div class="line"><a name="l04045"></a><span class="lineno"> 4045</span>&#160;</div><div class="line"><a name="l04046"></a><span class="lineno"> 4046</span>&#160;cleanup:</div><div class="line"><a name="l04047"></a><span class="lineno"> 4047</span>&#160;  <a class="code" href="crypt__gpgme_8c.html#ae007f214cde6d7245c8a5ca70da0e4de">crypt_key_free</a>(&amp;choice);</div><div class="line"><a name="l04048"></a><span class="lineno"> 4048</span>&#160;  <a class="code" href="crypt__gpgme_8c.html#ae007f214cde6d7245c8a5ca70da0e4de">crypt_key_free</a>(&amp;results);</div><div class="line"><a name="l04049"></a><span class="lineno"> 4049</span>&#160;  gpgme_release(ctx);</div><div class="line"><a name="l04050"></a><span class="lineno"> 4050</span>&#160;  <span class="keywordflow">return</span> rc;</div><div class="line"><a name="l04051"></a><span class="lineno"> 4051</span>&#160;}</div><div class="ttc" id="memory_8c_html_a4c1612d209c7825d55e6a014df352f03"><div class="ttname"><a href="memory_8c.html#a4c1612d209c7825d55e6a014df352f03">mutt_mem_calloc</a></div><div class="ttdeci">void * mutt_mem_calloc(size_t nmemb, size_t size)</div><div class="ttdoc">Allocate zeroed memory on the heap. </div><div class="ttdef"><b>Definition:</b> <a href="memory_8c_source.html#l00050">memory.c:50</a></div></div>
<div class="ttc" id="crypt__gpgme_8c_html_ae007f214cde6d7245c8a5ca70da0e4de"><div class="ttname"><a href="crypt__gpgme_8c.html#ae007f214cde6d7245c8a5ca70da0e4de">crypt_key_free</a></div><div class="ttdeci">static void crypt_key_free(struct CryptKeyInfo **keylist)</div><div class="ttdoc">Release all the keys in a list. </div><div class="ttdef"><b>Definition:</b> <a href="crypt__gpgme_8c_source.html#l00462">crypt_gpgme.c:462</a></div></div>
<div class="ttc" id="dlggpgme_8c_html_a5617f65588f988b6cafe9d1f3bf63edb"><div class="ttname"><a href="dlggpgme_8c.html#a5617f65588f988b6cafe9d1f3bf63edb">dlg_select_gpgme_key</a></div><div class="ttdeci">struct CryptKeyInfo * dlg_select_gpgme_key(struct CryptKeyInfo *keys, struct Address *p, const char *s, unsigned int app, int *forced_valid)</div><div class="ttdoc">Get the user to select a key. </div><div class="ttdef"><b>Definition:</b> <a href="dlggpgme_8c_source.html#l01319">dlggpgme.c:1319</a></div></div>
<div class="ttc" id="mailbox_8c_html_a103fe1fcacccda7d9cdacde44721faef"><div class="ttname"><a href="mailbox_8c.html#a103fe1fcacccda7d9cdacde44721faef">idx</a></div><div class="ttdeci">size_t idx</div><div class="ttdef"><b>Definition:</b> <a href="mailbox_8c_source.html#l00257">mailbox.c:257</a></div></div>
<div class="ttc" id="mutt_2message_8h_html_a479d658dfd60fe8d9709ec67a58b34ca"><div class="ttname"><a href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a></div><div class="ttdeci">#define _(a)</div><div class="ttdef"><b>Definition:</b> <a href="mutt_2message_8h_source.html#l00028">message.h:28</a></div></div>
<div class="ttc" id="crypt__gpgme_8h_html_aedb110bc0a5b06622df514a7b1f9bca7a75ebf9fda903040f7f471570de3b8007"><div class="ttname"><a href="crypt__gpgme_8h.html#aedb110bc0a5b06622df514a7b1f9bca7a75ebf9fda903040f7f471570de3b8007">KEY_CAP_CAN_ENCRYPT</a></div><div class="ttdoc">Key can be used for encryption. </div><div class="ttdef"><b>Definition:</b> <a href="crypt__gpgme_8h_source.html#l00077">crypt_gpgme.h:77</a></div></div>
<div class="ttc" id="crypt__gpgme_8h_html_aedb110bc0a5b06622df514a7b1f9bca7ae432daf7afa64983a95cfd196db416d4"><div class="ttname"><a href="crypt__gpgme_8h.html#aedb110bc0a5b06622df514a7b1f9bca7ae432daf7afa64983a95cfd196db416d4">KEY_CAP_CAN_SIGN</a></div><div class="ttdoc">Key can be used for signing. </div><div class="ttdef"><b>Definition:</b> <a href="crypt__gpgme_8h_source.html#l00078">crypt_gpgme.h:78</a></div></div>
<div class="ttc" id="structCryptKeyInfo_html_a6ff63ed6d46d28597f6e51b7720fb006"><div class="ttname"><a href="structCryptKeyInfo.html#a6ff63ed6d46d28597f6e51b7720fb006">CryptKeyInfo::next</a></div><div class="ttdeci">struct CryptKeyInfo * next</div><div class="ttdef"><b>Definition:</b> <a href="crypt__gpgme_8h_source.html#l00046">crypt_gpgme.h:46</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a7254adf21a76d4ceea08bd931df4310f"><div class="ttname"><a href="ncrypt_2lib_8h.html#a7254adf21a76d4ceea08bd931df4310f">KEYFLAG_CANENCRYPT</a></div><div class="ttdeci">#define KEYFLAG_CANENCRYPT</div><div class="ttdoc">Key is suitable for encryption. </div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00125">lib.h:125</a></div></div>
<div class="ttc" id="structCryptKeyInfo_html"><div class="ttname"><a href="structCryptKeyInfo.html">CryptKeyInfo</a></div><div class="ttdoc">A stored PGP key. </div><div class="ttdef"><b>Definition:</b> <a href="crypt__gpgme_8h_source.html#l00044">crypt_gpgme.h:44</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a20472f13517d60d40aa75287afc81c5d"><div class="ttname"><a href="ncrypt_2lib_8h.html#a20472f13517d60d40aa75287afc81c5d">KEYFLAG_EXPIRED</a></div><div class="ttdeci">#define KEYFLAG_EXPIRED</div><div class="ttdoc">Key is expired. </div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00128">lib.h:128</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a587e679a4c9cc44f11f0c467bb22b0af"><div class="ttname"><a href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a></div><div class="ttdeci">#define APPLICATION_PGP</div><div class="ttdoc">Use PGP to encrypt/sign. </div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00087">lib.h:87</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a827146354c736ec416508944692e52b2"><div class="ttname"><a href="ncrypt_2lib_8h.html#a827146354c736ec416508944692e52b2">KEYFLAG_NO_FLAGS</a></div><div class="ttdeci">#define KEYFLAG_NO_FLAGS</div><div class="ttdoc">No flags are set. </div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00123">lib.h:123</a></div></div>
<div class="ttc" id="crypt__gpgme_8c_html_a54ca8638b13c6da904a48009a8bba358"><div class="ttname"><a href="crypt__gpgme_8c.html#a54ca8638b13c6da904a48009a8bba358">create_gpgme_context</a></div><div class="ttdeci">gpgme_ctx_t create_gpgme_context(bool for_smime)</div><div class="ttdoc">Create a new GPGME context. </div><div class="ttdef"><b>Definition:</b> <a href="crypt__gpgme_8c_source.html#l00571">crypt_gpgme.c:571</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a530487c28aacc2c2d50f12eefb8c5506"><div class="ttname"><a href="ncrypt_2lib_8h.html#a530487c28aacc2c2d50f12eefb8c5506">KeyFlags</a></div><div class="ttdeci">uint16_t KeyFlags</div><div class="ttdoc">Flags describing PGP/SMIME keys, e.g. KEYFLAG_CANSIGN. </div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00122">lib.h:122</a></div></div>
<div class="ttc" id="structCryptKeyInfo_html_ae1f570089508f19aa36f6c1cdb31eca0"><div class="ttname"><a href="structCryptKeyInfo.html#ae1f570089508f19aa36f6c1cdb31eca0">CryptKeyInfo::kobj</a></div><div class="ttdeci">gpgme_key_t kobj</div><div class="ttdef"><b>Definition:</b> <a href="crypt__gpgme_8h_source.html#l00047">crypt_gpgme.h:47</a></div></div>
<div class="ttc" id="crypt__gpgme_8c_html_abb291e3ef82be0b81dd87945790b1ab8"><div class="ttname"><a href="crypt__gpgme_8c.html#abb291e3ef82be0b81dd87945790b1ab8">key_check_cap</a></div><div class="ttdeci">unsigned int key_check_cap(gpgme_key_t key, enum KeyCap cap)</div><div class="ttdoc">Check the capabilities of a key. </div><div class="ttdef"><b>Definition:</b> <a href="crypt__gpgme_8c_source.html#l03256">crypt_gpgme.c:3256</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_a989f3449b764c6a8f5f5e0481569884a"><div class="ttname"><a href="ncrypt_2lib_8h.html#a989f3449b764c6a8f5f5e0481569884a">KEYFLAG_DISABLED</a></div><div class="ttdeci">#define KEYFLAG_DISABLED</div><div class="ttdoc">Key is marked disabled. </div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00130">lib.h:130</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_aee8e2da44282ca27f6a786cef781334f"><div class="ttname"><a href="ncrypt_2lib_8h.html#aee8e2da44282ca27f6a786cef781334f">KEYFLAG_CANSIGN</a></div><div class="ttdeci">#define KEYFLAG_CANSIGN</div><div class="ttdoc">Key is suitable for signing. </div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00124">lib.h:124</a></div></div>
<div class="ttc" id="buffer_8c_html_a4bcc481586ae3af02645b4e23e48e0d7"><div class="ttname"><a href="buffer_8c.html#a4bcc481586ae3af02645b4e23e48e0d7">mutt_buffer_strcpy</a></div><div class="ttdeci">size_t mutt_buffer_strcpy(struct Buffer *buf, const char *s)</div><div class="ttdoc">Copy a string into a Buffer. </div><div class="ttdef"><b>Definition:</b> <a href="buffer_8c_source.html#l00312">buffer.c:312</a></div></div>
<div class="ttc" id="structCryptKeyInfo_html_a2894df08ee0680de1cb45856e8169bda"><div class="ttname"><a href="structCryptKeyInfo.html#a2894df08ee0680de1cb45856e8169bda">CryptKeyInfo::flags</a></div><div class="ttdeci">KeyFlags flags</div><div class="ttdoc">global and per uid flags (for convenience) </div><div class="ttdef"><b>Definition:</b> <a href="crypt__gpgme_8h_source.html#l00050">crypt_gpgme.h:50</a></div></div>
<div class="ttc" id="logging_8h_html_acc1fd6d7ab1603e80e11e84e90d061e4"><div class="ttname"><a href="logging_8h.html#acc1fd6d7ab1603e80e11e84e90d061e4">mutt_error</a></div><div class="ttdeci">#define mutt_error(...)</div><div class="ttdef"><b>Definition:</b> <a href="logging_8h_source.html#l00084">logging.h:84</a></div></div>
<div class="ttc" id="ncrypt_2lib_8h_html_acb95b48318487d9eb8f9709e933d749e"><div class="ttname"><a href="ncrypt_2lib_8h.html#acb95b48318487d9eb8f9709e933d749e">KEYFLAG_REVOKED</a></div><div class="ttdeci">#define KEYFLAG_REVOKED</div><div class="ttdoc">Key is revoked. </div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00129">lib.h:129</a></div></div>
</div><!-- fragment --><div id="dynsection-57" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-57-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-57-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-57-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_a2e8df329d00791c453eb6b3f60eabfdf_cgraph.svg" width="459" height="291"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div id="dynsection-58" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-58-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-58-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-58-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_a2e8df329d00791c453eb6b3f60eabfdf_icgraph.svg" width="463" height="52"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a6d2692bdc72ffa198bb8ca2a28cfa395"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6d2692bdc72ffa198bb8ca2a28cfa395">&#9670;&nbsp;</a></span>mutt_gpgme_print_version()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* mutt_gpgme_print_version </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get version of GPGME. </p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">ptr</td><td>GPGME version string </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="crypt__gpgme_8c_source.html#l04467">4467</a> of file <a class="el" href="crypt__gpgme_8c_source.html">crypt_gpgme.c</a>.</p>
<div class="fragment"><div class="line"><a name="l04468"></a><span class="lineno"> 4468</span>&#160;{</div><div class="line"><a name="l04469"></a><span class="lineno"> 4469</span>&#160;  <span class="keywordflow">return</span> GPGME_VERSION;</div><div class="line"><a name="l04470"></a><span class="lineno"> 4470</span>&#160;}</div></div><!-- fragment --><div id="dynsection-59" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-59-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-59-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-59-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_a6d2692bdc72ffa198bb8ca2a28cfa395_icgraph.svg" width="363" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
</body>
</html>
